<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Windows 服务配置指南 | CodeVerse | 技术宇宙</title><meta name="author" content="vilas"><meta name="copyright" content="vilas"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="详细的技术安装与配置指南，提供从零开始的完整部署流程，包含环境检查、依赖安装、参数配置、测试验证等关键步骤。">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows 服务配置指南">
<meta property="og:url" content="https://vilaswang.github.io/posts/7a1e3650/index.html">
<meta property="og:site_name" content="CodeVerse | 技术宇宙">
<meta property="og:description" content="详细的技术安装与配置指南，提供从零开始的完整部署流程，包含环境检查、依赖安装、参数配置、测试验证等关键步骤。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://vilaswang.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-12-04T14:47:58.000Z">
<meta property="article:modified_time" content="2025-12-17T15:36:29.266Z">
<meta property="article:author" content="vilas">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="服务器">
<meta property="article:tag" content="服务管理">
<meta property="article:tag" content="系统配置">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://vilaswang.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Windows 服务配置指南",
  "url": "https://vilaswang.github.io/posts/7a1e3650/",
  "image": "https://vilaswang.github.io/img/butterfly-icon.png",
  "datePublished": "2025-12-04T14:47:58.000Z",
  "dateModified": "2025-12-17T15:36:29.266Z",
  "author": [
    {
      "@type": "Person",
      "name": "vilas",
      "url": "https://VilasWang.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://vilaswang.github.io/posts/7a1e3650/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'undefined')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Windows 服务配置指南',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><style> .top-announcement { background: linear-gradient(90deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); color: #333; text-align: center; padding: 10px 0; font-size: 14px; font-weight: bold; width: 100%; border-bottom: 1px solid #eee; } </style><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="CodeVerse | 技术宇宙" type="application/atom+xml">
</head><body><div class="bg-animation" id="web_bg" style="background: [object Object];"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">155</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user-circle"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">CodeVerse | 技术宇宙</span></a><a class="nav-page-title" href="/"><span class="site-name">Windows 服务配置指南</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user-circle"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Windows 服务配置指南</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-12-04T14:47:58.000Z" title="发表于 2025-12-04 22:47:58">2025-12-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-17T15:36:29.266Z" title="更新于 2025-12-17 23:36:29">2025-12-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86/">系统运维管理</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%B3%BB%E7%BB%9F%E8%BF%90%E7%BB%B4%E7%AE%A1%E7%90%86/Windows%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86/">Windows服务管理</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Windows-服务配置指南"><a href="#Windows-服务配置指南" class="headerlink" title="Windows 服务配置指南"></a>Windows 服务配置指南</h1><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><a href="#windows-%E6%9C%8D%E5%8A%A1%E6%A6%82%E8%BF%B0">Windows 服务概述</a></li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80">服务管理基础</a></li>
<li><a href="#%E5%B8%B8%E8%A7%81%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE">常见服务配置</a></li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E4%BC%98%E5%8C%96">服务优化</a></li>
<li><a href="#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4">故障排除</a></li>
<li><a href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E7%AE%A1%E7%90%86">自动化管理</a></li>
<li><a href="#%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE">安全配置</a></li>
</ul>
<h2 id="Windows-服务概述"><a href="#Windows-服务概述" class="headerlink" title="Windows 服务概述"></a>Windows 服务概述</h2><p>Windows 服务是在后台运行的程序，不依赖于用户登录，提供系统级功能。</p>
<h3 id="服务特点"><a href="#服务特点" class="headerlink" title="服务特点"></a>服务特点</h3><ul>
<li><strong>后台运行</strong>: 无需用户交互</li>
<li><strong>自动启动</strong>: 可配置为系统启动时自动运行</li>
<li><strong>系统权限</strong>: 通常以系统账户运行</li>
<li><strong>可管理</strong>: 通过服务管理器进行控制</li>
</ul>
<h3 id="服务类型"><a href="#服务类型" class="headerlink" title="服务类型"></a>服务类型</h3><ul>
<li><strong>内置服务</strong>: Windows 系统自带的服务</li>
<li><strong>第三方服务</strong>: 应用程序安装的服务</li>
<li><strong>自定义服务</strong>: 用户开发的 Windows 服务</li>
</ul>
<h2 id="服务管理基础"><a href="#服务管理基础" class="headerlink" title="服务管理基础"></a>服务管理基础</h2><h3 id="服务管理器界面"><a href="#服务管理器界面" class="headerlink" title="服务管理器界面"></a>服务管理器界面</h3><h4 id="打开服务管理器"><a href="#打开服务管理器" class="headerlink" title="打开服务管理器"></a>打开服务管理器</h4><ol>
<li><strong>运行命令</strong>: <code>services.msc</code></li>
<li><strong>控制面板</strong>: 控制面板 → 管理工具 → 服务</li>
<li><strong>任务管理器</strong>: 任务管理器 → 服务选项卡</li>
<li><strong>PowerShell</strong>: <code>Get-Service</code></li>
</ol>
<h4 id="服务管理器界面说明"><a href="#服务管理器界面说明" class="headerlink" title="服务管理器界面说明"></a>服务管理器界面说明</h4><ul>
<li><strong>名称</strong>: 服务显示名称</li>
<li><strong>描述</strong>: 服务功能说明</li>
<li><strong>状态</strong>: 运行状态（运行中&#x2F;已停止）</li>
<li><strong>启动类型</strong>: 启动方式</li>
<li><strong>登录身份</strong>: 服务运行账户</li>
<li><strong>进程ID</strong>: 服务进程标识符</li>
</ul>
<h3 id="命令行管理"><a href="#命令行管理" class="headerlink" title="命令行管理"></a>命令行管理</h3><h4 id="net-命令"><a href="#net-命令" class="headerlink" title="net 命令"></a>net 命令</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span></span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">net</span> stop 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">pause</span> 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">net</span> continue 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> | <span class="built_in">findstr</span> &quot;服务名称&quot;</span><br></pre></td></tr></table></figure>

<h4 id="sc-命令"><a href="#sc-命令" class="headerlink" title="sc 命令"></a>sc 命令</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line">sc query 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc qc 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc <span class="built_in">start</span> 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc stop 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc <span class="built_in">pause</span> 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc continue 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc delete 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc create 服务名称 binPath= &quot;C:\<span class="built_in">path</span>\to\service.exe&quot; <span class="built_in">start</span>= auto DisplayName= &quot;显示名称&quot;</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc config 服务名称 <span class="built_in">start</span>= delayed-auto</span><br><span class="line">sc config 服务名称 binPath= &quot;C:\new\<span class="built_in">path</span>\to\service.exe&quot;</span><br><span class="line">sc config 服务名称 DisplayName= &quot;新显示名称&quot;</span><br></pre></td></tr></table></figure>

<h4 id="PowerShell-命令"><a href="#PowerShell-命令" class="headerlink" title="PowerShell 命令"></a>PowerShell 命令</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Get-Service</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Start-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Stop-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Restart-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Suspend-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Resume-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span> | <span class="built_in">Select-Object</span> Status, StartType</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span> <span class="literal">-StartupType</span> Automatic</span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span> <span class="literal">-StartupType</span> AutomaticDelayedStart</span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span> <span class="literal">-StartupType</span> Manual</span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;服务名称&quot;</span> <span class="literal">-StartupType</span> Disabled</span><br></pre></td></tr></table></figure>

<h2 id="常见服务配置"><a href="#常见服务配置" class="headerlink" title="常见服务配置"></a>常见服务配置</h2><h3 id="MySQL-服务配置"><a href="#MySQL-服务配置" class="headerlink" title="MySQL 服务配置"></a>MySQL 服务配置</h3><h4 id="安装-MySQL-服务"><a href="#安装-MySQL-服务" class="headerlink" title="安装 MySQL 服务"></a>安装 MySQL 服务</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">cd</span> D:\Software\MySQL\bin</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">mysqld --initialize --console</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">mysqld --install MySQL --defaults-file=&quot;D:\Software\MySQL\my.ini&quot;</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> MySQL</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc config MySQL <span class="built_in">start</span>= auto</span><br></pre></td></tr></table></figure>

<h4 id="服务管理脚本"><a href="#服务管理脚本" class="headerlink" title="服务管理脚本"></a>服务管理脚本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">rem mysql_service_manager.bat</span><br><span class="line"></span><br><span class="line">set MYSQL_HOME=D:\Software\MySQL</span><br><span class="line">set MYSQL_SERVICE=MySQL</span><br><span class="line"></span><br><span class="line">echo MySQL Service Manager</span><br><span class="line">echo ======================</span><br><span class="line"></span><br><span class="line">:menu</span><br><span class="line">echo 1. Start MySQL Service</span><br><span class="line">echo 2. Stop MySQL Service</span><br><span class="line">echo 3. Restart MySQL Service</span><br><span class="line">echo 4. Check Service Status</span><br><span class="line">echo 5. View MySQL Log</span><br><span class="line">echo 6. Connect to MySQL</span><br><span class="line">echo 7. Exit</span><br><span class="line">set /p choice=&quot;Enter choice: &quot;</span><br><span class="line"></span><br><span class="line">if &quot;%choice%&quot;==&quot;1&quot; (</span><br><span class="line">    echo Starting MySQL service...</span><br><span class="line">    net start %MYSQL_SERVICE%</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;2&quot; (</span><br><span class="line">    echo Stopping MySQL service...</span><br><span class="line">    net stop %MYSQL_SERVICE%</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;3&quot; (</span><br><span class="line">    echo Restarting MySQL service...</span><br><span class="line">    net stop %MYSQL_SERVICE%</span><br><span class="line">    timeout /t 2 &gt;nul</span><br><span class="line">    net start %MYSQL_SERVICE%</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;4&quot; (</span><br><span class="line">    echo Checking MySQL service status...</span><br><span class="line">    sc query %MYSQL_SERVICE%</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;5&quot; (</span><br><span class="line">    echo Opening MySQL log...</span><br><span class="line">    type &quot;%MYSQL_HOME%\data\*.err&quot; | more</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;6&quot; (</span><br><span class="line">    echo Connecting to MySQL...</span><br><span class="line">    &quot;%MYSQL_HOME%\bin\mysql.exe&quot; -u root -p</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;7&quot; (</span><br><span class="line">    echo Exiting...</span><br><span class="line">    exit /b 0</span><br><span class="line">) else (</span><br><span class="line">    echo Invalid choice!</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">timeout /t 2 &gt;nul</span><br><span class="line">goto menu</span><br></pre></td></tr></table></figure>

<h3 id="Redis-服务配置"><a href="#Redis-服务配置" class="headerlink" title="Redis 服务配置"></a>Redis 服务配置</h3><h4 id="安装-Redis-服务"><a href="#安装-Redis-服务" class="headerlink" title="安装 Redis 服务"></a>安装 Redis 服务</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">cd</span> D:\Software\Redis</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">redis-server --service-install redis.windows.conf --service-name Redis</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">redis-server --service-<span class="built_in">start</span> --service-name Redis</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc config Redis <span class="built_in">start</span>= auto</span><br></pre></td></tr></table></figure>

<h3 id="IIS-服务配置"><a href="#IIS-服务配置" class="headerlink" title="IIS 服务配置"></a>IIS 服务配置</h3><h4 id="启用-IIS-服务"><a href="#启用-IIS-服务" class="headerlink" title="启用 IIS 服务"></a>启用 IIS 服务</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line">dism /online /enable-feature /featurename:IIS-WebServerRole</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> w3svc</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc config w3svc <span class="built_in">start</span>= auto</span><br></pre></td></tr></table></figure>

<h4 id="IIS-服务管理脚本"><a href="#IIS-服务管理脚本" class="headerlink" title="IIS 服务管理脚本"></a>IIS 服务管理脚本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">rem iis_service_manager.bat</span><br><span class="line"></span><br><span class="line">echo IIS Service Manager</span><br><span class="line">echo ===================</span><br><span class="line"></span><br><span class="line">:menu</span><br><span class="line">echo 1. Start IIS Service</span><br><span class="line">echo 2. Stop IIS Service</span><br><span class="line">echo 3. Restart IIS Service</span><br><span class="line">echo 4. Check Service Status</span><br><span class="line">echo 5. Reset IIS</span><br><span class="line">echo 6. View IIS Log</span><br><span class="line">echo 7. Exit</span><br><span class="line">set /p choice=&quot;Enter choice: &quot;</span><br><span class="line"></span><br><span class="line">if &quot;%choice%&quot;==&quot;1&quot; (</span><br><span class="line">    echo Starting IIS service...</span><br><span class="line">    net start w3svc</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;2&quot; (</span><br><span class="line">    echo Stopping IIS service...</span><br><span class="line">    net stop w3svc</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;3&quot; (</span><br><span class="line">    echo Restarting IIS service...</span><br><span class="line">    net stop w3svc</span><br><span class="line">    timeout /t 2 &gt;nul</span><br><span class="line">    net start w3svc</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;4&quot; (</span><br><span class="line">    echo Checking IIS service status...</span><br><span class="line">    sc query w3svc</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;5&quot; (</span><br><span class="line">    echo Resetting IIS...</span><br><span class="line">    iisreset</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;6&quot; (</span><br><span class="line">    echo Opening IIS log...</span><br><span class="line">    type &quot;C:\inetpub\logs\LogFiles\W3SVC1\*.log&quot; | more</span><br><span class="line">) else if &quot;%choice%&quot;==&quot;7&quot; (</span><br><span class="line">    echo Exiting...</span><br><span class="line">    exit /b 0</span><br><span class="line">) else (</span><br><span class="line">    echo Invalid choice!</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">timeout /t 2 &gt;nul</span><br><span class="line">goto menu</span><br></pre></td></tr></table></figure>

<h2 id="服务优化"><a href="#服务优化" class="headerlink" title="服务优化"></a>服务优化</h2><h3 id="启动类型优化"><a href="#启动类型优化" class="headerlink" title="启动类型优化"></a>启动类型优化</h3><h4 id="启动类型说明"><a href="#启动类型说明" class="headerlink" title="启动类型说明"></a>启动类型说明</h4><ul>
<li><strong>自动 (Automatic)</strong>: 系统启动时自动启动</li>
<li><strong>自动(延迟启动) (AutomaticDelayedStart)</strong>: 系统启动后延迟启动</li>
<li><strong>手动 (Manual)</strong>: 需要手动启动</li>
<li><strong>已禁用 (Disabled)</strong>: 禁用服务</li>
<li><strong>触发启动 (Trigger Start)</strong>: 通过事件触发启动</li>
</ul>
<h4 id="优化建议"><a href="#优化建议" class="headerlink" title="优化建议"></a>优化建议</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;AdobeARMservice&quot;</span> <span class="literal">-StartupType</span> AutomaticDelayedStart</span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;GoogleChromeElevationService&quot;</span> <span class="literal">-StartupType</span> AutomaticDelayedStart</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;Fax&quot;</span> <span class="literal">-StartupType</span> Disabled</span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;Spooler&quot;</span> <span class="literal">-StartupType</span> Disabled  <span class="comment"># 如果不需要打印</span></span><br><span class="line"><span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="string">&quot;RemoteRegistry&quot;</span> <span class="literal">-StartupType</span> Disabled  <span class="comment"># 安全考虑</span></span><br></pre></td></tr></table></figure>

<h3 id="服务依赖关系"><a href="#服务依赖关系" class="headerlink" title="服务依赖关系"></a>服务依赖关系</h3><h4 id="查看服务依赖"><a href="#查看服务依赖" class="headerlink" title="查看服务依赖"></a>查看服务依赖</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line">sc enumdepend 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc qdepend 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">Get-Service -Name &quot;服务名称&quot; | Select-Object DependentServices, ServicesDependedOn</span><br></pre></td></tr></table></figure>

<h4 id="批量服务管理"><a href="#批量服务管理" class="headerlink" title="批量服务管理"></a>批量服务管理</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$service</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="string">&quot;主服务名称&quot;</span></span><br><span class="line"><span class="variable">$service</span>.ServicesDependedOn | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_</span>.Status <span class="operator">-eq</span> <span class="string">&quot;Stopped&quot;</span>) &#123;</span><br><span class="line">        <span class="built_in">Start-Service</span> <span class="variable">$_</span>.Name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$service</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="string">&quot;主服务名称&quot;</span></span><br><span class="line"><span class="variable">$service</span>.DependentServices | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_</span>.Status <span class="operator">-eq</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">        <span class="built_in">Stop-Service</span> <span class="variable">$_</span>.Name <span class="literal">-Force</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="性能监控"><a href="#性能监控" class="headerlink" title="性能监控"></a>性能监控</h3><h4 id="服务监控脚本"><a href="#服务监控脚本" class="headerlink" title="服务监控脚本"></a>服务监控脚本</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$services</span> = <span class="selector-tag">@</span>(<span class="string">&quot;MySQL&quot;</span>, <span class="string">&quot;Redis&quot;</span>, <span class="string">&quot;w3svc&quot;</span>)</span><br><span class="line"><span class="variable">$logFile</span> = <span class="string">&quot;C:\logs\service_monitor.log&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Write-Log</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(<span class="variable">$message</span>)</span><br><span class="line">    <span class="variable">$timestamp</span> = <span class="built_in">Get-Date</span> <span class="literal">-Format</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span></span><br><span class="line">    <span class="built_in">Add-Content</span> <span class="variable">$logFile</span> <span class="string">&quot;<span class="variable">$timestamp</span> - <span class="variable">$message</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$true</span>) &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$serviceName</span> <span class="keyword">in</span> <span class="variable">$services</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable">$service</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="variable">$serviceName</span> <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$service</span>.Status <span class="operator">-ne</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">                <span class="built_in">Write-Log</span> <span class="string">&quot;<span class="variable">$serviceName</span> is not running (Status: <span class="variable">$</span>(<span class="variable">$service</span>.Status))&quot;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># 尝试启动服务</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="built_in">Start-Service</span> <span class="literal">-Name</span> <span class="variable">$serviceName</span> <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">                    <span class="built_in">Write-Log</span> <span class="string">&quot;Successfully started <span class="variable">$serviceName</span>&quot;</span></span><br><span class="line">                &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">                    <span class="built_in">Write-Log</span> <span class="string">&quot;Failed to start <span class="variable">$serviceName:</span> <span class="variable">$_</span>&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="built_in">Write-Log</span> <span class="string">&quot;Error checking <span class="variable">$serviceName:</span> <span class="variable">$_</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 每5分钟检查一次</span></span><br><span class="line">    <span class="built_in">Start-Sleep</span> <span class="literal">-Seconds</span> <span class="number">300</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="资源使用监控"><a href="#资源使用监控" class="headerlink" title="资源使用监控"></a>资源使用监控</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Get-Process</span> | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span>.ProcessName <span class="operator">-in</span> <span class="selector-tag">@</span>(<span class="string">&quot;mysqld&quot;</span>, <span class="string">&quot;redis-server&quot;</span>, <span class="string">&quot;w3wp&quot;</span>)&#125; |</span><br><span class="line">    <span class="built_in">Select-Object</span> ProcessName, CPU, WorkingSet, PrivateMemorySize, StartTime |</span><br><span class="line">    <span class="built_in">Format-Table</span> <span class="literal">-AutoSize</span></span><br></pre></td></tr></table></figure>

<h2 id="故障排除"><a href="#故障排除" class="headerlink" title="故障排除"></a>故障排除</h2><h3 id="常见服务问题"><a href="#常见服务问题" class="headerlink" title="常见服务问题"></a>常见服务问题</h3><h4 id="服务无法启动"><a href="#服务无法启动" class="headerlink" title="服务无法启动"></a>服务无法启动</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line">sc query 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">eventvwr.msc</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc enumdepend 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">&quot;C:\<span class="built_in">path</span>\to\service.exe&quot; --test</span><br></pre></td></tr></table></figure>

<h4 id="服务启动后自动停止"><a href="#服务启动后自动停止" class="headerlink" title="服务启动后自动停止"></a>服务启动后自动停止</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line">sc query 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">wevtutil qe System /c:<span class="number">1</span> /<span class="built_in">rd</span>:true /f:text | <span class="built_in">findstr</span> &quot;服务名称&quot;</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">sc qc 服务名称</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">icacls &quot;C:\<span class="built_in">path</span>\to\service.exe&quot;</span><br></pre></td></tr></table></figure>

<h4 id="服务响应超时"><a href="#服务响应超时" class="headerlink" title="服务响应超时"></a>服务响应超时</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Windows 服务配置指南</span><br><span class="line">sc config 服务名称 <span class="built_in">start</span>= delayed-auto</span><br><span class="line"></span><br><span class="line"># Windows 服务配置指南</span><br><span class="line">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\服务名称&quot; /v &quot;Timeout&quot; /t REG_DWORD /d <span class="number">180000</span> /f</span><br></pre></td></tr></table></figure>

<h3 id="诊断工具"><a href="#诊断工具" class="headerlink" title="诊断工具"></a>诊断工具</h3><h4 id="服务诊断工具"><a href="#服务诊断工具" class="headerlink" title="服务诊断工具"></a>服务诊断工具</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Diagnose-Service</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(<span class="variable">$serviceName</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;=== Service Diagnosis for <span class="variable">$serviceName</span> ===&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查服务是否存在</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$service</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="variable">$serviceName</span> <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;Service Found: <span class="variable">$</span>(<span class="variable">$service</span>.DisplayName)&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;Service not found: <span class="variable">$serviceName</span>&quot;</span> <span class="literal">-ForegroundColor</span> Red</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查服务状态</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Status: <span class="variable">$</span>(<span class="variable">$service</span>.Status)&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;StartType: <span class="variable">$</span>(<span class="variable">$service</span>.StartType)&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查服务进程</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$service</span>.Status <span class="operator">-eq</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable">$process</span> = <span class="built_in">Get-Process</span> <span class="literal">-Id</span> <span class="variable">$service</span>.Id <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;Process ID: <span class="variable">$</span>(<span class="variable">$process</span>.Id)&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;CPU Time: <span class="variable">$</span>(<span class="variable">$process</span>.CPU)&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;Memory: <span class="variable">$</span>([math]::Round(<span class="variable">$process</span>.WorkingSet/1MB, 2)) MB&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;Process not found for service&quot;</span> <span class="literal">-ForegroundColor</span> Yellow</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查服务依赖</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Dependencies:&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line">    <span class="variable">$service</span>.ServicesDependedOn | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;  - <span class="variable">$</span>(<span class="variable">$_</span>.Name) (<span class="variable">$</span>(<span class="variable">$_</span>.Status))&quot;</span> <span class="literal">-ForegroundColor</span> White</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查依赖服务</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Dependent Services:&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line">    <span class="variable">$service</span>.DependentServices | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;  - <span class="variable">$</span>(<span class="variable">$_</span>.Name) (<span class="variable">$</span>(<span class="variable">$_</span>.Status))&quot;</span> <span class="literal">-ForegroundColor</span> White</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查服务配置</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Service Configuration:&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line">    <span class="variable">$config</span> = sc.exe qc <span class="variable">$serviceName</span></span><br><span class="line">    <span class="variable">$config</span> | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span> <span class="operator">-match</span> <span class="string">&quot;START_TYPE|BINARY_PATH_NAME|DISPLAY_NAME&quot;</span>&#125; | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;  <span class="variable">$_</span>&quot;</span> <span class="literal">-ForegroundColor</span> White</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查事件日志</span></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Recent Events:&quot;</span> <span class="literal">-ForegroundColor</span> Cyan</span><br><span class="line">    <span class="variable">$events</span> = <span class="built_in">Get-WinEvent</span> <span class="literal">-LogName</span> System <span class="literal">-MaxEvents</span> <span class="number">10</span> | <span class="built_in">Where-Object</span> &#123;</span><br><span class="line">        <span class="variable">$_</span>.ProviderName <span class="operator">-eq</span> <span class="string">&quot;Service Control Manager&quot;</span> <span class="operator">-and</span> <span class="variable">$_</span>.Message <span class="operator">-match</span> <span class="variable">$serviceName</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$events</span>) &#123;</span><br><span class="line">        <span class="variable">$events</span> | <span class="built_in">ForEach-Object</span> &#123;</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;  <span class="variable">$</span>(<span class="variable">$_</span>.TimeCreated) - <span class="variable">$</span>(<span class="variable">$_</span>.Message)&quot;</span> <span class="literal">-ForegroundColor</span> White</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;  No recent events found&quot;</span> <span class="literal">-ForegroundColor</span> Yellow</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line">Diagnose<span class="literal">-Service</span> <span class="string">&quot;MySQL&quot;</span></span><br><span class="line">Diagnose<span class="literal">-Service</span> <span class="string">&quot;w3svc&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="服务恢复脚本"><a href="#服务恢复脚本" class="headerlink" title="服务恢复脚本"></a>服务恢复脚本</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Repair-Service</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(<span class="variable">$serviceName</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Attempting to repair service: <span class="variable">$serviceName</span>&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment"># 停止服务</span></span><br><span class="line">        <span class="built_in">Stop-Service</span> <span class="literal">-Name</span> <span class="variable">$serviceName</span> <span class="literal">-Force</span> <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;Service stopped successfully&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 等待2秒</span></span><br><span class="line">        <span class="built_in">Start-Sleep</span> <span class="literal">-Seconds</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 启动服务</span></span><br><span class="line">        <span class="built_in">Start-Service</span> <span class="literal">-Name</span> <span class="variable">$serviceName</span> <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;Service started successfully&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 验证服务状态</span></span><br><span class="line">        <span class="variable">$service</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="variable">$serviceName</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$service</span>.Status <span class="operator">-eq</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;Service repair successful!&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;Service repair failed. Status: <span class="variable">$</span>(<span class="variable">$service</span>.Status)&quot;</span> <span class="literal">-ForegroundColor</span> Red</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;Error repairing service: <span class="variable">$_</span>&quot;</span> <span class="literal">-ForegroundColor</span> Red</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="自动化管理"><a href="#自动化管理" class="headerlink" title="自动化管理"></a>自动化管理</h2><h3 id="批量服务管理-1"><a href="#批量服务管理-1" class="headerlink" title="批量服务管理"></a>批量服务管理</h3><h4 id="批量启动-停止服务"><a href="#批量启动-停止服务" class="headerlink" title="批量启动&#x2F;停止服务"></a>批量启动&#x2F;停止服务</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$servicesToStart</span> = <span class="selector-tag">@</span>(<span class="string">&quot;MySQL&quot;</span>, <span class="string">&quot;Redis&quot;</span>, <span class="string">&quot;w3svc&quot;</span>)</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$service</span> <span class="keyword">in</span> <span class="variable">$servicesToStart</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$svc</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="variable">$service</span> <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$svc</span>.Status <span class="operator">-ne</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">            <span class="built_in">Start-Service</span> <span class="literal">-Name</span> <span class="variable">$service</span></span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;Started <span class="variable">$service</span>&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;<span class="variable">$service</span> is already running&quot;</span> <span class="literal">-ForegroundColor</span> Yellow</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;Failed to start <span class="variable">$service:</span> <span class="variable">$_</span>&quot;</span> <span class="literal">-ForegroundColor</span> Red</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$servicesToStop</span> = <span class="selector-tag">@</span>(<span class="string">&quot;MySQL&quot;</span>, <span class="string">&quot;Redis&quot;</span>, <span class="string">&quot;w3svc&quot;</span>)</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$service</span> <span class="keyword">in</span> <span class="variable">$servicesToStop</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$svc</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="variable">$service</span> <span class="literal">-ErrorAction</span> Stop</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$svc</span>.Status <span class="operator">-eq</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">            <span class="built_in">Stop-Service</span> <span class="literal">-Name</span> <span class="variable">$service</span> <span class="literal">-Force</span></span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;Stopped <span class="variable">$service</span>&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;<span class="variable">$service</span> is already stopped&quot;</span> <span class="literal">-ForegroundColor</span> Yellow</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;Failed to stop <span class="variable">$service:</span> <span class="variable">$_</span>&quot;</span> <span class="literal">-ForegroundColor</span> Red</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="定时任务管理"><a href="#定时任务管理" class="headerlink" title="定时任务管理"></a>定时任务管理</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$action</span> = &#123;</span><br><span class="line">    <span class="variable">$services</span> = <span class="selector-tag">@</span>(<span class="string">&quot;MySQL&quot;</span>, <span class="string">&quot;Redis&quot;</span>, <span class="string">&quot;w3svc&quot;</span>)</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$service</span> <span class="keyword">in</span> <span class="variable">$services</span>) &#123;</span><br><span class="line">        <span class="variable">$svc</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="variable">$service</span> <span class="literal">-ErrorAction</span> SilentlyContinue</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$svc</span> <span class="operator">-and</span> <span class="variable">$svc</span>.Status <span class="operator">-ne</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="built_in">Start-Service</span> <span class="literal">-Name</span> <span class="variable">$service</span></span><br><span class="line">                <span class="built_in">Write-Host</span> <span class="string">&quot;<span class="variable">$</span>(Get-Date): Started <span class="variable">$service</span>&quot;</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">                <span class="built_in">Write-Host</span> <span class="string">&quot;<span class="variable">$</span>(Get-Date): Failed to start <span class="variable">$service</span>&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$trigger</span> = <span class="built_in">New-JobTrigger</span> <span class="literal">-Once</span> <span class="literal">-At</span> (<span class="built_in">Get-Date</span>).AddMinutes(<span class="number">1</span>) <span class="literal">-RepetitionInterval</span> (<span class="built_in">New-TimeSpan</span> <span class="literal">-Minutes</span> <span class="number">5</span>) <span class="literal">-RepetitionIndefinitely</span></span><br><span class="line"><span class="built_in">Register-ScheduledJob</span> <span class="literal">-Name</span> <span class="string">&quot;ServiceMonitor&quot;</span> <span class="literal">-ScriptBlock</span> <span class="variable">$action</span> <span class="literal">-Trigger</span> <span class="variable">$trigger</span> <span class="literal">-RunLevel</span> Highest</span><br></pre></td></tr></table></figure>

<h3 id="配置文件管理"><a href="#配置文件管理" class="headerlink" title="配置文件管理"></a>配置文件管理</h3><h4 id="服务配置导出"><a href="#服务配置导出" class="headerlink" title="服务配置导出"></a>服务配置导出</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Export-ServiceConfig</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(<span class="variable">$outputFile</span> = <span class="string">&quot;C:\service_config.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="variable">$services</span> = <span class="built_in">Get-Service</span></span><br><span class="line">    <span class="variable">$results</span> = <span class="selector-tag">@</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$service</span> <span class="keyword">in</span> <span class="variable">$services</span>) &#123;</span><br><span class="line">        <span class="variable">$config</span> = sc.exe qc <span class="variable">$service</span>.Name</span><br><span class="line">        <span class="variable">$binaryPath</span> = (<span class="variable">$config</span> | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span> <span class="operator">-match</span> <span class="string">&quot;BINARY_PATH_NAME&quot;</span>&#125;) <span class="operator">-replace</span> <span class="string">&quot;BINARY_PATH_NAME\s*:\s*&quot;</span></span><br><span class="line">        <span class="variable">$startType</span> = (<span class="variable">$config</span> | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span> <span class="operator">-match</span> <span class="string">&quot;START_TYPE&quot;</span>&#125;) <span class="operator">-replace</span> <span class="string">&quot;START_TYPE\s*:\s*&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$result</span> = [<span class="type">PSCustomObject</span>]<span class="selector-tag">@</span>&#123;</span><br><span class="line">            ServiceName = <span class="variable">$service</span>.Name</span><br><span class="line">            DisplayName = <span class="variable">$service</span>.DisplayName</span><br><span class="line">            Status = <span class="variable">$service</span>.Status</span><br><span class="line">            StartType = <span class="variable">$service</span>.StartType</span><br><span class="line">            BinaryPath = <span class="variable">$binaryPath</span></span><br><span class="line">            ConfigStartType = <span class="variable">$startType</span></span><br><span class="line">            ProcessId = <span class="keyword">if</span> (<span class="variable">$service</span>.Status <span class="operator">-eq</span> <span class="string">&quot;Running&quot;</span>) &#123; <span class="variable">$service</span>.Id &#125; <span class="keyword">else</span> &#123; <span class="variable">$null</span> &#125;</span><br><span class="line">            CanStop = <span class="variable">$service</span>.CanStop</span><br><span class="line">            CanPauseAndContinue = <span class="variable">$service</span>.CanPauseAndContinue</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$results</span> += <span class="variable">$result</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$results</span> | <span class="built_in">Export-Csv</span> <span class="literal">-Path</span> <span class="variable">$outputFile</span> <span class="literal">-NoTypeInformation</span> <span class="literal">-Encoding</span> UTF8</span><br><span class="line">    <span class="built_in">Write-Host</span> <span class="string">&quot;Service configuration exported to <span class="variable">$outputFile</span>&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Export-ServiceConfig</span></span><br></pre></td></tr></table></figure>

<h4 id="服务配置导入"><a href="#服务配置导入" class="headerlink" title="服务配置导入"></a>服务配置导入</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Import-ServiceConfig</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(<span class="variable">$inputFile</span> = <span class="string">&quot;C:\service_config.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="operator">-not</span> (<span class="built_in">Test-Path</span> <span class="variable">$inputFile</span>)) &#123;</span><br><span class="line">        <span class="built_in">Write-Host</span> <span class="string">&quot;Configuration file not found: <span class="variable">$inputFile</span>&quot;</span> <span class="literal">-ForegroundColor</span> Red</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$configs</span> = <span class="built_in">Import-Csv</span> <span class="literal">-Path</span> <span class="variable">$inputFile</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$config</span> <span class="keyword">in</span> <span class="variable">$configs</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment"># 恢复启动类型</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$config</span>.StartType <span class="operator">-ne</span> <span class="variable">$config</span>.ConfigStartType) &#123;</span><br><span class="line">                <span class="built_in">Set-Service</span> <span class="literal">-Name</span> <span class="variable">$config</span>.ServiceName <span class="literal">-StartupType</span> <span class="variable">$config</span>.StartType</span><br><span class="line">                <span class="built_in">Write-Host</span> <span class="string">&quot;Restored startup type for <span class="variable">$</span>(<span class="variable">$config</span>.ServiceName)&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果服务应该运行但当前停止，启动它</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$config</span>.Status <span class="operator">-eq</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">                <span class="variable">$currentStatus</span> = (<span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="variable">$config</span>.ServiceName).Status</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable">$currentStatus</span> <span class="operator">-ne</span> <span class="string">&quot;Running&quot;</span>) &#123;</span><br><span class="line">                    <span class="built_in">Start-Service</span> <span class="literal">-Name</span> <span class="variable">$config</span>.ServiceName</span><br><span class="line">                    <span class="built_in">Write-Host</span> <span class="string">&quot;Started <span class="variable">$</span>(<span class="variable">$config</span>.ServiceName)&quot;</span> <span class="literal">-ForegroundColor</span> Green</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="built_in">Write-Host</span> <span class="string">&quot;Failed to restore <span class="variable">$</span>(<span class="variable">$config</span>.ServiceName): <span class="variable">$_</span>&quot;</span> <span class="literal">-ForegroundColor</span> Red</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="安全配置"><a href="#安全配置" class="headerlink" title="安全配置"></a>安全配置</h2><h3 id="服务账户管理"><a href="#服务账户管理" class="headerlink" title="服务账户管理"></a>服务账户管理</h3><h4 id="服务账户类型"><a href="#服务账户类型" class="headerlink" title="服务账户类型"></a>服务账户类型</h4><ul>
<li><strong>Local System</strong>: 完全系统权限</li>
<li><strong>Local Service</strong>: 有限权限，网络访问受限</li>
<li><strong>Network Service</strong>: 网络访问权限</li>
<li><strong>指定用户账户</strong>: 自定义域或本地账户</li>
</ul>
<h4 id="安全账户配置"><a href="#安全账户配置" class="headerlink" title="安全账户配置"></a>安全账户配置</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$serviceName</span> = <span class="string">&quot;MySQL&quot;</span></span><br><span class="line"><span class="variable">$account</span> = <span class="string">&quot;NT AUTHORITY\NetworkService&quot;</span></span><br><span class="line"><span class="variable">$password</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line">sc.exe config <span class="variable">$serviceName</span> obj= <span class="variable">$account</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$password</span>) &#123;</span><br><span class="line">    sc.exe config <span class="variable">$serviceName</span> password= <span class="variable">$password</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Restart-Service</span> <span class="literal">-Name</span> <span class="variable">$serviceName</span> <span class="literal">-Force</span></span><br></pre></td></tr></table></figure>

<h4 id="最小权限原则"><a href="#最小权限原则" class="headerlink" title="最小权限原则"></a>最小权限原则</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$serviceName</span> = <span class="string">&quot;CustomService&quot;</span></span><br><span class="line"><span class="variable">$accountName</span> = <span class="string">&quot;svc_<span class="variable">$serviceName</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$password</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;P@ssw0rd123!&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">New-LocalUser</span> <span class="literal">-Name</span> <span class="variable">$accountName</span> <span class="literal">-Password</span> <span class="variable">$password</span> <span class="literal">-PasswordNeverExpires</span> <span class="literal">-AccountNeverExpires</span> <span class="literal">-Description</span> <span class="string">&quot;Service account for <span class="variable">$serviceName</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br></pre></td></tr></table></figure>

<h3 id="服务权限配置"><a href="#服务权限配置" class="headerlink" title="服务权限配置"></a>服务权限配置</h3><h4 id="文件系统权限"><a href="#文件系统权限" class="headerlink" title="文件系统权限"></a>文件系统权限</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$servicePath</span> = <span class="string">&quot;C:\Program Files\MyService\MyService.exe&quot;</span></span><br><span class="line"><span class="variable">$account</span> = <span class="string">&quot;NT AUTHORITY\NetworkService&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$acl</span> = <span class="built_in">Get-Acl</span> <span class="variable">$servicePath</span></span><br><span class="line"><span class="variable">$rule</span> = <span class="built_in">New-Object</span> System.Security.AccessControl.FileSystemAccessRule(</span><br><span class="line">    <span class="variable">$account</span>,</span><br><span class="line">    <span class="string">&quot;ReadAndExecute&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ContainerInherit,ObjectInherit&quot;</span>,</span><br><span class="line">    <span class="string">&quot;None&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Allow&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="variable">$acl</span>.SetAccessRule(<span class="variable">$rule</span>)</span><br><span class="line"><span class="built_in">Set-Acl</span> <span class="variable">$servicePath</span> <span class="variable">$acl</span></span><br></pre></td></tr></table></figure>

<h4 id="注册表权限"><a href="#注册表权限" class="headerlink" title="注册表权限"></a>注册表权限</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$regPath</span> = <span class="string">&quot;HKLM:\SYSTEM\CurrentControlSet\Services\<span class="variable">$serviceName</span>&quot;</span></span><br><span class="line"><span class="variable">$account</span> = <span class="string">&quot;NT AUTHORITY\NetworkService&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$acl</span> = <span class="built_in">Get-Acl</span> <span class="variable">$regPath</span></span><br><span class="line"><span class="variable">$rule</span> = <span class="built_in">New-Object</span> System.Security.AccessControl.RegistryAccessRule(</span><br><span class="line">    <span class="variable">$account</span>,</span><br><span class="line">    <span class="string">&quot;ReadKey,WriteKey,Delete,EnumerateSubKeys&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ContainerInherit,ObjectInherit&quot;</span>,</span><br><span class="line">    <span class="string">&quot;None&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Allow&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="variable">$acl</span>.SetAccessRule(<span class="variable">$rule</span>)</span><br><span class="line"><span class="built_in">Set-Acl</span> <span class="variable">$regPath</span> <span class="variable">$acl</span></span><br></pre></td></tr></table></figure>

<h3 id="安全审计"><a href="#安全审计" class="headerlink" title="安全审计"></a>安全审计</h3><h4 id="服务访问审计"><a href="#服务访问审计" class="headerlink" title="服务访问审计"></a>服务访问审计</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line">auditpol /<span class="built_in">set</span> /subcategory:<span class="string">&quot;Service&quot;</span> /success:enable /failure:enable</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="built_in">Get-WinEvent</span> <span class="literal">-LogName</span> Security | <span class="built_in">Where-Object</span> &#123;</span><br><span class="line">    <span class="variable">$_</span>.Id <span class="operator">-eq</span> <span class="number">4674</span> <span class="operator">-or</span> <span class="variable">$_</span>.Id <span class="operator">-eq</span> <span class="number">4697</span> <span class="operator">-or</span> <span class="variable">$_</span>.Id <span class="operator">-eq</span> <span class="number">4698</span></span><br><span class="line">&#125; | <span class="built_in">Format-List</span> TimeCreated, Id, Message</span><br></pre></td></tr></table></figure>

<h4 id="服务监控脚本-1"><a href="#服务监控脚本-1" class="headerlink" title="服务监控脚本"></a>服务监控脚本</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Windows 服务配置指南</span></span><br><span class="line"><span class="variable">$monitorServices</span> = <span class="selector-tag">@</span>(<span class="string">&quot;MySQL&quot;</span>, <span class="string">&quot;Redis&quot;</span>, <span class="string">&quot;w3svc&quot;</span>)</span><br><span class="line"><span class="variable">$logFile</span> = <span class="string">&quot;C:\logs\service_security.log&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Write-SecurityLog</span></span> &#123;</span><br><span class="line">    <span class="keyword">param</span>(<span class="variable">$message</span>)</span><br><span class="line">    <span class="variable">$timestamp</span> = <span class="built_in">Get-Date</span> <span class="literal">-Format</span> <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span></span><br><span class="line">    <span class="built_in">Add-Content</span> <span class="variable">$logFile</span> <span class="string">&quot;<span class="variable">$timestamp</span> - SECURITY - <span class="variable">$message</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$serviceName</span> <span class="keyword">in</span> <span class="variable">$monitorServices</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$service</span> = <span class="built_in">Get-Service</span> <span class="literal">-Name</span> <span class="variable">$serviceName</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查服务账户</span></span><br><span class="line">        <span class="variable">$config</span> = sc.exe qc <span class="variable">$serviceName</span></span><br><span class="line">        <span class="variable">$account</span> = (<span class="variable">$config</span> | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span> <span class="operator">-match</span> <span class="string">&quot;SERVICE_START_NAME&quot;</span>&#125;) <span class="operator">-replace</span> <span class="string">&quot;SERVICE_START_NAME\s*:\s*&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查文件权限</span></span><br><span class="line">        <span class="variable">$binaryPath</span> = (<span class="variable">$config</span> | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span> <span class="operator">-match</span> <span class="string">&quot;BINARY_PATH_NAME&quot;</span>&#125;) <span class="operator">-replace</span> <span class="string">&quot;BINARY_PATH_NAME\s*:\s*&quot;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$binaryPath</span> <span class="operator">-match</span> <span class="string">&quot;^`&quot;(.+?)`&quot;&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$filePath</span> = <span class="variable">$matches</span><span class="function">[<span class="number">1</span>]</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">Test-Path</span> <span class="variable">$filePath</span>) &#123;</span><br><span class="line">                <span class="variable">$acl</span> = <span class="built_in">Get-Acl</span> <span class="variable">$filePath</span></span><br><span class="line">                <span class="built_in">Write-SecurityLog</span> <span class="string">&quot;<span class="variable">$serviceName</span> - File permissions checked for <span class="variable">$filePath</span>&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">Write-SecurityLog</span> <span class="string">&quot;<span class="variable">$serviceName</span> - Account: <span class="variable">$account</span> - Status: <span class="variable">$</span>(<span class="variable">$service</span>.Status)&quot;</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="built_in">Write-SecurityLog</span> <span class="string">&quot;Error monitoring <span class="variable">$serviceName</span> : <span class="variable">$_</span>&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>记住：Windows 服务管理需要谨慎操作，特别是在生产环境中，建议先在测试环境验证所有更改！</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://VilasWang.github.io">vilas</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://vilaswang.github.io/posts/7a1e3650/">https://vilaswang.github.io/posts/7a1e3650/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://VilasWang.github.io" target="_blank">CodeVerse | 技术宇宙</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86/">服务管理</a><a class="post-meta__tags" href="/tags/%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/">系统配置</a><a class="post-meta__tags" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/d7364a6b/" title="Linux CLI 参考手册"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Linux CLI 参考手册</div></div><div class="info-2"><div class="info-item-1">Linux CLI 参考手册目录 文件和目录操作 文本处理 系统管理 网络操作 用户与权限 进程管理 包管理 文件压缩与归档 系统监控与性能分析  文件和目录操作导航与查看 pwd: 显示当前工作目录。 ls -la: 列出所有文件和目录（包括隐藏的），显示详细信息。 ls -lh: 以人类可读的格式显示文件大小 (K, M, G)。 cd /path/to/dir: 切换到指定目录。 cd ..: 切换到上一级目录。 cd ~ 或 cd: 切换到当前用户的主目录。 cd -: 切换到上一个工作目录。  创建与删除 touch file.txt: 创建一个空文件或更新文件的时间戳。 mkdir new_dir: 创建一个新目录。 mkdir -p path/to/new_dir: 递归创建多级目录。 rm file.txt: 删除一个文件（会提示）。 rm -f file.txt: 强制删除一个文件。 rm -r my_dir: 递归删除一个目录及其所有内容。 rm -rf my_dir: 强制递归删除一个目录（危险命令，请谨慎使用）。  复制与移动 cp source.txt ...</div></div></div></a><a class="pagination-related" href="/posts/d1520bc/" title="OpenSSL mTLS Windows 指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">OpenSSL mTLS Windows 指南</div></div><div class="info-2"><div class="info-item-1">OpenSSL mTLS Windows 指南目录 概述 第一步：在 Windows 上安装 OpenSSL 第二步：生成根证书 (CA) 第三步：生成服务器证书 第四步：生成客户端证书 第五步：验证与打包 附录A：Windows 批处理自动化脚本 附录B：在 IIS 中配置双向认证 附录C：在 Nginx for Windows 中配置双向认证 附录D：生成 DH 参数 (可选) 附录E：常用 OpenSSL 命令  概述双向认证（Mutual TLS, mTLS）是一种高安全性的认证模式，它要求客户端和服务器双方都出示并验证对方的数字证书，从而确保通信双方的身份都是可信的。本指南将详细介绍如何在 Windows 系统上使用 OpenSSL 创建一套完整的、用于双向认证的证书。 Windows 环境注意事项 Windows 系统默认不包含 OpenSSL，需要单独安装 路径分隔符使用反斜杠 \ 批处理脚本使用 .bat 格式 文件权限管理与 Linux 不同  第一步：在 Windows 上安装 OpenSSL方法1：使用 Chocolatey (推荐)123456# Open...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/b47a5d97/" title="Drogon 编译指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-04</div><div class="info-item-2">Drogon 编译指南</div></div><div class="info-2"><div class="info-item-1">Drogon 编译指南目录 概述 系统要求 环境准备 下载源码 依赖管理 编译安装 配置环境变量 验证安装 项目配置 常见问题 最佳实践  概述Drogon 是一个基于 C++17&#x2F;20 的高性能 HTTP 应用框架，类似于 Python 的 Django 和 Flask。本指南详细介绍如何在 Windows 系统下从源码编译安装 Drogon 框架。 框架特性 高性能: 基于 non-blocking I&#x2F;O 和事件驱动 异步支持: 完整的异步编程模型 ORM支持: 内置对象关系映射 插件系统: 灵活的插件扩展机制 RESTful API: 天然支持 RESTful 风格 WebSocket: 内置 WebSocket 支持 跨平台: 支持 Windows、Linux、macOS  编译方式 源码编译: 完全控制编译选项和依赖 包管理器: 使用 vcpkg 或 Conan 管理依赖 预编译包: 使用官方预编译的二进制包  系统要求1. 硬件要求 CPU: x64 架构，推荐 4 核心以上 内存: 最少 8GB，推荐 16GB+ 磁盘空间: 最少 10GB，推...</div></div></div></a><a class="pagination-related" href="/posts/190baecd/" title="Boost Windows 编译指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-04</div><div class="info-item-2">Boost Windows 编译指南</div></div><div class="info-2"><div class="info-item-1">Boost Windows 编译指南目录 概述 环境准备 获取与准备源码 核心编译步骤 验证编译结果 项目集成 常见问题与解答 自动化脚本示例  概述本指南详细介绍如何在 Windows 平台上，使用 Visual Studio 和 b2.exe 构建工具，完整地静态编译 Boost C++ 库。 静态编译的优势 易于分发: 应用程序不依赖外部的 Boost DLL 文件，所有代码都在可执行文件内部。 版本控制: 避免最终用户的机器上出现 DLL 版本冲突。 性能: 可能有轻微的启动性能优势，因为减少了动态加载。  环境准备1. 软件要求 操作系统: Windows 10&#x2F;11 (x64) IDE: Visual Studio 2019 (MSVC v14.2) 或 2022 (MSVC v14.3) 组件: 确保 VS 安装程序已勾选 “使用 C++ 的桌面开发”，并包含最新的 Windows SDK。 (可选) Python: 如果需要编译 Boost.Python，请安装 Python 3.8+。  2. 开发者命令提示符编译 Boost 必须在 Visual S...</div></div></div></a><a class="pagination-related" href="/posts/e2f925a8/" title="MySQL Windows 安装指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-04</div><div class="info-item-2">MySQL Windows 安装指南</div></div><div class="info-2"><div class="info-item-1">MySQL Windows 安装指南目录 概述 第一步：下载与解压 第二步：配置 my.ini 文件 第三步：初始化与安装服务 第四步：服务管理与登录 用户与权限管理 备份与恢复 常见问题与故障排除  概述本指南详细介绍如何在 Windows 操作系统上，通过官方的 ZIP 压缩包手动安装、配置 MySQL，并将其注册为 Windows 服务。这种方式让你可以完全控制 MySQL 的安装位置和配置。 第一步：下载与解压 下载 MySQL Community Server:访问官方下载页面：https://dev.mysql.com/downloads/mysql/选择 “Windows (x86, 64-bit), ZIP Archive” 版本进行下载。  解压文件:将下载的 ZIP 文件解压到一个你选择的稳定路径，例如 C:\mysql。路径中最好不要包含中文或空格。 解压后的目录结构大致如下： 12345&lt;Your-MySQL-Path&gt;\├── bin\          # 可执行文件 (mysqld, mysql, mysqldump 等)├── incl...</div></div></div></a><a class="pagination-related" href="/posts/31cbd6c5/" title="Qt libcurl 集成指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-04</div><div class="info-item-2">Qt libcurl 集成指南</div></div><div class="info-2"><div class="info-item-1">Qt libcurl 集成指南目录 概述 方法一：使用vcpkg (强烈推荐) 方法二：手动从源码编译 (高级) 在Qt项目中使用libcurl 常见问题  概述本指南详细介绍如何在现代 Windows 开发环境 (Visual Studio 2022) 中，为 Qt 项目集成 libcurl 库。首选方法是使用 vcpkg 包管理器，因为它极大地简化了流程。 为什么使用 libcurl? 功能强大: 支持 HTTP&#x2F;2, HTTPS, FTP(S), a多种认证机制等。 稳定可靠: 经过长期和广泛使用的考验。 补充 Qt Network: 在处理复杂的 HTTP 头部、代理或特定认证时，比 QNetworkAccessManager 更灵活。  方法一：使用vcpkg (强烈推荐)vcpkg 是微软官方的 C++ 库管理器，它可以自动处理库的下载、编译和集成。 1. 安装 vcpkg如果尚未安装 vcpkg，请在命令行中执行以下步骤： 123456789# Qt libcurl 集成指南git clone https://github.com/microsoft/vc...</div></div></div></a><a class="pagination-related" href="/posts/2acf74bd/" title="FileZilla 内网穿透配置指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-09</div><div class="info-item-2">FileZilla 内网穿透配置指南</div></div><div class="info-2"><div class="info-item-1">🛠️ 详细配置步骤1. 安装与配置FileZilla Server 下载与安装在您的内网服务器上，从FileZilla官网下载FileZilla Server并安装。  注意: 本指南基于 FileZilla Server 经典版本 (0.9.x) 的界面描述。如果您使用的是 1.x 或更高版本，管理界面可能有所不同（通常为基于Web的仪表板），但核心配置概念（用户、被动模式端口）是通用的。  安装过程中，如果弹出“连接到服务器”配置界面，通常使用默认设置（如主机名127.0.0.1，管理端口）即可，点击“连接”或“确定”。  创建用户与设置密码安装完成后，在FileZilla Server管理界面中：  点击 Edit -&gt; Users 进入用户设置。 在 General（通用）页面，点击 Add 按钮创建新用户（例如 user1）。 为该用户设置密码。   设置共享文件夹创建用户后，系统通常会提示需设置至少一个共享文件夹。  在 Shared folders 页面，点击 Add 按钮，选择您希望外网能访问下载文件的内网目录。 根据需要，在 Files 和 Direct...</div></div></div></a><a class="pagination-related" href="/posts/d1520bc/" title="OpenSSL mTLS Windows 指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-04</div><div class="info-item-2">OpenSSL mTLS Windows 指南</div></div><div class="info-2"><div class="info-item-1">OpenSSL mTLS Windows 指南目录 概述 第一步：在 Windows 上安装 OpenSSL 第二步：生成根证书 (CA) 第三步：生成服务器证书 第四步：生成客户端证书 第五步：验证与打包 附录A：Windows 批处理自动化脚本 附录B：在 IIS 中配置双向认证 附录C：在 Nginx for Windows 中配置双向认证 附录D：生成 DH 参数 (可选) 附录E：常用 OpenSSL 命令  概述双向认证（Mutual TLS, mTLS）是一种高安全性的认证模式，它要求客户端和服务器双方都出示并验证对方的数字证书，从而确保通信双方的身份都是可信的。本指南将详细介绍如何在 Windows 系统上使用 OpenSSL 创建一套完整的、用于双向认证的证书。 Windows 环境注意事项 Windows 系统默认不包含 OpenSSL，需要单独安装 路径分隔符使用反斜杠 \ 批处理脚本使用 .bat 格式 文件权限管理与 Linux 不同  第一步：在 Windows 上安装 OpenSSL方法1：使用 Chocolatey (推荐)123456# Open...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">vilas</div><div class="author-info-description">CodeVerse | 技术宇宙 - 专注于 C++、Qt、系统架构与性能优化的技术知识库。</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">60</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">155</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div><a id="card-info-btn" href="/about/"><i class="fa fa-paper-plane"></i><span>关于</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/VilasWang" target="_blank" title="fab fa-github"><i class="Github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">🚀 欢迎来到 CodeVerse！这里专注于深度技术解析与实战经验分享。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Windows-%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">Windows 服务配置指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows-%E6%9C%8D%E5%8A%A1%E6%A6%82%E8%BF%B0"><span class="toc-number">1.2.</span> <span class="toc-text">Windows 服务概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%89%B9%E7%82%B9"><span class="toc-number">1.2.1.</span> <span class="toc-text">服务特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text">服务类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80"><span class="toc-number">1.3.</span> <span class="toc-text">服务管理基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8%E7%95%8C%E9%9D%A2"><span class="toc-number">1.3.1.</span> <span class="toc-text">服务管理器界面</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">打开服务管理器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8%E7%95%8C%E9%9D%A2%E8%AF%B4%E6%98%8E"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">服务管理器界面说明</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AE%A1%E7%90%86"><span class="toc-number">1.3.2.</span> <span class="toc-text">命令行管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#net-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">net 命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sc-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">sc 命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PowerShell-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">PowerShell 命令</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.</span> <span class="toc-text">常见服务配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.1.</span> <span class="toc-text">MySQL 服务配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-MySQL-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">安装 MySQL 服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E8%84%9A%E6%9C%AC"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">服务管理脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.2.</span> <span class="toc-text">Redis 服务配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-Redis-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">安装 Redis 服务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IIS-%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.3.</span> <span class="toc-text">IIS 服务配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E7%94%A8-IIS-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">启用 IIS 服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IIS-%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86%E8%84%9A%E6%9C%AC"><span class="toc-number">1.4.3.2.</span> <span class="toc-text">IIS 服务管理脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E4%BC%98%E5%8C%96"><span class="toc-number">1.5.</span> <span class="toc-text">服务优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E7%B1%BB%E5%9E%8B%E4%BC%98%E5%8C%96"><span class="toc-number">1.5.1.</span> <span class="toc-text">启动类型优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E7%B1%BB%E5%9E%8B%E8%AF%B4%E6%98%8E"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">启动类型说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">优化建议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="toc-number">1.5.2.</span> <span class="toc-text">服务依赖关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%E4%BE%9D%E8%B5%96"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">查看服务依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">1.5.2.2.</span> <span class="toc-text">批量服务管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7"><span class="toc-number">1.5.3.</span> <span class="toc-text">性能监控</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">服务监控脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E4%BD%BF%E7%94%A8%E7%9B%91%E6%8E%A7"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">资源使用监控</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4"><span class="toc-number">1.6.</span> <span class="toc-text">故障排除</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%9C%8D%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.1.</span> <span class="toc-text">常见服务问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">服务无法启动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8%E5%90%8E%E8%87%AA%E5%8A%A8%E5%81%9C%E6%AD%A2"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">服务启动后自动停止</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%93%8D%E5%BA%94%E8%B6%85%E6%97%B6"><span class="toc-number">1.6.1.3.</span> <span class="toc-text">服务响应超时</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%8A%E6%96%AD%E5%B7%A5%E5%85%B7"><span class="toc-number">1.6.2.</span> <span class="toc-text">诊断工具</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E8%AF%8A%E6%96%AD%E5%B7%A5%E5%85%B7"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">服务诊断工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%81%A2%E5%A4%8D%E8%84%9A%E6%9C%AC"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">服务恢复脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.</span> <span class="toc-text">自动化管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86-1"><span class="toc-number">1.7.1.</span> <span class="toc-text">批量服务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E5%90%AF%E5%8A%A8-%E5%81%9C%E6%AD%A2%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">批量启动&#x2F;停止服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">定时任务管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86"><span class="toc-number">1.7.2.</span> <span class="toc-text">配置文件管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E5%AF%BC%E5%87%BA"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">服务配置导出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE%E5%AF%BC%E5%85%A5"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">服务配置导入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.</span> <span class="toc-text">安全配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E8%B4%A6%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-number">1.8.1.</span> <span class="toc-text">服务账户管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E8%B4%A6%E6%88%B7%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">服务账户类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E8%B4%A6%E6%88%B7%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.1.2.</span> <span class="toc-text">安全账户配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E6%9D%83%E9%99%90%E5%8E%9F%E5%88%99"><span class="toc-number">1.8.1.3.</span> <span class="toc-text">最小权限原则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.2.</span> <span class="toc-text">服务权限配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%9D%83%E9%99%90"><span class="toc-number">1.8.2.1.</span> <span class="toc-text">文件系统权限</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%9D%83%E9%99%90"><span class="toc-number">1.8.2.2.</span> <span class="toc-text">注册表权限</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.8.3.</span> <span class="toc-text">安全审计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.8.3.1.</span> <span class="toc-text">服务访问审计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7%E8%84%9A%E6%9C%AC-1"><span class="toc-number">1.8.3.2.</span> <span class="toc-text">服务监控脚本</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/mcp-github-config/" title="Gemini CLI 和 Claude Code 中配置 GitHub MCP 服务器详解">Gemini CLI 和 Claude Code 中配置 GitHub MCP 服务器详解</a><time datetime="2025-12-18T01:09:23.000Z" title="发表于 2025-12-18 09:09:23">2025-12-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/gemini-cli-proxy/" title="Gemini CLI 在国内网络环境下的完整配置指南">Gemini CLI 在国内网络环境下的完整配置指南</a><time datetime="2025-12-18T01:09:23.000Z" title="发表于 2025-12-18 09:09:23">2025-12-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/windows-github-mcp/" title="Windows 环境下配置 GitHub MCP 服务器完整指南">Windows 环境下配置 GitHub MCP 服务器完整指南</a><time datetime="2025-12-18T01:09:23.000Z" title="发表于 2025-12-18 09:09:23">2025-12-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/56a10ecb/" title="Antigravity 登录认证完整解决方案（非TUN方法）">Antigravity 登录认证完整解决方案（非TUN方法）</a><time datetime="2025-12-16T22:30:00.000Z" title="发表于 2025-12-17 06:30:00">2025-12-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/55a960b4/" title="VSCode Qt MSVC 配置指南">VSCode Qt MSVC 配置指南</a><time datetime="2025-12-09T06:09:56.000Z" title="发表于 2025-12-09 14:09:56">2025-12-09</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By vilas</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'VilasWang/VilasWang.github.io',
      'data-repo-id': 'R_kgDOQkzqvg',
      'data-category-id': 'DIC_kwDOQkzqvs4Cz99h',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !true) {
    if (true) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script> document.addEventListener('DOMContentLoaded', function() { var announcement = document.createElement('div'); announcement.className = 'top-announcement'; announcement.innerHTML = '🚀 欢迎来到 CodeVerse 技术宇宙！'; document.body.insertBefore(announcement, document.body.firstChild); }); </script><script id="canvas_nest" defer="defer" color="102,204,255" opacity="0.6" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:description\"]","link[rel=\"canonical\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      false
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.3"></script></div></div></body></html>