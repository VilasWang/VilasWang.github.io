[{"title":"HM MES éƒ¨ç½²æŒ‡å—","url":"/posts/616ce96e/","content":"HM MES éƒ¨ç½²æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¯å¢ƒå‡†å¤‡\nåç«¯ç¼–è¯‘ä¸éƒ¨ç½²\nå‰ç«¯éƒ¨ç½²ä¸åå‘ä»£ç†\nå¸¸è§é—®é¢˜æ’æŸ¥\n\næ¦‚è¿°Hm-MES æ˜¯ä¸€ä¸ªåŸºäº Java Spring Boot çš„åˆ¶é€ æ‰§è¡Œç³»ç»Ÿï¼ˆMESï¼‰ï¼Œæä¾›ç”Ÿäº§ç®¡ç†ã€è´¨é‡æ§åˆ¶ã€è®¾å¤‡ç®¡ç†ç­‰ä¸€ç³»åˆ—åŠŸèƒ½ã€‚æœ¬æŒ‡å—æä¾›åœ¨ Windows å’Œ Ubuntu ç³»ç»Ÿä¸Šå®Œæ•´ç¼–è¯‘å’Œéƒ¨ç½² Hm-MES çš„è¯¦ç»†æ­¥éª¤ã€‚\nç³»ç»Ÿæ¶æ„\nåç«¯: Java Spring Boot + MyBatis\nå‰ç«¯: HTML5 + JavaScript\nä¸­é—´ä»¶: Apache Tomcat\næ•°æ®åº“: MySQL 8.0\næ¶ˆæ¯é˜Ÿåˆ— (å¯é€‰): RabbitMQ\nåå‘ä»£ç† (å¯é€‰): Nginx\n\nç¯å¢ƒå‡†å¤‡1. è½¯ä»¶ä¾èµ–\nJDK: 11 (æ¨èï¼ŒLTSç‰ˆæœ¬)\nMaven: 3.6+\nTomcat: 9.0+\nMySQL: 8.0+\nGit\n\n2. ç¡¬ä»¶è¦æ±‚\næœ€å°é…ç½®: 2æ ¸CPU, 4GBå†…å­˜, 20GBç£ç›˜ç©ºé—´\næ¨èé…ç½®: 4æ ¸CPU, 8GBå†…å­˜, 50GBç£ç›˜ç©ºé—´\nç”Ÿäº§ç¯å¢ƒ: 8æ ¸CPU, 16GBå†…å­˜, 100GB SSDç£ç›˜\n\n2. Windows ç¯å¢ƒå‡†å¤‡\nå®‰è£… JDK: ä» Adoptium ä¸‹è½½å¹¶å®‰è£…ã€‚ç¡®ä¿ JAVA_HOME ç¯å¢ƒå˜é‡å·²è®¾ç½®ã€‚\nå®‰è£… Maven: ä» Maven å®˜ç½‘ ä¸‹è½½å¹¶è§£å‹åˆ° &lt;Your-Maven-Path&gt;ã€‚å°† &lt;Your-Maven-Path&gt;\\bin æ·»åŠ åˆ°ç³»ç»Ÿ Path ç¯å¢ƒå˜é‡ã€‚\nå®‰è£… Tomcat: ä» Tomcat å®˜ç½‘ ä¸‹è½½å¹¶è§£å‹åˆ° &lt;Your-Tomcat-Path&gt;ã€‚\nå®‰è£… MySQL: ä½¿ç”¨ MySQL Installer å®‰è£…ï¼Œå¹¶è®°ä½è®¾ç½®çš„ root å¯†ç ã€‚\n\n3. Ubuntu ç¯å¢ƒå‡†å¤‡# HM MES éƒ¨ç½²æŒ‡å—sudo apt update &amp;&amp; sudo apt upgrade -ysudo apt install -y openjdk-11-jdk maven tomcat9 mysql-server git# HM MES éƒ¨ç½²æŒ‡å—sudo mysql_secure_installation# HM MES éƒ¨ç½²æŒ‡å—sudo systemctl start tomcat9 &amp;&amp; sudo systemctl enable tomcat9sudo systemctl start mysql &amp;&amp; sudo systemctl enable mysql\n\nåç«¯ç¼–è¯‘ä¸éƒ¨ç½²1. è·å–æºç git clone https://gitee.com/liangshengpan/hm-MES.gitcd hm-MES\n\n2. é…ç½®æ•°æ®åº“# HM MES éƒ¨ç½²æŒ‡å—mysql -u root -p# HM MES éƒ¨ç½²æŒ‡å—CREATE DATABASE hm_mes CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;CREATE USER &#x27;hm_user&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;your_strong_password&#x27;;GRANT ALL PRIVILEGES ON hm_mes.* TO &#x27;hm_user&#x27;@&#x27;localhost&#x27;;# HM MES éƒ¨ç½²æŒ‡å—ALTER USER &#x27;hm_user&#x27;@&#x27;localhost&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;your_strong_password&#x27;;FLUSH PRIVILEGES;EXIT;# HM MES éƒ¨ç½²æŒ‡å—# HM MES éƒ¨ç½²æŒ‡å—mysql -u hm_user -p hm_mes &lt; doc/hm-mes.sql\n\n3. ä¿®æ”¹åº”ç”¨é…ç½®ç¼–è¾‘åç«¯é¡¹ç›®çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼šmes-backend/src/main/resources/application.yml\nspring:  datasource:    # ç¡®ä¿è¿™é‡Œçš„åœ°å€ã€æ•°æ®åº“åã€ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®    url: jdbc:mysql://localhost:3306/hm_mes?useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;characterEncoding=utf8&amp;allowPublicKeyRetrieval=true    username: hm_user # ä½¿ç”¨æˆ‘ä»¬åˆšåˆ›å»ºçš„ç”¨æˆ·    password: your_strong_password # æ›¿æ¢ä¸ºä½ çš„å¯†ç     driver-class-name: com.mysql.cj.jdbc.Driver  # æ–‡ä»¶ä¸Šä¼ é…ç½®  servlet:    multipart:      max-file-size: 100MB      max-request-size: 100MBserver:  port: 8080  servlet:    # åº”ç”¨çš„ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œåå‘ä»£ç†æ—¶ä¼šç”¨åˆ°    context-path: /hm-mes\n\n4. ç¼–è¯‘æ‰“åŒ…ä½¿ç”¨ Maven å°†åç«¯é¡¹ç›®æ‰“åŒ…æˆ .war æ–‡ä»¶ã€‚\n# HM MES éƒ¨ç½²æŒ‡å—cd mes-backend# HM MES éƒ¨ç½²æŒ‡å—mvn clean package -DskipTests\næˆåŠŸåï¼Œä½ ä¼šåœ¨ mes-backend/target/ ç›®å½•ä¸‹æ‰¾åˆ° hm-mes.war æ–‡ä»¶ã€‚\n5. éƒ¨ç½²åˆ° Tomcat\nåœæ­¢ Tomcat:\nWindows: è¿è¡Œ &lt;Your-Tomcat-Path&gt;\\bin\\shutdown.bat\nUbuntu: sudo systemctl stop tomcat9\n\n\néƒ¨ç½² WAR æ–‡ä»¶:\nå°† hm-mes.war æ–‡ä»¶å¤åˆ¶åˆ° Tomcat çš„ webapps ç›®å½•ä¸‹ã€‚\nWindows: &lt;Your-Tomcat-Path&gt;\\webapps\\\nUbuntu: /var/lib/tomcat9/webapps/\n\n\nå¯åŠ¨ Tomcat:\nWindows: è¿è¡Œ &lt;Your-Tomcat-Path&gt;\\bin\\startup.bat\nUbuntu: sudo systemctl start tomcat9\n\n\n\nTomcat å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨è§£å‹ .war æ–‡ä»¶ã€‚\n6. è®¿é—®éªŒè¯æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® http://localhost:8080/hm-mesã€‚å¦‚æœèƒ½çœ‹åˆ°ç™»å½•é¡µé¢ï¼Œè¯´æ˜åç«¯éƒ¨ç½²æˆåŠŸã€‚\nå‰ç«¯éƒ¨ç½²ä¸åå‘ä»£ç†ä¸ºäº†è·å¾—æ›´å¥½çš„æ€§èƒ½å’Œæ›´æ–¹ä¾¿çš„ç®¡ç†ï¼Œæ¨èä½¿ç”¨ Nginx æ¥æ‰˜ç®¡å‰ç«¯é™æ€æ–‡ä»¶ï¼Œå¹¶å°† API è¯·æ±‚åå‘ä»£ç†åˆ° Tomcatã€‚\n1. éƒ¨ç½²å‰ç«¯æ–‡ä»¶å°†æºç ä¸­çš„ mes-front æ–‡ä»¶å¤¹å¤åˆ¶åˆ°ä½ çš„ Web æœåŠ¡å™¨æ ¹ç›®å½•ï¼Œä¾‹å¦‚ /var/www/html/mes-frontã€‚\n2. é…ç½® Nginxåˆ›å»ºä¸€ä¸ªæ–°çš„ Nginx ç«™ç‚¹é…ç½®ï¼š\nserver &#123;    listen 80;    server_name your_domain.com;    # å‰ç«¯é™æ€æ–‡ä»¶æ ¹ç›®å½•    root /var/www/html/mes-front;    index index.html;    # å®‰å…¨å¤´è®¾ç½®    add_header X-Frame-Options &quot;SAMEORIGIN&quot; always;    add_header X-Content-Type-Options &quot;nosniff&quot; always;    add_header X-XSS-Protection &quot;1; mode=block&quot; always;    add_header Referrer-Policy &quot;strict-origin-when-cross-origin&quot; always;    # é™æ€èµ„æºç¼“å­˜    location ~* \\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ &#123;        expires 1y;        add_header Cache-Control &quot;public, immutable&quot;;        access_log off;    &#125;    # SPA (å•é¡µåº”ç”¨) è·¯ç”±æ”¯æŒ    location / &#123;        try_files $uri $uri/ /index.html;    &#125;    # API åå‘ä»£ç†    # å°†æ‰€æœ‰ /api/ å¼€å¤´çš„è¯·æ±‚è½¬å‘åˆ° Tomcat    location /api/ &#123;        # æ³¨æ„ï¼šè¿™é‡Œçš„ /hm-mes/ å¿…é¡»ä¸ application.yml ä¸­çš„ context-path ä¸€è‡´        proxy_pass http://localhost:8080/hm-mes/;        # è®¾ç½®è¶…æ—¶æ—¶é—´        proxy_connect_timeout 60s;        proxy_send_timeout 60s;        proxy_read_timeout 60s;        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto $scheme;        # æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶        client_max_body_size 100M;    &#125;&#125;\né‡å¯ Nginx åï¼Œä½ å°±å¯ä»¥é€šè¿‡åŸŸåç›´æ¥è®¿é—®å‰ç«¯é¡µé¢ï¼Œå¹¶ä¸”å‰ç«¯å‘å‡ºçš„ API è¯·æ±‚ä¼šè¢«æ­£ç¡®è½¬å‘åˆ°åç«¯ã€‚\nå¸¸è§é—®é¢˜æ’æŸ¥Q1: æ•°æ®åº“è¿æ¥å¤±è´¥?A: æ£€æŸ¥ application.yml ä¸­çš„æ•°æ®åº“åœ°å€ã€ç«¯å£ã€ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ã€‚ç¡®è®¤æ•°æ®åº“æœåŠ¡æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸”é˜²ç«å¢™å…è®¸ 3306 ç«¯å£çš„è¿æ¥ã€‚\nQ2: éƒ¨ç½²åè®¿é—® 404?A:\n\næ£€æŸ¥ Tomcat çš„ logs/catalina.out æ—¥å¿—ï¼Œçœ‹åº”ç”¨æ˜¯å¦åœ¨å¯åŠ¨æ—¶æŠ¥é”™ã€‚\nç¡®è®¤ä½ çš„è®¿é—®åœ°å€åŒ…å«äº†æ­£ç¡®çš„ä¸Šä¸‹æ–‡è·¯å¾„ï¼Œå³ http://localhost:8080/hm-mesã€‚\nå¦‚æœä½¿ç”¨äº† Nginxï¼Œè¯·æ£€æŸ¥ proxy_pass è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚\n\nQ3: æ–‡ä»¶ä¸Šä¼ å¤±è´¥?A: æ£€æŸ¥ application.yml ä¸­çš„ max-file-size é…ç½®ï¼Œä»¥åŠéƒ¨ç½²ç›®å½•æ˜¯å¦æœ‰å†™å…¥æƒé™ã€‚\nQ4: MySQL 8.0 è¿æ¥è®¤è¯å¤±è´¥?A: MySQL 8.0 é»˜è®¤ä½¿ç”¨ caching_sha2_password è®¤è¯æ’ä»¶ï¼ŒJava é©±åŠ¨å¯èƒ½ä¸æ”¯æŒã€‚éœ€è¦å°†ç”¨æˆ·è®¤è¯æ–¹å¼æ”¹ä¸º mysql_native_passwordã€‚\nQ5: Tomcat å†…å­˜æº¢å‡º?A: ç¼–è¾‘ Tomcat çš„ setenv.sh (Linux) æˆ– setenv.bat (Windows)ï¼Œè®¾ç½®åˆé€‚çš„ JVM å‚æ•°ï¼š\nexport CATALINA_OPTS=&quot;$CATALINA_OPTS -Xms2G -Xmx4G -XX:+UseG1GC&quot;\n\nç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ä¼˜åŒ–1. JVM å‚æ•°ä¼˜åŒ–åœ¨ Tomcat å¯åŠ¨è„šæœ¬ä¸­æ·»åŠ ä»¥ä¸‹ JVM å‚æ•°ï¼š\n# HM MES éƒ¨ç½²æŒ‡å—-Xms4g -Xmx8g# HM MES éƒ¨ç½²æŒ‡å—-XX:+UseG1GC-XX:MaxGCPauseMillis=200-XX:G1HeapRegionSize=16m# HM MES éƒ¨ç½²æŒ‡å—-XX:+UseStringDeduplication-XX:+OptimizeStringConcat-Djava.awt.headless=true-Dfile.encoding=UTF-8-Duser.timezone=Asia/Shanghai\n\n2. æ•°æ®åº“è¿æ¥æ± é…ç½®åœ¨ application.yml ä¸­ä¼˜åŒ–æ•°æ®æºé…ç½®ï¼š\nspring:  datasource:    hikari:      # è¿æ¥æ± å¤§å°      maximum-pool-size: 20      minimum-idle: 5      # è¿æ¥è¶…æ—¶      connection-timeout: 20000      # ç©ºé—²è¿æ¥è¶…æ—¶      idle-timeout: 300000      # è¿æ¥æœ€å¤§ç”Ÿå‘½å‘¨æœŸ      max-lifetime: 900000      # è¿æ¥æµ‹è¯•      connection-test-query: SELECT 1\n\n3. æ—¥å¿—é…ç½®ä¼˜åŒ–ä½¿ç”¨ Logback é…ç½®æ–‡ä»¶ logback-spring.xmlï¼š\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;configuration&gt;    &lt;!-- ç”Ÿäº§ç¯å¢ƒæ—¥å¿—çº§åˆ« --&gt;    &lt;springProfile name=&quot;prod&quot;&gt;        &lt;root level=&quot;INFO&quot;&gt;            &lt;appender-ref ref=&quot;FILE&quot;/&gt;        &lt;/root&gt;    &lt;/springProfile&gt;    &lt;!-- æ—¥å¿—æ–‡ä»¶é…ç½® --&gt;    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;        &lt;file&gt;logs/hm-mes.log&lt;/file&gt;        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;            &lt;fileNamePattern&gt;logs/hm-mes.%d&#123;yyyy-MM-dd&#125;.%i.log.gz&lt;/fileNamePattern&gt;            &lt;maxFileSize&gt;100MB&lt;/maxFileSize&gt;            &lt;maxHistory&gt;30&lt;/maxHistory&gt;            &lt;totalSizeCap&gt;3GB&lt;/totalSizeCap&gt;        &lt;/rollingPolicy&gt;        &lt;encoder&gt;            &lt;pattern&gt;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt;        &lt;/encoder&gt;    &lt;/appender&gt;&lt;/configuration&gt;\n\n4. å®‰å…¨é…ç½®æ¸…å•\n ä¿®æ”¹é»˜è®¤å¯†ç å’Œå¯†é’¥\n å¯ç”¨ HTTPSï¼ˆé…ç½® SSL è¯ä¹¦ï¼‰\n é…ç½®é˜²ç«å¢™è§„åˆ™\n ç¦ç”¨ä¸å¿…è¦çš„æœåŠ¡ç«¯å£\n å®šæœŸå¤‡ä»½æ•°æ®åº“\n é…ç½®æ—¥å¿—è½®è½¬\n å®‰è£…ç³»ç»Ÿç›‘æ§å·¥å…·\n\n5. é˜²ç«å¢™é…ç½®# HM MES éƒ¨ç½²æŒ‡å—sudo ufw allow 22/tcp    # SSHsudo ufw allow 80/tcp    # HTTPsudo ufw allow 443/tcp   # HTTPSsudo ufw allow 3306/tcp  # MySQL (ä»…å†…ç½‘)sudo ufw enable# HM MES éƒ¨ç½²æŒ‡å—sudo firewall-cmd --permanent --add-service=httpsudo firewall-cmd --permanent --add-service=httpssudo firewall-cmd --reload\n\nDocker éƒ¨ç½²æ–¹æ¡ˆ1. Dockerfileåˆ›å»º Dockerfileï¼š\nFROM openjdk:11-jre-slim# HM MES éƒ¨ç½²æŒ‡å—WORKDIR /app# HM MES éƒ¨ç½²æŒ‡å—COPY target/hm-mes.war app.war# HM MES éƒ¨ç½²æŒ‡å—RUN mkdir -p /app/logs# HM MES éƒ¨ç½²æŒ‡å—EXPOSE 8080# HM MES éƒ¨ç½²æŒ‡å—ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;-Djava.security.egd=file:/dev/./urandom&quot;, &quot;app.war&quot;]\n\n2. Docker Composeåˆ›å»º docker-compose.ymlï¼š\nversion: &#x27;3.8&#x27;services:  mysql:    image: mysql:8.0    environment:      MYSQL_ROOT_PASSWORD: root_password      MYSQL_DATABASE: hm_mes      MYSQL_USER: hm_user      MYSQL_PASSWORD: your_strong_password    ports:      - &quot;3306:3306&quot;    volumes:      - mysql_data:/var/lib/mysql      - ./doc/hm-mes.sql:/docker-entrypoint-initdb.d/init.sql    command: --default-authentication-plugin=mysql_native_password  mes-backend:    build: .    ports:      - &quot;8080:8080&quot;    depends_on:      - mysql    environment:      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/hm_mes?useSSL=false&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true      SPRING_DATASOURCE_USERNAME: hm_user      SPRING_DATASOURCE_PASSWORD: your_strong_password    volumes:      - ./logs:/app/logs  nginx:    image: nginx:alpine    ports:      - &quot;80:80&quot;      - &quot;443:443&quot;    volumes:      - ./nginx.conf:/etc/nginx/conf.d/default.conf      - ./mes-front:/usr/share/nginx/html    depends_on:      - mes-backendvolumes:  mysql_data:\n\n3. Docker éƒ¨ç½²å‘½ä»¤# HM MES éƒ¨ç½²æŒ‡å—docker-compose up -d# HM MES éƒ¨ç½²æŒ‡å—docker-compose ps# HM MES éƒ¨ç½²æŒ‡å—docker-compose logs -f mes-backend# HM MES éƒ¨ç½²æŒ‡å—docker-compose down\n\nç›‘æ§ä¸ç»´æŠ¤1. åº”ç”¨ç›‘æ§æ¨è\nPrometheus + Grafana: ç³»ç»Ÿå’Œåº”ç”¨æ€§èƒ½ç›‘æ§\nELK Stack: æ—¥å¿—æ”¶é›†å’Œåˆ†æ\nZabbix: ç»¼åˆç›‘æ§å¹³å°\n\n2. å¤‡ä»½ç­–ç•¥# HM MES éƒ¨ç½²æŒ‡å—#!/bin/bashBACKUP_DIR=&quot;/backup/mysql&quot;DATE=$(date +%Y%m%d_%H%M%S)mkdir -p $BACKUP_DIR# HM MES éƒ¨ç½²æŒ‡å—mysqldump -u hm_user -p&#x27;your_strong_password&#x27; hm_mes | gzip &gt; $BACKUP_DIR/hm_mes_$DATE.sql.gz# HM MES éƒ¨ç½²æŒ‡å—find $BACKUP_DIR -name &quot;*.sql.gz&quot; -mtime +7 -delete# HM MES éƒ¨ç½²æŒ‡å—tar -czf $BACKUP_DIR/mes-front_$DATE.tar.gz /var/www/html/mes-front\n\n3. æ€§èƒ½æµ‹è¯•å»ºè®®ä½¿ç”¨ JMeter æˆ– LoadRunner è¿›è¡Œå‹åŠ›æµ‹è¯•ï¼š\n\nå¹¶å‘ç”¨æˆ·æ•°ï¼š100-500\næµ‹è¯•åœºæ™¯ï¼šç™»å½•ã€æŸ¥è¯¢ã€æ•°æ®å½•å…¥\nç›‘æ§æŒ‡æ ‡ï¼šå“åº”æ—¶é—´ã€ååé‡ã€CPU&#x2F;å†…å­˜ä½¿ç”¨ç‡\n\næ€»ç»“æœ¬æŒ‡å—æ¶µç›–äº† Hm-MES ç³»ç»Ÿä»å¼€å‘ç¯å¢ƒåˆ°ç”Ÿäº§ç¯å¢ƒçš„å®Œæ•´éƒ¨ç½²æµç¨‹ã€‚åœ¨å®é™…éƒ¨ç½²ä¸­ï¼Œè¯·æ ¹æ®ï¼š\n\nä¸šåŠ¡è§„æ¨¡ï¼šè°ƒæ•´ç¡¬ä»¶é…ç½®å’Œ JVM å‚æ•°\nå®‰å…¨è¦æ±‚ï¼šå®æ–½ç›¸åº”çš„å®‰å…¨æªæ–½\næ€§èƒ½éœ€æ±‚ï¼šä¼˜åŒ–æ•°æ®åº“å’Œç¼“å­˜é…ç½®\nè¿ç»´è¦æ±‚ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§å’Œå¤‡ä»½æœºåˆ¶\n\nå¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒå›¢é˜Ÿã€‚\n","categories":["äº‘æœåŠ¡ä¸DevOps","ä¼ä¸šçº§åº”ç”¨"],"tags":["MES","åˆ¶é€ æ‰§è¡Œç³»ç»Ÿ","ç¼–è¯‘éƒ¨ç½²","Java","Spring Boot","Tomcat","Nginx"]},{"title":"Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—","url":"/posts/e0946359/","content":"Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šç³»ç»Ÿæ›´æ–°å’ŒåŸºç¡€å·¥å…·å®‰è£…\nç¬¬äºŒæ­¥ï¼šå®‰è£…ç¼–è¯‘å™¨å·¥å…·é“¾\nç¬¬ä¸‰æ­¥ï¼šå®‰è£…æ„å»ºå·¥å…·\nç¬¬å››æ­¥ï¼šå®‰è£…è°ƒè¯•å·¥å…·\nç¬¬äº”æ­¥ï¼šå®‰è£…å¸¸ç”¨å¼€å‘åº“\nç¬¬å…­æ­¥ï¼šé…ç½® IDE å’Œç¼–è¾‘å™¨\nç¬¬ä¸ƒæ­¥ï¼šéªŒè¯å¼€å‘ç¯å¢ƒ\nç¬¬å…«æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡\né™„å½•ï¼šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥\nå¸¸è§é—®é¢˜\n\næ¦‚è¿°æœ¬æ–‡æ¡£æä¾›äº†åœ¨ Ubuntu 22.04 LTS ç³»ç»Ÿä¸Šæ­å»ºå®Œæ•´ C++ å¼€å‘ç¯å¢ƒçš„è¯¦ç»†æ­¥éª¤ã€‚æ— è®ºæ‚¨æ˜¯ C++ åˆå­¦è€…è¿˜æ˜¯æœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œéƒ½å¯ä»¥æŒ‰ç…§æœ¬æŒ‡å—å¿«é€Ÿé…ç½®ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å¼€å‘ç¯å¢ƒã€‚\nä¸»è¦ç»„ä»¶\nç¼–è¯‘å™¨: GCC&#x2F;G++ (æ”¯æŒ C++11&#x2F;14&#x2F;17&#x2F;20)\næ„å»ºç³»ç»Ÿ: CMake, Make\nè°ƒè¯•å™¨: GDB\nåŒ…ç®¡ç†: apt, vcpkg\nIDE: Visual Studio Code (å¯é€‰)\nç‰ˆæœ¬æ§åˆ¶: Git\n\nç¬¬ä¸€æ­¥ï¼šç³»ç»Ÿæ›´æ–°å’ŒåŸºç¡€å·¥å…·å®‰è£…1. æ›´æ–°ç³»ç»ŸåŒ…# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt update# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt upgrade -y# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt dist-upgrade -y\n\n2. å®‰è£…åŸºç¡€å¼€å‘å·¥å…·# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y build-essential# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y git wget curl unzip tar software-properties-common# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y manpages-dev man-db\n\n3. éªŒè¯åŸºç¡€å®‰è£…# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—gcc --version# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—g++ --version# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—make --version\n\nç¬¬äºŒæ­¥ï¼šå®‰è£…ç¼–è¯‘å™¨å·¥å…·é“¾1. å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ GCC&#x2F;G++Ubuntu 22.04 é»˜è®¤æä¾› GCC 11ï¼Œå¦‚éœ€æ›´æ–°ç‰ˆæœ¬ï¼š\n# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo add-apt-repository -y ppa:ubuntu-toolchain-r/testsudo apt update# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y gcc-11 g++-11sudo apt install -y gcc-12 g++-12  # å¦‚å¯ç”¨# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-11 11sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-11 11\n\n2. é…ç½®ç¼–è¯‘å™¨æ”¯æŒ C++ æ ‡å‡†é»˜è®¤æƒ…å†µä¸‹ï¼ŒGCC æ”¯æŒ C++17ã€‚ç¡®ä¿æ”¯æŒæœ€æ–°æ ‡å‡†ï¼š\n# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—echo &#x27;#include &lt;iostream&gt;#include &lt;ranges&gt;#include &lt;vector&gt;int main() &#123;    std::vector&lt;int&gt; v = &#123;1, 2, 3, 4, 5&#125;;    auto even = v | std::views::filter([](int n) &#123; return n % 2 == 0; &#125;);    for (int n : even) std::cout &lt;&lt; n &lt;&lt; &quot; &quot;;    return 0;&#125;&#x27; &gt; test_cpp20.cppg++ -std=c++20 -o test_cpp20 test_cpp20.cpp./test_cpp20rm test_cpp20.cpp test_cpp20\n\nç¬¬ä¸‰æ­¥ï¼šå®‰è£…æ„å»ºå·¥å…·1. å®‰è£… CMake# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y cmake# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—cmake --version\n\n2. å®‰è£… Ninja (å¯é€‰ï¼Œæ›´å¿«çš„æ„å»ºå·¥å…·)# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y ninja-build# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—ninja --version\n\n3. å®‰è£…å…¶ä»–æ„å»ºå·¥å…·# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y autotools-dev autoconf automake# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y pkg-config\n\nç¬¬å››æ­¥ï¼šå®‰è£…è°ƒè¯•å·¥å…·1. å®‰è£… GDB# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y gdb# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y gdbserver# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—gdb --version\n\n2. å®‰è£… Valgrind (å†…å­˜æ£€æŸ¥å·¥å…·)# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y valgrind# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—valgrind --version\n\n3. å®‰è£…å…¶ä»–è°ƒè¯•å·¥å…·# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y strace# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y ltrace# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y lsof\n\nç¬¬äº”æ­¥ï¼šå®‰è£…å¸¸ç”¨å¼€å‘åº“1. æ ‡å‡†åº“å’Œ STL æ‰©å±•# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libboost-all-dev# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libstdc++-12-dev\n\n2. ç½‘ç»œå’Œé€šä¿¡åº“# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libzmq3-dev# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libgrpc++-dev libprotobuf-dev protobuf-compiler-grpc# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libcurl4-openssl-dev\n\n3. æ•°æ®åº“åº“# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libsqlite3-dev# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libmysqlclient-dev# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libpq-dev\n\n4. å›¾å½¢å’Œ GUI åº“# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y qt6-base-dev qt6-tools-dev# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libgtk-3-dev# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libgl1-mesa-dev libglu1-mesa-dev libglut-dev\n\n5. æ•°å­¦å’Œç§‘å­¦è®¡ç®—åº“# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libblas-dev liblapack-dev# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libfftw3-dev# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y libeigen3-dev\n\nç¬¬å…­æ­¥ï¼šé…ç½® IDE å’Œç¼–è¾‘å™¨1. å®‰è£… Visual Studio Code# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—wget -qO- https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor &gt; packages.microsoft.gpgsudo install -o root -g root -m 644 packages.microsoft.gpg /etc/apt/trusted.gpg.d/sudo sh -c &#x27;echo &quot;deb [arch=amd64,arm64,armhf signed-by=/etc/apt/trusted.gpg.d/packages.microsoft.gpg] https://packages.microsoft.com/repos/code stable main&quot; &gt; /etc/apt/sources.list.d/vscode.list&#x27;sudo apt updatesudo apt install -y code# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—code --install-extension ms-vscode.cpptoolscode --install-extension ms-vscode.cmake-toolscode --install-extension ms-vscode.makefile-toolscode --install-extension vadimcn.vscode-lldb\n\n2. å®‰è£… CLion (JetBrains IDEï¼Œå¯é€‰)# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—wget -O - https://download.jetbrains.com/toolbox/jetbrains-toolbox.tar.gz | tar xz./jetbrains-toolbox/jetbrains-toolbox\n\n3. é…ç½® Vim&#x2F;Neovim (å¯é€‰)# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—sudo apt install -y neovim# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—mkdir -p ~/.config/nvimcat &gt; ~/.config/nvim/init.vim &lt;&lt; &#x27;EOF&#x27;&quot; C++ å¼€å‘é…ç½®set numberset syntax=onset tabstop=4set shiftwidth=4set expandtab&quot; æ’ä»¶ç®¡ç†å™¨ vim-plugsh -c &#x27;curl -fLo &quot;$&#123;XDG_DATA_HOME:-$HOME/.local/share&#125;&quot;/nvim/site/autoload/plug.vim --create-dirs \\       https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim&#x27;&quot; æ’ä»¶é…ç½®call plug#begin()Plug &#x27;derekwyatt/vim-cpp&#x27;Plug &#x27;rhysd/vim-clang-format&#x27;Plug &#x27;majutsushi/tagbar&#x27;call plug#end()EOF\n\nç¬¬ä¸ƒæ­¥ï¼šéªŒè¯å¼€å‘ç¯å¢ƒ1. åˆ›å»ºæµ‹è¯•é¡¹ç›®# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—mkdir ~/cpp_test_projectcd ~/cpp_test_project# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—cat &gt; main.cpp &lt;&lt; &#x27;EOF&#x27;#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;algorithm&gt;#include &lt;string&gt;int main() &#123;    std::vector&lt;std::string&gt; names = &#123;&quot;Alice&quot;, &quot;Bob&quot;, &quot;Charlie&quot;, &quot;David&quot;&#125;;    std::cout &lt;&lt; &quot;Hello from C++!&quot; &lt;&lt; std::endl;    std::cout &lt;&lt; &quot;Names:&quot; &lt;&lt; std::endl;    for (const auto&amp; name : names) &#123;        std::cout &lt;&lt; &quot;- &quot; &lt;&lt; name &lt;&lt; std::endl;    &#125;    // ä½¿ç”¨ STL ç®—æ³•    std::sort(names.begin(), names.end());    std::cout &lt;&lt; &quot;\\nSorted names:&quot; &lt;&lt; std::endl;    for (const auto&amp; name : names) &#123;        std::cout &lt;&lt; &quot;- &quot; &lt;&lt; name &lt;&lt; std::endl;    &#125;    return 0;&#125;EOF# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—g++ -std=c++17 -Wall -Wextra -o main_g++ main.cpp# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—cat &gt; Makefile &lt;&lt; &#x27;EOF&#x27;CXX = g++CXXFLAGS = -std=c++17 -Wall -Wextra -O2TARGET = main_makeall: $(TARGET)$(TARGET): main.cpp\t$(CXX) $(CXXFLAGS) -o $(TARGET) main.cppclean:\trm -f $(TARGET).PHONY: all cleanEOFmake\n\n2. ä½¿ç”¨ CMake æ„å»ºé¡¹ç›®# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—cat &gt; CMakeLists.txt &lt;&lt; &#x27;EOF&#x27;cmake_minimum_required(VERSION 3.16)project(CppTestProject VERSION 1.0)set(CMAKE_CXX_STANDARD 17)set(CMAKE_CXX_STANDARD_REQUIRED ON)# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES &quot;Clang&quot;)    add_compile_options(-Wall -Wextra -Wpedantic)endif()# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—add_executable(main_cmake main.cpp)# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—target_compile_features(main_cmake PRIVATE cxx_std_17)# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—EOF# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—mkdir buildcd buildcmake ..makecd ..# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—echo &quot;Testing g++ compiled version:&quot;./main_g++echo -e &quot;\\nTesting Make compiled version:&quot;./main_makeecho -e &quot;\\nTesting CMake compiled version:&quot;./build/main_cmake# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—make cleanrm -rf build\n\n3. æµ‹è¯•è°ƒè¯•åŠŸèƒ½# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—g++ -std=c++17 -g -o main_debug main.cpp# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—echo &quot;Testing GDB:&quot;echo &quot;run&quot; | gdb -batch -ex &quot;break main&quot; -ex &quot;next&quot; -ex &quot;next&quot; ./main_debug# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—echo -e &quot;\\nTesting Valgrind:&quot;valgrind --leak-check=full --error-exitcode=1 ./main_debug\n\nç¬¬å…«æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡1. åˆ›å»ºå¼€å‘ç¯å¢ƒé…ç½®æ–‡ä»¶# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—cat &gt; ~/.cpp_dev_env &lt;&lt; &#x27;EOF&#x27;#!/bin/bash# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—export CC=gccexport CXX=g++# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—export CMAKE_GENERATOR=Ninja  # ä½¿ç”¨ Ninja ä½œä¸ºé»˜è®¤ç”Ÿæˆå™¨# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—export DEV_HOME=$HOME/Developmentexport CPP_PROJECTS=$DEV_HOME/cpp_projects# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—mkdir -p $CPP_PROJECTS# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—alias cmake-build=&#x27;mkdir -p build &amp;&amp; cd build &amp;&amp; cmake .. &amp;&amp; make&#x27;alias cmake-clean=&#x27;rm -rf build&#x27;alias cpp-run=&#x27;g++ -std=c++17 -Wall -Wextra -O2&#x27;alias cpp-debug=&#x27;g++ -std=c++17 -g -DDEBUG -Wall -Wextra&#x27;# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—git config --global init.defaultBranch maingit config --global pull.rebase falseEOF# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—echo &#x27;source ~/.cpp_dev_env&#x27; &gt;&gt; ~/.bashrcsource ~/.bashrc\n\n2. é…ç½® vcpkg (C++ åŒ…ç®¡ç†å™¨ï¼Œå¯é€‰)# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—git clone https://github.com/Microsoft/vcpkg.git ~/vcpkg~/vcpkg/bootstrap-vcpkg.sh# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—echo &#x27;export PATH=&quot;$PATH:~/vcpkg&quot;&#x27; &gt;&gt; ~/.bashrc# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—~/vcpkg/vcpkg integrate install# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—vcpkg version\n\né™„å½•ï¼šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥ç¼–è¯‘å‘½ä»¤# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—g++ -std=c++17 -o program source.cpp# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—g++ -std=c++17 -Wall -Wextra -O2 -o program source.cpp# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—g++ -std=c++17 -g -o program_debug source.cpp# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—g++ -std=c++17 -S -o program.s source.cpp# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—g++ -std=c++17 -o program source.cpp -lpthread -lm\n\nCMake å‘½ä»¤# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—cmake -B build -S .# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—cmake --build build# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—rm -rf build# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—cmake -B build -S . -DCMAKE_BUILD_TYPE=Releasecmake -B build -S . -DCMAKE_BUILD_TYPE=Debug\n\nè°ƒè¯•å‘½ä»¤# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—gdb ./program# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—(gdb) run                 # è¿è¡Œç¨‹åº(gdb) break main          # åœ¨ main å‡½æ•°è®¾ç½®æ–­ç‚¹(gdb) next               # å•æ­¥æ‰§è¡Œ(gdb) step               # è¿›å…¥å‡½æ•°(gdb) print variable     # æ‰“å°å˜é‡å€¼(gdb) continue           # ç»§ç»­æ‰§è¡Œ(gdb) quit               # é€€å‡º GDB# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—valgrind --leak-check=full ./programvalgrind --tool=callgrind ./program\n\nå¸¸è§é—®é¢˜Q1: ç¼–è¯‘æ—¶æç¤ºæ‰¾ä¸åˆ°å¤´æ–‡ä»¶ï¼ŸA: æ£€æŸ¥æ˜¯å¦å®‰è£…äº†å¯¹åº”çš„å¼€å‘åŒ…ã€‚ä¾‹å¦‚ï¼Œæ‰¾ä¸åˆ° &lt;boost/filesystem.hpp&gt; æ—¶ï¼Œè¿è¡Œï¼š\nsudo apt install libboost-filesystem-dev\n\nQ2: é“¾æ¥æ—¶æç¤ºæ‰¾ä¸åˆ°åº“ï¼ŸA: ä½¿ç”¨ apt search æŸ¥æ‰¾å¯¹åº”çš„å¼€å‘åŒ…ï¼Œæˆ–ä½¿ç”¨ pkg-configï¼š\npkg-config --cflags --libs library_name\n\nQ3: GDB è°ƒè¯•æ—¶çœ‹ä¸åˆ°å˜é‡å€¼ï¼ŸA: ç¡®ä¿ä½¿ç”¨ -g é€‰é¡¹ç¼–è¯‘ï¼Œå¹¶ä¸”æ²¡æœ‰å¯ç”¨ä¼˜åŒ–ï¼š\ng++ -std=c++17 -g -O0 -o program source.cpp\n\nQ4: CMake æ‰¾ä¸åˆ°åŒ…ï¼ŸA: å®‰è£…å¯¹åº”çš„å¼€å‘åŒ…ï¼Œæˆ–è€…ä½¿ç”¨ CMAKE_PREFIX_PATH æŒ‡å®šå®‰è£…è·¯å¾„ï¼š\ncmake -DCMAKE_PREFIX_PATH=/usr/local ..\n\nQ5: ç¨‹åºè¿è¡Œæ—¶æç¤º Segmentation faultï¼ŸA: ä½¿ç”¨ GDB æˆ– Valgrind è¿›è¡Œè°ƒè¯•ï¼š\ngdb ./program(gdb) run(gdb) bt  # æŸ¥çœ‹è°ƒç”¨æ ˆ# Ubuntu CPP å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—valgrind ./program\n\nQ6: å¦‚ä½•åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„ GCCï¼ŸA: ä½¿ç”¨ update-alternativesï¼š\nsudo update-alternatives --config gccsudo update-alternatives --config g++\n\né€šè¿‡æœ¬æŒ‡å—ï¼Œæ‚¨åº”è¯¥å·²ç»æˆåŠŸæ­å»ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ Ubuntu 22 C++ å¼€å‘ç¯å¢ƒã€‚å»ºè®®åˆ›å»ºä¸€ä¸ªç¤ºä¾‹é¡¹ç›®æ¥æµ‹è¯•æ‰€æœ‰ç»„ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚\n","categories":["C++æ ¸å¿ƒå¼€å‘","å¼€å‘ç¯å¢ƒ"],"tags":["Ubuntu","C++","å¼€å‘ç¯å¢ƒ","GCC","G++","CMake","GDB","VSCode","åŒ…ç®¡ç†"]},{"title":"Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—","url":"/posts/cf6de084/","content":"Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šå®‰è£… atop\nç¬¬äºŒæ­¥ï¼šå®‰è£… netatop ç½‘ç»œç›‘æ§æ¨¡å— (å¯é€‰)\nç¬¬ä¸‰æ­¥ï¼šé…ç½® atop æœåŠ¡\nç¬¬å››æ­¥ï¼šä½¿ç”¨ atop\nç¬¬äº”æ­¥ï¼šåˆ†æå†å²æ—¥å¿—\né™„å½•ï¼šç›‘æ§å­—æ®µè¯´æ˜\nå¸¸è§é—®é¢˜\n\næ¦‚è¿°atop æ˜¯ä¸€ä¸ªé«˜çº§çš„ã€å¯äº¤äº’çš„ Linux ç³»ç»Ÿæ€§èƒ½ç›‘æ§å·¥å…·ã€‚ä¸ topã€htop ç­‰å·¥å…·ç›¸æ¯”ï¼Œatop æœ€å¼ºå¤§çš„ç‰¹æ€§æ˜¯å®ƒèƒ½å¤Ÿè®°å½•å†å²æ€§èƒ½æ•°æ®ï¼Œå¹¶å…è®¸ä½ åƒæ’­æ”¾è§†é¢‘ä¸€æ ·â€œå›æ”¾â€ç³»ç»Ÿåœ¨è¿‡å»æŸä¸ªæ—¶é—´ç‚¹çš„çŠ¶æ€ï¼Œæå¤§åœ°ä¾¿åˆ©äº†é—®é¢˜æ’æŸ¥å’Œæ€§èƒ½åˆ†æã€‚\nä¸»è¦ç‰¹æ€§\nå…¨é¢ç›‘æ§: ç›‘æ§ CPUã€å†…å­˜ã€äº¤æ¢ç©ºé—´ã€ç£ç›˜ I&#x2F;Oã€ç½‘ç»œä»¥åŠå„ä¸ªè¿›ç¨‹çš„èµ„æºä½¿ç”¨æƒ…å†µã€‚\nå†å²è®°å½•: é»˜è®¤ä»¥10åˆ†é’Ÿä¸ºé—´éš”ï¼Œå°†ç³»ç»Ÿå¿«ç…§è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå¹¶ä¿ç•™28å¤©ã€‚\nè¿›ç¨‹çº§è¯¦æƒ…: è®°å½•æ¯ä¸ªè¿›ç¨‹çš„èµ„æºä½¿ç”¨ã€çŠ¶æ€ã€é€€å‡ºç ç­‰è¯¦ç»†ä¿¡æ¯ã€‚\né«˜äº®æ˜¾ç¤º: å¯¹è¿‡è½½çš„ç³»ç»Ÿèµ„æºä½¿ç”¨ä¸åŒé¢œè‰²é«˜äº®æ˜¾ç¤ºï¼Œä¸€ç›®äº†ç„¶ã€‚\n\nç¬¬ä¸€æ­¥ï¼šå®‰è£… atopUbuntu&#x2F;Debian# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo apt update# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo apt install -y atop# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—atop --version\n\nCentOS&#x2F;RHEL# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo yum install -y epel-release# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo yum install -y atop# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—\n\nç¬¬äºŒæ­¥ï¼šå®‰è£… netatop ç½‘ç»œç›‘æ§æ¨¡å— (å¯é€‰)é»˜è®¤æƒ…å†µä¸‹ï¼Œatop åªèƒ½æ˜¾ç¤ºç³»ç»Ÿæ€»çš„ç½‘ç»œæµé‡ã€‚è¦æŸ¥çœ‹æ¯ä¸ªè¿›ç¨‹çš„ç½‘ç»œæ´»åŠ¨ï¼Œä½ éœ€è¦å®‰è£… netatop å†…æ ¸æ¨¡å—ã€‚\n1. å®‰è£…ä¾èµ–# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo apt install -y build-essential zlib1g-dev linux-headers-$(uname -r)# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo yum groupinstall -y &quot;Development Tools&quot;sudo yum install -y zlib-devel kernel-devel\n\n2. ä¸‹è½½å’Œç¼–è¯‘# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—mkdir -p ~/build/netatop &amp;&amp; cd ~/build/netatop# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—wget https://www.atoptool.nl/download/netatop-3.1.tar.gz --no-check-certificate# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—tar -zxvf netatop-3.1.tar.gzcd netatop-3.1# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo make &amp;&amp; sudo make install\n\n3. åŠ è½½æ¨¡å—å¹¶è®¾ä¸ºè‡ªå¯# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo modprobe netatop# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—lsmod | grep netatop# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—echo &quot;netatop&quot; | sudo tee /etc/modules-load.d/netatop.conf# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo systemctl start netatopsudo systemctl enable netatop\n\nç¬¬ä¸‰æ­¥ï¼šé…ç½® atop æœåŠ¡atop å®‰è£…åä¼šä½œä¸ºä¸€ä¸ªåå°æœåŠ¡è¿è¡Œï¼Œå®šæœŸè®°å½•ç³»ç»Ÿå¿«ç…§ã€‚æˆ‘ä»¬å¯ä»¥ä¼˜åŒ–å…¶é…ç½®ã€‚\n1. ç¼–è¾‘é…ç½®æ–‡ä»¶\nUbuntu&#x2F;Debian: /etc/default/atop\nCentOS&#x2F;RHEL: /etc/sysconfig/atop\n\n# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—sudo nano /etc/default/atop\n\n2. ä¿®æ”¹æ ¸å¿ƒå‚æ•°æ‰¾åˆ°ä»¥ä¸‹è¡Œå¹¶ä¿®æ”¹ä¸ºä½ éœ€è¦çš„å€¼ã€‚æ¨èé…ç½®å¦‚ä¸‹ï¼š\n# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—LOGPATH=&quot;/var/log/atop&quot;# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—LOGINTERVAL=60# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—LOGGENERATIONS=14\n\n3. é‡å¯æœåŠ¡ä¿®æ”¹é…ç½®åï¼Œé‡å¯ atop æœåŠ¡ä½¿å…¶ç”Ÿæ•ˆã€‚\nsudo systemctl restart atop\n\nç¬¬å››æ­¥ï¼šä½¿ç”¨ atopç›´æ¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œ atop å³å¯è¿›å…¥äº¤äº’å¼ç›‘æ§ç•Œé¢ã€‚\näº¤äº’ç•Œé¢å¸¸ç”¨å¿«æ·é”®\ng: é»˜è®¤è§†å›¾ï¼Œæ˜¾ç¤ºé€šç”¨ä¿¡æ¯ã€‚\nm: æŒ‰å†…å­˜ä½¿ç”¨ç‡å¯¹è¿›ç¨‹æ’åºã€‚\nd: æŒ‰ç£ç›˜æ´»åŠ¨å¯¹è¿›ç¨‹æ’åºã€‚\nn: æŒ‰ç½‘ç»œæ´»åŠ¨å¯¹è¿›ç¨‹æ’åº (éœ€è¦ netatop æ¨¡å—)ã€‚\nc: æ˜¾ç¤ºè¿›ç¨‹çš„å®Œæ•´å‘½ä»¤è¡Œã€‚\nu: æŒ‰ç”¨æˆ·èšåˆèµ„æºä½¿ç”¨æƒ…å†µã€‚\np: æ¢å¤åˆ°æŒ‰è¿›ç¨‹èšåˆçš„é»˜è®¤è§†å›¾ã€‚\nh æˆ– ?: æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ã€‚\nq: é€€å‡ºã€‚\n\nç¬¬äº”æ­¥ï¼šåˆ†æå†å²æ—¥å¿—è¿™æ˜¯ atop æœ€å¼ºå¤§çš„åŠŸèƒ½ã€‚\n1. è¯»å–æ—¥å¿—æ–‡ä»¶# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—atop -r# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—atop -r /var/log/atop/atop_20240921# Linux atop ç›‘æ§å·¥å…·ä½¿ç”¨æŒ‡å—atop -r /var/log/atop/atop_$(date -d &quot;yesterday&quot; +%Y%m%d)\n\n2. åœ¨å†å²è®°å½•ä¸­å¯¼èˆªè¿›å…¥å†å²è®°å½•è§†å›¾åï¼Œä½¿ç”¨ä»¥ä¸‹å¿«æ·é”®ï¼š\n\nt: å‘æœªæ¥è·³è½¬ä¸€ä¸ªæ—¶é—´é—´éš”ï¼ˆä½ åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®çš„ LOGINTERVALï¼‰ã€‚\nT: å‘è¿‡å»è·³è½¬ä¸€ä¸ªæ—¶é—´é—´éš”ã€‚\nb: ï¼ˆBeginï¼‰è·³è½¬åˆ°æŒ‡å®šçš„æ—¶é—´ç‚¹ï¼Œä¾‹å¦‚è¾“å…¥ 14:30ã€‚\n\né€šè¿‡è¿™äº›å‘½ä»¤ï¼Œä½ å¯ä»¥ç²¾ç¡®åœ°â€œå›æ”¾â€åˆ°ç³»ç»Ÿå‡ºç°é—®é¢˜çš„æ—¶é—´ç‚¹ï¼ŒæŸ¥çœ‹å½“æ—¶çš„ CPUã€å†…å­˜ã€ç£ç›˜å’Œç½‘ç»œçŠ¶å†µï¼Œä»¥åŠæ˜¯å“ªä¸ªè¿›ç¨‹å¯¼è‡´çš„é—®é¢˜ã€‚\né™„å½•ï¼šç›‘æ§å­—æ®µè¯´æ˜\nPRC (Process): è¿›ç¨‹æ€»ä½“çŠ¶æ€ï¼ŒåŒ…æ‹¬ sys (å†…æ ¸æ€) å’Œ user (ç”¨æˆ·æ€) çš„ CPU æ—¶é—´å æ¯”ï¼Œä»¥åŠè¿è¡Œã€ä¼‘çœ ã€åƒµå°¸è¿›ç¨‹çš„æ•°é‡ã€‚\nCPU: ç³»ç»Ÿæ€»çš„ CPU ä½¿ç”¨æƒ…å†µã€‚wait å æ¯”è¿‡é«˜é€šå¸¸è¡¨ç¤ºç£ç›˜ I&#x2F;O ç“¶é¢ˆã€‚\nCPL (CPU Load): CPU è´Ÿè½½æƒ…å†µï¼ŒåŒ…æ‹¬1ã€5ã€15åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ï¼Œä»¥åŠä¸Šä¸‹æ–‡åˆ‡æ¢ (csw) å’Œä¸­æ–­ (intr) æ¬¡æ•°ã€‚\nMEM: ç‰©ç†å†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬æ€»é‡ (tot)ã€ç©ºé—² (free)ã€ç¼“å­˜ (cache) å’Œç¼“å†² (buff)ã€‚\nSWP: äº¤æ¢ç©ºé—´ï¼ˆè™šæ‹Ÿå†…å­˜ï¼‰çš„ä½¿ç”¨æƒ…å†µã€‚\nDSK: ç£ç›˜æ´»åŠ¨ã€‚busy ç™¾åˆ†æ¯”æ˜¾ç¤ºäº†ç£ç›˜çš„ç¹å¿™ç¨‹åº¦ã€‚\nNET: ç½‘ç»œæ´»åŠ¨ã€‚é¡¶å±‚æ˜¾ç¤ºä¼ è¾“å±‚ï¼ˆTCP&#x2F;UDPï¼‰çš„åŒ…ç»Ÿè®¡ï¼Œåº•å±‚æ˜¾ç¤ºå„ä¸ªç½‘ç»œæ¥å£çš„æµé‡ã€‚\n\nå¸¸è§é—®é¢˜Q1: atop æ— æ³•å¯åŠ¨ï¼Œæˆ–æç¤º command not found?A: ç¡®è®¤ atop å·²æ­£ç¡®å®‰è£… (which atop)ã€‚å¦‚æœå·²å®‰è£…ä½†æ— æ³•è¿è¡Œï¼Œæ£€æŸ¥ PATH ç¯å¢ƒå˜é‡ã€‚\nQ2: ç½‘ç»œç›‘æ§ (n å¿«æ·é”®) ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯?A: netatop å†…æ ¸æ¨¡å—æ²¡æœ‰è¢«æ­£ç¡®åŠ è½½ã€‚è¯·è¿è¡Œ lsmod | grep netatop æ£€æŸ¥ï¼Œå¦‚æœæ— è¾“å‡ºï¼Œè¯·å°è¯•æ‰‹åŠ¨åŠ è½½ sudo modprobe netatop å¹¶å¯åŠ¨æœåŠ¡ sudo systemctl start netatopã€‚\nQ3: æ—¥å¿—æ–‡ä»¶è¿‡å¤§ï¼Œå ç”¨å¤ªå¤šç£ç›˜ç©ºé—´?A: ç¼–è¾‘ atop çš„é…ç½®æ–‡ä»¶ï¼ˆè§ç¬¬ä¸‰æ­¥ï¼‰ï¼Œå‡å° LOGGENERATIONS çš„å€¼ï¼ˆä¾‹å¦‚æ”¹ä¸º 7 å¤©ï¼‰ï¼Œæˆ–è€…å¢å¤§ LOGINTERVAL çš„å€¼ï¼ˆä¾‹å¦‚ 120 ç§’ï¼‰ã€‚\n","categories":["ç³»ç»Ÿè¿ç»´ç®¡ç†","ç›‘æ§ä¸è¯Šæ–­"],"tags":["Ubuntu","atop","ç³»ç»Ÿç›‘æ§","æ€§èƒ½åˆ†æ","Linux","netatop"]},{"title":"FileZilla å†…ç½‘ç©¿é€é…ç½®æŒ‡å—","url":"/posts/2acf74bd/","content":"ğŸ› ï¸ è¯¦ç»†é…ç½®æ­¥éª¤1. å®‰è£…ä¸é…ç½®FileZilla Server\nä¸‹è½½ä¸å®‰è£…åœ¨æ‚¨çš„å†…ç½‘æœåŠ¡å™¨ä¸Šï¼Œä»FileZillaå®˜ç½‘ä¸‹è½½FileZilla Serverå¹¶å®‰è£…ã€‚\n\næ³¨æ„: æœ¬æŒ‡å—åŸºäº FileZilla Server ç»å…¸ç‰ˆæœ¬ (0.9.x) çš„ç•Œé¢æè¿°ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ 1.x æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œç®¡ç†ç•Œé¢å¯èƒ½æœ‰æ‰€ä¸åŒï¼ˆé€šå¸¸ä¸ºåŸºäºWebçš„ä»ªè¡¨æ¿ï¼‰ï¼Œä½†æ ¸å¿ƒé…ç½®æ¦‚å¿µï¼ˆç”¨æˆ·ã€è¢«åŠ¨æ¨¡å¼ç«¯å£ï¼‰æ˜¯é€šç”¨çš„ã€‚\n\nå®‰è£…è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå¼¹å‡ºâ€œè¿æ¥åˆ°æœåŠ¡å™¨â€é…ç½®ç•Œé¢ï¼Œé€šå¸¸ä½¿ç”¨é»˜è®¤è®¾ç½®ï¼ˆå¦‚ä¸»æœºå127.0.0.1ï¼Œç®¡ç†ç«¯å£ï¼‰å³å¯ï¼Œç‚¹å‡»â€œè¿æ¥â€æˆ–â€œç¡®å®šâ€ã€‚\n\nåˆ›å»ºç”¨æˆ·ä¸è®¾ç½®å¯†ç å®‰è£…å®Œæˆåï¼Œåœ¨FileZilla Serverç®¡ç†ç•Œé¢ä¸­ï¼š\n\nç‚¹å‡» Edit -&gt; Users è¿›å…¥ç”¨æˆ·è®¾ç½®ã€‚\nåœ¨ Generalï¼ˆé€šç”¨ï¼‰é¡µé¢ï¼Œç‚¹å‡» Add æŒ‰é’®åˆ›å»ºæ–°ç”¨æˆ·ï¼ˆä¾‹å¦‚ user1ï¼‰ã€‚\nä¸ºè¯¥ç”¨æˆ·è®¾ç½®å¯†ç ã€‚\n\n\nè®¾ç½®å…±äº«æ–‡ä»¶å¤¹åˆ›å»ºç”¨æˆ·åï¼Œç³»ç»Ÿé€šå¸¸ä¼šæç¤ºéœ€è®¾ç½®è‡³å°‘ä¸€ä¸ªå…±äº«æ–‡ä»¶å¤¹ã€‚\n\nåœ¨ Shared folders é¡µé¢ï¼Œç‚¹å‡» Add æŒ‰é’®ï¼Œé€‰æ‹©æ‚¨å¸Œæœ›å¤–ç½‘èƒ½è®¿é—®ä¸‹è½½æ–‡ä»¶çš„å†…ç½‘ç›®å½•ã€‚\næ ¹æ®éœ€è¦ï¼Œåœ¨ Files å’Œ Directories ä¸‹ä¸ºç”¨æˆ·è®¾ç½®ç›®å½•çš„è¯»å–ï¼ˆå¯ä¸‹è½½ï¼‰ã€å†™å…¥ã€åˆ é™¤ç­‰æƒé™ã€‚è‡³å°‘éœ€è¦å¼€å¯è¯»å–æƒé™ï¼Œæ‰èƒ½å…è®¸æ–‡ä»¶ä¸‹è½½ã€‚\n\n\n\n2. é…ç½®èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€\nå®‰è£…èŠ±ç”Ÿå£³å¹¶æ·»åŠ æ˜ å°„åœ¨å†…ç½‘æœåŠ¡å™¨ä¸‹è½½ã€å®‰è£…å¹¶ç™»å½•èŠ±ç”Ÿå£³å®¢æˆ·ç«¯ã€‚\nåœ¨èŠ±ç”Ÿå£³å®¢æˆ·ç«¯çš„ å†…ç½‘ç©¿é€ é¡µé¢ï¼Œç‚¹å‡» + æŒ‰é’®æ·»åŠ æ˜ å°„ã€‚\nåº”ç”¨åç§°ï¼šå¯è‡ªå®šä¹‰ï¼Œå¦‚â€FTP-Controlâ€ã€‚\nåº”ç”¨ç±»å‹ï¼šé€‰æ‹© TCPã€‚\nå†…ç½‘ä¸»æœºIPï¼šå¡«å†™è¿è¡ŒFileZilla Serverçš„å†…ç½‘æœåŠ¡å™¨IPåœ°å€ï¼ˆé€šå¸¸æ˜¯192.168.x.xå½¢å¼çš„åœ°å€ï¼‰ã€‚æ³¨æ„ï¼šä¸è¦ä½¿ç”¨localhostæˆ–127.0.0.1ã€‚\nå†…ç½‘ç«¯å£ï¼šå¡«å†™FTPæœåŠ¡çš„æ§åˆ¶ç«¯å£ï¼Œé»˜è®¤ä¸º 21ã€‚\nç‚¹å‡»ä¿å­˜ï¼ŒèŠ±ç”Ÿå£³ä¼šç”Ÿæˆä¸€ä¸ªFTPæ§åˆ¶é€šé“çš„å¤–ç½‘è®¿é—®åœ°å€ï¼ˆåŒ…å«åŸŸåå’Œç«¯å£ï¼‰ã€‚\n\n\n\n3. é…ç½®FTPè¢«åŠ¨æ¨¡å¼ä¸æ•°æ®ä¼ è¾“ç«¯å£FTPåè®®ä½¿ç”¨21ç«¯å£å»ºç«‹æ§åˆ¶è¿æ¥ï¼Œä½¿ç”¨è¢«åŠ¨æ¨¡å¼ä¸‹çš„å…¶ä»–ç«¯å£è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚å› æ­¤ï¼Œå¿…é¡»å•ç‹¬æ˜ å°„æ•°æ®ä¼ è¾“ç«¯å£ã€‚\n\nåœ¨èŠ±ç”Ÿå£³ä¸­æ˜ å°„æ•°æ®ç«¯å£æŒ‰ç…§ä¸Šè¿°åŒæ ·æ–¹æ³•ï¼Œåœ¨èŠ±ç”Ÿå£³ä¸­ä¸ºFTPè¢«åŠ¨æ¨¡å¼ç«¯å£å†æ·»åŠ ä¸€æ¡æ˜ å°„ï¼š\n\nåº”ç”¨åç§°ï¼šå¯è‡ªå®šä¹‰ï¼Œå¦‚â€FTP-Dataâ€ã€‚\nåº”ç”¨ç±»å‹ï¼šTCPã€‚\nå†…ç½‘ä¸»æœºIPï¼šä¸ä¸Šä¸€æ­¥ç›¸åŒã€‚\nå†…ç½‘ç«¯å£ï¼šå¯ä»»æ„å¡«å†™ä¸€ä¸ªæœªå ç”¨çš„ç«¯å£å·ï¼Œä¾‹å¦‚ 12345ã€‚\nä¿å­˜åï¼ŒèŠ±ç”Ÿå£³ä¼šç”Ÿæˆç¬¬äºŒä¸ªå¤–ç½‘è®¿é—®åœ°å€ï¼Œè¯·è®°ä¸‹è¿™ä¸ªæ–°åœ°å€çš„å¤–ç½‘ç«¯å£å·ï¼ˆä¾‹å¦‚ 10418ï¼‰ï¼Œä¸‹ä¸€æ­¥éœ€è¦ç”¨åˆ°ã€‚\n\næ·»åŠ æ˜ å°„åï¼Œå¯èƒ½éœ€è¦ç¼–è¾‘è¿™æ¡æ˜ å°„ï¼Œå°† å†…ç½‘ç«¯å£ ä¿®æ”¹ä¸ºä¸èŠ±ç”Ÿå£³ç”Ÿæˆçš„ å¤–ç½‘ç«¯å£ä¸€è‡´ï¼ˆä¾‹å¦‚å°†å†…ç½‘ç«¯å£ä»12345æ”¹ä¸º10418ï¼‰ï¼Œä»¥ç¡®ä¿æ•°æ®é€šé“æ­£å¸¸ä¼ è¾“ã€‚\n\nåœ¨FileZilla Serverä¸­è®¾ç½®è¢«åŠ¨æ¨¡å¼ç°åœ¨éœ€è¦åœ¨FileZilla Serverä¸­å‘ŠçŸ¥å®ƒä½¿ç”¨è¿™ä¸ªæ˜ å°„å¥½çš„ç«¯å£ã€‚\n\næ‰“å¼€FileZilla Serverï¼Œç‚¹å‡» Edit -&gt; Settingsï¼Œè¿›å…¥ Passive mode settings (è¢«åŠ¨æ¨¡å¼è®¾ç½®)ã€‚\nå‹¾é€‰ Use custom port range (ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£èŒƒå›´)ã€‚\nåœ¨è¾“å…¥æ¡†ä¸­ï¼Œå¡«å†™èŠ±ç”Ÿå£³ä¸ºæ•°æ®é€šé“ç”Ÿæˆçš„å¤–ç½‘ç«¯å£å·ï¼ˆä¾‹å¦‚ä¸Šä¸€æ­¥çš„ 10418ï¼‰ã€‚å¦‚æœåªä½¿ç”¨å•ä¸ªç«¯å£ï¼Œèµ·å§‹å’Œç»“æŸç«¯å£å¡«ç›¸åŒçš„å³å¯ã€‚\nå…³é”®æ­¥éª¤ï¼šåœ¨ Use the following IP ä¸‹æ–¹ï¼Œå¯èƒ½éœ€è¦å¡«å†™èŠ±ç”Ÿå£³ç”Ÿæˆçš„å¤–ç½‘è®¿é—®åŸŸåï¼ˆå³FTPæ§åˆ¶é€šé“çš„åŸŸåï¼‰ã€‚è¿™èƒ½ç¡®ä¿FTPæœåŠ¡å™¨å°†æ­£ç¡®çš„åœ°å€å‘ŠçŸ¥å¤–ç½‘å®¢æˆ·ç«¯ã€‚\n\n\n\n4. è®¾ç½®Windowsé˜²ç«å¢™å¦‚æœå†…ç½‘æœåŠ¡å™¨çš„Windowsé˜²ç«å¢™å·²å¼€å¯ï¼Œéœ€è¦æ”¾è¡ŒFileZilla Serverç›¸å…³ç«¯å£ã€‚\n\nåœ¨ Windows Defender é˜²ç«å¢™ ä¸­ï¼Œæ·»åŠ å…¥ç«™è§„åˆ™ã€‚\nå…è®¸ä¹‹å‰ç”¨åˆ°çš„ç«¯å£ï¼ˆå¦‚æ§åˆ¶ç«¯å£21å’Œæ‚¨åœ¨èŠ±ç”Ÿå£³è®¾ç½®çš„æ•°æ®ç«¯å£10418ï¼‰çš„TCPè¿æ¥ã€‚\n\n5. å¤–ç½‘è¿æ¥æµ‹è¯•åœ¨å¦ä¸€å°å¤–ç½‘ç”µè„‘ä¸Šï¼Œä½¿ç”¨ä»»ä½•FTPå®¢æˆ·ç«¯ï¼ˆå¦‚FileZilla Clientï¼‰è¿›è¡Œæµ‹è¯•ã€‚\n\nä¸»æœº&#x2F;åœ°å€ï¼šå¡«å†™èŠ±ç”Ÿå£³ä¸ºæ§åˆ¶é€šé“ç”Ÿæˆçš„å¤–ç½‘è®¿é—®åœ°å€ï¼ˆåŸŸåå’Œç«¯å£ï¼Œä¾‹å¦‚ xxxx.vicp.cc:21 å¤„çš„ç«¯å£ï¼‰ã€‚\nç”¨æˆ·åä¸å¯†ç ï¼šå¡«å†™æ‚¨åœ¨FileZilla Serverä¸­è®¾ç½®çš„è´¦å·ï¼ˆå¦‚ user1ï¼‰å’Œå¯†ç ã€‚\nä¼ è¾“æ¨¡å¼ï¼šåœ¨FTPå®¢æˆ·ç«¯çš„ç«™ç‚¹è®¾ç½®ä¸­ï¼Œä¼ è¾“æ¨¡å¼è¯·é€‰æ‹©â€œè¢«åŠ¨æ¨¡å¼â€ã€‚\nè¿æ¥æˆåŠŸåï¼Œæ‚¨åº”è¯¥èƒ½çœ‹åˆ°å†…ç½‘å…±äº«çš„æ–‡ä»¶å¹¶å¯è¿›è¡Œä¸‹è½½ã€‚\n\nğŸ’¡ å…³é”®é…ç½®æé†’ä¸æ’æŸ¥\næ ¸å¿ƒåŸç†ï¼šæˆåŠŸçš„å…³é”®åœ¨äºç†è§£FTPéœ€è¦ä¸¤ä¸ªé€šé“ï¼ˆæ§åˆ¶+æ•°æ®ï¼‰ï¼Œå¹¶æ­£ç¡®é…ç½®è¢«åŠ¨æ¨¡å¼åŠå¯¹åº”çš„ç«¯å£æ˜ å°„ã€‚\nåŸŸåä¸IPï¼šåœ¨FileZilla Serverçš„è¢«åŠ¨æ¨¡å¼è®¾ç½®ä¸­ï¼Œâ€Use the following IPâ€å¤„å»ºè®®å¡«å†™èŠ±ç”Ÿå£³ç”Ÿæˆçš„åŸŸåï¼Œè€ŒéIPåœ°å€ã€‚\né˜²ç«å¢™ï¼šç¡®ä¿å†…ç½‘æœåŠ¡å™¨çš„é˜²ç«å¢™ä¸ä¼šé˜»æŒ¡è¿æ¥ã€‚\nèŠ±ç”Ÿå£³ç‰ˆæœ¬ï¼šå…è´¹ç‰ˆèŠ±ç”Ÿå£³é€šå¸¸æ”¯æŒæ·»åŠ 2æ¡æ˜ å°„ï¼Œåˆšå¥½æ»¡è¶³FTPæ§åˆ¶ä¸æ•°æ®é€šé“çš„éœ€æ±‚ã€‚å¦‚æœæ•°æ®ç«¯å£ä¸ç†æƒ³ï¼Œå¯ä»¥åˆ é™¤æ˜ å°„åé‡æ–°æ·»åŠ ã€‚\n\n","categories":["ç³»ç»Ÿè¿ç»´ç®¡ç†","WindowsæœåŠ¡ç®¡ç†"],"tags":["Windows"]},{"title":"IO äº‹ä»¶åˆ†ç±»æ¦‚å¿µ","url":"/posts/ecdf807f/","content":"IO äº‹ä»¶åˆ†ç±»æ¦‚å¿µ\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: io, events, networking, system-programming, poll, epoll\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. I&#x2F;O äº‹ä»¶ç±»å‹\n2.1 ç½‘ç»œI&#x2F;Oäº‹ä»¶\n2.2 æ–‡ä»¶I&#x2F;Oäº‹ä»¶\n2.3 è®¾å¤‡I&#x2F;Oäº‹ä»¶\n2.4 å®šæ—¶å™¨äº‹ä»¶\n2.5 ä¿¡å·äº‹ä»¶\n\n\n3. ç½‘ç»œç¼–ç¨‹ä¸­çš„I&#x2F;Oäº‹ä»¶\n4. äº‹ä»¶å¤„ç†æœ€ä½³å®è·µ\n\n\n1. ğŸ“– æ¦‚è¿°åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼ŒI&#x2F;Oï¼ˆè¾“å…¥&#x2F;è¾“å‡ºï¼‰äº‹ä»¶æ˜¯ç³»ç»Ÿé€šçŸ¥ç¨‹åºæŸä¸ª I&#x2F;O æ“ä½œçŠ¶æ€å˜åŒ–çš„æœºåˆ¶ã€‚æ­£ç¡®ç†è§£å’Œåˆ†ç±»è¿™äº›äº‹ä»¶å¯¹äºé«˜æ•ˆçš„ç½‘ç»œç¼–ç¨‹è‡³å…³é‡è¦ã€‚\n\n2. ğŸ”§ I&#x2F;O äº‹ä»¶ç±»å‹2.1 ğŸŒ ç½‘ç»œI&#x2F;Oäº‹ä»¶ç½‘ç»œç¼–ç¨‹ä¸­æœ€å¸¸è§çš„ I&#x2F;O äº‹ä»¶ç±»å‹ï¼š\ngraph TD    A[ç½‘ç»œI/Oäº‹ä»¶] --&gt; B[å¯è¯»äº‹ä»¶]    A --&gt; C[å¯å†™äº‹ä»¶]    A --&gt; D[é”™è¯¯äº‹ä»¶]    A --&gt; E[æŒ‚èµ·äº‹ä»¶]    B --&gt; B1[æ•°æ®åˆ°è¾¾]    B --&gt; B2[æ–°è¿æ¥è¯·æ±‚]    B --&gt; B3[å¯¹ç«¯å…³é—­]    C --&gt; C1[ç¼“å†²åŒºæœ‰ç©ºé—´]    C --&gt; C2[è¿æ¥å»ºç«‹å®Œæˆ]    D --&gt; D1[è¿æ¥å¼‚å¸¸]    D --&gt; D2[åè®®é”™è¯¯]    E --&gt; E1[å¯¹ç«¯ä¸»åŠ¨å…³é—­]    E --&gt; E2[è¿æ¥æ–­å¼€]\n\nå¯è¯»äº‹ä»¶ï¼ˆRead Eventï¼‰\nå®šä¹‰: æ•°æ®åˆ°è¾¾ï¼Œå¯ä»¥è¯»å–\nåœºæ™¯:\næ¥æ”¶åˆ°ç½‘ç»œæ•°æ®\næ–°çš„è¿æ¥è¯·æ±‚ï¼ˆç›‘å¬å¥—æ¥å­—ï¼‰\nå¯¹ç«¯å…³é—­è¿æ¥ï¼ˆè¯»å–è¿”å›0ï¼‰\n\n\n\nå¯å†™äº‹ä»¶ï¼ˆWrite Eventï¼‰\nå®šä¹‰: ç¼“å†²åŒºæœ‰ç©ºé—´ï¼Œå¯ä»¥å†™å…¥æ•°æ®\nåœºæ™¯:\nå‘é€ç¼“å†²åŒºæœ‰ç©ºé—´\néé˜»å¡è¿æ¥å»ºç«‹å®Œæˆ\n\n\n\né”™è¯¯äº‹ä»¶ï¼ˆError Eventï¼‰\nå®šä¹‰: è¿æ¥å‡ºç°é”™è¯¯\nåœºæ™¯:\nç½‘ç»œè¿æ¥å¼‚å¸¸\nåè®®é”™è¯¯\nèµ„æºä¸è¶³\n\n\n\næŒ‚èµ·äº‹ä»¶ï¼ˆHangup Eventï¼‰\nå®šä¹‰: è¿æ¥è¢«å¯¹ç«¯å…³é—­\nåœºæ™¯:\nå¯¹ç«¯ä¸»åŠ¨å…³é—­è¿æ¥\nè¿æ¥æ–­å¼€\n\n\n\n2.2 ğŸ“ æ–‡ä»¶I&#x2F;Oäº‹ä»¶graph LR    A[æ–‡ä»¶I/Oäº‹ä»¶] --&gt; B[è¯»å†™äº‹ä»¶]    A --&gt; C[çŠ¶æ€å˜åŒ–]    B --&gt; B1[æ–‡ä»¶å¯è¯»]    B --&gt; B2[æ–‡ä»¶å¯å†™]    C --&gt; C1[æ–‡ä»¶ä¿®æ”¹]    C --&gt; C2[æ–‡ä»¶åˆ é™¤]    C --&gt; C3[æƒé™å˜åŒ–]\n\nè¯»å†™äº‹ä»¶\næ–‡ä»¶å¯è¯»: æ–‡ä»¶æè¿°ç¬¦å¯ä»¥è¿›è¡Œè¯»æ“ä½œ\næ–‡ä»¶å¯å†™: æ–‡ä»¶æè¿°ç¬¦å¯ä»¥è¿›è¡Œå†™æ“ä½œ\n\nçŠ¶æ€å˜åŒ–äº‹ä»¶\næ–‡ä»¶ä¿®æ”¹: æ–‡ä»¶å†…å®¹è¢«ä¿®æ”¹\næ–‡ä»¶åˆ é™¤: æ–‡ä»¶è¢«åˆ é™¤\næƒé™å˜åŒ–: æ–‡ä»¶æƒé™æˆ–æ‰€æœ‰è€…æ”¹å˜\n\n2.3 ğŸ”Œ è®¾å¤‡I&#x2F;Oäº‹ä»¶graph TD    A[è®¾å¤‡I/Oäº‹ä»¶] --&gt; B[ç»ˆç«¯äº‹ä»¶]    A --&gt; C[ä¸²å£äº‹ä»¶]    A --&gt; D[ç¡¬ä»¶è®¾å¤‡äº‹ä»¶]    B --&gt; B1[é”®ç›˜è¾“å…¥]    B --&gt; B2[é¼ æ ‡äº‹ä»¶]    C --&gt; C1[ä¸²å£æ•°æ®åˆ°è¾¾]    C --&gt; C2[ä¸²å£å¯å‘é€]    D --&gt; D1[USBè®¾å¤‡æ’æ‹”]    D --&gt; D2[ç¡¬ä»¶çŠ¶æ€å˜åŒ–]\n\n2.4 â° å®šæ—¶å™¨äº‹ä»¶graph LR    A[å®šæ—¶å™¨äº‹ä»¶] --&gt; B[è¶…æ—¶äº‹ä»¶]    B --&gt; B1[å•æ¬¡å®šæ—¶å™¨]    B --&gt; B2[å‘¨æœŸæ€§å®šæ—¶å™¨]    B --&gt; B3[ç›¸å¯¹å®šæ—¶å™¨]    B --&gt; B4[ç»å¯¹å®šæ—¶å™¨]\n\n2.5 ğŸ“¢ ä¿¡å·äº‹ä»¶graph TD    A[ä¿¡å·äº‹ä»¶] --&gt; B[ç³»ç»Ÿä¿¡å·]    A --&gt; C[ç”¨æˆ·è‡ªå®šä¹‰ä¿¡å·]    B --&gt; B1[SIGTERM]    B --&gt; B2[SIGINT]    B --&gt; B3[SIGKILL]    B --&gt; B4[SIGUSR1]    B --&gt; B5[SIGUSR2]\n\n\n3. ğŸŒ ç½‘ç»œç¼–ç¨‹ä¸­çš„I&#x2F;Oäº‹ä»¶3.1 ğŸ“‹ äº‹ä»¶ç±»å‹è¯¦è§£1. å¯è¯»äº‹ä»¶ï¼ˆPOLLIN&#x2F;POLLPRIï¼‰// ä½¿ç”¨ poll ç›‘å¬å¯è¯»äº‹ä»¶struct pollfd fds[1];fds[0].fd = sockfd;fds[0].events = POLLIN;  // ç›‘å¬å¯è¯»äº‹ä»¶int ret = poll(fds, 1, timeout);if (fds[0].revents &amp; POLLIN) &#123;    // å¤„ç†å¯è¯»äº‹ä»¶    handle_read_event(sockfd);&#125;\n\nè¡¨ç¤ºçš„æƒ…å†µ:\n\nâœ… æœ‰æ–°æ•°æ®åˆ°è¾¾ï¼Œå¯ä»¥è¯»å–\nâœ… æ–°çš„è¿æ¥è¯·æ±‚åˆ°è¾¾ï¼ˆå¯¹äºç›‘å¬å¥—æ¥å­—ï¼‰\nâœ… å¯¹ç«¯å…³é—­è¿æ¥ï¼ˆè¯»å–æ—¶ä¼šè¿”å›0ï¼‰\n\n2. å¯å†™äº‹ä»¶ï¼ˆPOLLOUTï¼‰// ç›‘å¬å¯å†™äº‹ä»¶struct pollfd fds[1];fds[0].fd = sockfd;fds[0].events = POLLOUT;  // ç›‘å¬å¯å†™äº‹ä»¶int ret = poll(fds, 1, timeout);if (fds[0].revents &amp; POLLOUT) &#123;    // å¤„ç†å¯å†™äº‹ä»¶    handle_write_event(sockfd);&#125;\n\nè¡¨ç¤ºçš„æƒ…å†µ:\n\nâœ… å‘é€ç¼“å†²åŒºæœ‰ç©ºé—´\nâœ… è¿æ¥å»ºç«‹å®Œæˆï¼ˆå¯¹äºéé˜»å¡è¿æ¥ï¼‰\n\n3. é”™è¯¯äº‹ä»¶ï¼ˆPOLLERRï¼‰// æ£€æŸ¥é”™è¯¯äº‹ä»¶if (fds[0].revents &amp; POLLERR) &#123;    // å¤„ç†é”™è¯¯äº‹ä»¶    handle_error_event(sockfd);&#125;\n\nè¡¨ç¤ºçš„æƒ…å†µ:\n\nâŒ è¿æ¥å¼‚å¸¸\nâŒ åè®®é”™è¯¯\nâŒ ç½‘ç»œä¸å¯è¾¾\n\n4. æŒ‚èµ·äº‹ä»¶ï¼ˆPOLLHUPï¼‰// æ£€æŸ¥æŒ‚èµ·äº‹ä»¶if (fds[0].revents &amp; POLLHUP) &#123;    // å¤„ç†è¿æ¥å…³é—­    handle_hangup_event(sockfd);&#125;\n\nè¡¨ç¤ºçš„æƒ…å†µ:\n\nâš ï¸ å¯¹ç«¯ä¸»åŠ¨å…³é—­è¿æ¥\nâš ï¸ è¿æ¥æ–­å¼€\n\n5. æ— æ•ˆäº‹ä»¶ï¼ˆPOLLNVALï¼‰// æ£€æŸ¥æ— æ•ˆäº‹ä»¶if (fds[0].revents &amp; POLLNVAL) &#123;    // å¤„ç†æ— æ•ˆæ–‡ä»¶æè¿°ç¬¦    handle_invalid_event(sockfd);&#125;\n\nè¡¨ç¤ºçš„æƒ…å†µ:\n\nâŒ æ–‡ä»¶æè¿°ç¬¦æœªæ‰“å¼€æˆ–å·²å…³é—­\n\n3.2 ğŸ”„ äº‹ä»¶å¤„ç†æµç¨‹sequenceDiagram    participant App as åº”ç”¨ç¨‹åº    participant Kernel as å†…æ ¸    participant Network as ç½‘ç»œ    App-&gt;&gt;Kernel: poll/epoll_wait    Kernel-&gt;&gt;Network: ç›‘å¬äº‹ä»¶    Network-&gt;&gt;Kernel: äº‹ä»¶å‘ç”Ÿ    Kernel-&gt;&gt;App: è¿”å›å°±ç»ªäº‹ä»¶    App-&gt;&gt;App: å¤„ç†äº‹ä»¶    App-&gt;&gt;Kernel: ç»§ç»­ç›‘å¬\n\n\n4. ğŸ’¡ äº‹ä»¶å¤„ç†æœ€ä½³å®è·µ4.1 ğŸ¯ äº‹ä»¶å¤„ç†ç­–ç•¥// äº‹ä»¶å¤„ç†çš„æœ€ä½³å®è·µç¤ºä¾‹void handle_events(struct pollfd *fds, int nfds) &#123;    for (int i = 0; i &lt; nfds; i++) &#123;        int fd = fds[i].fd;        short revents = fds[i].revents;        if (revents == 0) continue;  // æ— äº‹ä»¶        // ä¼˜å…ˆå¤„ç†é”™è¯¯å’ŒæŒ‚èµ·äº‹ä»¶        if (revents &amp; POLLNVAL) &#123;            close(fd);            continue;        &#125;        if (revents &amp; POLLERR) &#123;            handle_socket_error(fd);            continue;        &#125;        if (revents &amp; POLLHUP) &#123;            handle_socket_hangup(fd);            continue;        &#125;        // å¤„ç†å¯è¯»äº‹ä»¶        if (revents &amp; POLLIN) &#123;            handle_read_event(fd);        &#125;        // å¤„ç†å¯å†™äº‹ä»¶        if (revents &amp; POLLOUT) &#123;            handle_write_event(fd);        &#125;        // å¤„ç†ç´§æ€¥æ•°æ®        if (revents &amp; POLLPRI) &#123;            handle_urgent_data(fd);        &#125;    &#125;&#125;\n\n4.2 âš ï¸ æ³¨æ„äº‹é¡¹\näº‹ä»¶ä¼˜å…ˆçº§: é”™è¯¯äº‹ä»¶ &gt; æŒ‚èµ·äº‹ä»¶ &gt; è¯»å†™äº‹ä»¶\nè¾¹ç¼˜è§¦å‘: ä½¿ç”¨ ET æ¨¡å¼æ—¶è¦ç¡®ä¿å¤„ç†å®Œæ‰€æœ‰æ•°æ®\nèµ„æºç®¡ç†: åŠæ—¶å…³é—­æ— æ•ˆçš„æ–‡ä»¶æè¿°ç¬¦\næ€§èƒ½ä¼˜åŒ–: é¿å…ä¸å¿…è¦çš„äº‹ä»¶ç›‘å¬\n\n4.3 ğŸ”§ å¸¸è§é—®é¢˜è§£å†³\n\n\né—®é¢˜\nåŸå› \nè§£å†³æ–¹æ¡ˆ\n\n\n\nCPUå ç”¨è¿‡é«˜\nå¿™ç­‰å¾…æˆ–äº‹ä»¶å¤„ç†ä¸å½“\nä½¿ç”¨é˜»å¡I&#x2F;Oæˆ–ä¼˜åŒ–äº‹ä»¶å¾ªç¯\n\n\näº‹ä»¶ä¸¢å¤±\nè¾¹ç¼˜è§¦å‘æ¨¡å¼å¤„ç†ä¸å®Œæ•´\nä½¿ç”¨æ°´å¹³è§¦å‘æˆ–ç¡®ä¿æ•°æ®è¯»å®Œ\n\n\nè¿æ¥æ³„æ¼\né”™è¯¯äº‹ä»¶å¤„ç†ä¸å½“\nåŠæ—¶æ¸…ç†å’Œå…³é—­è¿æ¥\n\n\n\nğŸ“Š æ€»ç»“âœ… æ ¸å¿ƒè¦ç‚¹\nI&#x2F;Oäº‹ä»¶åˆ†ç±»: ç½‘ç»œã€æ–‡ä»¶ã€è®¾å¤‡ã€å®šæ—¶å™¨ã€ä¿¡å·\nç½‘ç»œäº‹ä»¶å¤„ç†: å¯è¯»ã€å¯å†™ã€é”™è¯¯ã€æŒ‚èµ·ã€æ— æ•ˆ\næœ€ä½³å®è·µ: äº‹ä»¶ä¼˜å…ˆçº§ã€èµ„æºç®¡ç†ã€æ€§èƒ½ä¼˜åŒ–\n\nğŸ¯ å®é™…åº”ç”¨\nWebæœåŠ¡å™¨: å¤„ç†HTTPè¯·æ±‚å’Œå“åº”\nä»£ç†æœåŠ¡å™¨: è½¬å‘å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ•°æ®\nèŠå¤©åº”ç”¨: å®æ—¶æ¶ˆæ¯ä¼ è¾“\næ–‡ä»¶ç›‘æ§: ç›‘æ§æ–‡ä»¶ç³»ç»Ÿå˜åŒ–\n\nğŸ“š æ‰©å±•å­¦ä¹ \nLinux I&#x2F;O å¤šè·¯å¤ç”¨\nepoll ç¼–ç¨‹æŒ‡å—\né«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹\n\n\n\nğŸ’¡ æç¤º: åœ¨å®é™…å¼€å‘ä¸­ï¼Œå»ºè®®ä½¿ç”¨æˆç†Ÿçš„ç½‘ç»œåº“ï¼ˆå¦‚ libeventã€libuvï¼‰æ¥å¤„ç†å¤æ‚çš„äº‹ä»¶ç®¡ç†ï¼Œè¿™äº›åº“å·²ç»å¤„ç†äº†å¤§éƒ¨åˆ†è¾¹ç•Œæƒ…å†µå’Œä¼˜åŒ–ã€‚\n\n","categories":["ç³»ç»Ÿçº§ç¼–ç¨‹"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Git å¸¸ç”¨å‘½ä»¤å¤§å…¨ï¼šä»å…¥é—¨åˆ°ç²¾é€šçš„ç‰ˆæœ¬æ§åˆ¶å®æˆ˜æŒ‡å—","url":"/posts/bae20393/","content":"Git å¸¸ç”¨å‘½ä»¤æŒ‡å—ç›®å½•\nä»“åº“ç®¡ç†\nä»£ç æäº¤\nåˆ†æ”¯ç®¡ç†\nè¿œç¨‹æ“ä½œ\næ–‡ä»¶&#x2F;ç›®å½•æ“ä½œ\nå†å²æŸ¥çœ‹\næ’¤é”€ä¸ä¿®æ”¹\næ ‡ç­¾ç®¡ç†\nå‚¨è—å·¥ä½œ\nå­æ¨¡å—ç®¡ç†\n\nä»“åº“ç®¡ç†å…‹éš†ä»“åº“# å…‹éš†åŒ…å«å­æ¨¡å—çš„ä»“åº“git clone --recurse-submodules [url] [directory]\n\nåˆå§‹åŒ–æœ¬åœ°ä»“åº“# åœ¨å½“å‰ç›®å½•åˆå§‹åŒ–ä¸€ä¸ªæ–°ä»“åº“git init\n\nä»£ç æäº¤æŸ¥çœ‹æ›´æ”¹çŠ¶æ€# æŸ¥çœ‹å·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„æ›´æ”¹çŠ¶æ€git status# æŸ¥çœ‹ç®€æ´çš„çŠ¶æ€ä¿¡æ¯git status -s# æŸ¥çœ‹æ–‡ä»¶çš„å…·ä½“æ›´æ”¹å†…å®¹git diff\n\næš‚å­˜æ›´æ”¹# æ·»åŠ æ‰€æœ‰æ›´æ”¹åˆ°æš‚å­˜åŒºgit add .# æ·»åŠ ç‰¹å®šæ–‡ä»¶åˆ°æš‚å­˜åŒºgit add &lt;file&gt;# äº¤äº’å¼æš‚å­˜æ–‡ä»¶çš„éƒ¨åˆ†æ›´æ”¹git add -p &lt;file&gt;\n\næäº¤æ›´æ”¹# æäº¤åˆ°æœ¬åœ°ä»“åº“git commit -m &quot;Your commit message&quot;# æäº¤å¹¶æš‚å­˜æ‰€æœ‰å·²è·Ÿè¸ªæ–‡ä»¶çš„æ›´æ”¹git commit -am &quot;Your commit message&quot;# æŸ¥çœ‹å³å°†æäº¤çš„æ›´æ”¹ï¼ˆé¢„è§ˆï¼‰git commit --dry-run\n\nåˆ†æ”¯ç®¡ç†æŸ¥çœ‹åˆ†æ”¯# åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯git branch# åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯git branch -r# åˆ—å‡ºæ‰€æœ‰æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯git branch -a\n\nåˆ›å»ºä¸åˆ‡æ¢åˆ†æ”¯# åˆ›å»ºæ–°åˆ†æ”¯git branch [branch-name]# åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯git checkout [branch-name]# æˆ–è€…ä½¿ç”¨æ›´ç°ä»£çš„ switch å‘½ä»¤git switch [branch-name]# åˆ›å»ºå¹¶ç«‹å³åˆ‡æ¢åˆ°æ–°åˆ†æ”¯git checkout -b [new-branch-name]# æˆ–è€…ä½¿ç”¨æ›´ç°ä»£çš„ switch å‘½ä»¤git switch -c [new-branch-name]\n\nåˆå¹¶ä¸åˆ é™¤åˆ†æ”¯# å°†æŒ‡å®šåˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯git merge [branch-name]# åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼ˆéœ€å…ˆåˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯ï¼‰git branch -d [branch-name]\n\nè¿œç¨‹æ“ä½œå…³è”è¿œç¨‹ä»“åº“# æ·»åŠ è¿œç¨‹ä»“åº“å¹¶å‘½åä¸º origin# æ³¨æ„ï¼šæ–°ä»“åº“çš„é»˜è®¤åˆ†æ”¯å¯èƒ½ä¸º main è€Œä¸æ˜¯ mastergit remote add origin https://github.com/ç”¨æˆ·å/ä»“åº“å.git# æ¨é€æœ¬åœ°æäº¤åˆ°è¿œç¨‹ä»“åº“ï¼Œå¹¶å»ºç«‹ä¸Šæ¸¸è·Ÿè¸ªå…³ç³»git push -u origin main\n\næ‹‰å–è¿œç¨‹ä»£ç # ä»è¿œç¨‹æ‹‰å–æœ€æ–°ä»£ç å¹¶ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶git pull [remote] [branch]# ä»è¿œç¨‹æ‹‰å–æœ€æ–°ä»£ç å¹¶å°è¯•å°†æœ¬åœ°ä¿®æ”¹å˜åŸºåˆ°å…¶ä¹‹ä¸Šgit pull --rebase [remote] [branch]\n\næ¨é€åˆ°è¿œç¨‹ä»“åº“# æ¨é€å½“å‰åˆ†æ”¯çš„æäº¤git push [remote] [branch]# æ¨é€æ‰€æœ‰æœ¬åœ°æ ‡ç­¾git push [remote] --tags# åˆ é™¤è¿œç¨‹åˆ†æ”¯git push [remote] --delete [branch]# å¼ºåˆ¶æ¨é€ï¼ˆé«˜é£é™©æ“ä½œï¼‰# è­¦å‘Šï¼šè¿™ä¼šè¦†ç›–è¿œç¨‹å†å²è®°å½•ï¼Œå¯èƒ½å¯¼è‡´å›¢é˜Ÿæˆå‘˜ä¸¢å¤±æäº¤ã€‚è¯·ä»…åœ¨ç¡®çŸ¥åæœæ—¶ä½¿ç”¨ã€‚git push [remote] [branch] --force\n\næ–‡ä»¶&#x2F;ç›®å½•æ“ä½œé‡å‘½åæˆ–ç§»åŠ¨æ–‡ä»¶&#x2F;ç›®å½•# git mv å‘½ä»¤ä¼šåŒæ—¶æ›´æ–° Git çš„è·Ÿè¸ªè®°å½•git mv &lt;old-path&gt; &lt;new-path&gt;\n\nå†å²æŸ¥çœ‹æŸ¥çœ‹æäº¤å†å²# æŸ¥çœ‹è¯¦ç»†å†å²è®°å½•git log# ä»¥å•è¡Œã€å›¾å½¢åŒ–æ–¹å¼æ˜¾ç¤ºå†å²è®°å½•git log --oneline --graph --decorate# æŸ¥çœ‹ç‰¹å®šæ–‡ä»¶çš„ä¿®æ”¹å†å²git log --follow &lt;file&gt;\n\næ’¤é”€ä¸ä¿®æ”¹ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤# å¦‚æœè¿˜æœªæ¨é€åˆ°è¿œç¨‹ï¼Œå¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤æ¥ä¿®æ”¹æœ€åä¸€æ¬¡çš„æäº¤ä¿¡æ¯æˆ–å†…å®¹git commit --amend\n\næ’¤é”€æœ¬åœ°æ›´æ”¹# æ’¤é”€å·¥ä½œåŒºä¸­å¯¹æŸä¸ªæ–‡ä»¶çš„æ›´æ”¹ï¼ˆæ¢å¤åˆ°æš‚å­˜åŒºç‰ˆæœ¬ï¼‰git restore &lt;file&gt;# å°†æ–‡ä»¶ä»æš‚å­˜åŒºç§»å›å·¥ä½œåŒºï¼ˆä¸æ”¹å˜æ–‡ä»¶å†…å®¹ï¼‰git restore --staged &lt;file&gt;# æ’¤é”€å·¥ä½œåŒºä¸­æ‰€æœ‰æ–‡ä»¶çš„æ›´æ”¹git restore .# æ¢å¤æ–‡ä»¶åˆ°æŒ‡å®šæäº¤git restore --source=&lt;commit&gt; &lt;file&gt;\n\nä¿®æ”¹å†å²æäº¤# äº¤äº’å¼å˜åŸºï¼Œå¯ä»¥ä¿®æ”¹ã€åˆå¹¶æˆ–åˆ é™¤æœ€è¿‘çš„Næ¬¡æäº¤ï¼ˆé«˜é£é™©æ“ä½œï¼‰# è­¦å‘Šï¼šä¸è¦åœ¨å·²ç»æ¨é€åˆ°å…¬å…±ä»“åº“çš„åˆ†æ”¯ä¸Šæ‰§è¡Œæ­¤æ“ä½œã€‚git rebase -i HEAD~3\n\næ ‡ç­¾ç®¡ç†åˆ›å»ºæ ‡ç­¾# åˆ›å»ºè½»é‡æ ‡ç­¾git tag &lt;tag-name&gt;# åˆ›å»ºå¸¦æ³¨é‡Šçš„æ ‡ç­¾git tag -a &lt;tag-name&gt; -m &quot;Tag message&quot;# ä¸ºç‰¹å®šæäº¤åˆ›å»ºæ ‡ç­¾git tag &lt;tag-name&gt; &lt;commit-hash&gt;\n\næŸ¥çœ‹æ ‡ç­¾# åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾git tag# æŸ¥çœ‹æ ‡ç­¾è¯¦ç»†ä¿¡æ¯git show &lt;tag-name&gt;# æœç´¢ç‰¹å®šæ¨¡å¼çš„æ ‡ç­¾git tag -l &quot;v*&quot;\n\næ¨é€æ ‡ç­¾# æ¨é€å•ä¸ªæ ‡ç­¾åˆ°è¿œç¨‹git push origin &lt;tag-name&gt;# æ¨é€æ‰€æœ‰æ ‡ç­¾åˆ°è¿œç¨‹git push origin --tags# æ¨é€æ ‡ç­¾å¹¶è®¾ç½®è·Ÿè¸ªgit push --follow-tags\n\nåˆ é™¤æ ‡ç­¾# åˆ é™¤æœ¬åœ°æ ‡ç­¾git tag -d &lt;tag-name&gt;# åˆ é™¤è¿œç¨‹æ ‡ç­¾git push origin --delete &lt;tag-name&gt;\n\nå‚¨è—å·¥ä½œå‚¨è—å½“å‰å·¥ä½œ# å‚¨è—å½“å‰å·¥ä½œåŒºçš„æ›´æ”¹git stash# å‚¨è—å¹¶æ·»åŠ æ¶ˆæ¯git stash save &quot;Your stash message&quot;# å‚¨è—åŒ…æ‹¬æœªè·Ÿè¸ªçš„æ–‡ä»¶git stash -u\n\næŸ¥çœ‹å’Œåº”ç”¨å‚¨è—# æŸ¥çœ‹å‚¨è—åˆ—è¡¨git stash list# åº”ç”¨æœ€æ–°çš„å‚¨è—git stash apply# åº”ç”¨å¹¶åˆ é™¤æœ€æ–°çš„å‚¨è—git stash pop# åº”ç”¨ç‰¹å®šå‚¨è—git stash apply stash@&#123;0&#125;\n\nå­æ¨¡å—ç®¡ç†æ·»åŠ å­æ¨¡å—# æ·»åŠ å­æ¨¡å—åˆ°ä»“åº“git submodule add &lt;repository-url&gt; [path]# å…‹éš†åŒ…å«å­æ¨¡å—çš„ä»“åº“git clone --recurse-submodules &lt;repository-url&gt;\n\næ›´æ–°å­æ¨¡å—# åˆå§‹åŒ–å¹¶æ›´æ–°æ‰€æœ‰å­æ¨¡å—git submodule update --init --recursive# æ‹‰å–å­æ¨¡å—çš„æœ€æ–°æ›´æ”¹git submodule update --remote# è¿›å…¥å­æ¨¡å—ç›®å½•å¹¶æ‹‰å–æœ€æ–°æ›´æ”¹cd &lt;submodule-path&gt; &amp;&amp; git pull origin main\n","categories":["å¼€å‘å·¥å…·ä¸æµç¨‹","ç‰ˆæœ¬æ§åˆ¶"],"tags":["Git","ç‰ˆæœ¬æ§åˆ¶","å¼€å‘å·¥å…·"]},{"title":"Qt æ€§èƒ½ä¼˜åŒ–æŒ‡å—","url":"/posts/eebf2140/","content":"Qt æ€§èƒ½ä¼˜åŒ–æŒ‡å—æ¦‚è¿°Qtåº”ç”¨æ€§èƒ½ä¼˜åŒ–æ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„å…³é”®å› ç´ ã€‚æœ¬æ–‡ä»‹ç»å¤šç§Qtæ€§èƒ½ä¼˜åŒ–æŠ€æœ¯å’Œæœ€ä½³å®è·µã€‚\nå†…å­˜ç®¡ç†ä¼˜åŒ–æ™ºèƒ½æŒ‡é’ˆä½¿ç”¨// ä½¿ç”¨QSharedPointerè¿›è¡Œå…±äº«èµ„æºç®¡ç†#include &lt;QSharedPointer&gt;class ResourceManager &#123;public:    static QSharedPointer&lt;ResourceManager&gt; instance() &#123;        static QSharedPointer&lt;ResourceManager&gt; ptr(new ResourceManager());        return ptr;    &#125;private:    ResourceManager() = default;&#125;;// ä½¿ç”¨QWeakPointeré¿å…å¾ªç¯å¼•ç”¨class Controller : public QObject &#123;    Q_OBJECTpublic:    void setView(QSharedPointer&lt;View&gt; view) &#123;        m_view = view;        m_weakView = view.toWeakRef();    &#125;private:    QSharedPointer&lt;View&gt; m_view;    QWeakPointer&lt;View&gt; m_weakView;&#125;;\n\nå¯¹è±¡æ± æ¨¡å¼class ObjectPool &#123;public:    template&lt;typename T, typename... Args&gt;    std::unique_ptr&lt;T&gt; acquire(Args&amp;&amp;... args) &#123;        if (m_pool.empty()) &#123;            return std::make_unique&lt;T&gt;(std::forward&lt;Args&gt;(args)...);        &#125;        auto obj = std::move(m_pool.back());        m_pool.pop_back();        return std::unique_ptr&lt;T&gt;(static_cast&lt;T*&gt;(obj.release()));    &#125;    template&lt;typename T&gt;    void release(std::unique_ptr&lt;T&gt; obj) &#123;        if (obj) &#123;            obj-&gt;reset(); // é‡ç½®å¯¹è±¡çŠ¶æ€            m_pool.emplace_back(std::move(obj));        &#125;    &#125;private:    std::vector&lt;std::unique_ptr&lt;void&gt;&gt; m_pool;&#125;;\n\næ¸²æŸ“æ€§èƒ½ä¼˜åŒ–ç»˜åˆ¶ä¼˜åŒ–class OptimizedWidget : public QWidget &#123;public:    void paintEvent(QPaintEvent* event) override &#123;        QPainter painter(this);        // ä½¿ç”¨æŠ—é”¯é½¿        painter.setRenderHint(QPainter::Antialiasing);        // åªç»˜åˆ¶éœ€è¦æ›´æ–°çš„åŒºåŸŸ        QRect updateRect = event-&gt;rect();        // ä½¿ç”¨ç¼“å­˜        if (m_cache.isNull() || m_cache.size() != size()) &#123;            updateCache();        &#125;        painter.drawPixmap(updateRect, m_cache, updateRect);    &#125;private:    void updateCache() &#123;        m_cache = QPixmap(size());        m_cache.fill(Qt::transparent);        QPainter painter(&amp;m_cache);        painter.setRenderHint(QPainter::Antialiasing);        // æ‰§è¡Œå¤æ‚çš„ç»˜åˆ¶æ“ä½œ        drawComplexContent(&amp;painter);    &#125;    QPixmap m_cache;&#125;;\n\nOpenGLåŠ é€Ÿclass OpenGLWidget : public QOpenGLWidget &#123;protected:    void initializeGL() override &#123;        initializeOpenGLFunctions();        // å¯ç”¨æ·±åº¦æµ‹è¯•        glEnable(GL_DEPTH_TEST);        // åˆ›å»ºç€è‰²å™¨ç¨‹åº        m_shaderProgram.addShaderFromSourceCode(            QOpenGLShader::Vertex,            R&quot;(#version 330 core               layout(location = 0) in vec3 position;               uniform mat4 mvpMatrix;               void main() &#123;                   gl_Position = mvpMatrix * vec4(position, 1.0);               &#125;)&quot;        );        m_shaderProgram.link();    &#125;    void paintGL() override &#123;        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);        m_shaderProgram.bind();        // ç»˜åˆ¶OpenGLå†…å®¹    &#125;private:    QOpenGLShaderProgram m_shaderProgram;&#125;;\n\nå¤šçº¿ç¨‹ä¼˜åŒ–åå°å¤„ç†class BackgroundProcessor : public QObject &#123;    Q_OBJECTpublic:    explicit BackgroundProcessor(QObject* parent = nullptr)        : QObject(parent) &#123;        // åˆ›å»ºå·¥ä½œçº¿ç¨‹        m_workerThread = new QThread(this);        m_worker = new Worker();        m_worker-&gt;moveToThread(m_workerThread);        connect(this, &amp;BackgroundProcessor::processData,                m_worker, &amp;Worker::process);        connect(m_worker, &amp;Worker::finished,                this, &amp;BackgroundProcessor::onFinished);        m_workerThread-&gt;start();    &#125;    void processDataAsync(const QByteArray&amp; data) &#123;        emit processData(data);    &#125;signals:    void processData(const QByteArray&amp; data);private slots:    void onFinished(const QByteArray&amp; result) &#123;        // å¤„ç†å®Œæˆï¼Œæ›´æ–°UI        emit resultReady(result);    &#125;signals:    void resultReady(const QByteArray&amp; result);private:    QThread* m_workerThread;    Worker* m_worker;&#125;;\n\nçº¿ç¨‹æ± class ThreadPoolManager &#123;public:    ThreadPoolManager(int threadCount = QThread::idealThreadCount()) &#123;        m_threadPool.setMaxThreadCount(threadCount);    &#125;    template&lt;typename Func, typename... Args&gt;    auto run(Func&amp;&amp; func, Args&amp;&amp;... args)        -&gt; std::future&lt;decltype(func(args...))&gt; &#123;        using ReturnType = decltype(func(args...));        auto task = std::make_shared&lt;std::packaged_task&lt;ReturnType()&gt;&gt;(            std::bind(std::forward&lt;Func&gt;(func), std::forward&lt;Args&gt;(args)...)        );        std::future&lt;ReturnType&gt; result = task-&gt;get_future();        m_threadPool.start([task]() &#123;            (*task)();        &#125;);        return result;    &#125;private:    QThreadPool m_threadPool;&#125;;\n\næ•°æ®ç»“æ„ä¼˜åŒ–é«˜æ•ˆçš„æ•°æ®æ¨¡å‹class OptimizedModel : public QAbstractItemModel &#123;public:    QVariant data(const QModelIndex&amp; index, int role) const override &#123;        if (!index.isValid() || role != Qt::DisplayRole) &#123;            return QVariant();        &#125;        // ä½¿ç”¨è¡Œå·ç›´æ¥è®¿é—®ï¼Œé¿å…å¤æ‚çš„æŸ¥æ‰¾        int row = index.row();        if (row &gt;= 0 &amp;&amp; row &lt; m_data.size()) &#123;            return m_data[row];        &#125;        return QVariant();    &#125;    // æ‰¹é‡æ›´æ–°ä¼˜åŒ–    void updateData(const QList&lt;QString&gt;&amp; newData) &#123;        beginResetModel();        m_data = newData;        endResetModel();    &#125;private:    QList&lt;QString&gt; m_data; // ä½¿ç”¨QListè€ŒéQMapï¼Œæé«˜è®¿é—®é€Ÿåº¦&#125;;\n\nç¼“å­˜ç­–ç•¥class DataCache &#123;public:    template&lt;typename Key, typename Value&gt;    class LRUCache &#123;    public:        LRUCache(size_t capacity) : m_capacity(capacity) &#123;&#125;        Value get(const Key&amp; key) &#123;            auto it = m_cache.find(key);            if (it != m_cache.end()) &#123;                // ç§»åŠ¨åˆ°å‰é¢                m_usage.splice(m_usage.begin(), m_usage, it-&gt;second.second);                return it-&gt;second.first;            &#125;            return Value();        &#125;        void put(const Key&amp; key, const Value&amp; value) &#123;            auto it = m_cache.find(key);            if (it != m_cache.end()) &#123;                // æ›´æ–°ç°æœ‰é¡¹                it-&gt;second.first = value;                m_usage.splice(m_usage.begin(), m_usage, it-&gt;second.second);            &#125; else &#123;                // æ·»åŠ æ–°é¡¹                if (m_cache.size() &gt;= m_capacity) &#123;                    // ç§»é™¤æœ€ä¹…æœªä½¿ç”¨çš„é¡¹                    auto last = m_usage.back();                    m_cache.erase(last);                    m_usage.pop_back();                &#125;                m_usage.push_front(key);                m_cache[key] = &#123;value, m_usage.begin()&#125;;            &#125;        &#125;    private:        size_t m_capacity;        std::unordered_map&lt;Key, std::pair&lt;Value, std::list&lt;Key&gt;::iterator&gt;&gt; m_cache;        std::list&lt;Key&gt; m_usage;    &#125;;&#125;;\n\nç½‘ç»œä¼˜åŒ–å¼‚æ­¥ç½‘ç»œè¯·æ±‚class NetworkManager : public QObject &#123;    Q_OBJECTpublic:    NetworkManager(QObject* parent = nullptr) : QObject(parent) &#123;        m_manager.setRedirectPolicy(QNetworkRequest::NoLessSafeRedirectPolicy);    &#125;    QFuture&lt;QByteArray&gt; getAsync(const QString&amp; url) &#123;        auto promise = std::make_shared&lt;QPromise&lt;QByteArray&gt;&gt;();        auto future = promise-&gt;future();        QNetworkRequest request(QUrl(url));        request.setAttribute(QNetworkRequest::CacheLoadControlAttribute,                           QNetworkRequest::PreferCache);        QNetworkReply* reply = m_manager.get(request);        connect(reply, &amp;QNetworkReply::finished, [=]() &#123;            if (reply-&gt;error() == QNetworkReply::NoError) &#123;                promise-&gt;addResult(reply-&gt;readAll());            &#125; else &#123;                promise-&gt;setException(std::make_exception_ptr(                    std::runtime_error(reply-&gt;errorString().toStdString())));            &#125;            reply-&gt;deleteLater();        &#125;);        return future;    &#125;private:    QNetworkAccessManager m_manager;&#125;;\n\nè¿æ¥æ± class ConnectionPool &#123;public:    std::shared_ptr&lt;QNetworkAccessManager&gt; getConnection() &#123;        std::lock_guard&lt;std::mutex&gt; lock(m_mutex);        if (!m_connections.empty()) &#123;            auto connection = m_connections.back();            m_connections.pop_back();            return connection;        &#125;        return std::make_shared&lt;QNetworkAccessManager&gt;();    &#125;    void returnConnection(std::shared_ptr&lt;QNetworkAccessManager&gt; connection) &#123;        std::lock_guard&lt;std::mutex&gt; lock(m_mutex);        m_connections.push_back(connection);    &#125;private:    std::vector&lt;std::shared_ptr&lt;QNetworkAccessManager&gt;&gt; m_connections;    std::mutex m_mutex;&#125;;\n\næ€§èƒ½ç›‘æ§æ€§èƒ½åˆ†æå™¨class PerformanceProfiler &#123;public:    struct ProfileData &#123;        QString name;        qint64 elapsedTime;        qint64 memoryUsage;    &#125;;    static PerformanceProfiler&amp; instance() &#123;        static PerformanceProfiler profiler;        return profiler;    &#125;    void startProfile(const QString&amp; name) &#123;        m_startTimes[name] = QDateTime::currentMSecsSinceEpoch();        m_memoryUsages[name] = getCurrentMemoryUsage();    &#125;    ProfileData endProfile(const QString&amp; name) &#123;        auto startIt = m_startTimes.find(name);        if (startIt != m_startTimes.end()) &#123;            qint64 elapsedTime = QDateTime::currentMSecsSinceEpoch() - startIt-&gt;second;            qint64 memoryUsage = getCurrentMemoryUsage() - m_memoryUsages[name];            m_startTimes.erase(startIt);            m_memoryUsages.erase(name);            return &#123;name, elapsedTime, memoryUsage&#125;;        &#125;        return &#123;name, 0, 0&#125;;    &#125;private:    qint64 getCurrentMemoryUsage() &#123;        // å®ç°è·å–å½“å‰å†…å­˜ä½¿ç”¨é‡çš„é€»è¾‘        return 0;    &#125;    QHash&lt;QString, qint64&gt; m_startTimes;    QHash&lt;QString, qint64&gt; m_memoryUsages;&#125;;// RAIIæ€§èƒ½è®¡æ—¶å™¨class ScopedTimer &#123;public:    explicit ScopedTimer(const QString&amp; name) : m_name(name) &#123;        PerformanceProfiler::instance().startProfile(m_name);    &#125;    ~ScopedTimer() &#123;        auto data = PerformanceProfiler::instance().endProfile(m_name);        qDebug() &lt;&lt; &quot;Profile:&quot; &lt;&lt; data.name                 &lt;&lt; &quot;Time:&quot; &lt;&lt; data.elapsedTime &lt;&lt; &quot;ms&quot;                 &lt;&lt; &quot;Memory:&quot; &lt;&lt; data.memoryUsage &lt;&lt; &quot;bytes&quot;;    &#125;private:    QString m_name;&#125;;\n\næœ€ä½³å®è·µæ€»ç»“1. å†…å­˜ç®¡ç†\nä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆé¿å…å†…å­˜æ³„æ¼\nå®ç°å¯¹è±¡æ± å‡å°‘å†…å­˜åˆ†é…\nåŠæ—¶é‡Šæ”¾ä¸éœ€è¦çš„èµ„æº\n\n2. æ¸²æŸ“ä¼˜åŒ–\nä½¿ç”¨ç¼“å­˜å‡å°‘é‡å¤ç»˜åˆ¶\nå¯ç”¨OpenGLåŠ é€Ÿ\nåªæ›´æ–°å¿…è¦çš„åŒºåŸŸ\n\n3. å¤šçº¿ç¨‹\nå°†è€—æ—¶æ“ä½œç§»åˆ°åå°çº¿ç¨‹\nä½¿ç”¨çº¿ç¨‹æ± ç®¡ç†çº¿ç¨‹\né¿å…åœ¨UIçº¿ç¨‹æ‰§è¡Œé‡æ“ä½œ\n\n4. æ•°æ®ç»“æ„\né€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„\nä½¿ç”¨ç¼“å­˜ç­–ç•¥\næ‰¹é‡æ“ä½œè€Œéé€ä¸ªå¤„ç†\n\n5. ç½‘ç»œä¼˜åŒ–\nä½¿ç”¨å¼‚æ­¥ç½‘ç»œè¯·æ±‚\nå®ç°è¿æ¥æ± \nåˆç†ä½¿ç”¨ç¼“å­˜\n\né€šè¿‡è¿™äº›ä¼˜åŒ–æŠ€æœ¯ï¼Œå¯ä»¥æ˜¾è‘—æå‡Qtåº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt"]},{"title":"Qt æ¡†æ¶æ¦‚è¿°","url":"/posts/9b28b992/","content":"Qt æ¡†æ¶æ¦‚è¿°ğŸ“š çŸ¥è¯†åº“æ¦‚è¿°æœ¬çŸ¥è¯†åº“æä¾›äº†Qtæ¡†æ¶çš„å®Œæ•´å­¦ä¹ èµ„æºï¼Œæ¶µç›–äº†ä»åŸºç¡€å…¥é—¨åˆ°é«˜çº§åº”ç”¨çš„å…¨æ–¹ä½æŠ€æœ¯æŒ‡å—ã€‚æ‰€æœ‰æ–‡æ¡£éƒ½éµå¾ªç»Ÿä¸€çš„æ ‡å‡†ï¼ŒåŒ…å«å®Œæ•´çš„ä»£ç ç¤ºä¾‹å’Œæœ€ä½³å®è·µã€‚\nğŸ—‚ï¸ æ–‡æ¡£åˆ†ç±»ç»“æ„ğŸš€ æ ¸å¿ƒç‰¹æ€§ (Core-Features)\nQt Model-View æ¶æ„æŒ‡å—\nModel-View-Delegate æ¨¡å¼è¯¦è§£\nè‡ªå®šä¹‰ Model å’Œ Delegate\nä½¿ç”¨ ProxyModel å®ç°æ’åºå’Œè¿‡æ»¤\n\n\nQt å¤šçº¿ç¨‹ç¼–ç¨‹æŒ‡å—\nQThread çš„æ­£ç¡®ä½¿ç”¨æ¨¡å¼ (Worker-Object)\nçº¿ç¨‹åŒæ­¥ä¸ QtConcurrent å¹¶å‘æ¡†æ¶\n\n\nQt å›½é™…åŒ– (i18n) æŒ‡å—\nä½¿ç”¨ trã€lupdateã€lrelease å’Œ QTranslator çš„æ ‡å‡†å·¥ä½œæµç¨‹\nåŠ¨æ€è¯­è¨€åˆ‡æ¢ä¸ QLocale æœ¬åœ°åŒ–\n\n\nQt å•å…ƒæµ‹è¯•æŒ‡å—\nQt Test æ¡†æ¶ã€æ•°æ®é©±åŠ¨æµ‹è¯•ä¸ GUI æµ‹è¯•\næ¨¡æ‹Ÿå¯¹è±¡ (Mocking) ä¸æŒç»­é›†æˆ\n\n\n\nğŸ¨ GUIç¼–ç¨‹ (GUI)\nQPainter å®Œæ•´æŒ‡å—\n2Då›¾å½¢ç»˜åˆ¶ã€æ–‡æœ¬æ¸²æŸ“ã€å›¾åƒå¤„ç†\næ¸å˜ã€å˜æ¢ä¸é«˜çº§ç‰¹æ•ˆ\nè‡ªå®šä¹‰æ§ä»¶å¼€å‘å®ä¾‹\n\n\nQSS æ ·å¼è¡¨å®Œæ•´æŒ‡å—\nQSS è¯­æ³•ã€é€‰æ‹©å™¨ã€ç›’å­æ¨¡å‹ä¸ä¼ªçŠ¶æ€\nå­æ§ä»¶æ ·å¼åŒ–\nä¸»é¢˜åŒ–ä¸æœ€ä½³å®è·µ\n\n\n\nğŸŒ ç½‘ç»œç¼–ç¨‹ (Networking)\nQt ç½‘ç»œç¼–ç¨‹æŒ‡å—\nä½¿ç”¨ QNetworkAccessManager (HTTP), QTcpSocket, QUdpSocket, QWebSocket\nåŒ…å«æ¸…æ™°ã€ç‹¬ç«‹çš„å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ç¤ºä¾‹\n\n\nQt libcurl é›†æˆæŒ‡å— (Windows)\nä½¿ç”¨ vcpkg ç®¡ç†å’Œé›†æˆ libcurl\nåœ¨ Qt é¡¹ç›®ä¸­å°è£…å’Œä½¿ç”¨ libcurl\n\n\n\nğŸµ å¤šåª’ä½“ (Multimedia)\nQCamera æ‘„åƒå¤´å›¾åƒé‡‡é›†æŒ‡å—\nä½¿ç”¨ QCamera å’Œ QVideoWidget å®ç°æ‘„åƒå¤´é¢„è§ˆ\nä½¿ç”¨ QCameraImageCapture å®ç°æ‹ç…§åŠŸèƒ½\n\n\nQMediaPlayer éŸ³ä¹æ’­æ”¾å™¨æ•™ç¨‹\nä½¿ç”¨ QMediaPlayer å’Œ QMediaPlaylist æ„å»ºä¸€ä¸ªåŠŸèƒ½æ€§çš„éŸ³ä¹æ’­æ”¾å™¨\nå®ç°æ’­æ”¾ã€æš‚åœã€è¿›åº¦æ§åˆ¶å’Œæ’­æ”¾åˆ—è¡¨åŠŸèƒ½\n\n\nQAudioInput éŸ³é¢‘å½•åˆ¶æ•™ç¨‹\nä½¿ç”¨ QAudioInput å®ç°éŸ³é¢‘å½•åˆ¶\nWAV æ–‡ä»¶æ ¼å¼å¤„ç†\n\n\n\nğŸ—„ï¸ æ•°æ®å¤„ç† (Data)\nQt SQL æ•°æ®åº“æŒ‡å—\nä½¿ç”¨ QSqlDatabaseã€QSqlQuery å’Œ QSqlTableModel\né¢„å¤„ç†æŸ¥è¯¢ä¸äº‹åŠ¡\n\n\nQt SQLite åŠ å¯†æŒ‡å— (SQLCipher)\nç¼–è¯‘ Qt é©±åŠ¨ä»¥æ”¯æŒ SQLCipher\nåŠ å¯†æ•°æ®åº“çš„åˆ›å»ºå’Œä½¿ç”¨\n\n\n\nğŸ¯ å­¦ä¹ è·¯å¾„å»ºè®®åˆå­¦è€…è·¯å¾„\nGUI: ä» QPainter å®Œæ•´æŒ‡å— å’Œ QSS æ ·å¼è¡¨å®Œæ•´æŒ‡å— å¼€å§‹ï¼ŒæŒæ¡ç•Œé¢ç»˜åˆ¶ä¸ç¾åŒ–ã€‚\næ ¸å¿ƒç‰¹æ€§: å­¦ä¹  Qt å¤šçº¿ç¨‹ç¼–ç¨‹æŒ‡å— ä»¥å¤„ç†è€—æ—¶ä»»åŠ¡ï¼Œé¿å…ç•Œé¢å¡é¡¿ã€‚\næ•°æ®å¤„ç†: é˜…è¯» Qt SQL æ•°æ®åº“æŒ‡å— å­¦ä¹ æœ¬åœ°æ•°æ®å­˜å‚¨ã€‚\n\nä¸­çº§å¼€å‘è€…è·¯å¾„\nç½‘ç»œç¼–ç¨‹: å­¦ä¹  Qt ç½‘ç»œç¼–ç¨‹æŒ‡å— ä»¥å®ç°å®¢æˆ·ç«¯&#x2F;æœåŠ¡å™¨é€šä¿¡ã€‚\næ ¸å¿ƒç‰¹æ€§: æ·±å…¥ Qt Model-View æ¶æ„æŒ‡å— ä»¥æ„å»ºå¤æ‚çš„æ•°æ®é©±åŠ¨ç•Œé¢ã€‚\nå¤šåª’ä½“: å°è¯• QMediaPlayer éŸ³ä¹æ’­æ”¾å™¨æ•™ç¨‹ æ¥æ„å»ºå¤šåª’ä½“åº”ç”¨ã€‚\n\né«˜çº§å¼€å‘è€…è·¯å¾„\næ•°æ®å¤„ç†: å­¦ä¹  Qt SQLite åŠ å¯†æŒ‡å— (SQLCipher) äº†è§£é«˜çº§æ•°æ®å®‰å…¨æŠ€æœ¯ã€‚\næ ¸å¿ƒç‰¹æ€§: æŒæ¡ Qt å•å…ƒæµ‹è¯•æŒ‡å— å’Œ Qt å›½é™…åŒ– (i18n) æŒ‡å— ä»¥å¼€å‘ç”Ÿäº§çº§çš„ã€å…¨çƒåŒ–çš„åº”ç”¨ã€‚\nç½‘ç»œç¼–ç¨‹: äº†è§£å¦‚ä½•é›†æˆç¬¬ä¸‰æ–¹ç½‘ç»œåº“ï¼Œå¦‚ Qt libcurl é›†æˆæŒ‡å— (Windows)ã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","å­¦ä¹ è·¯å¾„"]},{"title":"QtInstallerFramework å®‰è£…åŒ…åˆ¶ä½œæŒ‡å—","url":"/posts/3097e686/","content":"QtInstallerFramework å®‰è£…åŒ…åˆ¶ä½œæŒ‡å—ç›®å½•\nå·¥å…·æ¦‚è¿°\nå®‰è£…å‡†å¤‡\né¡¹ç›®ç»“æ„\né…ç½®æ–‡ä»¶è¯¦è§£\nå®‰è£…è„šæœ¬è¯¦è§£\nç”Ÿæˆå®‰è£…åŒ…\né«˜çº§åŠŸèƒ½\nå¸¸è§é—®é¢˜\næœ€ä½³å®è·µ\n\nå·¥å…·æ¦‚è¿°QtInstallerFramework æ˜¯ Qt å®˜æ–¹æä¾›çš„è·¨å¹³å°å®‰è£…åŒ…åˆ¶ä½œå·¥å…·ï¼Œæ”¯æŒ Windowsã€macOS å’Œ Linux å¹³å°ã€‚\nç‰¹ç‚¹\nè·¨å¹³å°æ”¯æŒ\nå›¾å½¢åŒ–å®‰è£…å‘å¯¼\nå¼ºå¤§çš„ç»„ä»¶å’Œä¾èµ–ç®¡ç†\næ”¯æŒåœ¨çº¿å’Œç¦»çº¿å®‰è£…æ¨¡å¼\nå¯é€šè¿‡è„šæœ¬ï¼ˆqsï¼‰é«˜åº¦è‡ªå®šä¹‰å®‰è£…è¿‡ç¨‹\næ”¯æŒå¤šè¯­è¨€\n\nå®‰è£…å‡†å¤‡1. è·å– QtInstallerFrameworkQtInstallerFramework é€šå¸¸åŒ…å«åœ¨ Qt çš„åœ¨çº¿å®‰è£…å™¨ä¸­ï¼Œä½œä¸ºä¸€ä¸ªå¯é€‰ç»„ä»¶ã€‚ä¹Ÿå¯ä»¥ä» Qt å®˜ç½‘å•ç‹¬ä¸‹è½½ã€‚\nå®ƒçš„é»˜è®¤å®‰è£…è·¯å¾„é€šå¸¸åœ¨ Qt çš„ Tools ç›®å½•ä¸‹ï¼Œä¾‹å¦‚ï¼š&lt;Qtå®‰è£…ç›®å½•&gt;\\Tools\\QtInstallerFramework\\4.8\\binã€‚\n2. ç¯å¢ƒå˜é‡é…ç½®ä¸ºäº†æ–¹ä¾¿åœ¨ä»»ä½•è·¯å¾„ä¸‹ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼Œå»ºè®®å°† QtInstallerFramework çš„ bin ç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿçš„ PATH ç¯å¢ƒå˜é‡ä¸­ã€‚\nWindows ç¤ºä¾‹:\n# å°† &lt;Your-Qt-InstallerFramework-Path&gt; æ›¿æ¢ä¸ºä½ çš„å®é™…è·¯å¾„set PATH=%PATH%;&lt;Your-Qt-InstallerFramework-Path&gt;\\bin\n\né¡¹ç›®ç»“æ„ä¸€ä¸ªå…¸å‹çš„å®‰è£…åŒ…é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š\nYourAppInstaller/â”œâ”€â”€ config/â”‚   â””â”€â”€ config.xml          # 1. ä¸»é…ç½®æ–‡ä»¶â””â”€â”€ packages/    â””â”€â”€ com.yourcompany.yourapp/        â”œâ”€â”€ meta/        â”‚   â”œâ”€â”€ package.xml         # 2. åŒ…ï¼ˆç»„ä»¶ï¼‰é…ç½®æ–‡ä»¶        â”‚   â””â”€â”€ installscript.qs     # 3. å®‰è£…è„šæœ¬ (å¯é€‰)        â””â”€â”€ data/                    # 4. è¦å®‰è£…çš„å®é™…æ–‡ä»¶            â”œâ”€â”€ YourApp.exe            â”œâ”€â”€ Qt6Core.dll            â””â”€â”€ ...\n\né…ç½®æ–‡ä»¶è¯¦è§£1. ä¸»é…ç½®æ–‡ä»¶ (config&#x2F;config.xml)è¯¥æ–‡ä»¶å®šä¹‰äº†å®‰è£…å™¨çš„æ•´ä½“è¡Œä¸ºå’Œå¤–è§‚ã€‚\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;Installer&gt;    &lt;!-- åº”ç”¨åç§° --&gt;    &lt;Name&gt;YourApp&lt;/Name&gt;    &lt;!-- åº”ç”¨ç‰ˆæœ¬ --&gt;    &lt;Version&gt;1.0.0&lt;/Version&gt;    &lt;!-- å®‰è£…å™¨æ ‡é¢˜ --&gt;    &lt;Title&gt;YourApp Installer&lt;/Title&gt;    &lt;!-- å‘è¡Œå•† --&gt;    &lt;Publisher&gt;YourCompany&lt;/Publisher&gt;    &lt;!-- å¼€å§‹èœå•ç›®å½• --&gt;    &lt;StartMenuDir&gt;YourApp&lt;/StartMenuDir&gt;    &lt;!-- é»˜è®¤å®‰è£…è·¯å¾„, @ApplicationsDir@ æ˜¯é¢„å®šä¹‰å˜é‡ --&gt;    &lt;TargetDir&gt;@ApplicationsDir@/YourApp&lt;/TargetDir&gt;        &lt;!-- (å¯é€‰) å®‰è£…ç¨‹åºå›¾æ ‡ --&gt;    &lt;InstallerWindowIcon&gt;installer_icon.ico&lt;/InstallerWindowIcon&gt;    &lt;!-- (å¯é€‰) åº”ç”¨å›¾æ ‡ --&gt;    &lt;InstallerApplicationIcon&gt;app_icon.ico&lt;/InstallerApplicationIcon&gt;    &lt;!-- (å¯é€‰) Logoå›¾ç‰‡ --&gt;    &lt;Logo&gt;logo.png&lt;/Logo&gt;&lt;/Installer&gt;\n\n2. åŒ…é…ç½®æ–‡ä»¶ (packages&#x2F;â€¦&#x2F;meta&#x2F;package.xml)æ¯ä¸ªç»„ä»¶ï¼ˆåŒ…ï¼‰éƒ½æœ‰ä¸€ä¸ª package.xmlï¼Œç”¨äºæè¿°è¯¥ç»„ä»¶ã€‚\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;Package&gt;    &lt;!-- æ˜¾ç¤ºåç§° --&gt;    &lt;DisplayName&gt;Main Application&lt;/DisplayName&gt;    &lt;!-- ç»„ä»¶æè¿° --&gt;    &lt;Description&gt;The main application files.&lt;/Description&gt;    &lt;!-- ç»„ä»¶ç‰ˆæœ¬ --&gt;    &lt;Version&gt;1.0.0&lt;/Version&gt;    &lt;!-- å‘å¸ƒæ—¥æœŸ --&gt;    &lt;ReleaseDate&gt;2024-01-01&lt;/ReleaseDate&gt;    &lt;!-- é»˜è®¤é€‰ä¸­ --&gt;    &lt;Default&gt;true&lt;/Default&gt;    &lt;!-- å…³è”çš„å®‰è£…è„šæœ¬ --&gt;    &lt;Script&gt;installscript.qs&lt;/Script&gt;&lt;/Package&gt;\n\nå®‰è£…è„šæœ¬è¯¦è§£ (meta&#x2F;installscript.qs)å®‰è£…è„šæœ¬ä½¿ç”¨ç±» QML çš„è¯­æ³•ï¼ˆqsï¼‰ï¼Œå…è®¸ä½ å®Œå…¨è‡ªå®šä¹‰å®‰è£…å’Œå¸è½½è¿‡ç¨‹ã€‚\n// installscript.qsfunction Component() &#123;    // æ„é€ å‡½æ•°ï¼Œå¯ä»¥åœ¨æ­¤è·å–å®‰è£…å™¨æ ¸å¿ƒå¯¹è±¡&#125;// å®šä¹‰å®‰è£…æ“ä½œComponent.prototype.createOperations = function() &#123;    // å¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»çš„åŒåæ–¹æ³•    component.createOperations();    // ç¤ºä¾‹ï¼šåœ¨Windowsä¸Šåˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼    if (systemInfo.kernelType === &quot;winnt&quot;) &#123;        component.addOperation(            &quot;CreateShortcut&quot;,                               // æ“ä½œç±»å‹            &quot;@TargetDir@/YourApp.exe&quot;,                      // ç›®æ ‡æ–‡ä»¶            &quot;@DesktopDir@/YourApp.lnk&quot;,                     // å¿«æ·æ–¹å¼è·¯å¾„            &quot;workingDirectory=@TargetDir@&quot;,                 // å·¥ä½œç›®å½•            &quot;iconPath=@TargetDir@/app_icon.ico&quot;,            // å¿«æ·æ–¹å¼å›¾æ ‡            &quot;iconIndex=0&quot;                                   // å›¾æ ‡ç´¢å¼•        );    &#125;    // ç¤ºä¾‹ï¼šåœ¨Windowsä¸Šåˆ›å»ºå¼€å§‹èœå•å¿«æ·æ–¹å¼    if (systemInfo.kernelType === &quot;winnt&quot;) &#123;        component.addOperation(            &quot;CreateShortcut&quot;,            &quot;@TargetDir@/YourApp.exe&quot;,            &quot;@StartMenuDir@/YourApp.lnk&quot;,            &quot;workingDirectory=@TargetDir@&quot;        );    &#125;&#125;\n\nç”Ÿæˆå®‰è£…åŒ…åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼ˆä¾‹å¦‚ YourAppInstaller/ï¼‰æ‰“å¼€å‘½ä»¤è¡Œï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n1. ç”Ÿæˆåœ¨çº¿å®‰è£…åŒ…åœ¨çº¿å®‰è£…åŒ…ä½“ç§¯å°ï¼Œå®‰è£…æ—¶ä»æœåŠ¡å™¨ä¸‹è½½ç»„ä»¶æ•°æ®ã€‚éœ€è¦é¢„å…ˆå°†ç»„ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚\n# binarycreator æ˜¯ QtInstallerFramework çš„æ ¸å¿ƒå·¥å…·binarycreator --online-only -c config/config.xml -p packages YourAppInstaller_Online.exe\n\n2. ç”Ÿæˆç¦»çº¿å®‰è£…åŒ…ç¦»çº¿å®‰è£…åŒ…åŒ…å«æ‰€æœ‰æ–‡ä»¶ï¼Œä½“ç§¯è¾ƒå¤§ï¼Œæ— éœ€è”ç½‘å³å¯å®‰è£…ã€‚\n# -f æ˜¯ --offline-only çš„ç®€å†™binarycreator -f -c config/config.xml -p packages YourAppInstaller_Offline.exe\n\né«˜çº§åŠŸèƒ½å¤šè¯­è¨€æ”¯æŒåœ¨ config.xml ä¸­æ·»åŠ è¯­è¨€åŒ…æ–‡ä»¶ï¼ˆ.ts æ–‡ä»¶ç¼–è¯‘åçš„ .qm æ–‡ä»¶ï¼‰ã€‚\n&lt;Installer&gt;    ...    &lt;Translations&gt;        &lt;Translation&gt;zh_CN.qm&lt;/Translation&gt;        &lt;Translation&gt;en_US.qm&lt;/Translation&gt;    &lt;/Translations&gt;&lt;/Installer&gt;\n\né™é»˜&#x2F;æ— äººå€¼å®ˆå®‰è£…ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œè‡ªåŠ¨åŒ–å®‰è£…ã€‚\n# --unattended æ˜¯å…³é”®å‚æ•°YourAppInstaller.exe --unattended# ä¹Ÿå¯ä»¥ç»“åˆè„šæœ¬å®ç°æ›´å¤æ‚çš„è‡ªåŠ¨å®‰è£…# YourAppInstaller.exe --unattended --script your_script.qs# æŒ‡å®šå®‰è£…ç›®å½•YourAppInstaller.exe --unattended --target &quot;C:\\Path\\To\\Install&quot;\n\nå¸¸è§é—®é¢˜Q1: å¦‚ä½•æ‰“åŒ… VC++ è¿è¡Œæ—¶åº“?A: æ¨èåœ¨ installscript.qs ä¸­æ·»åŠ ä¸€ä¸ªæ“ä½œæ¥é™é»˜å®‰è£… VC++ è¿è¡Œæ—¶ï¼ˆvc_redist.x64.exeï¼‰ã€‚é¦–å…ˆå°† vc_redist.x64.exe æ”¾å…¥ data ç›®å½•ï¼Œç„¶åæ·»åŠ æ“ä½œï¼š\ncomponent.addOperation(&quot;Execute&quot;,    &quot;@TargetDir@/vc_redist.x64.exe&quot;,    &quot;/quiet&quot;,    &quot;/norestart&quot;);\n\nQ2: å¦‚ä½•ä½¿ç”¨ windeployqt è‡ªåŠ¨æ”¶é›† Qt ä¾èµ–?A: windeployqt æ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å·¥å…·ã€‚\n# 1. å…ˆåœ¨ä¸€ä¸ªä¸´æ—¶ç›®å½•ç”Ÿæˆä½ çš„ Release ç‰ˆæœ¬çš„ exe# 2. åœ¨è¯¥ç›®å½•è¿è¡Œ windeployqtwindeployqt YourApp.exe# 3. å°†æ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶å’Œç›®å½•ï¼ˆplatforms, styles, translationsç­‰ï¼‰å¤åˆ¶åˆ°ä½ çš„ç»„ä»¶çš„ data ç›®å½•ä¸‹\n\nQ3: å¿«æ·æ–¹å¼æ— æ³•åˆ›å»º?A: æ£€æŸ¥ installscript.qs ä¸­çš„è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼Œç‰¹åˆ«æ˜¯ @TargetDir@/YourApp.exe æ˜¯å¦æŒ‡å‘äº†æ­£ç¡®çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ç¡®ä¿ CreateShortcut æ“ä½œåœ¨ component.createOperations() ä¹‹åè°ƒç”¨ã€‚\næœ€ä½³å®è·µ\nç»„ä»¶åŒ–: å°†å¤§å‹åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªç»„ä»¶ï¼ˆpackagesï¼‰ï¼Œä¾‹å¦‚ä¸»ç¨‹åºã€æ–‡æ¡£ã€å¿«æ·æ–¹å¼ç­‰ã€‚è¿™è®©ç”¨æˆ·å¯ä»¥é€‰æ‹©æ€§å®‰è£…ï¼Œä¹Ÿä¾¿äºç»´æŠ¤ã€‚\nç¯å¢ƒå˜é‡: é¿å…åœ¨è„šæœ¬ä¸­ç¡¬ç¼–ç è·¯å¾„ï¼Œå¤šä½¿ç”¨é¢„å®šä¹‰å˜é‡å¦‚ @TargetDir@, @DesktopDir@ ç­‰ã€‚\nå¸è½½é€»è¾‘: åœ¨ installscript.qs ä¸­ä¸ºè‡ªå®šä¹‰çš„å®‰è£…æ“ä½œï¼ˆå¦‚æ·»åŠ æ³¨å†Œè¡¨ã€é…ç½®æ–‡ä»¶ï¼‰ç¼–å†™å¯¹åº”çš„å¸è½½é€»è¾‘ã€‚\næµ‹è¯•: åœ¨å¹²å‡€çš„è™šæ‹Ÿæœºä¸­ï¼ˆç‰¹åˆ«æ˜¯ Windowsï¼‰æµ‹è¯•ä½ çš„å®‰è£…ã€å¸è½½å’Œæ›´æ–°æµç¨‹ã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["Qt","QtInstallerFramework","å®‰è£…åŒ…åˆ¶ä½œ","éƒ¨ç½²å·¥å…·"]},{"title":"GDB è°ƒè¯•å·¥å…·å®Œæ•´ä½¿ç”¨æŒ‡å—","url":"/posts/b33ae3e9/","content":"GDB (GNU Debugger) è°ƒè¯•æŒ‡å—ç›®å½•\nç¼–è¯‘è°ƒè¯•ç‰ˆæœ¬\nå¯åŠ¨ GDB\næ–­ç‚¹\næ‰§è¡Œæ§åˆ¶\næŸ¥çœ‹æ•°æ®\né«˜çº§æŠ€å·§\nå¸¸è§é—®é¢˜\n\nç¼–è¯‘è°ƒè¯•ç‰ˆæœ¬ä¸ºäº†è®© GDB èƒ½å¤Ÿè·å–è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä½ å¿…é¡»åœ¨ç¼–è¯‘æ—¶åŠ å…¥ -g å‚æ•°ã€‚ä¸ºäº†è·å¾—æœ€ä½³è°ƒè¯•ä½“éªŒï¼Œå»ºè®®å…³é—­ä¼˜åŒ– (-O0) å¹¶å¼€å¯æ‰€æœ‰è­¦å‘Šã€‚\n# ä½¿ç”¨ -g å‚æ•°ç”Ÿæˆè°ƒè¯•ä¿¡æ¯g++ -g -o my_app my_app.cpp# æ¨èçš„è°ƒè¯•ç¼–è¯‘é€‰é¡¹g++ -g -O0 -Wall -Wextra -o my_app my_app.cpp# CMake æ„å»ºç³»ç»Ÿçš„è°ƒè¯•æ¨¡å¼cmake -DCMAKE_BUILD_TYPE=Debug .make# ç¦ç”¨æŸäº›ä¼˜åŒ–ä½†ä¿ç•™è°ƒè¯•ä¿¡æ¯g++ -g -O1 -fno-omit-frame-pointer -o my_app my_app.cpp\n\nå¯åŠ¨ GDB# 1. è°ƒè¯•å¯æ‰§è¡Œæ–‡ä»¶gdb ./my_app# 2. é™„åŠ åˆ°æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ (éœ€è¦è¿›ç¨‹ID)gdb -p &lt;pid&gt;# 3. è°ƒè¯•ç¨‹åºå´©æºƒäº§ç”Ÿçš„æ ¸å¿ƒè½¬å‚¨æ–‡ä»¶ (core dump)gdb ./my_app core.&lt;pid&gt;# 4. ä½¿ç”¨å‚æ•°å¯åŠ¨ç¨‹åºgdb --args ./my_app arg1 arg2# 5. åœ¨ GDB ä¸­è®¾ç½®ç¨‹åºçš„å‚æ•°(gdb) set args arg1 arg2\n\næ–­ç‚¹ (Breakpoints)è®¾ç½®æ–­ç‚¹# åœ¨å‡½æ•°å…¥å£è®¾ç½®æ–­ç‚¹break function_nameb main# åœ¨æŒ‡å®šæ–‡ä»¶çš„æŒ‡å®šè¡Œå·è®¾ç½®æ–­ç‚¹break file.cpp:42b 42# è®¾ç½®æ¡ä»¶æ–­ç‚¹ (å½“ a &gt; 10 æ—¶è§¦å‘)break 42 if a &gt; 10b file.cpp:50 if count == 0# è®¾ç½®ä¸´æ—¶æ–­ç‚¹ (å‘½ä¸­åè‡ªåŠ¨åˆ é™¤)tbreak function_name# åœ¨å†…å­˜åœ°å€è®¾ç½®æ–­ç‚¹break *0x400500\n\nç®¡ç†æ–­ç‚¹# æŸ¥çœ‹æ‰€æœ‰æ–­ç‚¹info breakpointsinfo b# ç¦ç”¨æ–­ç‚¹ (num ä¸ºæ–­ç‚¹ç¼–å·)disable &lt;num&gt;# å¯ç”¨æ–­ç‚¹enable &lt;num&gt;# åˆ é™¤æ–­ç‚¹delete &lt;num&gt;d &lt;num&gt;# æ¸…é™¤æ‰€æœ‰æ–­ç‚¹deleteclear# æ¸…é™¤æŒ‡å®šè¡Œçš„æ–­ç‚¹clear 42clear function_name\n\næ‰§è¡Œæ§åˆ¶# è¿è¡Œç¨‹åº (å¯è·Ÿå‚æ•°)run [args]r# ç»§ç»­æ‰§è¡Œç›´åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹continuec# å•æ­¥æ‰§è¡Œï¼Œä¼šè¿›å…¥å‡½æ•°å†…éƒ¨steps# å•æ­¥æ‰§è¡Œï¼Œä¸ä¼šè¿›å…¥å‡½æ•°å†…éƒ¨nextn# æ‰§è¡Œåˆ°å½“å‰å‡½æ•°è¿”å›finish# æ‰§è¡Œåˆ°å½“å‰å¾ªç¯ç»“æŸuntil# ç»§ç»­æ‰§è¡Œç›´åˆ°å½“å‰å‡½æ•°è¿”å›ï¼ˆä¸ finish ç±»ä¼¼ï¼‰return [expression]# é‡æ–°å¼€å§‹æ‰§è¡Œç¨‹åºrestart# é€€å‡º GDBquitq\n\næŸ¥çœ‹æ•°æ®æŸ¥çœ‹ä»£ç ä¸è°ƒç”¨æ ˆ# æ˜¾ç¤ºå½“å‰ä½ç½®é™„è¿‘çš„æºä»£ç listl# æ˜¾ç¤ºæŒ‡å®šå‡½æ•°æˆ–è¡Œçš„æºä»£ç list function_namelist file.cpp:42# æŸ¥çœ‹å½“å‰å‡½æ•°çš„è°ƒç”¨æ ˆå¸§ä¿¡æ¯info frame# æŸ¥çœ‹å®Œæ•´çš„å‡½æ•°è°ƒç”¨æ ˆbacktracebt# é™åˆ¶æ˜¾ç¤ºçš„æ ˆå¸§æ•°é‡backtrace 10bt 10# æŸ¥çœ‹ N ä¸ªæ ˆå¸§çš„è¯¦ç»†ä¿¡æ¯backtrace fullbt full\n\næŸ¥çœ‹å˜é‡ä¸å†…å­˜# æ‰“å°å˜é‡/è¡¨è¾¾å¼çš„å€¼print variablep i * 2# ä»¥ç‰¹å®šæ ¼å¼æ‰“å° (x:åå…­è¿›åˆ¶, d:åè¿›åˆ¶, t:äºŒè¿›åˆ¶, c:å­—ç¬¦)p/x variable# æŸ¥çœ‹å˜é‡ç±»å‹ptype variable# æŸ¥çœ‹å½“å‰æ ˆå¸§çš„å±€éƒ¨å˜é‡info locals# æŸ¥çœ‹å½“å‰å‡½æ•°çš„å‚æ•°info args# æ£€æŸ¥å†…å­˜åœ°å€ (x: examine)# æ ¼å¼: x/[N][F][U] address# N: æ˜¾ç¤ºæ•°é‡, F: æ ¼å¼, U: å•ä½å¤§å° (b:å­—èŠ‚, h:åŠå­—, w:å­—, g:åŒå­—)x/16xw 0x7fffffffe3c0  # ä»åœ°å€å¼€å§‹ï¼Œä»¥16è¿›åˆ¶æ ¼å¼æ˜¾ç¤º16ä¸ªå­—(word)# æ›´å¤š examine æ ¼å¼ç¤ºä¾‹x/10xb 0x7fffffffe3c0      # æ˜¾ç¤º10ä¸ªå­—èŠ‚ï¼Œ16è¿›åˆ¶x/20i 0x400500              # æ˜¾ç¤º20æ¡æŒ‡ä»¤ï¼Œæ±‡ç¼–æ ¼å¼x/4xg &amp;main                 # ä»¥16è¿›åˆ¶æ˜¾ç¤º4ä¸ª8å­—èŠ‚ç»„(&amp;mainåœ°å€)# æŸ¥çœ‹æ•°ç»„å†…å®¹p *array@len                 # æ˜¾ç¤ºæ•°ç»„arrayçš„å‰lenä¸ªå…ƒç´ p *(int(*)[10])ptr           # å°†ptrè½¬æ¢ä¸ºint[10]æŒ‡é’ˆå¹¶æŸ¥çœ‹# æŸ¥çœ‹å¯„å­˜å™¨å€¼info registersinfo r# è®¾ç½®å˜é‡å€¼set variable = 100set i = i + 1\n\né«˜çº§æŠ€å·§æ–‡æœ¬ç”¨æˆ·ç•Œé¢ (TUI) æ¨¡å¼TUI æ¨¡å¼å¯ä»¥åœ¨ä¸€ä¸ªçª—å£å†…åŒæ—¶æ˜¾ç¤ºæºä»£ç ã€æ±‡ç¼–å’Œ GDB å‘½ä»¤ï¼Œéå¸¸æ–¹ä¾¿ã€‚\n# å¯åŠ¨æ—¶è¿›å…¥ TUI æ¨¡å¼gdb -tui ./my_app# åœ¨ GDB å†…éƒ¨åˆ‡æ¢ TUI æ¨¡å¼# æŒ‰ä¸‹ Ctrl + x, ç„¶åå†æŒ‰ a\nTUI æ¨¡å¼ä¸‹å¸¸ç”¨å¿«æ·é”®ï¼š\n\nCtrl + x, 2: åˆ‡æ¢ç„¦ç‚¹åˆ°ä¸‹ä¸€ä¸ªçª—å£\nä¸Š/ä¸‹ç®­å¤´: æ»šåŠ¨å½“å‰çª—å£å†…å®¹\n\nè§‚å¯Ÿç‚¹ (Watchpoints)å½“ä¸€ä¸ªå˜é‡è¢«è¯»å–æˆ–å†™å…¥æ—¶ï¼Œç¨‹åºä¼šæš‚åœã€‚\n# å˜é‡è¢«å†™å…¥æ—¶æš‚åœwatch my_var# å˜é‡è¢«è¯»å–æ—¶æš‚åœrwatch my_var# å˜é‡è¢«è¯»å–æˆ–å†™å…¥æ—¶æš‚åœawatch my_var\n\nå¤šçº¿ç¨‹è°ƒè¯•# æŸ¥çœ‹æ‰€æœ‰çº¿ç¨‹info threads# åˆ‡æ¢åˆ°æŒ‡å®šçº¿ç¨‹ (num ä¸ºçº¿ç¨‹ç¼–å·)thread &lt;num&gt;# å¯¹æ‰€æœ‰çº¿ç¨‹æ‰§è¡ŒåŒä¸€ä¸ªå‘½ä»¤thread apply all bt  # æŸ¥çœ‹æ‰€æœ‰çº¿ç¨‹çš„è°ƒç”¨æ ˆthread apply all backtrace full  # è¯¦ç»†ä¿¡æ¯# åº”ç”¨å‘½ä»¤åˆ°æŒ‡å®šçº¿ç¨‹thread apply 3-5 bt  # å¯¹çº¿ç¨‹3åˆ°5æ‰§è¡Œbt# æŸ¥çœ‹çº¿ç¨‹é”å®šä¿¡æ¯info lock\n\nå¼‚å¸¸å¤„ç†# æ•è· C++ å¼‚å¸¸catch throwcatch catch# æ•è·ä¿¡å·catch signal SIGSEGVcatch signal SIGINT# å¿½ç•¥ä¿¡å·handle SIGUSR1 nostop noprint pass# æŸ¥çœ‹ä¿¡å·å¤„ç†è®¾ç½®info signals\n\nå®è°ƒè¯•# å±•å¼€å®macro expand MACRO_NAME# æ˜¾ç¤ºå®å®šä¹‰info macro MACRO_NAME# æŸ¥çœ‹æ‰€æœ‰å®å®šä¹‰info macros\n\nå…¶ä»–é«˜çº§åŠŸèƒ½# æŸ¥çœ‹å…±äº«åº“ä¿¡æ¯info sharedlibrary# åŠ è½½ç¬¦å·symbol-file /path/to/library.so# è®¾ç½®æ‰“å°æ•°ç»„çš„æœ€å¤§å…ƒç´ æ•°set print elements 100# è®¾ç½®æ‰“å°å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦set print null-stopset print elements 0  # æ— é™åˆ¶# è‡ªåŠ¨æ˜¾ç¤ºè¡¨è¾¾å¼çš„å€¼display variabledisplay *ptr# æŸ¥çœ‹æ‰€æœ‰æ˜¾ç¤ºçš„è¡¨è¾¾å¼info display# å–æ¶ˆæ˜¾ç¤ºundisplay &lt;num&gt;\n\nå¸¸è§é—®é¢˜Q1: å¦‚ä½•è°ƒè¯•æ®µé”™è¯¯ (Segmentation Fault)?A: é¦–å…ˆï¼Œå¼€å¯ core dump ç”Ÿæˆã€‚\n# å…è®¸ç”Ÿæˆæ— é™å¤§çš„ core dump æ–‡ä»¶ulimit -c unlimited\nç„¶åæ­£å¸¸è¿è¡Œä½ çš„ç¨‹åºï¼Œå½“å®ƒå´©æºƒæ—¶ï¼Œä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆä¸€ä¸ª core æ–‡ä»¶ã€‚æœ€åä½¿ç”¨ GDB åŠ è½½å®ƒè¿›è¡Œåˆ†æã€‚\n# è¿›å…¥ GDB åï¼Œç«‹å³ä½¿ç”¨ backtrace æŸ¥çœ‹å´©æºƒæ—¶çš„è°ƒç”¨æ ˆ(gdb) bt\n\nQ2: å¦‚ä½•ä½¿ç”¨ Valgrind è¿›è¡Œå†…å­˜æ³„æ¼æ£€æµ‹?A: Valgrind æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·ï¼Œåº”åœ¨ Shell ä¸­ä½¿ç”¨ï¼Œè€Œä¸æ˜¯åœ¨ GDB å†…éƒ¨ã€‚å®ƒä¼šè¿è¡Œä½ çš„ç¨‹åºå¹¶ç›‘æ§å†…å­˜ä½¿ç”¨ã€‚\n# --leak-check=full æä¾›æœ€è¯¦ç»†çš„æ³„æ¼æŠ¥å‘Švalgrind --leak-check=full ./my_app\n\nQ3: å¦‚ä½•è°ƒè¯•å¤šè¿›ç¨‹ç¨‹åº (fork)?A: é»˜è®¤æƒ…å†µä¸‹ï¼ŒGDB ä¼šç»§ç»­è°ƒè¯•çˆ¶è¿›ç¨‹ï¼Œè€Œå­è¿›ç¨‹ä¼šæ­£å¸¸è¿è¡Œã€‚ä½ å¯ä»¥ä¿®æ”¹è¿™ä¸ªè¡Œä¸ºã€‚\n# è®¾ç½® GDB åœ¨ fork åè°ƒè¯•å­è¿›ç¨‹set follow-fork-mode child# (å¯é€‰) è®¾ç½® GDB åŒæ—¶è°ƒè¯•çˆ¶å­è¿›ç¨‹ï¼Œéœ€è¦ GDB 7.0+set detach-on-fork off\n\nQ4: å¦‚ä½•è°ƒè¯•åŠ¨æ€é“¾æ¥åº“ä¸­çš„é—®é¢˜?A: ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š\n# åŠ è½½å…±äº«åº“çš„è°ƒè¯•ç¬¦å·(gdb) symbol-file /usr/lib/debug/libfoo.so# è®¾ç½®æ–­ç‚¹åˆ°å…±äº«åº“å‡½æ•°(gdb) break shared_function# æŸ¥çœ‹åŠ¨æ€é“¾æ¥ä¿¡æ¯(gdb) info sharedlibrary\n\nQ5: GDB æ˜¾ç¤º â€œNo symbol table is loadedâ€ æ€ä¹ˆåŠ?A: è¿™æ˜¯å› ä¸ºç¼–è¯‘æ—¶æ²¡æœ‰åŒ…å«è°ƒè¯•ä¿¡æ¯ã€‚\n\nç¡®ä¿ä½¿ç”¨ -g å‚æ•°ç¼–è¯‘ï¼š\ng++ -g program.cpp -o program\n\nå¯¹äºå·²ç¼–è¯‘çš„ç¨‹åºï¼Œæ£€æŸ¥æ˜¯å¦æœ‰è°ƒè¯•ä¿¡æ¯ï¼š\n\n\nfile program  # æŸ¥çœ‹æ˜¯å¦åŒ…å«è°ƒè¯•ä¿¡æ¯objdump -h program | grep .debug  # æŸ¥çœ‹è°ƒè¯•æ®µ\n\n\né‡æ–°ç¼–è¯‘ç¨‹åºåŒ…å«è°ƒè¯•ä¿¡æ¯ã€‚\n\nQ6: å¦‚ä½•æŸ¥çœ‹ STL å®¹å™¨çš„å†…å®¹?A: ä½¿ç”¨ Pretty Printersï¼ˆéœ€è¦ GDB 7.0+ å’Œ Python æ”¯æŒï¼‰ï¼š\n# å¯ç”¨ pretty printing(gdb) set print pretty on# æŸ¥çœ‹ vector(gdb) p my_vector# æŸ¥çœ‹ map(gdb) p my_map# æŸ¥çœ‹ string(gdb) p my_string\n\nQ7: å¦‚ä½•åœ¨ GDB ä¸­æ‰§è¡Œ shell å‘½ä»¤?A: ä½¿ç”¨ shell å‘½ä»¤ï¼š\n(gdb) shell ls -la(gdb) shell ps aux | grep my_program(gdb) shell cat /proc/$(pidof my_program)/status\n\n\n","categories":["å¼€å‘å·¥å…·ä¸æµç¨‹","è°ƒè¯•å·¥å…·"],"tags":["C++","GDB","å¼€å‘å·¥å…·","è°ƒè¯•"]},{"title":"Antigravity ç™»å½•è®¤è¯å®Œæ•´è§£å†³æ–¹æ¡ˆï¼ˆéTUNæ–¹æ³•ï¼‰","url":"/posts/56a10ecb/","content":"\nç³»ç»Ÿæ¶æ„ï¼šWindows 10&#x2F;11 + Clash Proxy + Proxifier + Microsoft Edge\nåè®®æ”¯æŒï¼šSOCKS5 ä»£ç† + OAuth 2.0 è®¤è¯\né€‚ç”¨åœºæ™¯ï¼šå›½å†…ç½‘ç»œç¯å¢ƒ + ç¬¬ä¸‰æ–¹æœåŠ¡è®¤è¯\næ–‡æ¡£ç‰ˆæœ¬ï¼šv2.0.0\næœ€åæ›´æ–°ï¼š2025-12-17\n\n\nğŸ“‹ ç›®å½•\næ¦‚è¿°\nç¯å¢ƒå‡†å¤‡\né…ç½®æ­¥éª¤\næ•…éšœæ’é™¤\næ ¸å¿ƒéªŒè¯æµ‹è¯•\n\n\nğŸ“– æ¦‚è¿°1.1 è§£å†³æ–¹æ¡ˆèƒŒæ™¯Antigravity æ˜¯ä¸€æ¬¾åŸºäºäº‘åŸç”Ÿçš„å¼€å‘å¹³å°ï¼Œé‡‡ç”¨ OAuth 2.0 æ ‡å‡†è¿›è¡Œç”¨æˆ·è®¤è¯ã€‚ç”±äºå›½å†…ç½‘ç»œç¯å¢ƒçš„ç½‘ç»œé™åˆ¶ï¼Œç›´æ¥è®¿é—® Google è®¤è¯æœåŠ¡å­˜åœ¨æŠ€æœ¯å£å’ï¼Œéœ€è¦é€šè¿‡ä¸“ä¸šçš„ä»£ç†æ¶æ„å®ç°è®¤è¯é“¾è·¯çš„æ‰“é€šã€‚\n1.2 æ ¸å¿ƒè¦æ±‚\nGoogle è´¦å·å½’å±åœ°å¿…é¡»ä¸ºç¾å›½ - Antigravity è®¤è¯çš„ç¡¬æ€§è¦æ±‚\nä»£ç†èŠ‚ç‚¹å¿…é¡»ä¸ºç¾å›½åœ°åŒº - ç¡®ä¿ä¸è´¦å·å½’å±åœ°åŒ¹é…\nä¼ä¸šç½‘ç»œç¯å¢ƒå…¼å®¹ - é€‚åº”ä¼ä¸šé˜²ç«å¢™å’Œç½‘ç»œå®‰å…¨ç­–ç•¥\n\n1.3 æŠ€æœ¯æ¶æ„â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  Antigravity.exe â”‚â”€â”€â”€â–¶â”‚  Proxifier      â”‚â”€â”€â”€â–¶â”‚  Clash Proxy    â”‚â”‚  (OAuth Client) â”‚    â”‚  (Process Rule) â”‚    â”‚ (SOCKS5:7890)   â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚  US Proxy    â”‚                                               â”‚  (Google API)â”‚                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚ Google OAuth  â”‚                                               â”‚  (US Region)   â”‚                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n\nğŸ”§ ç¯å¢ƒå‡†å¤‡2.1 Google è´¦å·è¦æ±‚\n\n\nè¦æ±‚é¡¹\nçŠ¶æ€\nè¯´æ˜\n\n\n\nè´¦å·å½’å±åœ°\nâš ï¸ å¿…é¡»ä¸ºç¾å›½\nAntigravity è®¤è¯çš„ç¡¬æ€§è¦æ±‚\n\n\nè´¦å·çŠ¶æ€\nâœ… æ­£å¸¸\næ— å°ç¦ã€é™åˆ¶æˆ–å®‰å…¨è­¦å‘Š\n\n\nåŒé‡è®¤è¯\nâœ… æ¨è\nå»ºè®®å¼€å¯ 2FA æé«˜å®‰å…¨æ€§\n\n\næµè§ˆå™¨ç™»å½•\nâœ… å·²å®Œæˆ\nEdge æµè§ˆå™¨å·²ç™»å½•ç›®æ ‡è´¦å·\n\n\nâš ï¸ é‡è¦æé†’ï¼š\n\néç¾å›½è´¦å·ä¼šè¢«ç›´æ¥æ‹’ç»è®¤è¯\nå½’å±åœ°ä¸åŒ¹é…ä¼šå¯¼è‡´è®¤è¯å¤±è´¥\né¢‘ç¹åˆ‡æ¢åœ°åŒºä¼šè¢«æ ‡è®°ä¸ºå¼‚å¸¸\n\n2.2 ä»£ç†æœåŠ¡è¦æ±‚\n\n\nè¦æ±‚é¡¹\nè§„æ ¼\nè¯´æ˜\n\n\n\nåœ°ç†ä½ç½®\nâš ï¸ å¿…é¡»ä¸ºç¾å›½æœ¬åœŸ\nç¡®ä¿ä¸è´¦å·å½’å±åœ°åŒ¹é…\n\n\nIP ç±»å‹\nâœ… ä½å®…çº§ IP\né¿å…æ•°æ®ä¸­å¿ƒ IP è¢«è¯†åˆ«\n\n\næœåŠ¡ç±»å‹\nâœ… ä¸“ä¸šä»˜è´¹æœåŠ¡\nå…è´¹èŠ‚ç‚¹é€šå¸¸ä¸å¯é \n\n\nåè®®æ”¯æŒ\nâœ… SOCKS5\nä¸ Clash å…¼å®¹\n\n\næ¨èèŠ‚ç‚¹é€‰æ‹©ï¼š\n\né¦–é€‰èŠ‚ç‚¹ï¼šæ´›æ‰çŸ¶ã€çº½çº¦ã€è¥¿é›…å›¾ã€èŠåŠ å“¥\nå¤‡é€‰èŠ‚ç‚¹ï¼šæ—§é‡‘å±±ã€è¾¾æ‹‰æ–¯ã€è¿ˆé˜¿å¯†\né¿å…ä½¿ç”¨ï¼šé¦™æ¸¯ã€æ—¥æœ¬ã€æ–°åŠ å¡ç­‰äºšæ´²èŠ‚ç‚¹\n\n2.3 è½¯ä»¶ç¯å¢ƒè¦æ±‚\n\n\nè½¯ä»¶\nç‰ˆæœ¬è¦æ±‚\nç”¨é€”\n\n\n\nClash\nv1.18.0+\nSOCKS5 ä»£ç†æœåŠ¡\n\n\nProxifier\nv4.0+\nè¿›ç¨‹çº§ä»£ç†ç®¡ç†\n\n\nEdge æµè§ˆå™¨\nv118.0+\nOAuth è®¤è¯æµè§ˆå™¨\n\n\nAntigravity\nLatest\nç›®æ ‡åº”ç”¨ç¨‹åº\n\n\n\nâš™ï¸ é…ç½®æ­¥éª¤3.1 Clash ä»£ç†é…ç½®3.1.1 èŠ‚ç‚¹é€‰æ‹©ç¡®ä¿ Clash å®¢æˆ·ç«¯è¿æ¥åˆ°ç¾å›½åœ°åŒºèŠ‚ç‚¹ï¼Œé¿å…ä½¿ç”¨é¦™æ¸¯ã€æ—¥æœ¬ç­‰äºšæ´²èŠ‚ç‚¹ã€‚\n3.1.2 è§„åˆ™é…ç½®æ›´æ–° Clash é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ  Antigravity ç›¸å…³è§„åˆ™ï¼š\n# Google Auth &amp; Antigravity å¿…é¡»èµ°ä»£ç†rules:    - &#x27;DOMAIN-SUFFIX,googleapis.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;    - &#x27;DOMAIN-SUFFIX,sandbox.googleapis.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;    - &#x27;DOMAIN,oauth2.googleapis.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;    - &#x27;DOMAIN,accounts.google.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;    - &#x27;DOMAIN,daily-cloudcode-pa.sandbox.googleapis.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;    - &#x27;PROCESS-NAME,Antigravity.exe,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;\n\n3.2 Proxifier é…ç½®3.2.1 æ·»åŠ ä»£ç†æœåŠ¡å™¨\næ‰“å¼€ Proxifier â†’ Profile â†’ Proxy Serversâ€¦ â†’ Add\né…ç½®å‚æ•°ï¼š\nAddress: 127.0.0.1\nPort: 7890\nProtocol: SOCKS5\nAuthentication: NO\n\n\nç‚¹å‡» Check éªŒè¯è¿æ¥ï¼Œç¡®è®¤æ˜¾ç¤º â€œSocks5 server is availableâ€\n\n3.2.2 åˆ›å»ºä»£ç†è§„åˆ™è§„åˆ™1ï¼šEdge æµè§ˆå™¨ç›´è¿ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰\n\nRule name: Edge Direct\nApplications: msedge.exe\nAction: Direct\nPriority: Highest\n\nè§„åˆ™2ï¼šClash è¿›ç¨‹ç›´è¿ï¼ˆé¿å…ä»£ç†å¾ªç¯ï¼‰\n\nRule name: Clash Processes Direct\nApplications: clash_*.exe\nAction: Direct\nPriority: High\n\nè§„åˆ™3ï¼šAntigravity åº”ç”¨èµ°ä»£ç†\n\nRule name: Antigravity via Clash\nApplications: Antigravity.exe, language_server_windows_x64.exe\nAction: 127.0.0.1:7890\nPriority: Normal\n\n3.2.3 è§„åˆ™ä¼˜å…ˆçº§ç¡®è®¤ç¡®ä¿è§„åˆ™æŒ‰ä»¥ä¸‹é¡ºåºæ’åˆ—ï¼š\n\nEdge Direct (æœ€é«˜ä¼˜å…ˆçº§)\nClash Processes Direct (é«˜ä¼˜å…ˆçº§)\nAntigravity via Clash (æ™®é€šä¼˜å…ˆçº§)\n\n3.3 ç³»ç»Ÿç¯å¢ƒé…ç½®3.3.1 æ¸…ç†ç¯å¢ƒå˜é‡å¿…é¡»æ¸…ç©ºä»¥ä¸‹ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼š\n# Windows å‘½ä»¤è¡Œset HTTP_PROXY=&quot;&quot;set HTTPS_PROXY=&quot;&quot;set NO_PROXY=&quot;&quot;\n\næˆ–è€…åœ¨ç³»ç»Ÿå±æ€§ä¸­æ°¸ä¹…åˆ é™¤è¿™äº›å˜é‡ã€‚\n3.3.2 é˜²ç«å¢™é…ç½®ç¡®ä¿é˜²ç«å¢™å…è®¸ä»¥ä¸‹è¿æ¥ï¼š\n\nClash.exe (TCP:7890 å…¥ç«™)\nProxifier.exe (TCP åŠ¨æ€ç«¯å£ å‡ºç«™)\nmsedge.exe (TCP&#x2F;UDP:80&#x2F;443 å‡ºç«™)\nAntigravity.exe (TCP&#x2F;UDP åŠ¨æ€ç«¯å£ å‡ºç«™)\n\n\nğŸ”§ æ•…éšœæ’é™¤4.1 è®¤è¯æµç¨‹é—®é¢˜é—®é¢˜ï¼šEdge æµè§ˆå™¨æ— æ³•æ‰“å¼€ Google ç™»å½•é¡µé¢\n\n\n\nç—‡çŠ¶\nå¯èƒ½åŸå› \nè§£å†³æ–¹æ¡ˆ\n\n\n\nEdge æ— å“åº”\nProxifier è§„åˆ™å†²çª\næ£€æŸ¥è§„åˆ™é¡ºåºï¼ŒEdge Direct ç½®é¡¶\n\n\né¡µé¢åŠ è½½å¤±è´¥\nç¯å¢ƒå˜é‡æ±¡æŸ“\næ¸…ç©º HTTP_PROXY&#x2F;HTTPS_PROXY\n\n\nè¿æ¥è¶…æ—¶\nç½‘ç»œé˜²ç«å¢™é™åˆ¶\næ£€æŸ¥é˜²ç«å¢™é…ç½®\n\n\né—®é¢˜ï¼šGoogle ç™»å½•æˆåŠŸä½†æ— æ³•è·³è½¬å› Antigravity\n\n\n\næ£€æŸ¥ç‚¹\néªŒè¯æ–¹æ³•\nè§£å†³æ–¹æ¡ˆ\n\n\n\nOAuth æµç¨‹\nClash Connections æ—¥å¿—\næ£€æŸ¥ Clash è§„åˆ™é…ç½®\n\n\nåº”ç”¨ä»£ç†\nProxifier å®æ—¶æ—¥å¿—\né‡æ–°é…ç½®åº”ç”¨è§„åˆ™\n\n\nä»£ç†å¾ªç¯\nProxifier è¿æ¥æ—¥å¿—\næ·»åŠ  Clash ç›´è¿è§„åˆ™\n\n\n4.2 ç½‘ç»œè¿æ¥é—®é¢˜é—®é¢˜ï¼šä»£ç†èŠ‚ç‚¹è¿æ¥ä¸ç¨³å®š\n# åŸºç¡€è¿æ¥æµ‹è¯•curl --proxy socks5://127.0.0.1:7890 https://www.google.com# IP åœ°ç†ä½ç½®æ£€æµ‹curl --proxy socks5://127.0.0.1:7890 &quot;https://httpbin.org/ip&quot;# è¿æ¥ç¨³å®šæ€§æµ‹è¯•ping -n 10 8.8.8.8\n\nèŠ‚ç‚¹è´¨é‡æ ‡å‡†ï¼š\n\n\n\næŒ‡æ ‡\nä¼˜ç§€\nå¯æ¥å—\néœ€æ›´æ¢\n\n\n\nå»¶è¿Ÿ\n&lt; 100ms\n100-200ms\n&gt; 200ms\n\n\nç¨³å®šæ€§\n99.9%+\n99%+\n&lt; 99%\n\n\næˆåŠŸç‡\n100%\n99%+\n&lt; 99%\n\n\n4.3 è´¦å·ç›¸å…³é—®é¢˜Google è´¦å·å®‰å…¨æ£€æŸ¥æ¸…å•ï¼š\n\n ç™»å½•åœ°ç‚¹æ˜¯å¦ä¸ºç¾å›½åœ°åŒº\n ç™»å½•è®¾å¤‡æ˜¯å¦ä¸ºå·²çŸ¥è®¾å¤‡\n æ˜¯å¦å¯ç”¨äº†ä¸¤æ­¥éªŒè¯\n åº”ç”¨æƒé™æ˜¯å¦æ­£ç¡®æˆæƒ\n\nå¦‚æœè´¦å·å½’å±åœ°æ£€æµ‹å¤±è´¥ï¼Œæ ¹æœ¬åŸå› é€šå¸¸æ˜¯ï¼š\n\nè´¦å·åˆ›å»ºåœ°ï¼šéç¾å›½åœ°åŒºåˆ›å»ºï¼ˆå›°éš¾è§£å†³ï¼‰\nå¸¸ç”¨ç™»å½•åœ°ï¼šé•¿æœŸéç¾å›½ç™»å½•ï¼ˆä¸­ç­‰è§£å†³ï¼‰\nç™»å½•è¡Œä¸ºï¼šé¢‘ç¹åˆ‡æ¢åœ°åŒºï¼ˆç®€å•è§£å†³ï¼‰\n\n\nğŸ§ª æ ¸å¿ƒéªŒè¯æµ‹è¯•5.1 åŸºç¡€ç¯å¢ƒéªŒè¯\n\n\nç»„ä»¶\næ£€æŸ¥å‘½ä»¤\né¢„æœŸç»“æœ\n\n\n\nClash\n&#96;tasklist\nfindstr Clash&#96;\n\n\nç«¯å£ç›‘å¬\n&#96;netstat -an\nfindstr :7890&#96;\n\n\nä»£ç†è¿æ¥\ncurl -x socks5://127.0.0.1:7890 https://www.google.com\nHTTP 200\n\n\nProxifier\nä»»åŠ¡ç®¡ç†å™¨æ£€æŸ¥\nè¿›ç¨‹è¿è¡Œ\n\n\nç¯å¢ƒå˜é‡\necho %HTTP_PROXY%\nç©ºå€¼\n\n\n5.2 OAuth è®¤è¯æµ‹è¯•å®Œæ•´è®¤è¯æµç¨‹æµ‹è¯•æ­¥éª¤ï¼š\n\nå¯åŠ¨ Antigravity å®¢æˆ·ç«¯\n\nç¡®è®¤ç¨‹åºæ­£å¸¸å¯åŠ¨\næ£€æŸ¥ Proxifier æ—¥å¿—æ˜¾ç¤ºä»£ç†è¿æ¥\n\n\nè§¦å‘ Google ç™»å½•\n\nç‚¹å‡» OAuth ç™»å½•æŒ‰é’®\nç¡®è®¤ Edge æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€\n\n\næµè§ˆå™¨éªŒè¯\n\nEdge åº”ç›´è¿æ‰“å¼€ Google ç™»å½•é¡µ\nåœ°å€æ  URL: accounts.google.com\né¡µé¢åŠ è½½æ­£å¸¸ï¼Œæ— ä»£ç†é”™è¯¯\n\n\nè´¦å·è®¤è¯\n\nè¾“å…¥ç¾å›½å½’å±åœ° Google è´¦å·å‡­æ®\nå®Œæˆä¸¤æ­¥éªŒè¯ï¼ˆå¦‚å·²å¯ç”¨ï¼‰\næˆæƒ Antigravity åº”ç”¨è®¿é—®æƒé™\n\n\nå›è·³éªŒè¯\n\nè‡ªåŠ¨è·³è½¬å› Antigravity åº”ç”¨\nåº”ç”¨æ˜¾ç¤ºç™»å½•æˆåŠŸçŠ¶æ€\nClash æ—¥å¿—æ˜¾ç¤º OAuth API ä»£ç†è¯·æ±‚\n\n\n\n5.3 å…³é”®éªŒè¯ç‚¹\n\n\næ£€æŸ¥èŠ‚ç‚¹\néªŒè¯æ–¹æ³•\næˆåŠŸçŠ¶æ€\n\n\n\nClash çŠ¶æ€\næ§åˆ¶é¢æ¿\nç»¿è‰²è¿æ¥\n\n\nç«¯å£ç›‘å¬\nnetstat -an\n:7890 å¤„äº LISTEN\n\n\nä»£ç†è§„åˆ™\nProxifier è§„åˆ™åˆ—è¡¨\nEdge è§„åˆ™ç½®é¡¶\n\n\næµè§ˆå™¨è®¿é—®\nç›´æ¥è®¿é—® Google\næ­£å¸¸åŠ è½½\n\n\nIP æ£€æµ‹\nåœ¨çº¿ IP æ£€æµ‹\nç¾å›½åœ°å€\n\n\nOAuth è¯·æ±‚\nClash Connections\næ˜¾ç¤º googleapis.com\n\n\n\nğŸ“‹ æ ¸å¿ƒæ£€æŸ¥æ¸…å•6.1 éƒ¨ç½²å‰æ£€æŸ¥Google è´¦å·éªŒè¯ï¼š\n\n è´¦å·å½’å±åœ°ä¸ºç¾å›½åœ°åŒº\n è´¦å·çŠ¶æ€æ­£å¸¸ï¼Œæ— å®‰å…¨è­¦å‘Š\n å·²å¯ç”¨ä¸¤æ­¥éªŒè¯\n æµè§ˆå™¨å·²ç™»å½•ç›®æ ‡è´¦å·\n\nä»£ç†æœåŠ¡éªŒè¯ï¼š\n\n ä»£ç†èŠ‚ç‚¹ä½äºç¾å›½åœ°åŒº\n èŠ‚ç‚¹æ”¯æŒ Google å…¨å¥—æœåŠ¡\n èŠ‚ç‚¹è¿æ¥ç¨³å®šæ€§ &gt; 99%\n IP åœ°å€æœªè¢« Google æ ‡è®°\n\nè½¯ä»¶ç¯å¢ƒéªŒè¯ï¼š\n\n Clash v1.18.0+ æ­£å¸¸è¿è¡Œ\n Proxifier v4.0+ å·²å®‰è£…\n Microsoft Edge v118.0+ å·²å®‰è£…\n ç³»ç»Ÿç¯å¢ƒå˜é‡å·²æ¸…ç©º\n\n6.2 åŠŸèƒ½éªŒè¯åŸºç¡€åŠŸèƒ½æµ‹è¯•ï¼š\n\n Clash æ§åˆ¶é¢æ¿æ˜¾ç¤ºè¿æ¥æ­£å¸¸\n ç«¯å£ 7890 å¤„äºç›‘å¬çŠ¶æ€\n Google æœåŠ¡è®¿é—®æ­£å¸¸\n IP åœ°å€æ˜¾ç¤ºä¸ºç¾å›½åœ°åŒº\n\nOAuth æµç¨‹æµ‹è¯•ï¼š\n\n Antigravity å¯åŠ¨æ­£å¸¸\n ç‚¹å‡»ç™»å½•æŒ‰é’®è§¦å‘ Edge æ‰“å¼€\n Edge ç›´è¿è®¿é—® Google ç™»å½•é¡µ\n Google è´¦å·ç™»å½•æˆåŠŸ\n è‡ªåŠ¨è·³è½¬å› Antigravity åº”ç”¨\n åº”ç”¨æ˜¾ç¤ºç™»å½•æˆåŠŸçŠ¶æ€\n\n\nğŸ“ æ€»ç»“7.1 å…³é”®æˆåŠŸå› ç´ æˆåŠŸçš„ä¸¤å¤§å‰æï¼š\n\nGoogle è´¦å·å½’å±åœ°å¿…é¡»ä¸ºç¾å›½ï¼šè¿™æ˜¯ Antigravity è®¤è¯çš„ç¡¬æ€§è¦æ±‚\nä»£ç†èŠ‚ç‚¹å¿…é¡»ä¸ºç¾å›½åœ°åŒºä¸”æ”¯æŒ Google å…¨å¥—æœåŠ¡ï¼šç¡®ä¿è®¤è¯æµé‡çš„åœ°ç†åˆè§„æ€§\n\næŠ€æœ¯å®æ–½è¦ç‚¹ï¼š\n\nProxifier è§„åˆ™ä¼˜å…ˆçº§é…ç½®æ˜¯å…³é”®ï¼ŒEdge æµè§ˆå™¨å¿…é¡»ç›´è¿\nClash è§„åˆ™éœ€è¦ç²¾ç¡®åŒ¹é… Google OAuth ç›¸å…³åŸŸå\nç³»ç»Ÿç¯å¢ƒå˜é‡å¿…é¡»æ¸…ç©ºï¼Œé¿å…ä»£ç†å†²çª\nClash ç›¸å…³è¿›ç¨‹å¿…é¡»ç›´è¿ï¼Œé¿å…ä»£ç†å¾ªç¯\n\n7.2 å¿«é€Ÿæ•…éšœæ’é™¤æŒ‡å—è®¤è¯å¤±è´¥çš„å¸¸è§åŸå› ï¼š\n\nGoogle è´¦å·å½’å±åœ°ä¸æ˜¯ç¾å›½ â†’ æ›´æ¢ç¾å›½è´¦å·æˆ–é‡æ–°æ³¨å†Œ\nä»£ç†èŠ‚ç‚¹ä¸åœ¨ç¾å›½åœ°åŒº â†’ åˆ‡æ¢åˆ°ç¾å›½èŠ‚ç‚¹\nEdge æµè§ˆå™¨è¢«ä»£ç† â†’ æ£€æŸ¥ Proxifier è§„åˆ™ä¼˜å…ˆçº§\nç³»ç»Ÿç¯å¢ƒå˜é‡å†²çª â†’ æ¸…ç©º HTTP_PROXY&#x2F;HTTPS_PROXY\nä»£ç†å¾ªç¯ â†’ æ·»åŠ  clash_*.exe ç›´è¿è§„åˆ™\n\néªŒè¯æˆåŠŸçš„æ ‡å¿—ï¼š\n\nâœ… Edge OAuth é¡µé¢æˆåŠŸæ‰“å¼€ï¼ˆç›´è¿ï¼‰\nâœ… ç™»å½•åæˆåŠŸå›è·³åˆ° Antigravity\nâœ… Clash Connections èƒ½çœ‹åˆ° oauth2.googleapis.com èµ°ä»£ç†\n\né€šè¿‡éµå¾ªæœ¬æ–‡æ¡£çš„æ ¸å¿ƒé…ç½®æ­¥éª¤å’ŒéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥å»ºç«‹ä¸€ä¸ªç¨³å®šã€å¯é çš„ Antigravity è®¤è¯ç¯å¢ƒã€‚\n","categories":["å¼€å‘å·¥å…·","IDEç¼–è¾‘å™¨"],"tags":["Antigravity","ä»£ç†é…ç½®","OAuthè®¤è¯","Clash","Proxifier","ç½‘ç»œé…ç½®","ä¼ä¸šç¯å¢ƒ"]},{"title":"Drogon Windows æ„å»ºæŒ‡å—","url":"/posts/58c0a1f/","content":"Drogon Windows æ„å»ºæŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: drogon, cpp, windows, source-build, cmake, conan\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. ç¯å¢ƒå‡†å¤‡\n3. æºç ä¸‹è½½\n4. ä¾èµ–å®‰è£…\n5. ç¼–è¯‘å®‰è£…\n6. ç¯å¢ƒé…ç½®\n7. åˆ›å»ºæ–°é¡¹ç›®\n8. å¸¸è§é—®é¢˜\n\n\n1. ğŸ“– æ¦‚è¿°Drogon æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ C++ Web æ¡†æ¶ã€‚æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åœ¨ Windows ç³»ç»Ÿä¸Šä»æºç ç¼–è¯‘å®‰è£… Drogonã€‚\nğŸ¯ å®‰è£…ç›®æ ‡\nâœ… ä»æºç ç¼–è¯‘ Drogon æ¡†æ¶\nâœ… é…ç½®å¼€å‘ç¯å¢ƒ\nâœ… åˆ›å»ºç¬¬ä¸€ä¸ª Drogon é¡¹ç›®\nâœ… éªŒè¯å®‰è£…æˆåŠŸ\n\n\n2. ğŸ”§ ç¯å¢ƒå‡†å¤‡2.1 å¿…éœ€å·¥å…·\nVisual Studio 2019+ - C++ ç¼–è¯‘å™¨\nGit - æºç ç®¡ç†\nCMake 3.15+ - æ„å»ºç³»ç»Ÿ\nConan - C++ åŒ…ç®¡ç†å™¨\n\n2.2 å®‰è£… Conan# Drogon Windows æ„å»ºæŒ‡å—pip install conan# Drogon Windows æ„å»ºæŒ‡å—choco install conan\n\n\n3. ğŸ“¥ æºç ä¸‹è½½# Drogon Windows æ„å»ºæŒ‡å—cd %WORK_PATH%# Drogon Windows æ„å»ºæŒ‡å—git clone https://github.com/drogonframework/drogoncd drogon# Drogon Windows æ„å»ºæŒ‡å—git submodule update --init\n\n\n4. ğŸ“¦ ä¾èµ–å®‰è£…# Drogon Windows æ„å»ºæŒ‡å—mkdir buildcd build# Drogon Windows æ„å»ºæŒ‡å—conan profile detect --force# Drogon Windows æ„å»ºæŒ‡å—conan install .. \\    -s compiler=&quot;msvc&quot; \\    -s compiler.version=194 \\    -s compiler.cppstd=17 \\    -s build_type=Debug \\    --output-folder . \\    --build=missing\n\n4.1 è‡ªå®šä¹‰ä¾èµ–ç¼–è¾‘ conanfile.txt å¯ä»¥æ·»åŠ æˆ–ä¿®æ”¹ä¾èµ–ï¼š\n[requires]# Drogon Windows æ„å»ºæŒ‡å—[generators]CMakeDepsCMakeToolchain[options]shared=False\n\n\n5. ğŸ”¨ ç¼–è¯‘å®‰è£…# Drogon Windows æ„å»ºæŒ‡å—cmake .. \\    -DCMAKE_BUILD_TYPE=Debug \\    -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot; \\    -DCMAKE_POLICY_DEFAULT_CMP0091=NEW \\    -DCMAKE_INSTALL_PREFIX=&quot;D:\\ThirdParty\\drogon&quot;# Drogon Windows æ„å»ºæŒ‡å—cmake --build . --parallel --target install\n\n5.1 âš ï¸ é‡è¦è¯´æ˜\nConan å’Œ CMake çš„ build type å¿…é¡»ä¿æŒä¸€è‡´\nRelease æ„å»ºæ—¶å°† Debug æ”¹ä¸º Release\nå¯æ ¹æ®éœ€è¦ä¿®æ”¹å®‰è£…è·¯å¾„\n\n\n6. ğŸ”— ç¯å¢ƒé…ç½®6.1 å®‰è£…ç»“æœç¼–è¯‘å®Œæˆåï¼Œä»¥ä¸‹æ–‡ä»¶å°†è¢«å®‰è£…åˆ°æŒ‡å®šç›®å½•ï¼š\n\n\n\næ–‡ä»¶ç±»å‹\nå®‰è£…è·¯å¾„\nè¯´æ˜\n\n\n\nå¤´æ–‡ä»¶\nD:\\ThirdParty\\drogon\\include\\drogon\nDrogon ä¸»è¦å¤´æ–‡ä»¶\n\n\nåº“æ–‡ä»¶\nD:\\ThirdParty\\drogon\\bin\ndrogon.dll\n\n\nå‘½ä»¤å·¥å…·\nD:\\ThirdParty\\drogon\\bin\ndrogon_ctl.exe\n\n\nTrantorå¤´æ–‡ä»¶\nD:\\ThirdParty\\drogon\\include\\trantor\nä¾èµ–åº“å¤´æ–‡ä»¶\n\n\nTrantoråº“æ–‡ä»¶\nD:\\ThirdParty\\drogon\\bin\ntrantor.dll\n\n\n6.2 ç¯å¢ƒå˜é‡æ·»åŠ ä»¥ä¸‹è·¯å¾„åˆ°ç³»ç»Ÿ PATH ç¯å¢ƒå˜é‡ï¼š\nD:\\ThirdParty\\drogon\\binD:\\ThirdParty\\drogon\\lib\\cmake\\DrogonD:\\ThirdParty\\drogon\\lib\\cmake\\Trantor\n\n\n7. ğŸš€ åˆ›å»ºæ–°é¡¹ç›®7.1 ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·# Drogon Windows æ„å»ºæŒ‡å—drogon_ctl create project your_project_name# Drogon Windows æ„å»ºæŒ‡å—copy drogon\\conanfile.txt your_project_name\\# Drogon Windows æ„å»ºæŒ‡å—cd your_project_name# Drogon Windows æ„å»ºæŒ‡å—mkdir buildcd buildconan profile detect --forceconan install .. \\    -s compiler=&quot;msvc&quot; \\    -s compiler.version=194 \\    -s compiler.cppstd=17 \\    -s build_type=Debug \\    --output-folder . \\    --build=missingcmake .. \\    -DCMAKE_BUILD_TYPE=Debug \\    -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot; \\    -DCMAKE_POLICY_DEFAULT_CMP0091=NEWcmake --build . --parallel\n\n7.2 é¡¹ç›®ç»“æ„your_project_name/â”œâ”€â”€ build/â”œâ”€â”€ config.jsonâ”œâ”€â”€ CMakeLists.txtâ”œâ”€â”€ conanfile.txtâ”œâ”€â”€ main.ccâ”œâ”€â”€ plugins/â”œâ”€â”€ run.batâ””â”€â”€ tests/\n\n\n8. ğŸ”§ å¸¸è§é—®é¢˜8.1 ç¼–è¯‘é”™è¯¯\nVS ç‰ˆæœ¬ä¸åŒ¹é…: ç¡®è®¤ compiler.version ä¸å®‰è£…çš„ Visual Studio ç‰ˆæœ¬ä¸€è‡´\nC++ æ ‡å‡†é—®é¢˜: ç¡®ä¿ compiler.cppstd è®¾ç½®æ­£ç¡®\nä¾èµ–ç¼ºå¤±: ä½¿ç”¨ --build=missing å¼ºåˆ¶æ„å»ºç¼ºå¤±çš„ä¾èµ–\n\n8.2 é“¾æ¥é”™è¯¯\nDLL æ‰¾ä¸åˆ°: æ£€æŸ¥ PATH ç¯å¢ƒå˜é‡è®¾ç½®\nåº“æ–‡ä»¶è·¯å¾„: ç¡®è®¤ CMAKE_PREFIX_PATH è®¾ç½®æ­£ç¡®\n\n8.3 è¿è¡Œæ—¶é”™è¯¯\né…ç½®æ–‡ä»¶: æ£€æŸ¥ config.json é…ç½®æ˜¯å¦æ­£ç¡®\nç«¯å£å ç”¨: ç¡®è®¤é…ç½®çš„ç«¯å£æœªè¢«å ç”¨\n\n\nğŸ“š ç›¸å…³èµ„æº\nDrogon å®˜æ–¹æ–‡æ¡£\nConan åŒ…ç®¡ç†å™¨\nCMake å®˜æ–¹æ–‡æ¡£\n\n\n\nğŸ’¡ æç¤º:\n\né¦–æ¬¡ç¼–è¯‘å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´\nå»ºè®®ä½¿ç”¨ Release æ¨¡å¼è¿›è¡Œç”Ÿäº§æ„å»º\nå®šæœŸæ›´æ–° Drogon æºç ä»¥è·å¾—æœ€æ–°åŠŸèƒ½\n\n\n","categories":["æ¡†æ¶åº“"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Drogon ç¼–è¯‘æŒ‡å—","url":"/posts/b47a5d97/","content":"Drogon ç¼–è¯‘æŒ‡å—ç›®å½•\næ¦‚è¿°\nç³»ç»Ÿè¦æ±‚\nç¯å¢ƒå‡†å¤‡\nä¸‹è½½æºç \nä¾èµ–ç®¡ç†\nç¼–è¯‘å®‰è£…\né…ç½®ç¯å¢ƒå˜é‡\néªŒè¯å®‰è£…\né¡¹ç›®é…ç½®\nå¸¸è§é—®é¢˜\næœ€ä½³å®è·µ\n\næ¦‚è¿°Drogon æ˜¯ä¸€ä¸ªåŸºäº C++17&#x2F;20 çš„é«˜æ€§èƒ½ HTTP åº”ç”¨æ¡†æ¶ï¼Œç±»ä¼¼äº Python çš„ Django å’Œ Flaskã€‚æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Windows ç³»ç»Ÿä¸‹ä»æºç ç¼–è¯‘å®‰è£… Drogon æ¡†æ¶ã€‚\næ¡†æ¶ç‰¹æ€§\né«˜æ€§èƒ½: åŸºäº non-blocking I&#x2F;O å’Œäº‹ä»¶é©±åŠ¨\nå¼‚æ­¥æ”¯æŒ: å®Œæ•´çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹\nORMæ”¯æŒ: å†…ç½®å¯¹è±¡å…³ç³»æ˜ å°„\næ’ä»¶ç³»ç»Ÿ: çµæ´»çš„æ’ä»¶æ‰©å±•æœºåˆ¶\nRESTful API: å¤©ç„¶æ”¯æŒ RESTful é£æ ¼\nWebSocket: å†…ç½® WebSocket æ”¯æŒ\nè·¨å¹³å°: æ”¯æŒ Windowsã€Linuxã€macOS\n\nç¼–è¯‘æ–¹å¼\næºç ç¼–è¯‘: å®Œå…¨æ§åˆ¶ç¼–è¯‘é€‰é¡¹å’Œä¾èµ–\nåŒ…ç®¡ç†å™¨: ä½¿ç”¨ vcpkg æˆ– Conan ç®¡ç†ä¾èµ–\né¢„ç¼–è¯‘åŒ…: ä½¿ç”¨å®˜æ–¹é¢„ç¼–è¯‘çš„äºŒè¿›åˆ¶åŒ…\n\nç³»ç»Ÿè¦æ±‚1. ç¡¬ä»¶è¦æ±‚\nCPU: x64 æ¶æ„ï¼Œæ¨è 4 æ ¸å¿ƒä»¥ä¸Š\nå†…å­˜: æœ€å°‘ 8GBï¼Œæ¨è 16GB+\nç£ç›˜ç©ºé—´: æœ€å°‘ 10GBï¼Œæ¨è 20GB+\n\n2. è½¯ä»¶è¦æ±‚\næ“ä½œç³»ç»Ÿ: Windows 10&#x2F;11 (64ä½)\nVisual Studio: 2019 æˆ– 2022\nCMake: 3.15+\nPython: 3.7+ (ç”¨äº Conan åŒ…ç®¡ç†å™¨)\nGit: æœ€æ–°ç‰ˆæœ¬\n\n3. å¼€å‘å·¥å…·\nVisual Studio: å®Œæ•´çš„ C++ å¼€å‘ç¯å¢ƒ\nCMake: è·¨å¹³å°æ„å»ºå·¥å…·\nConan: C++ åŒ…ç®¡ç†å™¨\nGit: ç‰ˆæœ¬æ§åˆ¶å·¥å…·\n\nç¯å¢ƒå‡†å¤‡1. å®‰è£… Visual Studio1.1 ä¸‹è½½å®‰è£…è®¿é—® https://visualstudio.microsoft.com/downloads/ ä¸‹è½½ Visual Studio 2022\n1.2 å·¥ä½œè´Ÿè½½é€‰æ‹©å®‰è£…æ—¶é€‰æ‹©ä»¥ä¸‹å·¥ä½œè´Ÿè½½ï¼š\n\nä½¿ç”¨ C++ çš„æ¡Œé¢å¼€å‘\nMSVC v143 ç¼–è¯‘å™¨å·¥å…·é›†\nWindows 10&#x2F;11 SDK\nC++ CMake å·¥å…·\n\n\n\n1.3 éªŒè¯å®‰è£…# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—cl# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—link# Drogon ç¼–è¯‘æŒ‡å—\n\n2. å®‰è£… CMake2.1 ä¸‹è½½å®‰è£…è®¿é—® https://cmake.org/download/ ä¸‹è½½ CMake\n2.2 å®‰è£…é…ç½®\né€‰æ‹© â€œAdd CMake to the system PATHâ€\nå®Œæˆå®‰è£…\n\n2.3 éªŒè¯å®‰è£…cmake --version# Drogon ç¼–è¯‘æŒ‡å—\n\n3. å®‰è£… Python å’Œ pip3.1 ä¸‹è½½å®‰è£… Pythonè®¿é—® https://python.org/downloads/ ä¸‹è½½ Python 3.9+\n3.2 é…ç½® pip æºï¼ˆå›½å†…åŠ é€Ÿï¼‰# Drogon ç¼–è¯‘æŒ‡å—pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple# Drogon ç¼–è¯‘æŒ‡å—pip config list\n\n4. å®‰è£… Conan4.1 å®‰è£… Conan# Drogon ç¼–è¯‘æŒ‡å—pip install conan# Drogon ç¼–è¯‘æŒ‡å—conan --version# Drogon ç¼–è¯‘æŒ‡å—\n\n4.2 é…ç½® Conan# Drogon ç¼–è¯‘æŒ‡å—conan profile detect --force# Drogon ç¼–è¯‘æŒ‡å—conan profile show default\n\n5. å®‰è£… Git5.1 ä¸‹è½½å®‰è£…è®¿é—® https://git-scm.com/download/win ä¸‹è½½ Git\n5.2 éªŒè¯å®‰è£…git --version# Drogon ç¼–è¯‘æŒ‡å—\n\nä¸‹è½½æºç 1. è®¾ç½®å·¥ä½œç›®å½•1.1 åˆ›å»ºå·¥ä½œç›®å½•# Drogon ç¼–è¯‘æŒ‡å—mkdir D:\\drogoncd D:\\drogon# Drogon ç¼–è¯‘æŒ‡å—set WORK_PATH=D:\\drogoncd %WORK_PATH%\n\n1.2 å…‹éš† Drogon æºç # Drogon ç¼–è¯‘æŒ‡å—git clone https://github.com/drogonframework/drogoncd drogon# Drogon ç¼–è¯‘æŒ‡å—git branch -agit tag -l# Drogon ç¼–è¯‘æŒ‡å—git checkout v1.8.4\n\n2. æ›´æ–°å­æ¨¡å—2.1 åˆå§‹åŒ–å­æ¨¡å—# Drogon ç¼–è¯‘æŒ‡å—git submodule update --init --recursive# Drogon ç¼–è¯‘æŒ‡å—git clone --recursive https://github.com/drogonframework/drogon\n\n2.2 éªŒè¯å­æ¨¡å—# Drogon ç¼–è¯‘æŒ‡å—git submodule status# Drogon ç¼–è¯‘æŒ‡å—\n\nä¾èµ–ç®¡ç†1. Conan ä¾èµ–ç®¡ç†1.1 åˆ›å»ºæ„å»ºç›®å½•# Drogon ç¼–è¯‘æŒ‡å—mkdir buildcd build\n\n1.2 å®‰è£…ä¾èµ–åº“# Drogon ç¼–è¯‘æŒ‡å—conan profile detect --force# Drogon ç¼–è¯‘æŒ‡å—conan install .. ^  -s compiler=&quot;msvc&quot; ^  -s compiler.version=193 ^  -s compiler.cppstd=17 ^  -s build_type=Debug ^  --output-folder=. ^  --build=missing# Drogon ç¼–è¯‘æŒ‡å—conan install .. ^  -s compiler=&quot;msvc&quot; ^  -s compiler.version=193 ^  -s compiler.cppstd=17 ^  -s build_type=Release ^  --output-folder=. ^  --build=missing\n\n1.3 Conan é…ç½®è¯´æ˜\ncompiler&#x3D;â€msvcâ€: ä½¿ç”¨ Microsoft Visual C++ ç¼–è¯‘å™¨\ncompiler.version&#x3D;193: VS2022 ç¼–è¯‘å™¨ç‰ˆæœ¬ï¼ˆ193å¯¹åº”VS2022ï¼‰\ncompiler.cppstd&#x3D;17: C++17 æ ‡å‡†\nbuild_type&#x3D;Debug&#x2F;Release: æ„å»ºç±»å‹\nâ€“build&#x3D;missing: è‡ªåŠ¨æ„å»ºç¼ºå¤±çš„ä¾èµ–\nâ€“output-folder&#x3D;.: è¾“å‡ºåˆ°å½“å‰ç›®å½•\n\n1.4 ç¼–è¾‘ conanfile.txt# Drogon ç¼–è¯‘æŒ‡å—[requires]# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—[generators]cmakecmake_find_package[options]# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—\n\n2. vcpkg ä¾èµ–ç®¡ç†ï¼ˆå¯é€‰ï¼‰2.1 å®‰è£… vcpkg# Drogon ç¼–è¯‘æŒ‡å—git clone https://github.com/microsoft/vcpkg.gitcd vcpkg.\\bootstrap-vcpkg.bat# Drogon ç¼–è¯‘æŒ‡å—.\\vcpkg install drogon:x64-windows\n\n2.2 é…ç½® CMake ä½¿ç”¨ vcpkgcmake .. -DCMAKE_TOOLCHAIN_FILE=D:/vcpkg/scripts/buildsystems/vcpkg.cmake\n\nç¼–è¯‘å®‰è£…1. åŸºç¡€ç¼–è¯‘1.1 ä»…ç¼–è¯‘ï¼ˆä¸å®‰è£…ï¼‰# Drogon ç¼–è¯‘æŒ‡å—cmake .. ^  -DCMAKE_BUILD_TYPE=Debug ^  -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot; ^  -DCMAKE_POLICY_DEFAULT_CMP0091=NEW# Drogon ç¼–è¯‘æŒ‡å—cmake --build . --parallel\n\n1.2 ç¼–è¯‘å‚æ•°è¯´æ˜\nCMAKE_BUILD_TYPE: Debug&#x2F;Release&#x2F;RelWithDebInfo&#x2F;MinSizeRel\nCMAKE_TOOLCHAIN_FILE: Conan ç”Ÿæˆçš„å·¥å…·é“¾æ–‡ä»¶\nCMAKE_POLICY_DEFAULT_CMP0091&#x3D;NEW: å¤„ç† MSVC è¿è¡Œæ—¶åº“ç­–ç•¥\n\n2. å®Œæ•´ç¼–è¯‘å¹¶å®‰è£…2.1 è®¾ç½®å®‰è£…è·¯å¾„# Drogon ç¼–è¯‘æŒ‡å—set INSTALL_PREFIX=D:\\Development\\drogon# Drogon ç¼–è¯‘æŒ‡å—cmake .. ^  -DCMAKE_BUILD_TYPE=Debug ^  -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot; ^  -DCMAKE_POLICY_DEFAULT_CMP0091=NEW ^  -DCMAKE_INSTALL_PREFIX=&quot;%INSTALL_PREFIX%&quot;\n\n2.2 ç¼–è¯‘å¹¶å®‰è£…# Drogon ç¼–è¯‘æŒ‡å—cmake --build . --parallel --target install# Drogon ç¼–è¯‘æŒ‡å—cmake --build . --config Debug --target install\n\n3. å¤šç‰ˆæœ¬ç¼–è¯‘3.1 Debug å’Œ Release ç‰ˆæœ¬# Drogon ç¼–è¯‘æŒ‡å—mkdir build-debug build-release# Drogon ç¼–è¯‘æŒ‡å—cd build-debugconan install .. -s build_type=Debug --output-folder=. --build=missingcmake .. -DCMAKE_BUILD_TYPE=Debug -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot; -DCMAKE_INSTALL_PREFIX=&quot;D:/Development/drogon/debug&quot;cmake --build . --parallel --target install# Drogon ç¼–è¯‘æŒ‡å—cd ../build-releaseconan install .. -s build_type=Release --output-folder=. --build=missingcmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot; -DCMAKE_INSTALL_PREFIX=&quot;D:/Development/drogon/release&quot;cmake --build . --parallel --target install\n\n3.2 é™æ€åº“å’ŒåŠ¨æ€åº“# Drogon ç¼–è¯‘æŒ‡å—cmake .. -DBUILD_SHARED_LIBS=OFF -DCMAKE_INSTALL_PREFIX=&quot;D:/Development/drogon/static&quot;# Drogon ç¼–è¯‘æŒ‡å—cmake .. -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=&quot;D:/Development/drogon/shared&quot;\n\nå®‰è£…ç»“æœ1. å®‰è£…çš„æ–‡ä»¶ç»“æ„1.1 é»˜è®¤å®‰è£…ç»“æ„D:\\Development\\drogon\\â”œâ”€â”€ include\\                 # å¤´æ–‡ä»¶â”‚   â”œâ”€â”€ drogon\\              # Drogon ä¸»æ¡†æ¶å¤´æ–‡ä»¶â”‚   â””â”€â”€ trantor\\             # Trantor ç½‘ç»œåº“å¤´æ–‡ä»¶â”œâ”€â”€ bin\\                     # å¯æ‰§è¡Œæ–‡ä»¶å’ŒåŠ¨æ€åº“â”‚   â”œâ”€â”€ drogon.dll           # Drogon ä¸»åº“â”‚   â”œâ”€â”€ trantor.dll          # Trantor ç½‘ç»œåº“â”‚   â””â”€â”€ drogon_ctl.exe       # å‘½ä»¤è¡Œå·¥å…·â”œâ”€â”€ lib\\                     # é™æ€åº“â”‚   â”œâ”€â”€ drogon.lib           # Drogon é™æ€åº“â”‚   â””â”€â”€ trantor.lib          # Trantor é™æ€åº“â””â”€â”€ lib\\cmake\\               # CMake é…ç½®æ–‡ä»¶    â”œâ”€â”€ Drogon\\              # Drogon CMake é…ç½®    â””â”€â”€ Trantor\\             # Trantor CMake é…ç½®\n\n1.2 å…³é”®æ–‡ä»¶è¯´æ˜\ndrogon.dll: Drogon ä¸»åº“åŠ¨æ€é“¾æ¥åº“\ntrantor.dll: Trantor ç½‘ç»œåº“åŠ¨æ€é“¾æ¥åº“\ndrogon_ctl.exe: Drogon å‘½ä»¤è¡Œå·¥å…·\ndrogon.lib: Drogon é™æ€é“¾æ¥åº“\ntrantor.lib: Trantor é™æ€é“¾æ¥åº“\n\n2. ç¯å¢ƒå˜é‡é…ç½®2.1 æ·»åŠ åˆ° PATH# Drogon ç¼–è¯‘æŒ‡å—set PATH=%PATH%;D:\\Development\\drogon\\bin# Drogon ç¼–è¯‘æŒ‡å—setx PATH &quot;%PATH%;D:\\Development\\drogon\\bin&quot;setx DROGON_ROOT &quot;D:\\Development\\drogon&quot;\n\n2.2 æ·»åŠ  CMake è·¯å¾„# Drogon ç¼–è¯‘æŒ‡å—setx CMAKE_PREFIX_PATH &quot;%CMAKE_PREFIX_PATH%;D:\\Development\\drogon\\lib\\cmake&quot;\n\n2.3 ç³»ç»Ÿç¯å¢ƒå˜é‡è®¾ç½®\næŒ‰ Win + Rï¼Œè¾“å…¥ sysdm.cpl\né€‰æ‹©â€é«˜çº§â€é€‰é¡¹å¡\nç‚¹å‡»â€ç¯å¢ƒå˜é‡â€\nåœ¨â€ç³»ç»Ÿå˜é‡â€ä¸­æ·»åŠ ï¼š\nDROGON_ROOT: D:\\Development\\drogon\nPATH: æ·»åŠ  %DROGON_ROOT%\\bin\n\n\n\néªŒè¯å®‰è£…1. åŸºæœ¬éªŒè¯1.1 æ£€æŸ¥å®‰è£…æ–‡ä»¶# Drogon ç¼–è¯‘æŒ‡å—dir D:\\Development\\drogon\\include\\drogon# Drogon ç¼–è¯‘æŒ‡å—dir D:\\Development\\drogon\\bin\\*.dlldir D:\\Development\\drogon\\lib\\*.lib# Drogon ç¼–è¯‘æŒ‡å—dir D:\\Development\\drogon\\bin\\drogon_ctl.exe\n\n1.2 æµ‹è¯•å‘½ä»¤è¡Œå·¥å…·# Drogon ç¼–è¯‘æŒ‡å—drogon_ctl --versiondrogon_ctl --help# Drogon ç¼–è¯‘æŒ‡å—drogon_ctl create project test_projectcd test_project\n\n2. ç¼–è¯‘æµ‹è¯•é¡¹ç›®2.1 åˆ›å»ºæµ‹è¯•é¡¹ç›®# Drogon ç¼–è¯‘æŒ‡å—drogon_ctl create project hello_drogoncd hello_drogon# Drogon ç¼–è¯‘æŒ‡å—mkdir buildcd buildcmake .. -DCMAKE_PREFIX_PATH=D:\\Development\\drogoncmake --build . --config Debug\n\n2.2 è¿è¡Œæµ‹è¯•é¡¹ç›®# Drogon ç¼–è¯‘æŒ‡å—Debug\\hello_drogon.exe# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—\n\n2.3 æµ‹è¯• HTTP è¯·æ±‚# Drogon ç¼–è¯‘æŒ‡å—curl http://localhost:8080# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—\n\né¡¹ç›®é…ç½®1. CMake é¡¹ç›®é…ç½®1.1 åŸºæœ¬é¡¹ç›®é…ç½®cmake_minimum_required(VERSION 3.15)project(MyDrogonApp)# Drogon ç¼–è¯‘æŒ‡å—set(CMAKE_CXX_STANDARD 17)set(CMAKE_CXX_STANDARD_REQUIRED ON)# Drogon ç¼–è¯‘æŒ‡å—find_package(Drogon REQUIRED)# Drogon ç¼–è¯‘æŒ‡å—add_executable(my_app main.cc)# Drogon ç¼–è¯‘æŒ‡å—target_link_libraries(my_app Drogon::Drogon)\n\n1.2 å®Œæ•´é¡¹ç›®é…ç½®cmake_minimum_required(VERSION 3.15)project(MyDrogonApp)# Drogon ç¼–è¯‘æŒ‡å—set(CMAKE_CXX_STANDARD 17)set(CMAKE_CXX_STANDARD_REQUIRED ON)# Drogon ç¼–è¯‘æŒ‡å—set(DROGON_ROOT &quot;D:/Development/drogon&quot;)set(CMAKE_PREFIX_PATH $&#123;CMAKE_PREFIX_PATH&#125; $&#123;DROGON_ROOT&#125;)# Drogon ç¼–è¯‘æŒ‡å—find_package(Drogon REQUIRED)# Drogon ç¼–è¯‘æŒ‡å—add_executable(my_app    src/main.cc    src/controllers/HomeController.cc    src/models/User.cc)# Drogon ç¼–è¯‘æŒ‡å—target_include_directories(my_app PRIVATE    $&#123;DROGON_ROOT&#125;/include)# Drogon ç¼–è¯‘æŒ‡å—target_link_libraries(my_app Drogon::Drogon)# Drogon ç¼–è¯‘æŒ‡å—if(WIN32)    add_custom_command(TARGET my_app POST_BUILD        COMMAND $&#123;CMAKE_COMMAND&#125; -E copy_if_different        $&#123;DROGON_ROOT&#125;/bin/drogon.dll        $&#123;DROGON_ROOT&#125;/bin/trantor.dll        $&lt;TARGET_FILE_DIR:my_app&gt;    )endif()\n\n2. Visual Studio é¡¹ç›®é…ç½®2.1 é¡¹ç›®å±æ€§è®¾ç½®\nå³é”®é¡¹ç›® â†’ å±æ€§\né…ç½®å±æ€§ â†’ C&#x2F;C++ â†’ å¸¸è§„\né™„åŠ åŒ…å«ç›®å½•: D:\\Development\\drogon\\include\n\n\né…ç½®å±æ€§ â†’ é“¾æ¥å™¨ â†’ å¸¸è§„\né™„åŠ åº“ç›®å½•: D:\\Development\\drogon\\lib\n\n\né…ç½®å±æ€§ â†’ é“¾æ¥å™¨ â†’ è¾“å…¥\né™„åŠ ä¾èµ–é¡¹: drogon.lib;trantor.lib;\n\n\n\n2.2 ç¯å¢ƒå˜é‡è®¾ç½®# Drogon ç¼–è¯‘æŒ‡å—set DROGON_ROOT=D:\\Development\\drogonset PATH=%PATH%;%DROGON_ROOT%\\bin\n\n3. ä»£ç ç¤ºä¾‹3.1 ç®€å•çš„ HTTP æœåŠ¡å™¨// main.cc#include &lt;drogon/drogon.h&gt;using namespace drogon;int main() &#123;    app().setLogPath(&quot;./&quot;)        .setLogLevel(trantor::Logger::kWarn)        .addListener(&quot;0.0.0.0&quot;, 8080)        .setThreadNum(16);    // æ·»åŠ è·¯ç”±    app().registerHandler(        &quot;/&quot;,        [](const HttpRequestPtr &amp;req,           std::function&lt;void(const HttpResponsePtr &amp;)&gt; &amp;&amp;callback) &#123;            auto resp = HttpResponse::newHttpResponse();            resp-&gt;setBody(&quot;Hello, Drogon!&quot;);            resp-&gt;setContentTypeCode(CT_TEXT_HTML);            callback(resp);        &#125;,        &#123;Get&#125;    );    LOG_INFO &lt;&lt; &quot;Server running on port 8080&quot;;    app().run();    return 0;&#125;\n\n3.2 æ§åˆ¶å™¨ç¤ºä¾‹// controllers/HomeController.h#pragma once#include &lt;drogon/HttpController.h&gt;using namespace drogon;namespace api &#123;class HomeController : public HttpController&lt;HomeController&gt; &#123;public:    METHOD_LIST_BEGIN    METHOD_ADD(HomeController::index, &quot;/&quot;, Get);    METHOD_ADD(HomeController::hello, &quot;/hello&quot;, Get);    METHOD_LIST_END    void index(const HttpRequestPtr &amp;req,               std::function&lt;void(const HttpResponsePtr &amp;)&gt; &amp;&amp;callback);    void hello(const HttpRequestPtr &amp;req,               std::function&lt;void(const HttpResponsePtr &amp;)&gt; &amp;&amp;callback,               const std::string &amp;name);&#125;;&#125;\n\n// controllers/HomeController.cc#include &quot;HomeController.h&quot;#include &lt;drogon/HttpResponse.h&gt;using namespace drogon;using namespace api;void HomeController::index(const HttpRequestPtr &amp;req,                          std::function&lt;void(const HttpResponsePtr &amp;)&gt; &amp;&amp;callback) &#123;    auto resp = HttpResponse::newHttpResponse();    resp-&gt;setBody(&quot;&lt;h1&gt;Welcome to Drogon!&lt;/h1&gt;&quot;);    resp-&gt;setContentTypeCode(CT_TEXT_HTML);    callback(resp);&#125;void HomeController::hello(const HttpRequestPtr &amp;req,                           std::function&lt;void(const HttpResponsePtr &amp;)&gt; &amp;&amp;callback,                           const std::string &amp;name) &#123;    Json::Value ret;    ret[&quot;message&quot;] = &quot;Hello, &quot; + name + &quot;!&quot;;    auto resp = HttpResponse::newHttpJsonResponse(ret);    callback(resp);&#125;\n\nå¸¸è§é—®é¢˜Q1: ç¼–è¯‘å™¨ç‰ˆæœ¬ä¸åŒ¹é…é—®é¢˜: æç¤º â€œMSVC version not supportedâ€ æˆ–ç¼–è¯‘å™¨ç‰ˆæœ¬é”™è¯¯\nè§£å†³æ–¹æ¡ˆ:\n# Drogon ç¼–è¯‘æŒ‡å—cl# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—conan profile update settings.compiler.version=192 default  # VS2019conan profile update settings.compiler.version=193 default  # VS2022\n\nQ2: CMake é…ç½®é”™è¯¯é—®é¢˜: CMake æ‰¾ä¸åˆ° Conan ç”Ÿæˆçš„å·¥å…·é“¾æ–‡ä»¶\nè§£å†³æ–¹æ¡ˆ:\n# Drogon ç¼–è¯‘æŒ‡å—dir conan_toolchain.cmake# Drogon ç¼–è¯‘æŒ‡å—conan install .. --output-folder=. --build=missing# Drogon ç¼–è¯‘æŒ‡å—cmake .. -DCMAKE_TOOLCHAIN_FILE=&quot;%CD%\\conan_toolchain.cmake&quot;\n\nQ3: ä¾èµ–åº“ç¼ºå¤±é—®é¢˜: ç¼–è¯‘æ—¶æç¤ºæ‰¾ä¸åˆ°æŸäº›åº“æ–‡ä»¶\nè§£å†³æ–¹æ¡ˆ:\n# Drogon ç¼–è¯‘æŒ‡å—conan install .. --build=missing# Drogon ç¼–è¯‘æŒ‡å—# Drogon ç¼–è¯‘æŒ‡å—[requires]openssl/1.1.1qzlib/1.2.11\n\nQ4: é“¾æ¥é”™è¯¯é—®é¢˜: é“¾æ¥æ—¶æç¤º â€œunresolved external symbolâ€\nè§£å†³æ–¹æ¡ˆ:\n# Drogon ç¼–è¯‘æŒ‡å—cmake .. -DCMAKE_BUILD_TYPE=Debug -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot;# Drogon ç¼–è¯‘æŒ‡å—rm -rf *conan install .. --output-folder=. --build=missingcmake .. -DCMAKE_BUILD_TYPE=Debug -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot;cmake --build . --config Debug --target install\n\nQ5: è¿è¡Œæ—¶é”™è¯¯é—®é¢˜: ç¨‹åºè¿è¡Œæ—¶æç¤º â€œæ‰¾ä¸åˆ° drogon.dllâ€\nè§£å†³æ–¹æ¡ˆ:\n# Drogon ç¼–è¯‘æŒ‡å—echo %PATH%# Drogon ç¼–è¯‘æŒ‡å—copy D:\\Development\\drogon\\bin\\*.dll .\\# Drogon ç¼–è¯‘æŒ‡å—set PATH=%PATH%;D:\\Development\\drogon\\bin\n\nQ6: Python å’Œ pip é—®é¢˜é—®é¢˜: pip å®‰è£… Conan å¤±è´¥æˆ–é€Ÿåº¦æ…¢\nè§£å†³æ–¹æ¡ˆ:\n# Drogon ç¼–è¯‘æŒ‡å—python -m pip install --upgrade pip# Drogon ç¼–è¯‘æŒ‡å—pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple# Drogon ç¼–è¯‘æŒ‡å—pip config list\n\næœ€ä½³å®è·µ1. å¼€å‘ç¯å¢ƒé…ç½®1.1 è‡ªåŠ¨åŒ–è„šæœ¬@echo offREM install_drogon.batsetlocalset WORK_DIR=D:\\Development\\drogonset BUILD_TYPE=Debugecho Installing Drogon...echo 1. Creating directories...mkdir &quot;%WORK_DIR%&quot; 2&gt;nulcd &quot;%WORK_DIR%&quot;echo 2. Cloning source code...if not exist &quot;drogon&quot; (    git clone https://github.com/drogonframework/drogon    cd drogon    git submodule update --init --recursive) else (    cd drogon)echo 3. Installing dependencies...mkdir build 2&gt;nulcd buildconan profile detect --forceconan install .. -s build_type=%BUILD_TYPE% --output-folder=. --build=missingecho 4. Building and installing...cmake .. -DCMAKE_BUILD_TYPE=%BUILD_TYPE% -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot; -DCMAKE_INSTALL_PREFIX=&quot;%WORK_DIR%&quot;cmake --build . --parallel --target installecho 5. Setting environment variables...setx DROGON_ROOT &quot;%WORK_DIR%&quot;setx PATH &quot;%PATH%;%WORK_DIR%\\bin&quot;echo Installation completed successfully!endlocal\n\n1.2 å¼€å‘ç¯å¢ƒæ£€æŸ¥@echo offREM check_env.batecho Checking Drogon development environment...echo 1. Checking Visual Studio...cl &gt;nul 2&gt;&amp;1if %errorlevel% equ 0 (    echo Visual Studio: OK) else (    echo Visual Studio: NOT FOUND    echo Please run this script from Visual Studio Developer Command Prompt    exit /b 1)echo 2. Checking CMake...cmake --version &gt;nul 2&gt;&amp;1if %errorlevel% equ 0 (    echo CMake: OK) else (    echo CMake: NOT FOUND    exit /b 1)echo 3. Checking Conan...conan --version &gt;nul 2&gt;&amp;1if %errorlevel% equ 0 (    echo Conan: OK) else (    echo Conan: NOT FOUND    echo Run: pip install conan    exit /b 1)echo 4. Checking Drogon installation...if exist &quot;%DROGON_ROOT%\\bin\\drogon_ctl.exe&quot; (    echo Drogon: OK    drogon_ctl --version) else (    echo Drogon: NOT FOUND    echo Please run install_drogon.bat first    exit /b 1)echo All checks passed!\n\n2. é¡¹ç›®ç®¡ç†2.1 ç‰ˆæœ¬ç®¡ç†# Drogon ç¼–è¯‘æŒ‡å—git clone https://github.com/drogonframework/drogoncd drogongit checkout v1.8.4  # åˆ‡æ¢åˆ°ç¨³å®šç‰ˆæœ¬git submodule update --init --recursive\n\n2.2 å¤šé¡¹ç›®é…ç½®# Drogon ç¼–è¯‘æŒ‡å—set(DROGON_ROOT &quot;D:/Work/Development/Projects/ThirdParty/drogon&quot;)set(CMAKE_PREFIX_PATH $&#123;CMAKE_PREFIX_PATH&#125; $&#123;DROGON_ROOT&#125;)find_package(Drogon REQUIRED)message(STATUS &quot;Found Drogon: $&#123;Drogon_VERSION&#125;&quot;)\n\n3. æ€§èƒ½ä¼˜åŒ–3.1 ç¼–è¯‘ä¼˜åŒ–# Drogon ç¼–è¯‘æŒ‡å—conan install .. -s build_type=Release --output-folder=. --build=missingcmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot;cmake --build . --config Release --target install# Drogon ç¼–è¯‘æŒ‡å—cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_TOOLCHAIN_FILE=&quot;conan_toolchain.cmake&quot; -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON\n\n3.2 è¿è¡Œæ—¶ä¼˜åŒ–// åœ¨åº”ç”¨å¯åŠ¨æ—¶é…ç½®app().setThreadNum(std::thread::hardware_concurrency())  // ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ     .setIoLoopNum(4)                                   // è®¾ç½®I/Oå¾ªç¯æ•°é‡     .setUseGzip(true)                                 // å¯ç”¨Gzipå‹ç¼©     .setMaxConnectionNum(10000)                      // æœ€å¤§è¿æ¥æ•°     .setIdleConnectionTimeout(60);                   // ç©ºé—²è¿æ¥è¶…æ—¶\n\nè®°ä½ï¼šDrogon æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ C++ Web æ¡†æ¶ï¼Œæ­£ç¡®çš„ç¼–è¯‘å®‰è£…æ˜¯å¼€å§‹å¼€å‘çš„åŸºç¡€ã€‚å»ºè®®åœ¨å¼€å‘ç¯å¢ƒä¸­å……åˆ†æµ‹è¯•åå†éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼\n","categories":["C++æ ¸å¿ƒå¼€å‘","ç³»ç»Ÿåº“ä¸æ¡†æ¶"],"tags":["C++","Windows","Drogon","Webæ¡†æ¶","ç¼–è¯‘å®‰è£…"]},{"title":"Claude MCP é…ç½®æŒ‡å—","url":"/posts/361d35d7/","content":"Claude MCP é…ç½®æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: claude-code, mcp, model-context-protocol, productivity, automation\n\nğŸ“‘ ç›®å½•\n1. MCP æ¦‚è¿°\n2. å¿…è£… MCP æœåŠ¡å™¨\n3. æ¨èç»„åˆ\n4. é…ç½®æ­¥éª¤\n5. Top 15 MCP æœåŠ¡å™¨\n6. æ•…éšœæ’é™¤\n\n\n1. ğŸ“– MCP æ¦‚è¿°MCP (Model Context Protocol) æ˜¯ Claude Code çš„æ‰©å±•åè®®ï¼Œå…è®¸ AI åŠ©æ‰‹ç›´æ¥æ§åˆ¶å„ç§å·¥å…·å’ŒæœåŠ¡ã€‚\nğŸ¯ MCP ä¼˜åŠ¿\nâœ… æ‰©å±•èƒ½åŠ› - å¤§å¹…æ‰©å±• Claude çš„åŠŸèƒ½èŒƒå›´\nâœ… è‡ªåŠ¨åŒ– - å®ç°å¤æ‚çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ\nâœ… é›†æˆæ€§ - è¿æ¥å„ç§ç¬¬ä¸‰æ–¹æœåŠ¡å’Œå·¥å…·\nâœ… å®æ—¶æ€§ - è·å–æœ€æ–°çš„ API æ–‡æ¡£å’Œä»£ç ç¤ºä¾‹\n\n\n2. â­ å¿…è£… MCP æœåŠ¡å™¨2.1 ğŸŒ Playwright MCP - æµè§ˆå™¨è‡ªåŠ¨åŒ–åŠŸèƒ½: è®© Claude ç›´æ¥æ§åˆ¶æµè§ˆå™¨è¿›è¡Œæµ‹è¯•ã€æˆªå›¾ã€æ•°æ®çˆ¬å–\n# Claude MCP é…ç½®æŒ‡å—claude mcp add playwright -s user -- npx @playwright/mcp@latest# Claude MCP é…ç½®æŒ‡å—claude mcp list\n\né€‚ç”¨åœºæ™¯:\n\nğŸ”„ è‡ªåŠ¨åŒ–æµ‹è¯•\nğŸ“¸ ç½‘é¡µæˆªå›¾\nğŸ•·ï¸ ç½‘é¡µæ•°æ®çˆ¬å–\nğŸ¯ UI äº¤äº’æµ‹è¯•\n\n2.2 ğŸ“š Context7 MCP - æ–‡æ¡£å®æ—¶æŸ¥è¯¢åŠŸèƒ½: è·å–å„ç§ç¼–ç¨‹åº“çš„æœ€æ–°æ–‡æ¡£å’Œä»£ç ç¤ºä¾‹\n# Claude MCP é…ç½®æŒ‡å—claude mcp add context7 -- npx -y @upstash/context7-mcp# Claude MCP é…ç½®æŒ‡å—claude mcp add context7 -s user -- npx -y @upstash/context7-mcp\n\né€‚ç”¨åœºæ™¯:\n\nğŸ” API é›†æˆå¼€å‘\nğŸ“– ç¼–ç¨‹å­¦ä¹ \nğŸ’¡ ä»£ç ç¤ºä¾‹æŸ¥æ‰¾\nğŸ†• æ–°æŠ€æœ¯æ¢ç´¢\n\n2.3 ğŸ–¥ï¸ Filesystem MCP - æ–‡ä»¶ç³»ç»Ÿæ“ä½œåŠŸèƒ½: è¯»å†™å’Œç®¡ç†æœ¬åœ°æ–‡ä»¶ã€æ–‡ä»¶å¤¹ï¼Œæ‰¹é‡æ“ä½œ\n# Claude MCP é…ç½®æŒ‡å—npm install -g @modelcontextprotocol/server-filesystem\n\né€‚ç”¨åœºæ™¯:\n\nğŸ“ ä»£ç åˆ†æ\nğŸ“„ æ–‡æ¡£ç”Ÿæˆ\nğŸ’¾ è‡ªåŠ¨å¤‡ä»½\nğŸ”„ æ‰¹é‡æ–‡ä»¶å¤„ç†\n\n2.4 ğŸ”§ Git MCP - ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½: æ‰§è¡Œ Git å‘½ä»¤ï¼Œç®¡ç†ç‰ˆæœ¬æ§åˆ¶\n# Claude MCP é…ç½®æŒ‡å—npm install -g @modelcontextprotocol/server-github\n\né€‚ç”¨åœºæ™¯:\n\nğŸ“Š ç‰ˆæœ¬ç®¡ç†\nğŸš€ è‡ªåŠ¨åŒ–éƒ¨ç½²\nğŸ‘¥ å›¢é˜Ÿåä½œ\nğŸ” ä»£ç å®¡æŸ¥\n\n2.5 ğŸ—ƒï¸ Database MCP - æ•°æ®åº“è¿æ¥åŠŸèƒ½: è¿æ¥å’Œç®¡ç†å¤šç§æ•°æ®åº“\n# Claude MCP é…ç½®æŒ‡å—npm install -g @modelcontextprotocol/server-postgres\n\né€‚ç”¨åœºæ™¯:\n\nğŸ—„ï¸ æ•°æ®åº“ç®¡ç†\nğŸ“Š æ•°æ®åˆ†æ\nğŸ” SQL æŸ¥è¯¢\nğŸ’¿ æ•°æ®è¿ç§»\n\n\n3. ğŸ¯ æ¨èç»„åˆ3.1 ğŸ“± æŒ‰è§’è‰²åˆ†ç±»graph TD    A[å¼€å‘è€…è§’è‰²] --&gt; B[å‰ç«¯å¼€å‘è€…]    A --&gt; C[åç«¯å¼€å‘è€…]    A --&gt; D[æ•°æ®åˆ†æå¸ˆ]    A --&gt; E[å…¨æ ˆå¼€å‘è€…]    B --&gt; B1[Filesystem + Git + Figma]    C --&gt; C1[Git + Prisma + FastAPI]    D --&gt; D1[Context7 + Python + Database]    E --&gt; E1[Filesystem + Git + Pipedream]\n\n3.2 ğŸ“¦ 5ä¸ªå¿…è£…ç»„åˆåŸºäº2025å¹´ä½¿ç”¨ç»Ÿè®¡ï¼Œä»¥ä¸‹ MCP æœåŠ¡å™¨è¦†ç›–90%çš„æ—¥å¸¸éœ€æ±‚ï¼š\n\n@modelcontextprotocol&#x2F;server-filesystem - æ–‡ä»¶ç³»ç»Ÿè®¿é—®\n@modelcontextprotocol&#x2F;server-github - GitHub é›†æˆ\n@modelcontextprotocol&#x2F;server-postgres - æ•°æ®åº“è¿æ¥\n@modelcontextprotocol&#x2F;server-slack - å›¢é˜Ÿåä½œ\n@modelcontextprotocol&#x2F;server-kubernetes - å®¹å™¨ç®¡ç†\n\n\n4. âš™ï¸ é…ç½®æ­¥éª¤4.1 ğŸ” æ­¥éª¤1: å®‰è£… MCP æœåŠ¡å™¨# Claude MCP é…ç½®æŒ‡å—npm install -g @modelcontextprotocol/server-browserkit \\  @modelcontextprotocol/server-ollama \\  @modelcontextprotocol/server-filesystem \\  @modelcontextprotocol/server-github \\  @modelcontextprotocol/server-postgres\n\n4.2 ğŸ“ æ­¥éª¤2: é…ç½® Claude Code CLIClaude Code CLI çš„é…ç½®æ–‡ä»¶ä½äºï¼š\n\nmacOS &#x2F; Linux: ~/.config/claude/claude_desktop_config.json\nWindows: %USERPROFILE%\\.claude.json\n\n4.3 ğŸ“„ æ­¥éª¤3: é…ç½®ç¤ºä¾‹&#123;  &quot;mcpServers&quot;: &#123;    &quot;browserkit&quot;: &#123;      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [        &quot;-y&quot;,        &quot;@modelcontextprotocol/server-browserkit&quot;      ]    &#125;,    &quot;ollama&quot;: &#123;      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [        &quot;-y&quot;,        &quot;@modelcontextprotocol/server-ollama&quot;      ]    &#125;,    &quot;filesystem&quot;: &#123;      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [        &quot;-y&quot;,        &quot;@modelcontextprotocol/server-filesystem&quot;,        &quot;/path/to/allowed/directory&quot;      ]    &#125;,    &quot;github&quot;: &#123;      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [        &quot;-y&quot;,        &quot;@modelcontextprotocol/server-github&quot;      ]    &#125;  &#125;&#125;\n\n4.4 ğŸ”§ æ­¥éª¤4: ç‰¹æ®Šé…ç½®Xmind ç”Ÿæˆå™¨ MCP&#123;  &quot;mcpServers&quot;: &#123;    &quot;xmind&quot;: &#123;      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [&quot;xmind-generator-mcp&quot;],      &quot;env&quot;: &#123;        &quot;outputPath&quot;: &quot;E:/xmind_generator_mcp_path&quot;,        &quot;autoOpenFile&quot;: &quot;false&quot;      &#125;    &#125;  &#125;&#125;\n\nOffice Word MCP# Claude MCP é…ç½®æŒ‡å—claude mcp add office-word -s user -- uvx --from office-word-mcp-server word_mcp_server\n\n\n5. ğŸ“Š Top 15 MCP æœåŠ¡å™¨\n\n\næ’å\nåç§°\nStaræ•°\næ ¸å¿ƒåŠŸèƒ½\næœ€ä½³åœºæ™¯\n\n\n\n1\nFilesystem MCP\n64,053 â­\nè¯»å†™&#x2F;ç®¡ç†æœ¬åœ°æ–‡ä»¶ã€æ–‡ä»¶å¤¹\nä»£ç åˆ†æã€æ–‡æ¡£ç”Ÿæˆã€è‡ªåŠ¨å¤‡ä»½\n\n\n2\nGit MCP\n64,053 â­\næ‰§è¡Œgitå‘½ä»¤ï¼ŒæŸ¥çœ‹å†å²å’Œå·®å¼‚\nç‰ˆæœ¬ç®¡ç†ã€è‡ªåŠ¨åŒ–éƒ¨ç½²ã€å›¢é˜Ÿåä½œ\n\n\n3\nPrisma MCP\n43,499 â­\nç®¡ç†Prismaæ•°æ®åº“æ¨¡å¼\nWebå¼€å‘ã€æ•°æ®åº“è®¾è®¡\n\n\n4\nContext7 MCP\n25,610 â­\nè·å–æœ€æ–°åº“æ–‡æ¡£å’Œä»£ç ç¤ºä¾‹\nAPIé›†æˆã€ç¼–ç¨‹å­¦ä¹ \n\n\n5\nGitHub MCP\n20,923 â­\nç®¡ç†ä»“åº“ã€PRå’ŒIssues\nå¼€æºé¡¹ç›®ç®¡ç†ã€CI&#x2F;CD\n\n\n6\nTask Master\n20,520 â­\næ™ºèƒ½ä»»åŠ¡åˆ†è§£å’Œä¼˜å…ˆçº§ç®¡ç†\né¡¹ç›®ç®¡ç†ã€æ•æ·å¼€å‘\n\n\n7\nRepomix\n18,511 â­\nå‹ç¼©ä»£ç åº“ä¸ºAIå‹å¥½æ ¼å¼\nå¤§å‹ä»£ç å®¡æŸ¥ã€æ¶æ„åˆ†æ\n\n\n8\nBlenderMCP\n12,829 â­\næ§åˆ¶Blenderè¿›è¡Œ3Då»ºæ¨¡\næ¸¸æˆå¼€å‘ã€3Dè®¾è®¡\n\n\n9\nmcp-run-python\n11,603 â­\nå®‰å…¨è¿è¡ŒPythonä»£ç \nç®—æ³•éªŒè¯ã€æ•°æ®åˆ†æ\n\n\n10\nPipedream\n10,139 â­\nè¿æ¥2500+åº”ç”¨å’ŒAPI\nä¸šåŠ¡æµç¨‹è‡ªåŠ¨åŒ–ã€æ•°æ®åŒæ­¥\n\n\n11\nFigma MCP\n9,891 â­\nè¯»å–Figmaè®¾è®¡ï¼Œç”Ÿæˆå‰ç«¯ä»£ç \nUI&#x2F;UXå¼€å‘ã€è®¾è®¡è½¬ä»£ç \n\n\n12\næ•°æ®åº“MCPå·¥å…·ç®±\n9,229 â­\næ”¯æŒå¤šæ•°æ®åº“æŸ¥è¯¢å’Œä¼˜åŒ–\næ•°æ®åº“ç®¡ç†ã€æ•°æ®åˆ†æ\n\n\n13\nSerena\n8,743 â­\nå¤§å‹ä»£ç åº“ç¬¦å·åŒ–åˆ†æ\nä»£ç é‡æ„ã€bugä¿®å¤\n\n\n14\nFastAPI-MCP\n7,857 â­\né›¶é…ç½®é›†æˆFastAPI\nAPIå¼€å‘ã€å¾®æœåŠ¡\n\n\n15\nFonoster MCP\n6,740 â­\nç®¡ç†ç”µè¯ç³»ç»Ÿ\nå®¢æœç³»ç»Ÿã€ç”µè¯è¥é”€\n\n\n\n6. ğŸ”§ æ•…éšœæ’é™¤6.1 âŒ å¸¸è§é—®é¢˜é—®é¢˜1: MCP æœåŠ¡å™¨æ— æ³•å¯åŠ¨# Claude MCP é…ç½®æŒ‡å—claude mcp list# Claude MCP é…ç½®æŒ‡å—claude mcp remove &lt;server-name&gt;claude mcp add &lt;server-name&gt; &lt;command&gt;\n\né—®é¢˜2: é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯// éªŒè¯ JSON æ ¼å¼&#123;  &quot;mcpServers&quot;: &#123;    &quot;server-name&quot;: &#123;      &quot;command&quot;: &quot;command-string&quot;,      &quot;args&quot;: [&quot;arg1&quot;, &quot;arg2&quot;]    &#125;  &#125;&#125;\n\né—®é¢˜3: æƒé™é—®é¢˜# Claude MCP é…ç½®æŒ‡å—ls -la ~/.claude.json# Claude MCP é…ç½®æŒ‡å—chmod 600 ~/.claude.json\n\n6.2 ğŸ› ï¸ è°ƒè¯•æŠ€å·§\næŸ¥çœ‹æ—¥å¿—: æ£€æŸ¥ Claude Code çš„æ—¥å¿—è¾“å‡º\næµ‹è¯•è¿æ¥: ä½¿ç”¨ç®€å•çš„å‘½ä»¤æµ‹è¯• MCP æœåŠ¡å™¨\né€æ­¥é…ç½®: ä¸€æ¬¡åªæ·»åŠ ä¸€ä¸ª MCP æœåŠ¡å™¨\nç‰ˆæœ¬æ£€æŸ¥: ç¡®ä¿æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬å…¼å®¹\n\n6.3 ğŸ“ è·å–å¸®åŠ©\nå®˜æ–¹æ–‡æ¡£: Claude Code MCP Documentation\nç¤¾åŒºæ”¯æŒ: GitHub Issues å’Œ Discussions\nç¤ºä¾‹é…ç½®: å®˜æ–¹ç¤ºä¾‹ä»“åº“\n\n\nğŸ“š æ‰©å±•èµ„æºğŸ”— ç›¸å…³é“¾æ¥\nMCP å®˜æ–¹æ–‡æ¡£\nClaude Code æŒ‡å—\nMCP æœåŠ¡å™¨åˆ—è¡¨\n\nğŸ¯ å­¦ä¹ è·¯å¾„\nåŸºç¡€é…ç½® - ä»ç®€å•çš„ Filesystem MCP å¼€å§‹\nåŠŸèƒ½æ‰©å±• - é€æ­¥æ·»åŠ ä¸“ä¸šé¢†åŸŸ MCP\nè‡ªå®šä¹‰å¼€å‘ - å­¦ä¹ å¼€å‘è‡ªå®šä¹‰ MCP æœåŠ¡å™¨\næœ€ä½³å®è·µ - æŒæ¡é«˜çº§é…ç½®å’Œä¼˜åŒ–æŠ€å·§\n\n\nğŸ“ˆ ä½¿ç”¨å»ºè®®ğŸ’¡ æ•ˆç‡æå‡æŠ€å·§\næŒ‰éœ€å®‰è£… - åªå®‰è£…å½“å‰é¡¹ç›®éœ€è¦çš„ MCP\nå®šæœŸæ›´æ–° - ä¿æŒ MCP æœåŠ¡å™¨ä¸ºæœ€æ–°ç‰ˆæœ¬\næ€§èƒ½ä¼˜åŒ– - ç›‘æ§ MCP æœåŠ¡å™¨èµ„æºä½¿ç”¨æƒ…å†µ\nå®‰å…¨è€ƒè™‘ - é™åˆ¶æ–‡ä»¶ç³»ç»Ÿè®¿é—®èŒƒå›´\n\nğŸ”„ å·¥ä½œæµä¼˜åŒ–graph LR    A[é¡¹ç›®åˆ†æ] --&gt; B[é€‰æ‹©åˆé€‚MCP]    B --&gt; C[é…ç½®æµ‹è¯•]    C --&gt; D[é›†æˆå·¥ä½œæµ]    D --&gt; E[æŒç»­ä¼˜åŒ–]    style A fill:#e1f5fe    style B fill:#f3e5f5    style C fill:#e8f5e8    style D fill:#fff3e0    style E fill:#fce4ec\n\n\n\nğŸ’¡ æç¤º: MCP é…ç½®æ˜¯ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ï¼Œå»ºè®®ä»åŸºç¡€åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥æ‰©å±•åˆ°å¤æ‚çš„è‡ªåŠ¨åŒ–å·¥ä½œæµã€‚å®šæœŸæ£€æŸ¥æ›´æ–°ä»¥è·å¾—æœ€æ–°åŠŸèƒ½å’Œå®‰å…¨ä¿®å¤ã€‚\n\n","categories":["å¼€å‘å·¥å…·"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Gemini CLI å’Œ Claude Code ä¸­é…ç½® GitHub MCP æœåŠ¡å™¨è¯¦è§£","url":"/posts/mcp-github-config/","content":"Gemini CLI å’Œ Claude Code ä¸­é…ç½® GitHub MCP æœåŠ¡å™¨è¯¦è§£\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-12-18æœ€åæ›´æ–°: 2025-12-18æ ‡ç­¾: github, mcp, gemini-cli, claude-code, http, stdio, ai-tools\n\nğŸ“‘ ç›®å½•\n1. MCPä¼ è¾“æ–¹å¼å¯¹æ¯”\n2. Gemini CLI çš„ MCP é…ç½®\n3. Claude Code çš„ MCP é…ç½®\n4. å®ç°å·®å¼‚è¯¦è§£\n5. æœ€ä½³å®è·µå»ºè®®\n6. æ•…éšœæ’é™¤\n7. æ€§èƒ½ä¼˜åŒ–\n8. æ€»ç»“\n\n\n1. ğŸ“– MCPä¼ è¾“æ–¹å¼å¯¹æ¯”MCPä¼ è¾“æ–¹å¼å¯¹æ¯”HTTP vs stdio ä¼ è¾“æ–¹å¼\n\n\nç‰¹æ€§\nHTTPä¼ è¾“\nstdioä¼ è¾“\n\n\n\nå®ç°å¤æ‚åº¦\nç›¸å¯¹ç®€å•\nè¾ƒç®€å•\n\n\nè°ƒè¯•ä¾¿åˆ©æ€§\nå®¹æ˜“è°ƒè¯•ï¼ˆå¯ç”¨curlç­‰å·¥å…·ï¼‰\nè°ƒè¯•è¾ƒå›°éš¾\n\n\nè·¨å¹³å°æ€§\nä¼˜ç§€\néœ€è€ƒè™‘æ¢è¡Œç¬¦é—®é¢˜\n\n\nå®‰å…¨è€ƒè™‘\néœ€è¦å¤„ç†è®¤è¯\né€šè¿‡stdin&#x2F;stdouté€šä¿¡\n\n\næ€§èƒ½\næœ‰ç½‘ç»œå¼€é”€\nç›´æ¥è¿›ç¨‹é€šä¿¡\n\n\næ‰©å±•æ€§\næ˜“äºé›†ç¾¤éƒ¨ç½²\nå•è¿›ç¨‹é™åˆ¶\n\n\nä¸€ã€Gemini CLI çš„ MCP é…ç½®1.1 HTTPæ–¹å¼é…ç½®HTTPæ–¹å¼é€‚åˆå·²ç»å®ç°äº†REST APIçš„MCPæœåŠ¡å™¨ï¼š\n&#123;  &quot;selectedAuthType&quot;: &quot;vertex-ai&quot;,  &quot;theme&quot;: &quot;GitHub&quot;,  &quot;mcpServers&quot;: &#123;    &quot;github-http&quot;: &#123;      &quot;type&quot;: &quot;http&quot;,      &quot;url&quot;: &quot;http://localhost:8080/mcp&quot;,      &quot;headers&quot;: &#123;        &quot;Authorization&quot;: &quot;Bearer $&#123;GITHUB_TOKEN&#125;&quot;,        &quot;Content-Type&quot;: &quot;application/json&quot;      &#125;    &#125;  &#125;&#125;\n\n1.2 stdioæ–¹å¼é…ç½®stdioæ–¹å¼é€‚åˆç›´æ¥å‘½ä»¤è¡Œå¯åŠ¨çš„MCPæœåŠ¡å™¨ï¼š\n&#123;  &quot;selectedAuthType&quot;: &quot;vertex-ai&quot;,  &quot;theme&quot;: &quot;GitHub&quot;,  &quot;mcpServers&quot;: &#123;    &quot;github-stdio&quot;: &#123;      &quot;type&quot;: &quot;stdio&quot;,      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [&quot;-y&quot;, &quot;@modelcontextprotocol/server-github&quot;],      &quot;env&quot;: &#123;        &quot;GITHUB_PERSONAL_ACCESS_TOKEN&quot;: &quot;$&#123;GITHUB_PERSONAL_ACCESS_TOKEN&#125;&quot;      &#125;    &#125;  &#125;&#125;\n\n1.3 æ··åˆé…ç½®ç¤ºä¾‹åŒæ—¶æ”¯æŒä¸¤ç§ä¼ è¾“æ–¹å¼ï¼š\n&#123;  &quot;selectedAuthType&quot;: &quot;vertex-ai&quot;,  &quot;theme&quot;: &quot;GitHub&quot;,  &quot;mcpServers&quot;: &#123;    &quot;github&quot;: &#123;      &quot;type&quot;: &quot;stdio&quot;,      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [&quot;-y&quot;, &quot;@modelcontextprotocol/server-github&quot;],      &quot;env&quot;: &#123;        &quot;GITHUB_PERSONAL_ACCESS_TOKEN&quot;: &quot;$&#123;GITHUB_PERSONAL_ACCESS_TOKEN&#125;&quot;      &#125;    &#125;,    &quot;github-fallback&quot;: &#123;      &quot;type&quot;: &quot;http&quot;,      &quot;url&quot;: &quot;http://localhost:8080/github-mcp&quot;,      &quot;headers&quot;: &#123;        &quot;Authorization&quot;: &quot;Bearer $&#123;GITHUB_TOKEN&#125;&quot;      &#125;    &#125;  &#125;&#125;\n\näºŒã€Claude Code çš„ MCP é…ç½®2.1 é…ç½®æ–‡ä»¶ä½ç½®Claude Codeæ”¯æŒå¤šä¸ªé…ç½®æ–‡ä»¶ä½ç½®ï¼š\n\nç”¨æˆ·çº§é…ç½®ï¼š~/.claude/claude_desktop_config.json\né¡¹ç›®çº§é…ç½®ï¼š.claude/claude_desktop_config.json\nä¸´æ—¶é…ç½®ï¼š./mcp.json\n\n2.2 HTTPæ–¹å¼é…ç½®&#123;  &quot;mcpServers&quot;: &#123;    &quot;github-api&quot;: &#123;      &quot;type&quot;: &quot;http&quot;,      &quot;url&quot;: &quot;https://api.github.com/mcp&quot;,      &quot;headers&quot;: &#123;        &quot;Authorization&quot;: &quot;Bearer $&#123;GITHUB_TOKEN&#125;&quot;,        &quot;X-GitHub-API-Version&quot;: &quot;2022-11-28&quot;      &#125;    &#125;  &#125;&#125;\n\n2.3 stdioæ–¹å¼é…ç½®&#123;  &quot;mcpServers&quot;: &#123;    &quot;github-cli&quot;: &#123;      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [&quot;-y&quot;, &quot;@modelcontextprotocol/server-github&quot;],      &quot;env&quot;: &#123;        &quot;GITHUB_PERSONAL_ACCESS_TOKEN&quot;: &quot;$&#123;GITHUB_PERSONAL_ACCESS_TOKEN&#125;&quot;      &#125;    &#125;  &#125;&#125;\n\n2.4 ä½¿ç”¨CLIå‘½ä»¤æ·»åŠ MCPClaude Codeæä¾›äº†ä¾¿æ·çš„CLIå‘½ä»¤ï¼š\n# æ·»åŠ HTTPç±»å‹çš„MCPæœåŠ¡å™¨claude mcp add --transport http \\  --name github-api \\  --url https://api.github.com/mcp \\  --env GITHUB_TOKEN=&quot;$&#123;GITHUB_TOKEN&#125;&quot;# æ·»åŠ stdioç±»å‹çš„MCPæœåŠ¡å™¨claude mcp add --transport stdio \\  --name github-cli \\  --command npx \\  --args &quot;-y&quot; &quot;@modelcontextprotocol/server-github&quot; \\  --env GITHUB_PERSONAL_ACCESS_TOKEN=&quot;$&#123;GITHUB_PERSONAL_ACCESS_TOKEN&#125;&quot;\n\nä¸‰ã€å®ç°å·®å¼‚è¯¦è§£3.1 æœåŠ¡å™¨ç«¯å®ç°HTTPæœåŠ¡å™¨ç¤ºä¾‹# github_mcp_http_server.pyfrom http.server import HTTPServer, BaseHTTPRequestHandlerimport jsonimport subprocessclass GitHubMCPHandler(BaseHTTPRequestHandler):    def do_POST(self):        content_length = int(self.headers[&#x27;Content-Length&#x27;])        post_data = self.rfile.read(content_length)        # å¤„ç†MCPè¯·æ±‚        response = self.handle_mcp_request(json.loads(post_data))        self.send_response(200)        self.send_header(&#x27;Content-type&#x27;, &#x27;application/json&#x27;)        self.end_headers()        self.wfile.write(json.dumps(response).encode())def handle_mcp_request(self, request):    # å®ç°MCPåè®®é€»è¾‘    if request.get(&#x27;method&#x27;) == &#x27;tools/list&#x27;:        return &#123;&#x27;tools&#x27;: list_available_tools()&#125;    elif request.get(&#x27;method&#x27;) == &#x27;tools/call&#x27;:        return execute_tool_call(request)    return &#123;&#125;if __name__ == &#x27;__main__&#x27;:    server = HTTPServer((&#x27;localhost&#x27;, 8080), GitHubMCPHandler)    server.serve_forever()\n\nstdioæœåŠ¡å™¨ç¤ºä¾‹# github_mcp_stdio_server.pyimport sysimport jsondef main():    while True:        try:            line = sys.stdin.readline()            if not line:                break            request = json.loads(line.strip())            response = handle_mcp_request(request)            print(json.dumps(response))            sys.stdout.flush()        except Exception as e:            error_response = &#123;                &#x27;error&#x27;: &#123;                    &#x27;code&#x27;: -32603,                    &#x27;message&#x27;: str(e)                &#125;            print(json.dumps(error_response))            sys.stdout.flush()if __name__ == &#x27;__main__&#x27;:    main()\n\n3.2 è®¤è¯å¤„ç†å·®å¼‚HTTPè®¤è¯&#123;  &quot;headers&quot;: &#123;    &quot;Authorization&quot;: &quot;Bearer $&#123;GITHUB_TOKEN&#125;&quot;,    &quot;X-API-Key&quot;: &quot;$&#123;API_KEY&#125;&quot;  &#125;&#125;\n\nstdioè®¤è¯&#123;  &quot;env&quot;: &#123;    &quot;GITHUB_PERSONAL_ACCESS_TOKEN&quot;: &quot;$&#123;GITHUB_PERSONAL_ACCESS_TOKEN&#125;&quot;,    &quot;API_KEY&quot;: &quot;$&#123;API_KEY&#125;&quot;  &#125;&#125;\n\nå››ã€æœ€ä½³å®è·µå»ºè®®4.1 é€‰æ‹©ä¼ è¾“æ–¹å¼çš„è€ƒè™‘å› ç´ \nå¼€å‘é˜¶æ®µï¼šä½¿ç”¨stdioï¼Œä¾¿äºè°ƒè¯•\nç”Ÿäº§ç¯å¢ƒï¼šä½¿ç”¨HTTPï¼Œä¾¿äºç›‘æ§å’Œæ‰©å±•\nç½‘ç»œç¯å¢ƒï¼šå—é™ç¯å¢ƒå¯èƒ½éœ€è¦stdio\næ€§èƒ½è¦æ±‚ï¼šé«˜é¢‘è°ƒç”¨ä½¿ç”¨stdio\n\n4.2 é”™è¯¯å¤„ç†ç­–ç•¥&#123;  &quot;mcpServers&quot;: &#123;    &quot;github&quot;: &#123;      &quot;type&quot;: &quot;stdio&quot;,      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [&quot;-y&quot;, &quot;@modelcontextprotocol/server-github&quot;],      &quot;env&quot;: &#123;        &quot;GITHUB_PERSONAL_ACCESS_TOKEN&quot;: &quot;$&#123;GITHUB_PERSONAL_ACCESS_TOKEN&#125;&quot;,        &quot;NODE_ENV&quot;: &quot;production&quot;      &#125;,      &quot;retries&quot;: 3,      &quot;timeout&quot;: 30000    &#125;,    &quot;github-backup&quot;: &#123;      &quot;type&quot;: &quot;http&quot;,      &quot;url&quot;: &quot;http://backup-server:8080/mcp&quot;,      &quot;fallback&quot;: true    &#125;  &#125;&#125;\n\n4.3 å®‰å…¨è€ƒè™‘\nä»¤ç‰Œç®¡ç†ï¼š\n\nä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œé¿å…ç¡¬ç¼–ç \nå®šæœŸè½®æ¢è®¿é—®ä»¤ç‰Œ\nä½¿ç”¨æœ€å°æƒé™åŸåˆ™\n\n\nç½‘ç»œå®‰å…¨ï¼š\n\nHTTPæ–¹å¼ä½¿ç”¨HTTPS\néªŒè¯æœåŠ¡å™¨è¯ä¹¦\né™åˆ¶è®¿é—®æ¥æº\n\n\næ•°æ®ä¿æŠ¤ï¼š\n\næ•æ„Ÿæ•°æ®è„±æ•\næ—¥å¿—è®°å½•æ§åˆ¶\nä¸´æ—¶æ–‡ä»¶æ¸…ç†\n\n\n\näº”ã€æ•…éšœæ’é™¤5.1 å¸¸è§é—®é¢˜\nè¿æ¥è¶…æ—¶\n&#123;  &quot;timeout&quot;: 60000,  &quot;retries&quot;: 5,  &quot;retryDelay&quot;: 1000&#125;\n\nè®¤è¯å¤±è´¥\n\næ£€æŸ¥ç¯å¢ƒå˜é‡è®¾ç½®\néªŒè¯ä»¤ç‰Œæœ‰æ•ˆæ€§\nç¡®è®¤æƒé™é…ç½®\n\n\né€šä¿¡é”™è¯¯\n\nstdioï¼šæ£€æŸ¥æ¢è¡Œç¬¦ï¼ˆ\\n vs \\r\\nï¼‰\nHTTPï¼šæ£€æŸ¥Content-Typeå¤´\n\n\n\n5.2 è°ƒè¯•æŠ€å·§HTTPæ–¹å¼è°ƒè¯•# æµ‹è¯•è¿æ¥curl -X POST http://localhost:8080/mcp \\  -H &quot;Content-Type: application/json&quot; \\  -H &quot;Authorization: Bearer $GITHUB_TOKEN&quot; \\  -d &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;tools/list&quot;&#125;&#x27;\n\nstdioæ–¹å¼è°ƒè¯•# æ‰‹åŠ¨æµ‹è¯•echo &#x27;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;method&quot;: &quot;tools/list&quot;&#125;&#x27; | npx -y @modelcontextprotocol/server-github\n\nå…­ã€æ€§èƒ½ä¼˜åŒ–6.1 HTTPä¼˜åŒ–&#123;  &quot;headers&quot;: &#123;    &quot;Connection&quot;: &quot;keep-alive&quot;,    &quot;Keep-Alive&quot;: &quot;timeout=60, max=100&quot;  &#125;,  &quot;timeout&quot;: 30000&#125;\n\n6.2 stdioä¼˜åŒ–# æ‰¹é‡å¤„ç†è¯·æ±‚def batch_process_requests(requests):    results = []    for request in requests:        results.append(handle_request(request))    return results\n\nä¸ƒã€æ€»ç»“HTTPå’Œstdioä¸¤ç§ä¼ è¾“æ–¹å¼å„æœ‰ä¼˜åŠ¿ï¼š\n\nHTTPï¼šæ˜“äºè°ƒè¯•ã€æ‰©å±•æ€§å¥½ã€é€‚åˆåˆ†å¸ƒå¼éƒ¨ç½²\nstdioï¼šæ€§èƒ½é«˜ã€å®ç°ç®€å•ã€é€‚åˆæœ¬åœ°å¼€å‘\n\næ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„ä¼ è¾“æ–¹å¼ï¼Œå¹¶åšå¥½é”™è¯¯å¤„ç†å’Œå®‰å…¨é˜²æŠ¤ã€‚é€šè¿‡åˆç†çš„é…ç½®å’Œä¼˜åŒ–ï¼Œå¯ä»¥åœ¨Gemini CLIå’ŒClaude Codeä¸­ç¨³å®šåœ°ä½¿ç”¨GitHub MCPæœåŠ¡å™¨ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚\nå‚è€ƒèµ„æ–™\nModel Context Protocolå®˜æ–¹æ–‡æ¡£\nGemini CLIæ–‡æ¡£\nClaude Codeæ–‡æ¡£\n\n","categories":["å¼€å‘å·¥å…·"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Windows æœåŠ¡é…ç½®æŒ‡å—","url":"/posts/7a1e3650/","content":"Windows æœåŠ¡é…ç½®æŒ‡å—ç›®å½•\nWindows æœåŠ¡æ¦‚è¿°\næœåŠ¡ç®¡ç†åŸºç¡€\nå¸¸è§æœåŠ¡é…ç½®\næœåŠ¡ä¼˜åŒ–\næ•…éšœæ’é™¤\nè‡ªåŠ¨åŒ–ç®¡ç†\nå®‰å…¨é…ç½®\n\nWindows æœåŠ¡æ¦‚è¿°Windows æœåŠ¡æ˜¯åœ¨åå°è¿è¡Œçš„ç¨‹åºï¼Œä¸ä¾èµ–äºç”¨æˆ·ç™»å½•ï¼Œæä¾›ç³»ç»Ÿçº§åŠŸèƒ½ã€‚\næœåŠ¡ç‰¹ç‚¹\nåå°è¿è¡Œ: æ— éœ€ç”¨æˆ·äº¤äº’\nè‡ªåŠ¨å¯åŠ¨: å¯é…ç½®ä¸ºç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œ\nç³»ç»Ÿæƒé™: é€šå¸¸ä»¥ç³»ç»Ÿè´¦æˆ·è¿è¡Œ\nå¯ç®¡ç†: é€šè¿‡æœåŠ¡ç®¡ç†å™¨è¿›è¡Œæ§åˆ¶\n\næœåŠ¡ç±»å‹\nå†…ç½®æœåŠ¡: Windows ç³»ç»Ÿè‡ªå¸¦çš„æœåŠ¡\nç¬¬ä¸‰æ–¹æœåŠ¡: åº”ç”¨ç¨‹åºå®‰è£…çš„æœåŠ¡\nè‡ªå®šä¹‰æœåŠ¡: ç”¨æˆ·å¼€å‘çš„ Windows æœåŠ¡\n\næœåŠ¡ç®¡ç†åŸºç¡€æœåŠ¡ç®¡ç†å™¨ç•Œé¢æ‰“å¼€æœåŠ¡ç®¡ç†å™¨\nè¿è¡Œå‘½ä»¤: services.msc\næ§åˆ¶é¢æ¿: æ§åˆ¶é¢æ¿ â†’ ç®¡ç†å·¥å…· â†’ æœåŠ¡\nä»»åŠ¡ç®¡ç†å™¨: ä»»åŠ¡ç®¡ç†å™¨ â†’ æœåŠ¡é€‰é¡¹å¡\nPowerShell: Get-Service\n\næœåŠ¡ç®¡ç†å™¨ç•Œé¢è¯´æ˜\nåç§°: æœåŠ¡æ˜¾ç¤ºåç§°\næè¿°: æœåŠ¡åŠŸèƒ½è¯´æ˜\nçŠ¶æ€: è¿è¡ŒçŠ¶æ€ï¼ˆè¿è¡Œä¸­&#x2F;å·²åœæ­¢ï¼‰\nå¯åŠ¨ç±»å‹: å¯åŠ¨æ–¹å¼\nç™»å½•èº«ä»½: æœåŠ¡è¿è¡Œè´¦æˆ·\nè¿›ç¨‹ID: æœåŠ¡è¿›ç¨‹æ ‡è¯†ç¬¦\n\nå‘½ä»¤è¡Œç®¡ç†net å‘½ä»¤# Windows æœåŠ¡é…ç½®æŒ‡å—net start# Windows æœåŠ¡é…ç½®æŒ‡å—net start æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—net stop æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—net pause æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—net continue æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—net start | findstr &quot;æœåŠ¡åç§°&quot;\n\nsc å‘½ä»¤# Windows æœåŠ¡é…ç½®æŒ‡å—sc query æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—sc qc æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—sc start æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—sc stop æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—sc pause æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—sc continue æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—sc delete æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—sc create æœåŠ¡åç§° binPath= &quot;C:\\path\\to\\service.exe&quot; start= auto DisplayName= &quot;æ˜¾ç¤ºåç§°&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—sc config æœåŠ¡åç§° start= delayed-autosc config æœåŠ¡åç§° binPath= &quot;C:\\new\\path\\to\\service.exe&quot;sc config æœåŠ¡åç§° DisplayName= &quot;æ–°æ˜¾ç¤ºåç§°&quot;\n\nPowerShell å‘½ä»¤# Windows æœåŠ¡é…ç½®æŒ‡å—Get-Service# Windows æœåŠ¡é…ç½®æŒ‡å—Get-Service -Name &quot;æœåŠ¡åç§°&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—Start-Service -Name &quot;æœåŠ¡åç§°&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—Stop-Service -Name &quot;æœåŠ¡åç§°&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—Restart-Service -Name &quot;æœåŠ¡åç§°&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—Suspend-Service -Name &quot;æœåŠ¡åç§°&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—Resume-Service -Name &quot;æœåŠ¡åç§°&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—Get-Service -Name &quot;æœåŠ¡åç§°&quot; | Select-Object Status, StartType# Windows æœåŠ¡é…ç½®æŒ‡å—Set-Service -Name &quot;æœåŠ¡åç§°&quot; -StartupType AutomaticSet-Service -Name &quot;æœåŠ¡åç§°&quot; -StartupType AutomaticDelayedStartSet-Service -Name &quot;æœåŠ¡åç§°&quot; -StartupType ManualSet-Service -Name &quot;æœåŠ¡åç§°&quot; -StartupType Disabled\n\nå¸¸è§æœåŠ¡é…ç½®MySQL æœåŠ¡é…ç½®å®‰è£… MySQL æœåŠ¡# Windows æœåŠ¡é…ç½®æŒ‡å—cd D:\\Software\\MySQL\\bin# Windows æœåŠ¡é…ç½®æŒ‡å—mysqld --initialize --console# Windows æœåŠ¡é…ç½®æŒ‡å—mysqld --install MySQL --defaults-file=&quot;D:\\Software\\MySQL\\my.ini&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—net start MySQL# Windows æœåŠ¡é…ç½®æŒ‡å—sc config MySQL start= auto\n\næœåŠ¡ç®¡ç†è„šæœ¬@echo offrem mysql_service_manager.batset MYSQL_HOME=D:\\Software\\MySQLset MYSQL_SERVICE=MySQLecho MySQL Service Managerecho ======================:menuecho 1. Start MySQL Serviceecho 2. Stop MySQL Serviceecho 3. Restart MySQL Serviceecho 4. Check Service Statusecho 5. View MySQL Logecho 6. Connect to MySQLecho 7. Exitset /p choice=&quot;Enter choice: &quot;if &quot;%choice%&quot;==&quot;1&quot; (    echo Starting MySQL service...    net start %MYSQL_SERVICE%) else if &quot;%choice%&quot;==&quot;2&quot; (    echo Stopping MySQL service...    net stop %MYSQL_SERVICE%) else if &quot;%choice%&quot;==&quot;3&quot; (    echo Restarting MySQL service...    net stop %MYSQL_SERVICE%    timeout /t 2 &gt;nul    net start %MYSQL_SERVICE%) else if &quot;%choice%&quot;==&quot;4&quot; (    echo Checking MySQL service status...    sc query %MYSQL_SERVICE%) else if &quot;%choice%&quot;==&quot;5&quot; (    echo Opening MySQL log...    type &quot;%MYSQL_HOME%\\data\\*.err&quot; | more) else if &quot;%choice%&quot;==&quot;6&quot; (    echo Connecting to MySQL...    &quot;%MYSQL_HOME%\\bin\\mysql.exe&quot; -u root -p) else if &quot;%choice%&quot;==&quot;7&quot; (    echo Exiting...    exit /b 0) else (    echo Invalid choice!)timeout /t 2 &gt;nulgoto menu\n\nRedis æœåŠ¡é…ç½®å®‰è£… Redis æœåŠ¡# Windows æœåŠ¡é…ç½®æŒ‡å—cd D:\\Software\\Redis# Windows æœåŠ¡é…ç½®æŒ‡å—redis-server --service-install redis.windows.conf --service-name Redis# Windows æœåŠ¡é…ç½®æŒ‡å—redis-server --service-start --service-name Redis# Windows æœåŠ¡é…ç½®æŒ‡å—sc config Redis start= auto\n\nIIS æœåŠ¡é…ç½®å¯ç”¨ IIS æœåŠ¡# Windows æœåŠ¡é…ç½®æŒ‡å—dism /online /enable-feature /featurename:IIS-WebServerRole# Windows æœåŠ¡é…ç½®æŒ‡å—net start w3svc# Windows æœåŠ¡é…ç½®æŒ‡å—sc config w3svc start= auto\n\nIIS æœåŠ¡ç®¡ç†è„šæœ¬@echo offrem iis_service_manager.batecho IIS Service Managerecho ===================:menuecho 1. Start IIS Serviceecho 2. Stop IIS Serviceecho 3. Restart IIS Serviceecho 4. Check Service Statusecho 5. Reset IISecho 6. View IIS Logecho 7. Exitset /p choice=&quot;Enter choice: &quot;if &quot;%choice%&quot;==&quot;1&quot; (    echo Starting IIS service...    net start w3svc) else if &quot;%choice%&quot;==&quot;2&quot; (    echo Stopping IIS service...    net stop w3svc) else if &quot;%choice%&quot;==&quot;3&quot; (    echo Restarting IIS service...    net stop w3svc    timeout /t 2 &gt;nul    net start w3svc) else if &quot;%choice%&quot;==&quot;4&quot; (    echo Checking IIS service status...    sc query w3svc) else if &quot;%choice%&quot;==&quot;5&quot; (    echo Resetting IIS...    iisreset) else if &quot;%choice%&quot;==&quot;6&quot; (    echo Opening IIS log...    type &quot;C:\\inetpub\\logs\\LogFiles\\W3SVC1\\*.log&quot; | more) else if &quot;%choice%&quot;==&quot;7&quot; (    echo Exiting...    exit /b 0) else (    echo Invalid choice!)timeout /t 2 &gt;nulgoto menu\n\næœåŠ¡ä¼˜åŒ–å¯åŠ¨ç±»å‹ä¼˜åŒ–å¯åŠ¨ç±»å‹è¯´æ˜\nè‡ªåŠ¨ (Automatic): ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨\nè‡ªåŠ¨(å»¶è¿Ÿå¯åŠ¨) (AutomaticDelayedStart): ç³»ç»Ÿå¯åŠ¨åå»¶è¿Ÿå¯åŠ¨\næ‰‹åŠ¨ (Manual): éœ€è¦æ‰‹åŠ¨å¯åŠ¨\nå·²ç¦ç”¨ (Disabled): ç¦ç”¨æœåŠ¡\nè§¦å‘å¯åŠ¨ (Trigger Start): é€šè¿‡äº‹ä»¶è§¦å‘å¯åŠ¨\n\nä¼˜åŒ–å»ºè®®# Windows æœåŠ¡é…ç½®æŒ‡å—Set-Service -Name &quot;AdobeARMservice&quot; -StartupType AutomaticDelayedStartSet-Service -Name &quot;GoogleChromeElevationService&quot; -StartupType AutomaticDelayedStart# Windows æœåŠ¡é…ç½®æŒ‡å—Set-Service -Name &quot;Fax&quot; -StartupType DisabledSet-Service -Name &quot;Spooler&quot; -StartupType Disabled  # å¦‚æœä¸éœ€è¦æ‰“å°Set-Service -Name &quot;RemoteRegistry&quot; -StartupType Disabled  # å®‰å…¨è€ƒè™‘\n\næœåŠ¡ä¾èµ–å…³ç³»æŸ¥çœ‹æœåŠ¡ä¾èµ–# Windows æœåŠ¡é…ç½®æŒ‡å—sc enumdepend æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—sc qdepend æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—Get-Service -Name &quot;æœåŠ¡åç§°&quot; | Select-Object DependentServices, ServicesDependedOn\n\næ‰¹é‡æœåŠ¡ç®¡ç†# Windows æœåŠ¡é…ç½®æŒ‡å—$service = Get-Service -Name &quot;ä¸»æœåŠ¡åç§°&quot;$service.ServicesDependedOn | ForEach-Object &#123;    if ($_.Status -eq &quot;Stopped&quot;) &#123;        Start-Service $_.Name    &#125;&#125;# Windows æœåŠ¡é…ç½®æŒ‡å—$service = Get-Service -Name &quot;ä¸»æœåŠ¡åç§°&quot;$service.DependentServices | ForEach-Object &#123;    if ($_.Status -eq &quot;Running&quot;) &#123;        Stop-Service $_.Name -Force    &#125;&#125;\n\næ€§èƒ½ç›‘æ§æœåŠ¡ç›‘æ§è„šæœ¬# Windows æœåŠ¡é…ç½®æŒ‡å—$services = @(&quot;MySQL&quot;, &quot;Redis&quot;, &quot;w3svc&quot;)$logFile = &quot;C:\\logs\\service_monitor.log&quot;function Write-Log &#123;    param($message)    $timestamp = Get-Date -Format &quot;yyyy-MM-dd HH:mm:ss&quot;    Add-Content $logFile &quot;$timestamp - $message&quot;&#125;while ($true) &#123;    foreach ($serviceName in $services) &#123;        try &#123;            $service = Get-Service -Name $serviceName -ErrorAction Stop            if ($service.Status -ne &quot;Running&quot;) &#123;                Write-Log &quot;$serviceName is not running (Status: $($service.Status))&quot;                # å°è¯•å¯åŠ¨æœåŠ¡                try &#123;                    Start-Service -Name $serviceName -ErrorAction Stop                    Write-Log &quot;Successfully started $serviceName&quot;                &#125; catch &#123;                    Write-Log &quot;Failed to start $serviceName: $_&quot;                &#125;            &#125;        &#125; catch &#123;            Write-Log &quot;Error checking $serviceName: $_&quot;        &#125;    &#125;    # æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡    Start-Sleep -Seconds 300&#125;\n\nèµ„æºä½¿ç”¨ç›‘æ§# Windows æœåŠ¡é…ç½®æŒ‡å—Get-Process | Where-Object &#123;$_.ProcessName -in @(&quot;mysqld&quot;, &quot;redis-server&quot;, &quot;w3wp&quot;)&#125; |    Select-Object ProcessName, CPU, WorkingSet, PrivateMemorySize, StartTime |    Format-Table -AutoSize\n\næ•…éšœæ’é™¤å¸¸è§æœåŠ¡é—®é¢˜æœåŠ¡æ— æ³•å¯åŠ¨# Windows æœåŠ¡é…ç½®æŒ‡å—sc query æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—eventvwr.msc# Windows æœåŠ¡é…ç½®æŒ‡å—sc enumdepend æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—&quot;C:\\path\\to\\service.exe&quot; --test\n\næœåŠ¡å¯åŠ¨åè‡ªåŠ¨åœæ­¢# Windows æœåŠ¡é…ç½®æŒ‡å—sc query æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—wevtutil qe System /c:1 /rd:true /f:text | findstr &quot;æœåŠ¡åç§°&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—sc qc æœåŠ¡åç§°# Windows æœåŠ¡é…ç½®æŒ‡å—icacls &quot;C:\\path\\to\\service.exe&quot;\n\næœåŠ¡å“åº”è¶…æ—¶# Windows æœåŠ¡é…ç½®æŒ‡å—sc config æœåŠ¡åç§° start= delayed-auto# Windows æœåŠ¡é…ç½®æŒ‡å—reg add &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\æœåŠ¡åç§°&quot; /v &quot;Timeout&quot; /t REG_DWORD /d 180000 /f\n\nè¯Šæ–­å·¥å…·æœåŠ¡è¯Šæ–­å·¥å…·# Windows æœåŠ¡é…ç½®æŒ‡å—function Diagnose-Service &#123;    param($serviceName)    Write-Host &quot;=== Service Diagnosis for $serviceName ===&quot; -ForegroundColor Green    # æ£€æŸ¥æœåŠ¡æ˜¯å¦å­˜åœ¨    try &#123;        $service = Get-Service -Name $serviceName -ErrorAction Stop        Write-Host &quot;Service Found: $($service.DisplayName)&quot; -ForegroundColor Green    &#125; catch &#123;        Write-Host &quot;Service not found: $serviceName&quot; -ForegroundColor Red        return    &#125;    # æ£€æŸ¥æœåŠ¡çŠ¶æ€    Write-Host &quot;Status: $($service.Status)&quot; -ForegroundColor Cyan    Write-Host &quot;StartType: $($service.StartType)&quot; -ForegroundColor Cyan    # æ£€æŸ¥æœåŠ¡è¿›ç¨‹    if ($service.Status -eq &quot;Running&quot;) &#123;        try &#123;            $process = Get-Process -Id $service.Id -ErrorAction Stop            Write-Host &quot;Process ID: $($process.Id)&quot; -ForegroundColor Cyan            Write-Host &quot;CPU Time: $($process.CPU)&quot; -ForegroundColor Cyan            Write-Host &quot;Memory: $([math]::Round($process.WorkingSet/1MB, 2)) MB&quot; -ForegroundColor Cyan        &#125; catch &#123;            Write-Host &quot;Process not found for service&quot; -ForegroundColor Yellow        &#125;    &#125;    # æ£€æŸ¥æœåŠ¡ä¾èµ–    Write-Host &quot;Dependencies:&quot; -ForegroundColor Cyan    $service.ServicesDependedOn | ForEach-Object &#123;        Write-Host &quot;  - $($_.Name) ($($_.Status))&quot; -ForegroundColor White    &#125;    # æ£€æŸ¥ä¾èµ–æœåŠ¡    Write-Host &quot;Dependent Services:&quot; -ForegroundColor Cyan    $service.DependentServices | ForEach-Object &#123;        Write-Host &quot;  - $($_.Name) ($($_.Status))&quot; -ForegroundColor White    &#125;    # æ£€æŸ¥æœåŠ¡é…ç½®    Write-Host &quot;Service Configuration:&quot; -ForegroundColor Cyan    $config = sc.exe qc $serviceName    $config | Where-Object &#123;$_ -match &quot;START_TYPE|BINARY_PATH_NAME|DISPLAY_NAME&quot;&#125; | ForEach-Object &#123;        Write-Host &quot;  $_&quot; -ForegroundColor White    &#125;    # æ£€æŸ¥äº‹ä»¶æ—¥å¿—    Write-Host &quot;Recent Events:&quot; -ForegroundColor Cyan    $events = Get-WinEvent -LogName System -MaxEvents 10 | Where-Object &#123;        $_.ProviderName -eq &quot;Service Control Manager&quot; -and $_.Message -match $serviceName    &#125;    if ($events) &#123;        $events | ForEach-Object &#123;            Write-Host &quot;  $($_.TimeCreated) - $($_.Message)&quot; -ForegroundColor White        &#125;    &#125; else &#123;        Write-Host &quot;  No recent events found&quot; -ForegroundColor Yellow    &#125;&#125;# Windows æœåŠ¡é…ç½®æŒ‡å—Diagnose-Service &quot;MySQL&quot;Diagnose-Service &quot;w3svc&quot;\n\næœåŠ¡æ¢å¤è„šæœ¬# Windows æœåŠ¡é…ç½®æŒ‡å—function Repair-Service &#123;    param($serviceName)    Write-Host &quot;Attempting to repair service: $serviceName&quot; -ForegroundColor Green    try &#123;        # åœæ­¢æœåŠ¡        Stop-Service -Name $serviceName -Force -ErrorAction Stop        Write-Host &quot;Service stopped successfully&quot; -ForegroundColor Green        # ç­‰å¾…2ç§’        Start-Sleep -Seconds 2        # å¯åŠ¨æœåŠ¡        Start-Service -Name $serviceName -ErrorAction Stop        Write-Host &quot;Service started successfully&quot; -ForegroundColor Green        # éªŒè¯æœåŠ¡çŠ¶æ€        $service = Get-Service -Name $serviceName        if ($service.Status -eq &quot;Running&quot;) &#123;            Write-Host &quot;Service repair successful!&quot; -ForegroundColor Green        &#125; else &#123;            Write-Host &quot;Service repair failed. Status: $($service.Status)&quot; -ForegroundColor Red        &#125;    &#125; catch &#123;        Write-Host &quot;Error repairing service: $_&quot; -ForegroundColor Red    &#125;&#125;\n\nè‡ªåŠ¨åŒ–ç®¡ç†æ‰¹é‡æœåŠ¡ç®¡ç†æ‰¹é‡å¯åŠ¨&#x2F;åœæ­¢æœåŠ¡# Windows æœåŠ¡é…ç½®æŒ‡å—$servicesToStart = @(&quot;MySQL&quot;, &quot;Redis&quot;, &quot;w3svc&quot;)foreach ($service in $servicesToStart) &#123;    try &#123;        $svc = Get-Service -Name $service -ErrorAction Stop        if ($svc.Status -ne &quot;Running&quot;) &#123;            Start-Service -Name $service            Write-Host &quot;Started $service&quot; -ForegroundColor Green        &#125; else &#123;            Write-Host &quot;$service is already running&quot; -ForegroundColor Yellow        &#125;    &#125; catch &#123;        Write-Host &quot;Failed to start $service: $_&quot; -ForegroundColor Red    &#125;&#125;# Windows æœåŠ¡é…ç½®æŒ‡å—$servicesToStop = @(&quot;MySQL&quot;, &quot;Redis&quot;, &quot;w3svc&quot;)foreach ($service in $servicesToStop) &#123;    try &#123;        $svc = Get-Service -Name $service -ErrorAction Stop        if ($svc.Status -eq &quot;Running&quot;) &#123;            Stop-Service -Name $service -Force            Write-Host &quot;Stopped $service&quot; -ForegroundColor Green        &#125; else &#123;            Write-Host &quot;$service is already stopped&quot; -ForegroundColor Yellow        &#125;    &#125; catch &#123;        Write-Host &quot;Failed to stop $service: $_&quot; -ForegroundColor Red    &#125;&#125;\n\nå®šæ—¶ä»»åŠ¡ç®¡ç†# Windows æœåŠ¡é…ç½®æŒ‡å—$action = &#123;    $services = @(&quot;MySQL&quot;, &quot;Redis&quot;, &quot;w3svc&quot;)    foreach ($service in $services) &#123;        $svc = Get-Service -Name $service -ErrorAction SilentlyContinue        if ($svc -and $svc.Status -ne &quot;Running&quot;) &#123;            try &#123;                Start-Service -Name $service                Write-Host &quot;$(Get-Date): Started $service&quot;            &#125; catch &#123;                Write-Host &quot;$(Get-Date): Failed to start $service&quot;            &#125;        &#125;    &#125;&#125;$trigger = New-JobTrigger -Once -At (Get-Date).AddMinutes(1) -RepetitionInterval (New-TimeSpan -Minutes 5) -RepetitionIndefinitelyRegister-ScheduledJob -Name &quot;ServiceMonitor&quot; -ScriptBlock $action -Trigger $trigger -RunLevel Highest\n\né…ç½®æ–‡ä»¶ç®¡ç†æœåŠ¡é…ç½®å¯¼å‡º# Windows æœåŠ¡é…ç½®æŒ‡å—function Export-ServiceConfig &#123;    param($outputFile = &quot;C:\\service_config.csv&quot;)    $services = Get-Service    $results = @()    foreach ($service in $services) &#123;        $config = sc.exe qc $service.Name        $binaryPath = ($config | Where-Object &#123;$_ -match &quot;BINARY_PATH_NAME&quot;&#125;) -replace &quot;BINARY_PATH_NAME\\s*:\\s*&quot;        $startType = ($config | Where-Object &#123;$_ -match &quot;START_TYPE&quot;&#125;) -replace &quot;START_TYPE\\s*:\\s*&quot;        $result = [PSCustomObject]@&#123;            ServiceName = $service.Name            DisplayName = $service.DisplayName            Status = $service.Status            StartType = $service.StartType            BinaryPath = $binaryPath            ConfigStartType = $startType            ProcessId = if ($service.Status -eq &quot;Running&quot;) &#123; $service.Id &#125; else &#123; $null &#125;            CanStop = $service.CanStop            CanPauseAndContinue = $service.CanPauseAndContinue        &#125;        $results += $result    &#125;    $results | Export-Csv -Path $outputFile -NoTypeInformation -Encoding UTF8    Write-Host &quot;Service configuration exported to $outputFile&quot; -ForegroundColor Green&#125;# Windows æœåŠ¡é…ç½®æŒ‡å—Export-ServiceConfig\n\næœåŠ¡é…ç½®å¯¼å…¥# Windows æœåŠ¡é…ç½®æŒ‡å—function Import-ServiceConfig &#123;    param($inputFile = &quot;C:\\service_config.csv&quot;)    if (-not (Test-Path $inputFile)) &#123;        Write-Host &quot;Configuration file not found: $inputFile&quot; -ForegroundColor Red        return    &#125;    $configs = Import-Csv -Path $inputFile    foreach ($config in $configs) &#123;        try &#123;            # æ¢å¤å¯åŠ¨ç±»å‹            if ($config.StartType -ne $config.ConfigStartType) &#123;                Set-Service -Name $config.ServiceName -StartupType $config.StartType                Write-Host &quot;Restored startup type for $($config.ServiceName)&quot; -ForegroundColor Green            &#125;            # å¦‚æœæœåŠ¡åº”è¯¥è¿è¡Œä½†å½“å‰åœæ­¢ï¼Œå¯åŠ¨å®ƒ            if ($config.Status -eq &quot;Running&quot;) &#123;                $currentStatus = (Get-Service -Name $config.ServiceName).Status                if ($currentStatus -ne &quot;Running&quot;) &#123;                    Start-Service -Name $config.ServiceName                    Write-Host &quot;Started $($config.ServiceName)&quot; -ForegroundColor Green                &#125;            &#125;        &#125; catch &#123;            Write-Host &quot;Failed to restore $($config.ServiceName): $_&quot; -ForegroundColor Red        &#125;    &#125;&#125;\n\nå®‰å…¨é…ç½®æœåŠ¡è´¦æˆ·ç®¡ç†æœåŠ¡è´¦æˆ·ç±»å‹\nLocal System: å®Œå…¨ç³»ç»Ÿæƒé™\nLocal Service: æœ‰é™æƒé™ï¼Œç½‘ç»œè®¿é—®å—é™\nNetwork Service: ç½‘ç»œè®¿é—®æƒé™\næŒ‡å®šç”¨æˆ·è´¦æˆ·: è‡ªå®šä¹‰åŸŸæˆ–æœ¬åœ°è´¦æˆ·\n\nå®‰å…¨è´¦æˆ·é…ç½®# Windows æœåŠ¡é…ç½®æŒ‡å—$serviceName = &quot;MySQL&quot;$account = &quot;NT AUTHORITY\\NetworkService&quot;$password = ConvertTo-SecureString &quot;&quot; -AsPlainText -Force# Windows æœåŠ¡é…ç½®æŒ‡å—sc.exe config $serviceName obj= $accountif ($password) &#123;    sc.exe config $serviceName password= $password&#125;# Windows æœåŠ¡é…ç½®æŒ‡å—Restart-Service -Name $serviceName -Force\n\næœ€å°æƒé™åŸåˆ™# Windows æœåŠ¡é…ç½®æŒ‡å—$serviceName = &quot;CustomService&quot;$accountName = &quot;svc_$serviceName&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—$password = ConvertTo-SecureString &quot;P@ssw0rd123!&quot; -AsPlainText -ForceNew-LocalUser -Name $accountName -Password $password -PasswordNeverExpires -AccountNeverExpires -Description &quot;Service account for $serviceName&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—# Windows æœåŠ¡é…ç½®æŒ‡å—\n\næœåŠ¡æƒé™é…ç½®æ–‡ä»¶ç³»ç»Ÿæƒé™# Windows æœåŠ¡é…ç½®æŒ‡å—$servicePath = &quot;C:\\Program Files\\MyService\\MyService.exe&quot;$account = &quot;NT AUTHORITY\\NetworkService&quot;# Windows æœåŠ¡é…ç½®æŒ‡å—$acl = Get-Acl $servicePath$rule = New-Object System.Security.AccessControl.FileSystemAccessRule(    $account,    &quot;ReadAndExecute&quot;,    &quot;ContainerInherit,ObjectInherit&quot;,    &quot;None&quot;,    &quot;Allow&quot;)$acl.SetAccessRule($rule)Set-Acl $servicePath $acl\n\næ³¨å†Œè¡¨æƒé™# Windows æœåŠ¡é…ç½®æŒ‡å—$regPath = &quot;HKLM:\\SYSTEM\\CurrentControlSet\\Services\\$serviceName&quot;$account = &quot;NT AUTHORITY\\NetworkService&quot;$acl = Get-Acl $regPath$rule = New-Object System.Security.AccessControl.RegistryAccessRule(    $account,    &quot;ReadKey,WriteKey,Delete,EnumerateSubKeys&quot;,    &quot;ContainerInherit,ObjectInherit&quot;,    &quot;None&quot;,    &quot;Allow&quot;)$acl.SetAccessRule($rule)Set-Acl $regPath $acl\n\nå®‰å…¨å®¡è®¡æœåŠ¡è®¿é—®å®¡è®¡# Windows æœåŠ¡é…ç½®æŒ‡å—auditpol /set /subcategory:&quot;Service&quot; /success:enable /failure:enable# Windows æœåŠ¡é…ç½®æŒ‡å—Get-WinEvent -LogName Security | Where-Object &#123;    $_.Id -eq 4674 -or $_.Id -eq 4697 -or $_.Id -eq 4698&#125; | Format-List TimeCreated, Id, Message\n\næœåŠ¡ç›‘æ§è„šæœ¬# Windows æœåŠ¡é…ç½®æŒ‡å—$monitorServices = @(&quot;MySQL&quot;, &quot;Redis&quot;, &quot;w3svc&quot;)$logFile = &quot;C:\\logs\\service_security.log&quot;function Write-SecurityLog &#123;    param($message)    $timestamp = Get-Date -Format &quot;yyyy-MM-dd HH:mm:ss&quot;    Add-Content $logFile &quot;$timestamp - SECURITY - $message&quot;&#125;foreach ($serviceName in $monitorServices) &#123;    try &#123;        $service = Get-Service -Name $serviceName        # æ£€æŸ¥æœåŠ¡è´¦æˆ·        $config = sc.exe qc $serviceName        $account = ($config | Where-Object &#123;$_ -match &quot;SERVICE_START_NAME&quot;&#125;) -replace &quot;SERVICE_START_NAME\\s*:\\s*&quot;        # æ£€æŸ¥æ–‡ä»¶æƒé™        $binaryPath = ($config | Where-Object &#123;$_ -match &quot;BINARY_PATH_NAME&quot;&#125;) -replace &quot;BINARY_PATH_NAME\\s*:\\s*&quot;        if ($binaryPath -match &quot;^`&quot;(.+?)`&quot;&quot;) &#123;            $filePath = $matches[1]            if (Test-Path $filePath) &#123;                $acl = Get-Acl $filePath                Write-SecurityLog &quot;$serviceName - File permissions checked for $filePath&quot;            &#125;        &#125;        Write-SecurityLog &quot;$serviceName - Account: $account - Status: $($service.Status)&quot;    &#125; catch &#123;        Write-SecurityLog &quot;Error monitoring $serviceName : $_&quot;    &#125;&#125;\n\nè®°ä½ï¼šWindows æœåŠ¡ç®¡ç†éœ€è¦è°¨æ…æ“ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯æ‰€æœ‰æ›´æ”¹ï¼\n","categories":["ç³»ç»Ÿè¿ç»´ç®¡ç†","WindowsæœåŠ¡ç®¡ç†"],"tags":["Windows","æœåŠ¡ç®¡ç†","ç³»ç»Ÿé…ç½®","æœåŠ¡å™¨"]},{"title":"MariaDB C++ Windows å®‰è£…æŒ‡å—","url":"/posts/15251b3b/","content":"MariaDB C++ Windows å®‰è£…æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: mariadb, cpp, windows, development, database, connector\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. å®‰è£… MariaDB æœåŠ¡å™¨\n2.1 è·å–å®‰è£…ç¨‹åº\n2.2 è¿è¡Œå®‰è£…å‘å¯¼\n2.3 éªŒè¯å®‰è£…\n\n\n3. å®‰è£… MariaDB è¿æ¥å™¨\n3.1 Connector&#x2F;C++\n3.2 Connector&#x2F;C\n3.3 é…ç½®ç¯å¢ƒå˜é‡\n\n\n4. é…ç½® Visual Studio é¡¹ç›®\n4.1 åŒ…å«å¤´æ–‡ä»¶ç›®å½•\n4.2 é…ç½®åº“æ–‡ä»¶ç›®å½•\n4.3 æŒ‡å®šä¾èµ–çš„åº“æ–‡ä»¶\n4.4 æ‹·è´ DLL æ–‡ä»¶\n\n\n5. ç¼–å†™æµ‹è¯•ä»£ç \n6. å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ\n7. é«˜çº§é…ç½®\n\n\n1. ğŸ“– æ¦‚è¿°åœ¨Windowsä¸‹è¿›è¡ŒC++å¼€å‘å¹¶ä½¿ç”¨MariaDBï¼Œä¸»è¦æ¶‰åŠMariaDBæœåŠ¡å™¨ç«¯çš„å®‰è£…ã€å¼€å‘åº“çš„é…ç½®ï¼Œä»¥åŠåœ¨ä½ çš„C++é¡¹ç›®ä¸­æ­£ç¡®è¿æ¥å’Œä½¿ç”¨è¿™äº›åº“ã€‚\nğŸ¯ ç›®æ ‡\nâœ… å®‰è£… MariaDB æœåŠ¡å™¨\nâœ… é…ç½® C++ å¼€å‘ç¯å¢ƒ\nâœ… åˆ›å»ºå¯è¿è¡Œçš„ C++ æ•°æ®åº“ç¨‹åº\nâœ… æŒæ¡åŸºæœ¬çš„æ•°æ®åº“æ“ä½œ\n\nğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾graph TD    A[C++ Application] --&gt; B[MariaDB Connector/C++]    B --&gt; C[MariaDB Connector/C]    C --&gt; D[MariaDB Server]    D --&gt; E[Database Files]    F[Visual Studio IDE] --&gt; G[Project Configuration]    G --&gt; H[Include Directories]    G --&gt; I[Library Directories]    G --&gt; J[Dependencies]\n\n\n2. ğŸ’¾ å®‰è£… MariaDB æœåŠ¡å™¨2.1 ğŸ” è·å–å®‰è£…ç¨‹åºè®¿é—® MariaDBå®˜æ–¹ç½‘ç«™çš„ä¸‹è½½é¡µé¢ï¼Œé€‰æ‹©é€‚ç”¨äºWindowsçš„å®‰è£…ç¨‹åºã€‚\næ¨èç‰ˆæœ¬é€‰æ‹©ï¼š\n\nç¨³å®šç‰ˆæœ¬: MariaDB 11.8 LTS (é•¿æœŸæ”¯æŒç‰ˆæœ¬)\næ–‡ä»¶æ ¼å¼: .msi å®‰è£…ç¨‹åº\næ¶æ„: æ ¹æ®ä½ çš„ç³»ç»Ÿé€‰æ‹© x64 æˆ– x86\n\n2.2 âš™ï¸ è¿è¡Œå®‰è£…å‘å¯¼è¿è¡Œä¸‹è½½çš„ .msi å®‰è£…ç¨‹åºï¼ŒæŒ‰ç…§å‘å¯¼æ­¥éª¤æ“ä½œï¼š\nğŸ“‹ é‡è¦é…ç½®é¡¹\n\n\né…ç½®é¡¹\næ¨èè®¾ç½®\nè¯´æ˜\n\n\n\næ ¹å¯†ç \nå¼ºå¯†ç \nç®¡ç†æ•°æ®åº“çš„æœ€é«˜æƒé™è´¦æˆ·\n\n\næœåŠ¡å\nMariaDB æˆ– MySQL\nä¿æŒé»˜è®¤å³å¯\n\n\nç«¯å£\n3306\né»˜è®¤æ•°æ®åº“ç«¯å£\n\n\nå­—ç¬¦é›†\nUTF-8\næ”¯æŒå¤šè¯­è¨€\n\n\nå¯ç”¨ç½‘ç»œè®¿é—®\næ˜¯\nå…è®¸è¿œç¨‹è¿æ¥\n\n\nâš ï¸ æƒé™é”™è¯¯å¤„ç†å¦‚æœåœ¨å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°æœåŠ¡æƒé™ç›¸å…³çš„é”™è¯¯ï¼š\n\nä¸è¦é€€å‡ºå®‰è£…ç¨‹åº\næ‰“å¼€ Windows çš„â€æœåŠ¡â€ç®¡ç†ç•Œé¢ (services.msc)\næ‰¾åˆ° MariaDB æœåŠ¡\nå³é”® â†’ â€œå±æ€§â€ â†’ â€œç™»å½•â€é€‰é¡¹å¡\nå°†ç™»å½•èº«ä»½ä¿®æ”¹ä¸ºâ€æœ¬åœ°ç³»ç»Ÿè´¦æˆ·â€œ\nè¿”å›å®‰è£…ç¨‹åºç‚¹å‡»â€é‡è¯•â€œ\n\n2.3 âœ… éªŒè¯å®‰è£…å®‰è£…å®Œæˆåï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š\næ–¹æ³•ä¸€ï¼šå‘½ä»¤è¡ŒéªŒè¯# MariaDB C++ Windows å®‰è£…æŒ‡å—mysql -u root -p# MariaDB C++ Windows å®‰è£…æŒ‡å—\n\næ–¹æ³•äºŒï¼šå›¾å½¢åŒ–å·¥å…·\nHeidiSQL (å¯èƒ½éšå®‰è£…åŒ…æä¾›)\nDBeaver\nNavicat\nphpMyAdmin\n\n\n3. ğŸ”Œ å®‰è£… MariaDB è¿æ¥å™¨3.1 ğŸ“¦ Connector&#x2F;C++MariaDB Connector&#x2F;C++ æ˜¯å®˜æ–¹çš„ C++ æ•°æ®åº“è¿æ¥å™¨ã€‚\nä¸‹è½½åœ°å€ï¼šMariaDB Connector&#x2F;C++ å®˜æ–¹ä¸‹è½½é¡µé¢\nç‰ˆæœ¬é€‰æ‹©æŒ‡å—ï¼š\ngraph LR    A[Visual Studioç‰ˆæœ¬] --&gt; B[Connectorç‰ˆæœ¬]    B --&gt; C[VS 2019/2022]    B --&gt; D[VS 2017]    B --&gt; E[VS 2015]    C --&gt; F[æœ€æ–°ç‰ˆæœ¬]    D --&gt; G[è¾ƒæ–°ç‰ˆæœ¬]    E --&gt; H[å…¼å®¹ç‰ˆæœ¬]\n\n3.2 ğŸ”§ Connector&#x2F;C (ä¾èµ–é¡¹)é‡è¦ï¼šMariaDB Connector/C++ ä¾èµ–äº MariaDB Connector/C\nä¸‹è½½åœ°å€ï¼šMariaDB Connector&#x2F;C å®˜æ–¹ä¸‹è½½é¡µé¢\n3.3 ğŸŒ é…ç½®ç¯å¢ƒå˜é‡ä¸ºäº†ç¡®ä¿è¿è¡Œæ—¶èƒ½æ‰¾åˆ°å¿…è¦çš„ DLL æ–‡ä»¶ï¼š\nè‡ªåŠ¨é…ç½®ï¼ˆæ¨èï¼‰# MariaDB C++ Windows å®‰è£…æŒ‡å—setx PATH &quot;%PATH%;C:\\mariadb-connector-c\\lib&quot;\n\næ‰‹åŠ¨é…ç½®\nå³é”®â€æ­¤ç”µè„‘â€ â†’ â€œå±æ€§â€ â†’ â€œé«˜çº§ç³»ç»Ÿè®¾ç½®â€\nç‚¹å‡»â€ç¯å¢ƒå˜é‡â€\nåœ¨â€ç³»ç»Ÿå˜é‡â€ä¸­æ‰¾åˆ° Path\nç‚¹å‡»â€ç¼–è¾‘â€ â†’ â€œæ–°å»ºâ€\næ·»åŠ è·¯å¾„ï¼šC:\\mariadb-connector-c\\lib\n\n\n4. ğŸ› ï¸ é…ç½® Visual Studio é¡¹ç›®4.1 ğŸ“ åŒ…å«å¤´æ–‡ä»¶ç›®å½•\nåœ¨ Visual Studio ä¸­æ‰“å¼€é¡¹ç›®\nå³é”®ç‚¹å‡»é¡¹ç›®åç§°ï¼Œé€‰æ‹© â€œå±æ€§â€\nå¯¼èˆªåˆ° â€œé…ç½®å±æ€§â€ â†’ â€œC&#x2F;C++â€ â†’ â€œå¸¸è§„â€ â†’ â€œé™„åŠ åŒ…å«ç›®å½•â€\næ·»åŠ ä»¥ä¸‹è·¯å¾„ï¼šC:\\mariadb-connector-cpp\\includeC:\\mariadb-connector-c\\include\n\n4.2 ğŸ”— é…ç½®åº“æ–‡ä»¶ç›®å½•åœ¨åŒä¸€ä¸ªå±æ€§é¡µä¸­ï¼š\n\nå¯¼èˆªåˆ° â€œé…ç½®å±æ€§â€ â†’ â€œé“¾æ¥å™¨â€ â†’ â€œå¸¸è§„â€ â†’ â€œé™„åŠ åº“ç›®å½•â€\næ·»åŠ ä»¥ä¸‹è·¯å¾„ï¼šC:\\mariadb-connector-cpp\\libC:\\mariadb-connector-c\\lib\n\n4.3 ğŸ“š æŒ‡å®šä¾èµ–çš„åº“æ–‡ä»¶\nå¯¼èˆªåˆ° â€œé…ç½®å±æ€§â€ â†’ â€œé“¾æ¥å™¨â€ â†’ â€œè¾“å…¥â€ â†’ â€œé™„åŠ ä¾èµ–é¡¹â€\næ·»åŠ ä»¥ä¸‹åº“æ–‡ä»¶ï¼ˆæ ¹æ®å®é™…æ–‡ä»¶åå¯èƒ½ç•¥æœ‰ä¸åŒï¼‰ï¼šmariadbclient.liblibmariadb.libmariadbcpp.lib\n\n4.4 ğŸ“‹ æ‹·è´ DLL æ–‡ä»¶ç¡®ä¿ç¨‹åºè¿è¡Œæ—¶èƒ½æ‰¾åˆ°å¿…è¦çš„åŠ¨æ€é“¾æ¥åº“ï¼š\ngraph LR    A[Connector/lib] --&gt; B[é¡¹ç›®è¾“å‡ºç›®å½•]    A --&gt; C[libmariadb.dll]    A --&gt; D[mariadbcpp.dll]    B --&gt; E[Debug/Releaseæ–‡ä»¶å¤¹]\n\néœ€è¦å¤åˆ¶çš„ DLL æ–‡ä»¶ï¼š\n\nlibmariadb.dll (æ¥è‡ª Connector&#x2F;C)\nmariadbcpp.dll (æ¥è‡ª Connector&#x2F;C++)\nå…¶ä»–ä¾èµ–çš„ DLL æ–‡ä»¶\n\n\n5. ğŸ’» ç¼–å†™æµ‹è¯•ä»£ç 5.1 ğŸ“„ å®Œæ•´æµ‹è¯•ç¨‹åº#include &lt;iostream&gt;#include &lt;mariadb/conncpp.hpp&gt; // Connector/C++ çš„ä¸»è¦å¤´æ–‡ä»¶// æ•°æ®åº“é…ç½®ç»“æ„struct DatabaseConfig &#123;    std::string host = &quot;localhost&quot;;    int port = 3306;    std::string database = &quot;test_db&quot;;    std::string username = &quot;root&quot;;    std::string password = &quot;your_root_password_here&quot;; // æ›¿æ¢ä¸ºå®é™…å¯†ç &#125;;int main() &#123;    DatabaseConfig config;    try &#123;        std::cout &lt;&lt; &quot;ğŸ”Œ æ­£åœ¨è¿æ¥åˆ° MariaDB æœåŠ¡å™¨...&quot; &lt;&lt; std::endl;        // 1. è·å–é©±åŠ¨å®ä¾‹        sql::mariadb::IMariaDBDriver* driver = sql::mariadb::get_driver_instance();        // 2. é…ç½®æ•°æ®åº“è¿æ¥å±æ€§        sql::SQLString url = &quot;jdbc:mariadb://&quot; + config.host + &quot;:&quot; +                           std::to_string(config.port) + &quot;/&quot; + config.database;        sql::Properties properties;        properties[&quot;user&quot;] = config.username;        properties[&quot;password&quot;] = config.password;        // 3. å»ºç«‹è¿æ¥        std::unique_ptr&lt;sql::Connection&gt; conn(driver-&gt;connect(url, properties));        std::cout &lt;&lt; &quot;âœ… æˆåŠŸè¿æ¥åˆ° MariaDB æœåŠ¡å™¨ï¼&quot; &lt;&lt; std::endl;        std::cout &lt;&lt; &quot;ğŸ“Š æ•°æ®åº“: &quot; &lt;&lt; config.database &lt;&lt; std::endl;        std::cout &lt;&lt; &quot;ğŸŒ ä¸»æœº: &quot; &lt;&lt; config.host &lt;&lt; &quot;:&quot; &lt;&lt; config.port &lt;&lt; std::endl;        // 4. æ‰§è¡Œç®€å•æŸ¥è¯¢æµ‹è¯•        std::cout &lt;&lt; &quot;\\nğŸ” æ‰§è¡Œæµ‹è¯•æŸ¥è¯¢...&quot; &lt;&lt; std::endl;        std::unique_ptr&lt;sql::Statement&gt; stmt(conn-&gt;createStatement());        std::unique_ptr&lt;sql::ResultSet&gt; res(            stmt-&gt;executeQuery(&quot;SELECT VERSION() as version, NOW() as current_time&quot;)        );        if (res-&gt;next()) &#123;            std::cout &lt;&lt; &quot;ğŸ“¦ MariaDB ç‰ˆæœ¬: &quot; &lt;&lt; res-&gt;getString(&quot;version&quot;) &lt;&lt; std::endl;            std::cout &lt;&lt; &quot;â° å½“å‰æ—¶é—´: &quot; &lt;&lt; res-&gt;getString(&quot;current_time&quot;) &lt;&lt; std::endl;        &#125;        // 5. åˆ›å»ºæµ‹è¯•è¡¨        std::cout &lt;&lt; &quot;\\nğŸ—ï¸  åˆ›å»ºæµ‹è¯•è¡¨...&quot; &lt;&lt; std::endl;        stmt-&gt;execute(&quot;DROP TABLE IF EXISTS test_users&quot;);        stmt-&gt;execute(R&quot;(            CREATE TABLE test_users (                id INT AUTO_INCREMENT PRIMARY KEY,                username VARCHAR(50) NOT NULL,                email VARCHAR(100),                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP            )        )&quot;);        std::cout &lt;&lt; &quot;âœ… æµ‹è¯•è¡¨åˆ›å»ºæˆåŠŸ&quot; &lt;&lt; std::endl;        // 6. æ’å…¥æµ‹è¯•æ•°æ®        std::cout &lt;&lt; &quot;\\nğŸ“ æ’å…¥æµ‹è¯•æ•°æ®...&quot; &lt;&lt; std::endl;        std::unique_ptr&lt;sql::PreparedStatement&gt; pstmt(            conn-&gt;prepareStatement(&quot;INSERT INTO test_users (username, email) VALUES (?, ?)&quot;)        );        pstmt-&gt;setString(1, &quot;test_user1&quot;);        pstmt-&gt;setString(2, &quot;user1@example.com&quot;);        pstmt-&gt;executeUpdate();        pstmt-&gt;setString(1, &quot;test_user2&quot;);        pstmt-&gt;setString(2, &quot;user2@example.com&quot;);        pstmt-&gt;executeUpdate();        std::cout &lt;&lt; &quot;âœ… æµ‹è¯•æ•°æ®æ’å…¥æˆåŠŸ&quot; &lt;&lt; std::endl;        // 7. æŸ¥è¯¢æµ‹è¯•æ•°æ®        std::cout &lt;&lt; &quot;\\nğŸ“‹ æŸ¥è¯¢æµ‹è¯•æ•°æ®...&quot; &lt;&lt; std::endl;        std::unique_ptr&lt;sql::ResultSet&gt; selectRes(            stmt-&gt;executeQuery(&quot;SELECT * FROM test_users ORDER BY id&quot;)        );        std::cout &lt;&lt; &quot;+----+------------+---------------------+---------------------+&quot; &lt;&lt; std::endl;        std::cout &lt;&lt; &quot;| ID | Username   | Email               | Created At          |&quot; &lt;&lt; std::endl;        std::cout &lt;&lt; &quot;+----+------------+---------------------+---------------------+&quot; &lt;&lt; std::endl;        while (selectRes-&gt;next()) &#123;            std::cout &lt;&lt; &quot;| &quot; &lt;&lt; std::setw(2) &lt;&lt; selectRes-&gt;getInt(&quot;id&quot;)                      &lt;&lt; &quot; | &quot; &lt;&lt; std::setw(10) &lt;&lt; selectRes-&gt;getString(&quot;username&quot;)                      &lt;&lt; &quot; | &quot; &lt;&lt; std::setw(19) &lt;&lt; selectRes-&gt;getString(&quot;email&quot;)                      &lt;&lt; &quot; | &quot; &lt;&lt; std::setw(19) &lt;&lt; selectRes-&gt;getString(&quot;created_at&quot;)                      &lt;&lt; &quot; |&quot; &lt;&lt; std::endl;        &#125;        std::cout &lt;&lt; &quot;+----+------------+---------------------+---------------------+&quot; &lt;&lt; std::endl;        // 8. ç»Ÿè®¡è®°å½•æ•°        std::unique_ptr&lt;sql::ResultSet&gt; countRes(            stmt-&gt;executeQuery(&quot;SELECT COUNT(*) as total FROM test_users&quot;)        );        if (countRes-&gt;next()) &#123;            std::cout &lt;&lt; &quot;\\nğŸ“Š æ€»è®°å½•æ•°: &quot; &lt;&lt; countRes-&gt;getInt(&quot;total&quot;) &lt;&lt; std::endl;        &#125;        std::cout &lt;&lt; &quot;\\nğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼MariaDB C++ è¿æ¥é…ç½®æˆåŠŸï¼&quot; &lt;&lt; std::endl;    &#125; catch (sql::SQLException&amp; e) &#123;        std::cerr &lt;&lt; &quot;âŒ æ•°æ®åº“è¿æ¥æˆ–æŸ¥è¯¢é”™è¯¯:&quot; &lt;&lt; std::endl;        std::cerr &lt;&lt; &quot;   é”™è¯¯ä¿¡æ¯: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;        std::cerr &lt;&lt; &quot;   é”™è¯¯ä»£ç : &quot; &lt;&lt; e.getErrorCode() &lt;&lt; std::endl;        std::cerr &lt;&lt; &quot;   SQLçŠ¶æ€: &quot; &lt;&lt; e.getSQLState() &lt;&lt; std::endl;        return 1;    &#125; catch (std::exception&amp; e) &#123;        std::cerr &lt;&lt; &quot;âŒ ç¨‹åºé”™è¯¯: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;        return 1;    &#125;    return 0;&#125;\n\n5.2 ğŸƒâ€â™‚ï¸ è¿è¡Œæµ‹è¯•\nç¼–è¯‘é¡¹ç›®\nBuild â†’ Build Solution (Ctrl+Shift+B)\n\nè¿è¡Œç¨‹åº\nDebug â†’ Start Without Debugging (Ctrl+F5)\n\né¢„æœŸè¾“å‡º\nğŸ”Œ æ­£åœ¨è¿æ¥åˆ° MariaDB æœåŠ¡å™¨...âœ… æˆåŠŸè¿æ¥åˆ° MariaDB æœåŠ¡å™¨ï¼ğŸ“Š æ•°æ®åº“: test_dbğŸŒ ä¸»æœº: localhost:3306ğŸ” æ‰§è¡Œæµ‹è¯•æŸ¥è¯¢...ğŸ“¦ MariaDB ç‰ˆæœ¬: 11.8.0â° å½“å‰æ—¶é—´: 2025-11-14 16:30:00ğŸ—ï¸  åˆ›å»ºæµ‹è¯•è¡¨...âœ… æµ‹è¯•è¡¨åˆ›å»ºæˆåŠŸğŸ“ æ’å…¥æµ‹è¯•æ•°æ®...âœ… æµ‹è¯•æ•°æ®æ’å…¥æˆåŠŸğŸ“‹ æŸ¥è¯¢æµ‹è¯•æ•°æ®...+----+------------+---------------------+---------------------+| ID | Username   | Email               | Created At          |+----+------------+---------------------+---------------------+|  1 | test_user1 | user1@example.com   | 2025-11-14 16:30:01 ||  2 | test_user2 | user2@example.com   | 2025-11-14 16:30:01 |+----+------------+---------------------+---------------------+ğŸ“Š æ€»è®°å½•æ•°: 2ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼MariaDB C++ è¿æ¥é…ç½®æˆåŠŸï¼\n\n\n6. ğŸ”§ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ6.1 âŒ è¿æ¥å¤±è´¥é”™è¯¯ä¿¡æ¯: Can&#39;t connect to MySQL server\nè§£å†³æ–¹æ¡ˆ:\ngraph TD    A[è¿æ¥å¤±è´¥] --&gt; B&#123;æ£€æŸ¥é¡¹ç›®&#125;    B --&gt; C[MariaDBæœåŠ¡æ˜¯å¦å¯åŠ¨]    B --&gt; D[ç«¯å£3306æ˜¯å¦è¢«å ç”¨]    B --&gt; E[é˜²ç«å¢™è®¾ç½®]    B --&gt; F[ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®]    C --&gt; G[å¯åŠ¨æœåŠ¡: net start mysql]    D --&gt; H[æ›´æ¢ç«¯å£æˆ–é‡Šæ”¾ç«¯å£]    E --&gt; I[æ·»åŠ é˜²ç«å¢™ä¾‹å¤–]    F --&gt; J[é‡ç½®rootå¯†ç ]\n\n6.2 âŒ DLL æ‰¾ä¸åˆ°é”™è¯¯ä¿¡æ¯: æ— æ³•å¯åŠ¨æ­¤ç¨‹åºï¼Œå› ä¸ºè®¡ç®—æœºä¸­ä¸¢å¤± libmariadb.dll\nè§£å†³æ–¹æ¡ˆ:\n\nç¡®è®¤ DLL æ–‡ä»¶åœ¨æ­£ç¡®ä½ç½®\næ£€æŸ¥ PATH ç¯å¢ƒå˜é‡\nå°† DLL å¤åˆ¶åˆ°é¡¹ç›®è¾“å‡ºç›®å½•\n\n6.3 âŒ ç¼–è¯‘é”™è¯¯å¸¸è§ç¼–è¯‘é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ:\n\n\n\né”™è¯¯ä¿¡æ¯\nåŸå› \nè§£å†³æ–¹æ¡ˆ\n\n\n\næ— æ³•æ‰¾åˆ°å¤´æ–‡ä»¶\nInclude ç›®å½•æœªæ­£ç¡®é…ç½®\næ£€æŸ¥é™„åŠ åŒ…å«ç›®å½•è®¾ç½®\n\n\næ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å·\nåº“æ–‡ä»¶æœªæ­£ç¡®é“¾æ¥\næ£€æŸ¥é™„åŠ ä¾èµ–é¡¹å’Œåº“ç›®å½•\n\n\nå­—ç¬¦é›†ä¸åŒ¹é…\nUnicode&#x2F;ANSI ç¼–ç é—®é¢˜\nåœ¨é¡¹ç›®è®¾ç½®ä¸­ç»Ÿä¸€å­—ç¬¦é›†\n\n\n\n7. ğŸš€ é«˜çº§é…ç½®7.1 ğŸ” è¿æ¥æ± é…ç½®#include &lt;mariadb/conncpp.hpp&gt;class MariaDBConnectionPool &#123;private:    std::unique_ptr&lt;sql::mariadb::IMariaDBDriver&gt; driver;    sql::SQLString url;    sql::Properties properties;    std::vector&lt;std::unique_ptr&lt;sql::Connection&gt;&gt; connections;    std::mutex mutex;    int maxConnections;public:    MariaDBConnectionPool(const std::string&amp; host, int port,                         const std::string&amp; database,                         const std::string&amp; username,                         const std::string&amp; password,                         int maxConn = 10)        : maxConnections(maxConn) &#123;        driver = std::unique_ptr&lt;sql::mariadb::IMariaDBDriver&gt;(            sql::mariadb::get_driver_instance()        );        url = &quot;jdbc:mariadb://&quot; + host + &quot;:&quot; + std::to_string(port) + &quot;/&quot; + database;        properties[&quot;user&quot;] = username;        properties[&quot;password&quot;] = password;        properties[&quot;autoReconnect&quot;] = &quot;true&quot;;        properties[&quot;useSSL&quot;] = &quot;false&quot;;    &#125;    std::unique_ptr&lt;sql::Connection&gt; getConnection() &#123;        std::lock_guard&lt;std::mutex&gt; lock(mutex);        for (auto&amp; conn : connections) &#123;            if (conn &amp;&amp; !conn-&gt;isClosed()) &#123;                return std::move(conn);            &#125;        &#125;        // åˆ›å»ºæ–°è¿æ¥        return std::unique_ptr&lt;sql::Connection&gt;(            driver-&gt;connect(url, properties)        );    &#125;    void returnConnection(std::unique_ptr&lt;sql::Connection&gt; conn) &#123;        std::lock_guard&lt;std::mutex&gt; lock(mutex);        if (conn &amp;&amp; connections.size() &lt; maxConnections) &#123;            connections.push_back(std::move(conn));        &#125;    &#125;&#125;;\n\n7.2 ğŸ“ äº‹åŠ¡å¤„ç†void transactionExample(std::unique_ptr&lt;sql::Connection&gt;&amp; conn) &#123;    try &#123;        // å¼€å§‹äº‹åŠ¡        std::unique_ptr&lt;sql::Statement&gt; stmt(conn-&gt;createStatement());        stmt-&gt;execute(&quot;START TRANSACTION&quot;);        // æ‰§è¡Œå¤šä¸ªSQLæ“ä½œ        std::unique_ptr&lt;sql::PreparedStatement&gt; pstmt(            conn-&gt;prepareStatement(&quot;UPDATE accounts SET balance = balance - ? WHERE id = ?&quot;)        );        // æ‰£æ¬¾        pstmt-&gt;setDouble(1, 100.0);        pstmt-&gt;setInt(2, 1);        pstmt-&gt;executeUpdate();        // åŠ æ¬¾        pstmt-&gt;setDouble(1, 100.0);        pstmt-&gt;setInt(2, 2);        pstmt-&gt;executeUpdate();        // æäº¤äº‹åŠ¡        conn-&gt;commit();        std::cout &lt;&lt; &quot;âœ… äº‹åŠ¡æ‰§è¡ŒæˆåŠŸ&quot; &lt;&lt; std::endl;    &#125; catch (sql::SQLException&amp; e) &#123;        // å›æ»šäº‹åŠ¡        conn-&gt;rollback();        std::cerr &lt;&lt; &quot;âŒ äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå·²å›æ»š: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;    &#125;&#125;\n\n7.3 ğŸŒ å›½é™…åŒ–æ”¯æŒvoid setupUTF8Connection(std::unique_ptr&lt;sql::Connection&gt;&amp; conn) &#123;    try &#123;        // è®¾ç½®è¿æ¥å­—ç¬¦é›†        std::unique_ptr&lt;sql::Statement&gt; stmt(conn-&gt;createStatement());        stmt-&gt;execute(&quot;SET NAMES &#x27;utf8mb4&#x27;&quot;);        stmt-&gt;execute(&quot;SET CHARACTER SET utf8mb4&quot;);        std::cout &lt;&lt; &quot;âœ… UTF-8 å­—ç¬¦é›†é…ç½®å®Œæˆ&quot; &lt;&lt; std::endl;        // æµ‹è¯•ä¸­æ–‡æ”¯æŒ        std::unique_ptr&lt;sql::PreparedStatement&gt; pstmt(            conn-&gt;prepareStatement(&quot;INSERT INTO test_table (name) VALUES (?)&quot;)        );        pstmt-&gt;setString(1, &quot;æµ‹è¯•ä¸­æ–‡å­—ç¬¦&quot;);        pstmt-&gt;executeUpdate();    &#125; catch (sql::SQLException&amp; e) &#123;        std::cerr &lt;&lt; &quot;âŒ UTF-8 é…ç½®å¤±è´¥: &quot; &lt;&lt; e.what() &lt;&lt; std::endl;    &#125;&#125;\n\n\nğŸ“Š æ€»ç»“âœ… æˆåŠŸæ ‡å¿—\n MariaDB æœåŠ¡å™¨å®‰è£…å®Œæˆ\n Connector&#x2F;C å’Œ Connector&#x2F;C++ å®‰è£…å®Œæˆ\n Visual Studio é¡¹ç›®é…ç½®æ­£ç¡®\n æµ‹è¯•ç¨‹åºè¿è¡ŒæˆåŠŸ\n åŸºæœ¬æ•°æ®åº“æ“ä½œæ­£å¸¸\n\nğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®\nå­¦ä¹ é«˜çº§ SQL æ“ä½œï¼šå­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€è§†å›¾\næŒæ¡è¿æ¥æ± æŠ€æœ¯ï¼šæé«˜åº”ç”¨ç¨‹åºæ€§èƒ½\näº†è§£äº‹åŠ¡å¤„ç†ï¼šç¡®ä¿æ•°æ®ä¸€è‡´æ€§\nå®ç°é”™è¯¯å¤„ç†ï¼šå¢å¼ºç¨‹åºå¥å£®æ€§\nå®‰å…¨é…ç½®ï¼šé˜²æ­¢ SQL æ³¨å…¥æ”»å‡»\n\nğŸ“š æ¨èèµ„æº\nMariaDB Connector&#x2F;C++ å®˜æ–¹æ–‡æ¡£\nSQL åŸºç¡€æ•™ç¨‹\nC++ æ•°æ®åº“ç¼–ç¨‹æœ€ä½³å®è·µ\n\n\n\nğŸ’¡ æç¤º: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·åŠ¡å¿…ï¼š\n\nä½¿ç”¨å¼ºå¯†ç å’Œè¿æ¥åŠ å¯†\nå®æ–½é€‚å½“çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•\nå®šæœŸå¤‡ä»½æ•°æ®åº“\nç›‘æ§æ•°æ®åº“æ€§èƒ½å’Œå®‰å…¨\n\n\n","categories":["æ•°æ®åº“ç³»ç»Ÿ","å…³ç³»å‹æ•°æ®åº“"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Gemini CLI åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸‹çš„å®Œæ•´é…ç½®æŒ‡å—","url":"/posts/gemini-cli-proxy/","content":"Gemini CLI åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸‹çš„å®Œæ•´é…ç½®æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-12-18æœ€åæ›´æ–°: 2025-12-18æ ‡ç­¾: gemini-cli, proxy, vpn, network, ai-tools, è·¨åŸŸè®¿é—®\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. ç³»ç»Ÿè¦æ±‚\n3. ç¯å¢ƒå‡†å¤‡\n4. Gemini CLI å®‰è£…é…ç½®\n5. ä»£ç†é…ç½®\n6. è®¤è¯æµç¨‹\n7. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ\n8. æœ€ä½³å®è·µ\n9. éªŒè¯æµ‹è¯•\n10. æ€»ç»“\n\n\n1. ğŸ“– æ¦‚è¿°æœ¬æ–‡æ¡£æä¾›äº†ä¸€å¥—å®Œæ•´çš„ Gemini CLI åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸‹çš„é…ç½®è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ä»£ç†æœåŠ¡å’Œ VPN ç»„åˆï¼Œå®ç°ç¨³å®šçš„ Google æœåŠ¡è®¿é—®ã€‚\n2. âš™ï¸ ç³»ç»Ÿè¦æ±‚ç³»ç»Ÿè¦æ±‚åŸºç¡€ç¯å¢ƒ\n\n\nç»„ä»¶\næœ€ä½ç‰ˆæœ¬\næ¨èç‰ˆæœ¬\néªŒè¯æ–¹æ³•\n\n\n\nNode.js\nv18.x\nv20.x+\nnode --version\n\n\nnpm\nv9.x\nv10.x+\nnpm --version\n\n\næ“ä½œç³»ç»Ÿ\nWindows 10+\nWindows 11&#x2F;macOS&#x2F;Linux\nç³»ç»Ÿä¿¡æ¯\n\n\nç½‘ç»œç¯å¢ƒä»£ç†æœåŠ¡è¦æ±‚\n\n\nè¦æ±‚é¡¹\nè§„æ ¼\nè¯´æ˜\n\n\n\nåè®®æ”¯æŒ\nâœ… HTTPS\nå¿…é¡»æ”¯æŒ SSL&#x2F;TLS\n\n\nç«¯å£é…ç½®\nâœ… è‡ªå®šä¹‰ç«¯å£\næ”¯æŒå¸¸ç”¨ç«¯å£ï¼ˆ7890, 7890, 10808ç­‰ï¼‰\n\n\nè¿æ¥ç¨³å®šæ€§\nâœ… é«˜å¯ç”¨\n99%+ è¿æ¥æˆåŠŸç‡\n\n\nå¸¦å®½è¦æ±‚\nâœ… &gt; 1Mbps\næ»¡è¶³ API è°ƒç”¨éœ€æ±‚\n\n\nVPN æœåŠ¡è¦æ±‚\n\n\nè¦æ±‚é¡¹\nè§„æ ¼\nè¯´æ˜\n\n\n\nåœ°ç†ä½ç½®\nâš ï¸ ç¾å›½èŠ‚ç‚¹æ¨è\né¿å…åœ°ç†ä½ç½®é™åˆ¶\n\n\nåè®®æ”¯æŒ\nâœ… OpenVPN&#x2F;WireGuard\nç¡®ä¿å…¼å®¹æ€§\n\n\nDNS ä¿æŠ¤\nâœ… DNS leaké˜²æŠ¤\né˜²æ­¢ DNS æ³„éœ²\n\n\nKill Switch\nâœ… è‡ªåŠ¨æ–­ç½‘ä¿æŠ¤\næ„å¤–æ–­å¼€æ—¶ä¿æŠ¤éšç§\n\n\nç¯å¢ƒå‡†å¤‡Node.js å®‰è£…Windows å®‰è£…\nè®¿é—® Node.js å®˜ç½‘\nä¸‹è½½ Windows å®‰è£…åŒ…ï¼ˆ.msiï¼‰\nè¿è¡Œå®‰è£…ç¨‹åºï¼Œå‹¾é€‰ â€œAdd to PATHâ€\néªŒè¯å®‰è£…ï¼š\n\nnode --versionnpm --version\n\nmacOS å®‰è£…# ä½¿ç”¨ Homebrewbrew install node# æˆ–ä¸‹è½½å®˜æ–¹å®‰è£…åŒ…\n\nLinux å®‰è£…# Ubuntu/Debiancurl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -sudo apt-get install -y nodejs# æˆ–ä½¿ç”¨ NodeSource\n\nç½‘ç»œè¿æ¥æµ‹è¯•# æµ‹è¯• Google å¯è®¿é—®æ€§curl -I https://google.com# æµ‹è¯•ç‰¹å®šæœåŠ¡å™¨è¿é€šæ€§ping 216.239.32.223# æµ‹è¯• HTTPS ä»£ç†curl -x http://127.0.0.1:7890 https://www.google.com\n\nGemini CLI å®‰è£…é…ç½®å…¨å±€å®‰è£…# æ ‡å‡†å®‰è£…å‘½ä»¤npm install -g @google/gemini-cli# éªŒè¯å®‰è£…gemini --version# æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯gemini --help# æµ‹è¯•è°ƒè¯•æ¨¡å¼gemini -d --help\n\nå®‰è£…éªŒè¯# éªŒè¯ npm åŒ…å®‰è£…npm list -g @google/gemini-cli# æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶where gemini  # Windowswhich gemini   # macOS/Linux# æµ‹è¯•åŸºæœ¬åŠŸèƒ½gemini --version\n\nä»£ç†é…ç½®ç¯å¢ƒå˜é‡é…ç½®Windows ç³»ç»ŸCMD ç¯å¢ƒï¼š\nrem è®¾ç½® HTTP ä»£ç†ï¼ˆæ¢æˆä½ è‡ªå·±çš„ä»£ç†åœ°å€ï¼‰set HTTP_PROXY=http://127.0.0.1:7890set HTTPS_PROXY=https://127.0.0.1:7890rem éªŒè¯è®¾ç½®echo %HTTP_PROXY%echo %HTTPS_PROXY%\n\nPowerShell ç¯å¢ƒï¼š\n# è®¾ç½®ä»£ç†ç¯å¢ƒå˜é‡$env:HTTP_PROXY=&quot;http://127.0.0.1:7890&quot;$env:HTTPS_PROXY=&quot;https://127.0.0.1:7890&quot;# éªŒè¯è®¾ç½®$env:HTTP_PROXY$env:HTTPS_PROXY\n\nmacOS&#x2F;Linux ç³»ç»Ÿ# Bash/Zsh ç¯å¢ƒexport HTTP_PROXY=http://127.0.0.1:7890export HTTPS_PROXY=https://127.0.0.1:7890# éªŒè¯è®¾ç½®echo $HTTP_PROXYecho $HTTPS_PROXY# æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ï¼ˆæ°¸ä¹…ç”Ÿæ•ˆï¼‰echo &#x27;export HTTP_PROXY=http://127.0.0.1:7890&#x27; &gt;&gt; ~/.bashrcecho &#x27;export HTTPS_PROXY=https://127.0.0.1:7890&#x27; &gt;&gt; ~/.bashrcsource ~/.bashrc\n\nä»£ç†æ’é™¤è®¾ç½®# Windows CMDset NO_PROXY=localhost,127.0.0.1,.local# Windows PowerShell$env:NO_PROXY=&quot;localhost,127.0.0.1,.local&quot;# macOS/Linuxexport NO_PROXY=localhost,127.0.0.1,.local\n\nä»£ç†æœåŠ¡é…ç½®ç¤ºä¾‹Clash é…ç½®# Gemini CLI ä¸“ç”¨è§„åˆ™rules:  # Google ç›¸å…³åŸŸåèµ°ä»£ç†  - &#x27;DOMAIN-SUFFIX,googleapis.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;  - &#x27;DOMAIN-SUFFIX,google.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;  - &#x27;DOMAIN,generativelanguage.googleapis.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;  - &#x27;DOMAIN,aistudio.google.com,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;  # Gemini CLI è¿›ç¨‹èµ°ä»£ç†  - &#x27;PROCESS-NAME,gemini,ğŸ”° èŠ‚ç‚¹é€‰æ‹©&#x27;proxy-groups:  - name: ğŸ”° èŠ‚ç‚¹é€‰æ‹©    type: select    proxies:      - ç¾å›½èŠ‚ç‚¹1      - ç¾å›½èŠ‚ç‚¹2      - ç¾å›½èŠ‚ç‚¹3\n\nè®¤è¯æµç¨‹å¯åŠ¨ Gemini CLI# åŸºç¡€å¯åŠ¨gemini# è°ƒè¯•æ¨¡å¼å¯åŠ¨gemini -d# æŒ‡å®šæ¨¡å‹å¯åŠ¨gemini --model=gemini-1.5-flash\n\nè®¤è¯æ­¥éª¤\nGemini CLI ä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨è¿›è¡Œ OAuth è®¤è¯\nç™»å½• Google è´¦å·\næˆæƒ Gemini CLI è®¿é—®æƒé™\næµè§ˆå™¨ä¼šè·³è½¬å›æœ¬åœ°ç«¯å£ï¼ˆé€šå¸¸ä¸º localhost:11101ï¼‰\nCLI ç¡®è®¤è®¤è¯æˆåŠŸ\n\nå¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆè¿æ¥è¶…æ—¶é—®é¢˜ç—‡çŠ¶ï¼š\n\nç»ˆç«¯æ˜¾ç¤º â€œWaiting for authâ€¦â€ åè‡ªåŠ¨é€€å‡º\næµè§ˆå™¨æˆæƒæˆåŠŸä½† CLI è¿æ¥å¤±è´¥\né”™è¯¯æ—¥å¿—æ˜¾ç¤º AggregateError [ETIMEDOUT]\n\nè§£å†³æ­¥éª¤ï¼š\n# 1. å¯ç”¨è°ƒè¯•æ¨¡å¼gemini -d# 2. æ£€æŸ¥ä»£ç†è®¾ç½®echo $HTTPS_PROXY  # Linux/macOSecho %HTTPS_PROXY%  # Windows# 3. æµ‹è¯•ç½‘ç»œè¿é€šæ€§curl -x $HTTPS_PROXY https://google.com# 4. æ£€æŸ¥ç‰¹å®šæœåŠ¡å™¨curl -x $HTTPS_PROXY https://216.239.32.223# 5. æµ‹è¯• DNS è§£ænslookup google.com 8.8.8.8\n\nè®¤è¯æˆæƒé—®é¢˜æ£€æŸ¥æ¸…å•ï¼š\n\n é˜²ç«å¢™æ˜¯å¦é˜»æ­¢ localhost:11101\n æ€æ¯’è½¯ä»¶æ˜¯å¦æ‹¦æˆª Gemini CLI\n ä»£ç†æ˜¯å¦æ”¯æŒ WebSocket è¿æ¥\n æµè§ˆå™¨æ˜¯å¦å…è®¸é‡å®šå‘\n\nç¯å¢ƒå˜é‡é—®é¢˜éªŒè¯æ–¹æ³•ï¼š\n# æ£€æŸ¥å½“å‰ç¯å¢ƒå˜é‡env | grep -i proxy  # Linux/macOSset | findstr PROXY     # Windows# æµ‹è¯•ä»£ç†è¿æ¥curl -v -x $HTTPS_PROXY https://httpbin.org/ip\n\nè§£å†³æ–¹æ¡ˆ# ä¸´æ—¶è®¾ç½®ï¼ˆå½“å‰ä¼šè¯æœ‰æ•ˆï¼‰export HTTPS_PROXY=http://127.0.0.1:7890# æ°¸ä¹…è®¾ç½®ï¼ˆå†™å…¥é…ç½®æ–‡ä»¶ï¼‰echo &#x27;export HTTPS_PROXY=http://127.0.0.1:7890&#x27; &gt;&gt; ~/.profilesource ~/.profile# ç³»ç»Ÿçº§è®¾ç½®ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰sudo tee /etc/environment &gt; /dev/null &lt;&lt;EOFHTTPS_PROXY=http://127.0.0.1:7890HTTP_PROXY=http://127.0.0.1:7890NO_PROXY=localhost,127.0.0.1,.localEOF\n\næœ€ä½³å®è·µæ€§èƒ½ä¼˜åŒ–èŠ‚ç‚¹è¯„ä¼°æ ‡å‡†\n\n\næŒ‡æ ‡\nä¼˜ç§€\nè‰¯å¥½\nå¯æ¥å—\n\n\n\nå»¶è¿Ÿ\n&lt; 100ms\n100-200ms\n200-500ms\n\n\nç¨³å®šæ€§\n99.9%+\n99%+\n95%+\n\n\nå¸¦å®½\n&gt; 10Mbps\n5-10Mbps\n&gt; 1Mbps\n\n\næˆåŠŸç‡\n100%\n99%+\n95%+\n\n\nè‡ªåŠ¨åˆ‡æ¢é…ç½®# Clash é…ç½®ç¤ºä¾‹proxy-groups:  - name: &quot;Auto-Best-Proxy&quot;    type: url-test    url: &quot;http://www.gstatic.com/generate_204&quot;    interval: 300    tolerance: 50    use:      - proxy-nodes\n\nå®‰å…¨ç­–ç•¥ç½‘ç»œå®‰å…¨\né€‰æ‹©å¯ä¿¡æœåŠ¡å•†ï¼šé¿å…ä½¿ç”¨å…è´¹æˆ–ä¸ç¨³å®šçš„ä»£ç†æœåŠ¡\nåŠ å¯†é€šä¿¡ï¼šç¡®ä¿ä»£ç†æ”¯æŒ HTTPS åè®®\næ—¥å¿—å®¡è®¡ï¼šå®šæœŸæ£€æŸ¥ä»£ç†è¿æ¥æ—¥å¿—\nè®¿é—®æ§åˆ¶ï¼šé™åˆ¶ä»£ç†æœåŠ¡çš„è®¿é—®æƒé™\n\nè´¦å·å®‰å…¨\nä¸¤æ­¥éªŒè¯ï¼šä¸º Google è´¦å·å¯ç”¨ 2FA\nåº”ç”¨å¯†ç ï¼šä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç è€Œéä¸»å¯†ç \nå®šæœŸå®¡æŸ¥ï¼šæ£€æŸ¥æˆæƒçš„åº”ç”¨åˆ—è¡¨\nå®‰å…¨ç›‘æ§ï¼šç›‘æ§å¼‚å¸¸ç™»å½•æ´»åŠ¨\n\néªŒè¯æµ‹è¯•åŸºç¡€ç¯å¢ƒéªŒè¯# æµ‹è¯•åŸºç¡€è¿æ¥curl -I https://www.google.com# æµ‹è¯•ä»£ç†è¿æ¥curl -x $HTTPS_PROXY -I https://www.google.com# æµ‹è¯•ç‰¹å®šæœåŠ¡å™¨curl -x $HTTPS_PROXY -I https://216.239.32.223# æµ‹è¯• API ç«¯ç‚¹curl -x $HTTPS_PROXY https://generativelanguage.googleapis.com\n\nç«¯åˆ°ç«¯æµ‹è¯•è„šæœ¬#!/bin/bash# Gemini CLI è®¤è¯æµ‹è¯•è„šæœ¬echo &quot;å¼€å§‹ Gemini CLI è®¤è¯æµ‹è¯•...&quot;# 1. æ£€æŸ¥ç¯å¢ƒå˜é‡if [ -z &quot;$HTTPS_PROXY&quot; ]; then    echo &quot;âŒ ä»£ç†ç¯å¢ƒå˜é‡æœªè®¾ç½®&quot;    exit 1fiecho &quot;âœ… ä»£ç†ç¯å¢ƒå˜é‡: $HTTPS_PROXY&quot;# 2. æµ‹è¯•ç½‘ç»œè¿æ¥if ! curl -s -x &quot;$HTTPS_PROXY&quot; https://www.google.com &gt; /dev/null; then    echo &quot;âŒ ä»£ç†è¿æ¥å¤±è´¥&quot;    exit 1fiecho &quot;âœ… ä»£ç†è¿æ¥æ­£å¸¸&quot;# 3. å¯åŠ¨è°ƒè¯•æ¨¡å¼echo &quot;å¯åŠ¨ Gemini CLI è°ƒè¯•æ¨¡å¼...&quot;timeout 30 gemini -d &amp;GEMINI_PID=$!# 4. ç­‰å¾…è®¤è¯å®Œæˆsleep 5# 5. æ£€æŸ¥è¿›ç¨‹çŠ¶æ€if kill -0 $GEMINI_PID 2&gt;/dev/null; then    echo &quot;âœ… Gemini CLI è¿›ç¨‹è¿è¡Œä¸­&quot;    echo &quot;è¯·å®Œæˆæµè§ˆå™¨è®¤è¯æµç¨‹&quot;    wait $GEMINI_PID    echo &quot;âœ… è®¤è¯æµç¨‹å®Œæˆ&quot;else    echo &quot;âŒ Gemini CLI è¿›ç¨‹å¼‚å¸¸é€€å‡º&quot;fi\n\næ€»ç»“æœ¬æ–‡æ¡£æä¾›äº†ä¸€å¥—å®Œæ•´çš„ Gemini CLI åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸‹çš„é…ç½®è§£å†³æ–¹æ¡ˆï¼Œæ¶µç›–äº†ä»ç¯å¢ƒå‡†å¤‡åˆ°æœ€ç»ˆéªŒè¯çš„å®Œæ•´æµç¨‹ã€‚\nå…³é”®æˆåŠŸå› ç´ \nä»£ç†æœåŠ¡ç¨³å®šæ€§ï¼šé€‰æ‹©å¯é çš„ä»£ç†æœåŠ¡æä¾›å•†\nç¯å¢ƒå˜é‡é…ç½®ï¼šæ­£ç¡®è®¾ç½® HTTPS_PROXY å’Œç›¸å…³ç¯å¢ƒå˜é‡\nç½‘ç»œå…¼å®¹æ€§ï¼šç¡®ä¿ä»£ç†æœåŠ¡æ”¯æŒ HTTPS åè®®å’Œ WebSocket è¿æ¥\nç³»ç»Ÿæƒé™é…ç½®ï¼šæ­£ç¡®é…ç½®é˜²ç«å¢™å’Œæ€æ¯’è½¯ä»¶\n\né€šè¿‡éµå¾ªæœ¬æ–‡æ¡£çš„æŒ‡å¯¼åŸåˆ™å’Œæœ€ä½³å®è·µï¼Œç”¨æˆ·å¯ä»¥åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸­ç¨³å®šã€é«˜æ•ˆåœ°ä½¿ç”¨ Gemini CLIï¼Œäº«å— Google AI æŠ€æœ¯å¸¦æ¥çš„ä¾¿åˆ©å’Œå¼ºå¤§åŠŸèƒ½ã€‚\n","categories":["å¼€å‘å·¥å…·"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"VSCode Qt MSVC é…ç½®æŒ‡å—","url":"/posts/55a960b4/","content":"VSCode Qt MSVC é…ç½®æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: vscode, qt, msvc, cmake, windows, development, cpp\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. ç¯å¢ƒå‡†å¤‡\n3. VS Code é…ç½®\n3.1 C&#x2F;C++ æ‰©å±•é…ç½®\n3.2 è°ƒè¯•å™¨é…ç½®\n3.3 æ„å»ºä»»åŠ¡é…ç½®\n3.4 Qt å¯è§†åŒ–è°ƒè¯•\n\n\n4. CMake é…ç½®\n5. ç¯å¢ƒéªŒè¯\n6. å¸¸è§é—®é¢˜è§£å†³\n7. å®Œæ•´å·¥ä½œæµç¨‹\n\n\n1. ğŸ“– æ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Windows ç³»ç»Ÿä¸Šé…ç½® VS Code è¿›è¡Œ Qt C++ å¼€å‘ï¼Œä½¿ç”¨ MSVC ç¼–è¯‘å™¨å’Œ CMake æ„å»ºç³»ç»Ÿã€‚\nğŸ¯ é…ç½®ç›®æ ‡\nâœ… ä½¿ç”¨ MSVC ç¼–è¯‘å™¨è¿›è¡Œ Qt å¼€å‘\nâœ… VS Code å®Œæ•´çš„ IntelliSense æ”¯æŒ\nâœ… é›†æˆçš„è°ƒè¯•å’Œæ„å»ºåŠŸèƒ½\nâœ… è·¨å¹³å° CMake æ„å»ºç³»ç»Ÿ\n\nğŸ—ï¸ ç³»ç»Ÿæ¶æ„graph TB    A[VS Code IDE] --&gt; B[C/C++ Extension]    A --&gt; C[CMake Tools Extension]    A --&gt; D[Qt Extension]    B --&gt; E[IntelliSense Engine]    C --&gt; F[CMake Configuration]    D --&gt; G[Qt Tools Integration]    E --&gt; H[MSVC Compiler]    F --&gt; I[Build System]    G --&gt; J[Qt Libraries]    H --&gt; K[cl.exe]    I --&gt; L[cmake.exe]    J --&gt; M[Qt5/Qt6]\n\n\n2. ğŸ”§ ç¯å¢ƒå‡†å¤‡2.1 å¿…éœ€ç»„ä»¶\n\n\nç»„ä»¶\nç‰ˆæœ¬è¦æ±‚\nä¸‹è½½åœ°å€\n\n\n\nVisual Studio Build Tools\n2019&#x2F;2022\nMicrosoftå®˜ç½‘\n\n\nQt\n5.6.3+ &#x2F; 6.x\nQtå®˜ç½‘\n\n\nCMake\n3.15+\nCMakeå®˜ç½‘\n\n\nVS Code\næœ€æ–°ç‰ˆ\nVS Codeå®˜ç½‘\n\n\n2.2 VS Code æ‰©å±•å®‰è£…# VSCode Qt MSVC é…ç½®æŒ‡å—code --install-extension ms-vscode.cpptoolscode --install-extension ms-vscode.cmake-toolscode --install-extension ms-vscode.cpptools-extension-pack# VSCode Qt MSVC é…ç½®æŒ‡å—code --install-extension twxs.cmakecode --install-extension ms-vscode.hexeditor\n\n\n3. âš™ï¸ VS Code é…ç½®3.1 ğŸ§  C&#x2F;C++ æ‰©å±•é…ç½®åˆ›å»º .vscode/c_cpp_properties.jsonï¼š\n&#123;    &quot;configurations&quot;: [        &#123;            &quot;name&quot;: &quot;Win32-MSVC&quot;,            &quot;includePath&quot;: [                &quot;$&#123;workspaceFolder&#125;/**&quot;,                // MSVC æ ‡å‡†åº“è·¯å¾„                &quot;$&#123;env.VCToolsInstallDir&#125;include&quot;,                // Windows SDK è·¯å¾„                &quot;$&#123;env.WindowsSdkDir&#125;Include/$&#123;env.WindowsSDKVersion&#125;/**&quot;,                // Qt åŒ…å«è·¯å¾„ï¼ˆä¿®æ”¹ä¸ºä½ çš„å®é™…è·¯å¾„ï¼‰                &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/include/**&quot;,                &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/include/QtCore&quot;,                &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/include/QtWidgets&quot;,                &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/include/QtGui&quot;,                // æ·»åŠ å…¶ä»–éœ€è¦çš„ Qt æ¨¡å—                &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/include/QtNetwork&quot;            ],            &quot;defines&quot;: [                &quot;_DEBUG&quot;,                &quot;UNICODE&quot;,                &quot;_UNICODE&quot;,                // Qt ç›¸å…³å®šä¹‰                &quot;QT_CORE_LIB&quot;,                &quot;QT_WIDGETS_LIB&quot;,                &quot;QT_GUI_LIB&quot;,                &quot;QT_NETWORK_LIB&quot;,                &quot;_WIN32_WINNT=0x0601&quot;  // Windows 7+            ],            &quot;compilerPath&quot;: &quot;C:/Program Files (x86)/Microsoft Visual Studio/2019/BuildTools/VC/Tools/MSVC/14.29.30133/bin/Hostx64/x64/cl.exe&quot;,            &quot;cStandard&quot;: &quot;c17&quot;,            &quot;cppStandard&quot;: &quot;c++17&quot;,            &quot;intelliSenseMode&quot;: &quot;windows-msvc-x64&quot;,            &quot;windowsSdkVersion&quot;: &quot;10.0.19041.0&quot;,            &quot;compileCommands&quot;: &quot;$&#123;workspaceFolder&#125;/build/compile_commands.json&quot;        &#125;    ],    &quot;version&quot;: 4&#125;\n\nâš™ï¸ å…³é”®é…ç½®è¯´æ˜ï¼š\n\n\n\né…ç½®é¡¹\nè¯´æ˜\nç¤ºä¾‹å€¼\n\n\n\ncompilerPath\nMSVC ç¼–è¯‘å™¨è·¯å¾„\ncl.exe å®Œæ•´è·¯å¾„\n\n\nintelliSenseMode\nIntelliSense å¼•æ“\nwindows-msvc-x64\n\n\nincludePath\nå¤´æ–‡ä»¶æœç´¢è·¯å¾„\nQt å’Œ MSVC åŒ…å«ç›®å½•\n\n\ndefines\né¢„å¤„ç†å™¨å®å®šä¹‰\nQt æ¨¡å—å’Œ Windows å®\n\n\n3.2 ğŸ› è°ƒè¯•å™¨é…ç½®åˆ›å»º .vscode/launch.jsonï¼š\n&#123;    &quot;version&quot;: &quot;0.2.0&quot;,    &quot;configurations&quot;: [        &#123;            &quot;name&quot;: &quot;Debug Qt App (MSVC)&quot;,            &quot;type&quot;: &quot;cppvsdbg&quot;,            &quot;request&quot;: &quot;launch&quot;,            &quot;program&quot;: &quot;$&#123;workspaceFolder&#125;/build/Debug/MyQtApp.exe&quot;,            &quot;args&quot;: [],            &quot;stopAtEntry&quot;: false,            &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;,            &quot;environment&quot;: [                &#123;                    &quot;name&quot;: &quot;PATH&quot;,                    &quot;value&quot;: &quot;$&#123;env:Path&#125;;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/bin;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/plugins/platforms&quot;                &#125;,                &#123;                    &quot;name&quot;: &quot;QT_DEBUG_PLUGINS&quot;,                    &quot;value&quot;: &quot;1&quot;                &#125;            ],            &quot;console&quot;: &quot;externalTerminal&quot;,            &quot;visualizerFile&quot;: &quot;$&#123;workspaceFolder&#125;/.vscode/qt.natvis&quot;,            &quot;preLaunchTask&quot;: &quot;cmake: build debug&quot;,            &quot;postDebugTask&quot;: &quot;cmake: clean&quot;        &#125;,        &#123;            &quot;name&quot;: &quot;Release Qt App (MSVC)&quot;,            &quot;type&quot;: &quot;cppvsdbg&quot;,            &quot;request&quot;: &quot;launch&quot;,            &quot;program&quot;: &quot;$&#123;workspaceFolder&#125;/build/Release/MyQtApp.exe&quot;,            &quot;args&quot;: [],            &quot;stopAtEntry&quot;: false,            &quot;cwd&quot;: &quot;$&#123;workspaceFolder&#125;&quot;,            &quot;environment&quot;: [                &#123;                    &quot;name&quot;: &quot;PATH&quot;,                    &quot;value&quot;: &quot;$&#123;env:Path&#125;;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/bin&quot;                &#125;            ],            &quot;console&quot;: &quot;externalTerminal&quot;,            &quot;preLaunchTask&quot;: &quot;cmake: build release&quot;        &#125;    ]&#125;\n\nğŸ” è°ƒè¯•é…ç½®è¦ç‚¹ï¼š\n\nè°ƒè¯•å™¨ç±»å‹: ä½¿ç”¨ cppvsdbg (MSVC åŸç”Ÿè°ƒè¯•å™¨)\nç¯å¢ƒå˜é‡: ç¡®ä¿ Qt DLL å’Œæ’ä»¶è·¯å¾„åœ¨ PATH ä¸­\nç¨‹åºè·¯å¾„: Debug å’Œ Release ç‰ˆæœ¬çš„æ­£ç¡®è·¯å¾„\nè°ƒè¯•æ’ä»¶: QT_DEBUG_PLUGINS=1 ç”¨äºè°ƒè¯• Qt æ’ä»¶é—®é¢˜\n\n3.3 ğŸ”¨ æ„å»ºä»»åŠ¡é…ç½®åˆ›å»º .vscode/tasks.jsonï¼š\n&#123;    &quot;version&quot;: &quot;2.0.0&quot;,    &quot;tasks&quot;: [        &#123;            &quot;label&quot;: &quot;cmake: configure&quot;,            &quot;type&quot;: &quot;shell&quot;,            &quot;command&quot;: &quot;cmake&quot;,            &quot;args&quot;: [                &quot;-B&quot;, &quot;build&quot;,                &quot;-G&quot;, &quot;Visual Studio 16 2019&quot;,                &quot;-A&quot;, &quot;x64&quot;,                &quot;-DCMAKE_BUILD_TYPE=Debug&quot;,                &quot;-DCMAKE_PREFIX_PATH=C:/Qt/Qt5.6.3/5.6.3/msvc2015_64&quot;            ],            &quot;group&quot;: &quot;build&quot;,            &quot;problemMatcher&quot;: [],            &quot;detail&quot;: &quot;é…ç½® CMake é¡¹ç›®&quot;        &#125;,        &#123;            &quot;label&quot;: &quot;cmake: build debug&quot;,            &quot;type&quot;: &quot;shell&quot;,            &quot;command&quot;: &quot;cmake&quot;,            &quot;args&quot;: [                &quot;--build&quot;, &quot;build&quot;,                &quot;--config&quot;, &quot;Debug&quot;,                &quot;--parallel&quot;            ],            &quot;group&quot;: &#123;                &quot;kind&quot;: &quot;build&quot;,                &quot;isDefault&quot;: true            &#125;,            &quot;problemMatcher&quot;: [&quot;$msCompile&quot;],            &quot;detail&quot;: &quot;æ„å»º Debug ç‰ˆæœ¬&quot;,            &quot;dependsOn&quot;: [&quot;cmake: configure&quot;]        &#125;,        &#123;            &quot;label&quot;: &quot;cmake: build release&quot;,            &quot;type&quot;: &quot;shell&quot;,            &quot;command&quot;: &quot;cmake&quot;,            &quot;args&quot;: [                &quot;--build&quot;, &quot;build&quot;,                &quot;--config&quot;, &quot;Release&quot;,                &quot;--parallel&quot;            ],            &quot;group&quot;: &quot;build&quot;,            &quot;problemMatcher&quot;: [&quot;$msCompile&quot;],            &quot;detail&quot;: &quot;æ„å»º Release ç‰ˆæœ¬&quot;        &#125;,        &#123;            &quot;label&quot;: &quot;cmake: clean&quot;,            &quot;type&quot;: &quot;shell&quot;,            &quot;command&quot;: &quot;cmake&quot;,            &quot;args&quot;: [                &quot;--build&quot;, &quot;build&quot;,                &quot;--target&quot;, &quot;clean&quot;            ],            &quot;group&quot;: &quot;build&quot;,            &quot;problemMatcher&quot;: [],            &quot;detail&quot;: &quot;æ¸…ç†æ„å»ºæ–‡ä»¶&quot;        &#125;,        &#123;            &quot;label&quot;: &quot;cmake: install qt dlls&quot;,            &quot;type&quot;: &quot;shell&quot;,            &quot;command&quot;: &quot;powershell&quot;,            &quot;args&quot;: [                &quot;-Command&quot;,                &quot;Copy-Item &#x27;C:\\\\Qt\\\\Qt5.6.3\\\\5.6.3\\\\msvc2015_64\\\\bin\\\\*.dll&#x27; &#x27;build\\\\Debug\\\\&#x27; -Force; Copy-Item &#x27;C:\\\\Qt\\\\Qt5.6.3\\\\5.6.3\\\\msvc2015_64\\\\plugins\\\\platforms\\\\qwindows.dll&#x27; &#x27;build\\\\Debug\\\\platforms\\\\&#x27; -Force&quot;            ],            &quot;group&quot;: &quot;build&quot;,            &quot;problemMatcher&quot;: [],            &quot;detail&quot;: &quot;å¤åˆ¶ Qt è¿è¡Œæ—¶ DLL&quot;        &#125;    ]&#125;\n\n3.4 ğŸ¨ Qt å¯è§†åŒ–è°ƒè¯•åˆ›å»º .vscode/qt.natvis æ–‡ä»¶ç”¨äº Qt ç±»å‹å¯è§†åŒ–ï¼š\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;AutoVisualizer xmlns=&quot;http://schemas.microsoft.com/vstudio/debugger/natvis/2010&quot;&gt;  &lt;Type Name=&quot;QString&quot;&gt;    &lt;DisplayString&gt;&#123;&#123; &#123;reinterpret_cast&lt;const wchar_t*&gt;(d-&gt;data()), d-&gt;size&#125; &#125;&#125;&lt;/DisplayString&gt;    &lt;StringView&gt;d-&gt;data(),d-&gt;size,utf-16&lt;/StringView&gt;    &lt;Expand&gt;      &lt;Item Name=&quot;[size]&quot;&gt;d-&gt;size&lt;/Item&gt;      &lt;Item Name=&quot;[raw]&quot;&gt;d-&gt;data(),d-&gt;size&lt;/Item&gt;    &lt;/Expand&gt;  &lt;/Type&gt;  &lt;Type Name=&quot;QByteArray&quot;&gt;    &lt;DisplayString&gt;&#123;&#123; &#123;d-&gt;data(),d-&gt;size&#125; &#125;&#125;&lt;/DisplayString&gt;    &lt;StringView&gt;d-&gt;data(),d-&gt;size&lt;/StringView&gt;    &lt;Expand&gt;      &lt;Item Name=&quot;[size]&quot;&gt;d-&gt;size&lt;/Item&gt;      &lt;ArrayItems&gt;        &lt;Size&gt;d-&gt;size&lt;/Size&gt;        &lt;ValuePointer&gt;d-&gt;data()&lt;/ValuePointer&gt;      &lt;/ArrayItems&gt;    &lt;/Expand&gt;  &lt;/Type&gt;  &lt;Type Name=&quot;QList&amp;lt;*&amp;gt;&quot;&gt;    &lt;DisplayString&gt;&#123;&#123; size=&#123;d-&gt;size&#125; &#125;&#125;&lt;/DisplayString&gt;    &lt;Expand&gt;      &lt;Item Name=&quot;[size]&quot;&gt;d-&gt;size&lt;/Item&gt;      &lt;ArrayItems&gt;        &lt;Size&gt;d-&gt;size&lt;/Size&gt;        &lt;ValuePointer&gt;e&lt;/ValuePointer&gt;      &lt;/ArrayItems&gt;    &lt;/Expand&gt;  &lt;/Type&gt;&lt;/AutoVisualizer&gt;\n\n\n4. ğŸ“¦ CMake é…ç½®4.1 ğŸ“„ CMakeLists.txtcmake_minimum_required(VERSION 3.15)project(MyQtApp LANGUAGES CXX)# VSCode Qt MSVC é…ç½®æŒ‡å—set(CMAKE_CXX_STANDARD 17)set(CMAKE_CXX_STANDARD_REQUIRED ON)# VSCode Qt MSVC é…ç½®æŒ‡å—if(MSVC)    # è®¾ç½®è¿è¡Œæ—¶åº“    set(CMAKE_MSVC_RUNTIME_LIBRARY &quot;MultiThreaded$&lt;$&lt;CONFIG:Debug&gt;:Debug&gt;DLL&quot;)    # å¯ç”¨å¹¶è¡Œç¼–è¯‘    add_compile_options(/MP)    # è­¦å‘Šè®¾ç½®    add_compile_options(/W3)    # ç¦ç”¨ä¸€äº› MSVC è­¦å‘Š    add_compile_definitions(_CRT_SECURE_NO_WARNINGS)endif()# VSCode Qt MSVC é…ç½®æŒ‡å—set(CMAKE_PREFIX_PATH &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64&quot;)set(CMAKE_AUTOMOC ON)set(CMAKE_AUTOUIC ON)set(CMAKE_AUTORCC ON)# VSCode Qt MSVC é…ç½®æŒ‡å—find_package(Qt5 COMPONENTS Core Widgets Gui Network REQUIRED)# VSCode Qt MSVC é…ç½®æŒ‡å—file(GLOB_RECURSE SOURCES    &quot;src/*.cpp&quot;    &quot;src/*.h&quot;    &quot;src/*.ui&quot;)# VSCode Qt MSVC é…ç½®æŒ‡å—add_executable(MyQtApp $&#123;SOURCES&#125;)# VSCode Qt MSVC é…ç½®æŒ‡å—target_link_libraries(MyQtApp    Qt5::Core    Qt5::Widgets    Qt5::Gui    Qt5::Network)# VSCode Qt MSVC é…ç½®æŒ‡å—set_target_properties(MyQtApp PROPERTIES    RUNTIME_OUTPUT_DIRECTORY_DEBUG $&#123;CMAKE_BINARY_DIR&#125;/Debug    RUNTIME_OUTPUT_DIRECTORY_RELEASE $&#123;CMAKE_BINARY_DIR&#125;/Release)# VSCode Qt MSVC é…ç½®æŒ‡å—if(WIN32)    # è®¾ç½® Windows å­ç³»ç»Ÿ    set_target_properties(MyQtApp PROPERTIES        WIN32_EXECUTABLE TRUE    )    # å¤åˆ¶ Qt DLL åˆ°è¾“å‡ºç›®å½•    add_custom_command(TARGET MyQtApp POST_BUILD        COMMAND $&#123;CMAKE_COMMAND&#125; -E copy_directory        &quot;$&#123;CMAKE_PREFIX_PATH&#125;/bin&quot;        $&lt;TARGET_FILE_DIR:MyQtApp&gt;        COMMENT &quot;Copying Qt DLLs to output directory&quot;    )endif()\n\n4.2 ğŸ”§ CMakePresets.json (å¯é€‰)åˆ›å»º CMakePresets.json ç®€åŒ–é…ç½®ï¼š\n&#123;    &quot;version&quot;: 3,    &quot;cmakeMinimumRequired&quot;: &#123;        &quot;major&quot;: 3,        &quot;minor&quot;: 15,        &quot;patch&quot;: 0    &#125;,    &quot;configurePresets&quot;: [        &#123;            &quot;name&quot;: &quot;windows-msvc-debug&quot;,            &quot;generator&quot;: &quot;Visual Studio 16 2019&quot;,            &quot;architecture&quot;: &quot;x64&quot;,            &quot;toolset&quot;: &quot;host=x64&quot;,            &quot;binaryDir&quot;: &quot;$&#123;sourceDir&#125;/build&quot;,            &quot;cacheVariables&quot;: &#123;                &quot;CMAKE_BUILD_TYPE&quot;: &quot;Debug&quot;,                &quot;CMAKE_PREFIX_PATH&quot;: &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64&quot;,                &quot;CMAKE_MSVC_RUNTIME_LIBRARY&quot;: &quot;MultiThreadedDebugDLL&quot;            &#125;        &#125;,        &#123;            &quot;name&quot;: &quot;windows-msvc-release&quot;,            &quot;generator&quot;: &quot;Visual Studio 16 2019&quot;,            &quot;architecture&quot;: &quot;x64&quot;,            &quot;toolset&quot;: &quot;host=x64&quot;,            &quot;binaryDir&quot;: &quot;$&#123;sourceDir&#125;/build&quot;,            &quot;cacheVariables&quot;: &#123;                &quot;CMAKE_BUILD_TYPE&quot;: &quot;Release&quot;,                &quot;CMAKE_PREFIX_PATH&quot;: &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64&quot;,                &quot;CMAKE_MSVC_RUNTIME_LIBRARY&quot;: &quot;MultiThreadedDLL&quot;            &#125;        &#125;    ],    &quot;buildPresets&quot;: [        &#123;            &quot;name&quot;: &quot;debug&quot;,            &quot;configurePreset&quot;: &quot;windows-msvc-debug&quot;,            &quot;configuration&quot;: &quot;Debug&quot;        &#125;,        &#123;            &quot;name&quot;: &quot;release&quot;,            &quot;configurePreset&quot;: &quot;windows-msvc-release&quot;,            &quot;configuration&quot;: &quot;Release&quot;        &#125;    ]&#125;\n\n\n5. âœ… ç¯å¢ƒéªŒè¯5.1 ğŸ” å‘½ä»¤è¡ŒéªŒè¯# VSCode Qt MSVC é…ç½®æŒ‡å—cl.exe /?# VSCode Qt MSVC é…ç½®æŒ‡å—# VSCode Qt MSVC é…ç½®æŒ‡å—qmake -query# VSCode Qt MSVC é…ç½®æŒ‡å—# VSCode Qt MSVC é…ç½®æŒ‡å—# VSCode Qt MSVC é…ç½®æŒ‡å—# VSCode Qt MSVC é…ç½®æŒ‡å—# VSCode Qt MSVC é…ç½®æŒ‡å—cmake -G# VSCode Qt MSVC é…ç½®æŒ‡å—# VSCode Qt MSVC é…ç½®æŒ‡å—echo $env:VCToolsInstallDirecho $env:WindowsSdkDirecho $env:WindowsSDKVersion\n\n5.2 ğŸ§ª æµ‹è¯•é¡¹ç›®åˆ›å»ºåˆ›å»ºæµ‹è¯•æºæ–‡ä»¶ src/main.cppï¼š\n#include &lt;QApplication&gt;#include &lt;QMainWindow&gt;#include &lt;QLabel&gt;#include &lt;QVBoxLayout&gt;#include &lt;QPushButton&gt;#include &lt;QMessageBox&gt;#include &lt;QDebug&gt;class MainWindow : public QMainWindow &#123;    Q_OBJECTpublic:    MainWindow(QWidget *parent = nullptr) : QMainWindow(parent) &#123;        setWindowTitle(&quot;Qt MSVC Test App&quot;);        resize(400, 300);        QWidget *centralWidget = new QWidget(this);        setCentralWidget(centralWidget);        QVBoxLayout *layout = new QVBoxLayout(centralWidget);        QLabel *label = new QLabel(&quot;Hello Qt with MSVC!&quot;, this);        label-&gt;setAlignment(Qt::AlignCenter);        label-&gt;setStyleSheet(&quot;font-size: 18px; font-weight: bold;&quot;);        layout-&gt;addWidget(label);        QPushButton *button = new QPushButton(&quot;Test Message&quot;, this);        connect(button, &amp;QPushButton::clicked, this, &amp;MainWindow::showTestMessage);        layout-&gt;addWidget(button);        QPushButton *debugButton = new QPushButton(&quot;Print Debug Info&quot;, this);        connect(debugButton, &amp;QPushButton::clicked, this, &amp;MainWindow::printDebugInfo);        layout-&gt;addWidget(debugButton);    &#125;private slots:    void showTestMessage() &#123;        QMessageBox::information(this, &quot;Test&quot;, &quot;MSVC + Qt é…ç½®æˆåŠŸï¼&quot;);        qDebug() &lt;&lt; &quot;Message box shown successfully&quot;;    &#125;    void printDebugInfo() &#123;        qDebug() &lt;&lt; &quot;=== Qt Configuration Info ===&quot;;        qDebug() &lt;&lt; &quot;Qt Version:&quot; &lt;&lt; QT_VERSION_STR;        qDebug() &lt;&lt; &quot;Compiler:&quot; &lt;&lt;#ifdef _MSC_VER            &quot;MSVC &quot; &lt;&lt; _MSC_VER;#else            &quot;Unknown&quot;;#endif        qDebug() &lt;&lt; &quot;Build Type:&quot; &lt;&lt;#ifdef _DEBUG            &quot;Debug&quot;;#else            &quot;Release&quot;;#endif        qDebug() &lt;&lt; &quot;===============================&quot;;    &#125;&#125;;int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);    qDebug() &lt;&lt; &quot;Starting Qt application...&quot;;    qDebug() &lt;&lt; &quot;Qt version:&quot; &lt;&lt; QT_VERSION_STR;    MainWindow window;    window.show();    return app.exec();&#125;#include &quot;main.moc&quot;\n\n\n6. ğŸ”§ å¸¸è§é—®é¢˜è§£å†³6.1 âŒ CMake æ‰¾ä¸åˆ° Qté”™è¯¯ä¿¡æ¯: Could NOT find Qt5\nè§£å†³æ–¹æ¡ˆï¼š\n# VSCode Qt MSVC é…ç½®æŒ‡å—set(CMAKE_PREFIX_PATH &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64&quot;)# VSCode Qt MSVC é…ç½®æŒ‡å—set(ENV&#123;QTDIR&#125; &quot;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64&quot;)\n\n6.2 âŒ ç¼ºå°‘è¿è¡Œæ—¶åº“é”™è¯¯ä¿¡æ¯: æ— æ³•å¯åŠ¨æ­¤ç¨‹åºï¼Œå› ä¸ºè®¡ç®—æœºä¸­ç¼ºå°‘ VCRUNTIME140.dll\nè§£å†³æ–¹æ¡ˆï¼š\ngraph TD    A[ç¼ºå°‘ VCRUNTIME140.dll] --&gt; B&#123;è§£å†³æ–¹æ¡ˆ&#125;    B --&gt; C[å®‰è£… Visual C++ Redistributable]    B --&gt; D[é™æ€é“¾æ¥è¿è¡Œæ—¶åº“]    B --&gt; E[å¤åˆ¶ DLL åˆ°è¾“å‡ºç›®å½•]    C --&gt; F[ä¸‹è½½å®‰è£… vc_redist.x64.exe]    D --&gt; G[è®¾ç½® CMAKE_MSVC_RUNTIME_LIBRARY]    E --&gt; H[æ‰‹åŠ¨å¤åˆ¶ç³»ç»Ÿ DLL]\n\nCMake é…ç½®ï¼š\n# VSCode Qt MSVC é…ç½®æŒ‡å—set(CMAKE_MSVC_RUNTIME_LIBRARY &quot;MultiThreaded$&lt;$&lt;CONFIG:Debug&gt;:Debug&gt;&quot;)\n\n6.3 âŒ Qt æ’ä»¶åŠ è½½å¤±è´¥é”™è¯¯ä¿¡æ¯: This application failed to start because it could not find or load the Qt platform plugin &quot;windows&quot;\nè§£å†³æ–¹æ¡ˆï¼š\n// åœ¨ launch.json ä¸­æ·»åŠ ç¯å¢ƒå˜é‡&quot;environment&quot;: [    &#123;        &quot;name&quot;: &quot;PATH&quot;,        &quot;value&quot;: &quot;$&#123;env:Path&#125;;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/bin;C:/Qt/Qt5.6.3/5.6.3/msvc2015_64/plugins/platforms&quot;    &#125;]\n\n6.4 âŒ IntelliSense ä¸å·¥ä½œç—‡çŠ¶: Qt å¤´æ–‡ä»¶æ˜¾ç¤ºçº¢è‰²ä¸‹åˆ’çº¿ï¼Œä»£ç è¡¥å…¨ä¸å·¥ä½œ\nè§£å†³æ–¹æ¡ˆï¼š\n\næ£€æŸ¥ c_cpp_properties.json ä¸­çš„è·¯å¾„æ˜¯å¦æ­£ç¡®\nç¡®ä¿ Qt ç‰ˆæœ¬ä¸ç¼–è¯‘å™¨ç‰ˆæœ¬åŒ¹é… (MSVC vs MinGW)\né‡æ–°åŠ è½½ VS Code çª—å£ (Ctrl+Shift+P â†’ Developer: Reload Window)\n\n6.5 âŒ è°ƒè¯•æ—¶æ— æ³•æŸ¥çœ‹ Qt å¯¹è±¡è§£å†³æ–¹æ¡ˆï¼š\n\nå®‰è£… Qt Visual Studio Tools\nä½¿ç”¨è‡ªå®šä¹‰çš„ qt.natvis æ–‡ä»¶\nåœ¨è°ƒè¯•æ—¶æŸ¥çœ‹ this æŒ‡é’ˆå’Œæˆå‘˜å˜é‡\n\n\n7. ğŸš€ å®Œæ•´å·¥ä½œæµç¨‹flowchart TD    A[æ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹] --&gt; B[VS Code è‡ªåŠ¨æ£€æµ‹ CMake]    B --&gt; C[é€‰æ‹©é…ç½®é¢„è®¾]    C --&gt; D[CMake é…ç½®é¡¹ç›®]    D --&gt; E[IntelliSense åˆå§‹åŒ–å®Œæˆ]    E --&gt; F[ç¼–å†™ä»£ç ]    F --&gt; G&#123;æ„å»ºé¡¹ç›®&#125;    G --&gt; H[Ctrl+Shift+B]    H --&gt; I[ç¼–è¯‘æˆåŠŸ]    I --&gt; J&#123;è°ƒè¯•è¿è¡Œ&#125;    J --&gt; K[F5 å¯åŠ¨è°ƒè¯•]    K --&gt; L[åº”ç”¨è¿è¡Œ]    L --&gt; M[è°ƒè¯•å’Œæµ‹è¯•]    M --&gt; N&#123;ä¿®æ”¹ä»£ç ?&#125;    N --&gt;|æ˜¯| F    N --&gt;|å¦| O[å®Œæˆå¼€å‘]\n\n7.1 ğŸ“ æ—¥å¸¸å¼€å‘æ­¥éª¤\næ‰“å¼€é¡¹ç›®ï¼šVS Code æ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹\né…ç½® CMakeï¼šCtrl+Shift+P â†’ CMake: Configure\né€‰æ‹©é¢„è®¾ï¼šåº•éƒ¨çŠ¶æ€æ é€‰æ‹© windows-msvc-debug æˆ– windows-msvc-release\næ™ºèƒ½æç¤ºï¼šç­‰å¾… IntelliSense å®Œæˆåˆå§‹åŒ–\nç¼–å†™ä»£ç ï¼šäº«å—å®Œæ•´çš„ä»£ç è¡¥å…¨å’Œè¯­æ³•é«˜äº®\næ„å»ºé¡¹ç›®ï¼šCtrl+Shift+B æˆ–ç‚¹å‡»åº•éƒ¨çŠ¶æ€æ çš„æ„å»ºæŒ‰é’®\nè¿è¡Œè°ƒè¯•ï¼šF5 å¯åŠ¨è°ƒè¯•ä¼šè¯\n\n7.2 ğŸ¯ æ¨èå¿«æ·é”®\n\n\nå¿«æ·é”®\nåŠŸèƒ½\nè¯´æ˜\n\n\n\nCtrl+Shift+B\næ„å»ºé¡¹ç›®\næ‰§è¡Œé»˜è®¤æ„å»ºä»»åŠ¡\n\n\nF5\nå¯åŠ¨è°ƒè¯•\nè¿è¡Œå½“å‰é…ç½®çš„è°ƒè¯•ä¼šè¯\n\n\nCtrl+Shift+P\nå‘½ä»¤é¢æ¿\nè®¿é—®æ‰€æœ‰ VS Code å‘½ä»¤\n\n\nCtrl+,\nè®¾ç½®\næ‰“å¼€ VS Code è®¾ç½®\n\n\nCtrl+K Ctrl+S\nå¿«æ·é”®è®¾ç½®\nè‡ªå®šä¹‰å¿«æ·é”®\n\n\n\nğŸ“Š æ€»ç»“âœ… é…ç½®å®Œæˆæ£€æŸ¥æ¸…å•\n Visual Studio Build Tools å®‰è£…å®Œæˆ\n Qt MSVC ç‰ˆæœ¬å®‰è£…å®Œæˆ\n VS Code å¿…éœ€æ‰©å±•å®‰è£…\n C&#x2F;C++ é…ç½®æ–‡ä»¶æ­£ç¡®è®¾ç½®\n CMake é…ç½®æ–‡ä»¶æ­£ç¡®è®¾ç½®\n è°ƒè¯•å™¨é…ç½®æ­£ç¡®\n æµ‹è¯•é¡¹ç›®ç¼–è¯‘è¿è¡ŒæˆåŠŸ\n è°ƒè¯•åŠŸèƒ½æ­£å¸¸å·¥ä½œ\n IntelliSense å®Œæ•´æ”¯æŒ\n\nğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®\nå­¦ä¹  Qt æ¡†æ¶ï¼šæŒæ¡ä¿¡å·æ§½ã€UI è®¾è®¡ã€å¤šçº¿ç¨‹ç­‰\nCMake è¿›é˜¶ï¼šå­¦ä¹ è‡ªå®šä¹‰æ„å»ºè§„åˆ™ã€äº¤å‰ç¼–è¯‘\nè°ƒè¯•æŠ€å·§ï¼šæŒæ¡æ–­ç‚¹ã€å†…å­˜æŸ¥çœ‹ã€æ€§èƒ½åˆ†æ\nç‰ˆæœ¬æ§åˆ¶ï¼šé›†æˆ Git è¿›è¡Œä»£ç ç®¡ç†\nå•å…ƒæµ‹è¯•ï¼šé›†æˆ Qt Test æˆ– Google Test\n\nğŸ“š æ¨èèµ„æº\nQt å®˜æ–¹æ–‡æ¡£\nCMake å®˜æ–¹æ–‡æ¡£\nVS Code C++ æ‰©å±•æ–‡æ¡£\nMicrosoft C++ æ–‡æ¡£\n\n\n\nğŸ’¡ æç¤º:\n\né¦–æ¬¡é…ç½®å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè€å¿ƒæŒ‰ç…§æ­¥éª¤æ“ä½œ\né‡åˆ°é—®é¢˜æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è·¯å¾„å’Œç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®\nå»ºè®®ä½¿ç”¨ç›¸å¯¹è·¯å¾„å’Œ CMake å˜é‡æé«˜é¡¹ç›®å¯ç§»æ¤æ€§\nå®šæœŸæ›´æ–° VS Code æ‰©å±•ä»¥è·å¾—æœ€æ–°åŠŸèƒ½\n\n\n","categories":["å¼€å‘å·¥å…·"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"MySQL Windows å®‰è£…æŒ‡å—","url":"/posts/e2f925a8/","content":"MySQL Windows å®‰è£…æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šä¸‹è½½ä¸è§£å‹\nç¬¬äºŒæ­¥ï¼šé…ç½® my.ini æ–‡ä»¶\nç¬¬ä¸‰æ­¥ï¼šåˆå§‹åŒ–ä¸å®‰è£…æœåŠ¡\nç¬¬å››æ­¥ï¼šæœåŠ¡ç®¡ç†ä¸ç™»å½•\nç”¨æˆ·ä¸æƒé™ç®¡ç†\nå¤‡ä»½ä¸æ¢å¤\nå¸¸è§é—®é¢˜ä¸æ•…éšœæ’é™¤\n\næ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œé€šè¿‡å®˜æ–¹çš„ ZIP å‹ç¼©åŒ…æ‰‹åŠ¨å®‰è£…ã€é…ç½® MySQLï¼Œå¹¶å°†å…¶æ³¨å†Œä¸º Windows æœåŠ¡ã€‚è¿™ç§æ–¹å¼è®©ä½ å¯ä»¥å®Œå…¨æ§åˆ¶ MySQL çš„å®‰è£…ä½ç½®å’Œé…ç½®ã€‚\nç¬¬ä¸€æ­¥ï¼šä¸‹è½½ä¸è§£å‹\nä¸‹è½½ MySQL Community Server:è®¿é—®å®˜æ–¹ä¸‹è½½é¡µé¢ï¼šhttps://dev.mysql.com/downloads/mysql/é€‰æ‹© â€œWindows (x86, 64-bit), ZIP Archiveâ€ ç‰ˆæœ¬è¿›è¡Œä¸‹è½½ã€‚\n\nè§£å‹æ–‡ä»¶:å°†ä¸‹è½½çš„ ZIP æ–‡ä»¶è§£å‹åˆ°ä¸€ä¸ªä½ é€‰æ‹©çš„ç¨³å®šè·¯å¾„ï¼Œä¾‹å¦‚ C:\\mysqlã€‚è·¯å¾„ä¸­æœ€å¥½ä¸è¦åŒ…å«ä¸­æ–‡æˆ–ç©ºæ ¼ã€‚\nè§£å‹åçš„ç›®å½•ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š\n&lt;Your-MySQL-Path&gt;\\â”œâ”€â”€ bin\\          # å¯æ‰§è¡Œæ–‡ä»¶ (mysqld, mysql, mysqldump ç­‰)â”œâ”€â”€ include\\â”œâ”€â”€ lib\\â””â”€â”€ share\\\n\nç¬¬äºŒæ­¥ï¼šé…ç½® my.ini æ–‡ä»¶\nåœ¨ä½ çš„ MySQL æ ¹ç›®å½•ä¸‹ï¼ˆä¾‹å¦‚ C:\\mysqlï¼‰åˆ›å»ºä¸€ä¸ªåä¸º my.ini çš„æ–‡æœ¬æ–‡ä»¶ã€‚è¿™æ˜¯ MySQL çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ã€‚\n\nåˆ›å»º data ç›®å½•: åœ¨æ ¹ç›®å½•ä¸‹æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªåä¸º data çš„ç©ºæ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾æ•°æ®åº“æ–‡ä»¶ã€‚\n\nç¼–è¾‘ my.ini: å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶åˆ° my.ini æ–‡ä»¶ä¸­ï¼Œå¹¶åŠ¡å¿…å°† &lt;Your-MySQL-Path&gt; æ›¿æ¢ä¸ºä½ è‡ªå·±çš„å®é™…è·¯å¾„ï¼ˆæ³¨æ„è·¯å¾„ä¸­çš„åæ–œæ  \\ éœ€è¦è½¬ä¹‰ä¸º \\\\ï¼‰ã€‚\n[mysqld]# è®¾ç½® 3306 ç«¯å£port=3306# è®¾ç½® mysql çš„å®‰è£…ç›®å½•basedir=&lt;Your-MySQL-Path&gt;# è®¾ç½® mysql æ•°æ®åº“çš„æ•°æ®çš„å­˜æ”¾ç›®å½•datadir=&lt;Your-MySQL-Path&gt;\\\\data# å…è®¸æœ€å¤§è¿æ¥æ•°max_connections=200# æœåŠ¡ç«¯ä½¿ç”¨çš„å­—ç¬¦é›†é»˜è®¤ä¸º utf8mb4character-set-server=utf8mb4# é»˜è®¤å­˜å‚¨å¼•æ“default-storage-engine=INNODB# [MySQL 8.0+ æ–°ç‰¹æ€§] é»˜è®¤è®¤è¯æ–¹å¼default_authentication_plugin=mysql_native_password[mysql]# è®¾ç½® mysql å®¢æˆ·ç«¯é»˜è®¤å­—ç¬¦é›†default-character-set=utf8mb4[client]# è®¾ç½® mysql å®¢æˆ·ç«¯è¿æ¥æ—¶çš„é»˜è®¤ç«¯å£port=3306default-character-set=utf8mb4\n\nç¬¬ä¸‰æ­¥ï¼šåˆå§‹åŒ–ä¸å®‰è£…æœåŠ¡ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ (CMD) æˆ– PowerShellï¼Œå¹¶è¿›å…¥ bin ç›®å½•ã€‚\ncd &lt;Your-MySQL-Path&gt;\\bin\n\n\nåˆå§‹åŒ–æ•°æ®åº“:\nmysqld --initialize --console\né‡è¦: æ­¤å‘½ä»¤ä¼šåˆ›å»º data ç›®å½•å¹¶ç”Ÿæˆä¸€ä¸ªä¸´æ—¶çš„ root ç”¨æˆ·å¯†ç ã€‚è¯·åœ¨è¾“å‡ºçš„æ—¥å¿—ä¸­æ‰¾åˆ°å¹¶ç«‹å³å¤åˆ¶ä¿å­˜è¿™è¡Œä¿¡æ¯ï¼šA temporary password is generated for root@localhost: &lt;éšæœºå¯†ç &gt;\n\nå®‰è£… MySQL æœåŠ¡:\n# å®‰è£…æœåŠ¡ï¼ŒæœåŠ¡åä¸º MySQLmysqld --install MySQL# å¦‚æœ my.ini ä¸åœ¨é»˜è®¤ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨ --defaults-file æŒ‡å®š# mysqld --install MySQL --defaults-file=\\&quot;&lt;Your-MySQL-Path&gt;\\\\my.ini\\&quot;\nå¦‚æœçœ‹åˆ° Service successfully installed. åˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚\n\n\nç¬¬å››æ­¥ï¼šæœåŠ¡ç®¡ç†ä¸ç™»å½•\nå¯åŠ¨æœåŠ¡:\nnet start MySQL\n\nç™»å½•å¹¶ä¿®æ”¹å¯†ç :ä½¿ç”¨ä¸Šä¸€æ­¥ä¸­ä¿å­˜çš„ä¸´æ—¶å¯†ç ç™»å½•ã€‚\nmysql -u root -p\nåœ¨æç¤º Enter password: åï¼Œç²˜è´´ä½ çš„ä¸´æ—¶å¯†ç å¹¶æŒ‰å›è½¦ã€‚\n\nä¿®æ”¹ root å¯†ç :ç™»å½•æˆåŠŸåï¼Œç«‹å³ä¿®æ”¹ä¸ºä¸€ä¸ªæ›´å¼ºçš„å¯†ç ã€‚\nALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;YourNewStrongPassword&#x27;;FLUSH PRIVILEGES;EXIT;\n\nç”¨æˆ·ä¸æƒé™ç®¡ç†-- åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ· &#x27;appuser&#x27;ï¼Œå¯†ç ä¸º &#x27;password123&#x27;CREATE USER &#x27;appuser&#x27;@&#x27;localhost&#x27; IDENTIFIED BY &#x27;password123&#x27;;-- æˆäºˆ &#x27;appuser&#x27; å¯¹ &#x27;mydatabase&#x27; æ•°æ®åº“çš„æ‰€æœ‰æƒé™GRANT ALL PRIVILEGES ON mydatabase.* TO &#x27;appuser&#x27;@&#x27;localhost&#x27;;-- åˆ·æ–°æƒé™ä½¿ä¹‹ç”Ÿæ•ˆFLUSH PRIVILEGES;\n\nå¤‡ä»½ä¸æ¢å¤å¤‡ä»½ä½¿ç”¨ mysqldump å·¥å…·è¿›è¡Œå¤‡ä»½ã€‚\n# MySQL Windows å®‰è£…æŒ‡å—mysqldump -u root -p mydatabase &gt; D:\\\\backups\\\\mydatabase_backup.sql# MySQL Windows å®‰è£…æŒ‡å—mysqldump -u root -p --all-databases &gt; D:\\\\backups\\\\all_databases.sql\n\næ¢å¤# MySQL Windows å®‰è£…æŒ‡å—mysql -u root -p mydatabase &lt; D:\\\\backups\\\\mydatabase_backup.sql\n\nå¸¸è§é—®é¢˜ä¸æ•…éšœæ’é™¤Q: æœåŠ¡å¯åŠ¨å¤±è´¥?A:\n\næ£€æŸ¥ data ç›®å½•ä¸‹çš„ .err æ—¥å¿—æ–‡ä»¶ï¼ŒæŸ¥æ‰¾å…·ä½“çš„é”™è¯¯ä¿¡æ¯ã€‚\næ£€æŸ¥ç«¯å£ï¼ˆå¦‚ 3306ï¼‰æ˜¯å¦è¢«å…¶ä»–ç¨‹åºå ç”¨ (netstat -ano | findstr 3306)ã€‚\n\nQ: å¿˜è®° root å¯†ç ?A:\n\nä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ cmdï¼Œåœæ­¢ MySQL æœåŠ¡ï¼šnet stop MySQLã€‚\nåˆ›å»º mysql-init.txt æ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼šALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;NewPassword&#39;;\nä½¿ç”¨æ— æƒé™éªŒè¯æ¨¡å¼å¯åŠ¨ MySQL å¹¶åŠ è½½è¯¥æ–‡ä»¶ï¼šmysqld --init-file=&quot;C:\\\\mysql-init.txt&quot; --console\nçœ‹åˆ°æœåŠ¡å¯åŠ¨åï¼Œå…³é—­è¯¥ cmd çª—å£ï¼Œç„¶åæ­£å¸¸å¯åŠ¨ MySQL æœåŠ¡ï¼šnet start MySQLã€‚ç°åœ¨ä½ å¯ä»¥ç”¨ NewPassword ç™»å½•äº†ã€‚\n\nQ: å­—ç¬¦é›†ä¹±ç ?A: ç¡®ä¿ my.ini æ–‡ä»¶ä¸­ [mysqld], [mysql], [client] ä¸‹éƒ½è®¾ç½®äº† character-set-server=utf8mb4 æˆ– default-character-set=utf8mb4ã€‚\n","categories":["åç«¯æœåŠ¡æ¶æ„","æ•°æ®åº“ä¸ç¼“å­˜"],"tags":["Windows","MySQL","æ•°æ®åº“","æœåŠ¡é…ç½®"]},{"title":"Graphviz æµç¨‹å›¾æŒ‡å—","url":"/posts/445c44cb/","content":"Graphviz æµç¨‹å›¾æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: graphviz, flowchart, diagram, visualization, documentation\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. ç¯å¢ƒå‡†å¤‡\n3. åŸºæœ¬ä½¿ç”¨\n4. è¾“å‡ºæ ¼å¼\n5. å¸¸è§ç”¨ä¾‹\n6. é«˜çº§é…ç½®\n\n\n1. ğŸ“– æ¦‚è¿°Graphviz æ˜¯ä¸€ä¸ªå¼€æºçš„å›¾å½¢å¯è§†åŒ–è½¯ä»¶ï¼Œç‰¹åˆ«é€‚åˆç”Ÿæˆå„ç§æµç¨‹å›¾ã€æ¶æ„å›¾å’Œå…³ç³»å›¾ã€‚\nğŸ¯ ä¸»è¦ç”¨é€”\nâœ… æµç¨‹å›¾ç”Ÿæˆ\nâœ… ç³»ç»Ÿæ¶æ„å›¾\nâœ… ç±»å…³ç³»å›¾\nâœ… ä¾èµ–å…³ç³»å›¾\nâœ… çŠ¶æ€æœºå›¾\n\n\n2. ğŸ”§ ç¯å¢ƒå‡†å¤‡2.1 å®‰è£…ä¾èµ–# Graphviz æµç¨‹å›¾æŒ‡å—pip install graphviz# Graphviz æµç¨‹å›¾æŒ‡å—conda install python-graphviz# Graphviz æµç¨‹å›¾æŒ‡å—sudo apt-get install graphviz\n\n2.2 éªŒè¯å®‰è£…import graphviz# Graphviz æµç¨‹å›¾æŒ‡å—dot = graphviz.Digraph(comment=&#x27;Test Graph&#x27;)dot.node(&#x27;A&#x27;, &#x27;Test Node&#x27;)print(dot.source)  # è¾“å‡º DOT æºç \n\n\n3. ğŸš€ åŸºæœ¬ä½¿ç”¨3.1 ç”Ÿæˆæµç¨‹å›¾# Graphviz æµç¨‹å›¾æŒ‡å—python drogon_flow_diagram.py\n\n3.2 åŸºæœ¬ç¤ºä¾‹from graphviz import Digraph# Graphviz æµç¨‹å›¾æŒ‡å—dot = Digraph(comment=&#x27;Simple Flowchart&#x27;)dot.attr(rankdir=&#x27;LR&#x27;)  # ä»å·¦åˆ°å³å¸ƒå±€# Graphviz æµç¨‹å›¾æŒ‡å—dot.node(&#x27;A&#x27;, &#x27;å¼€å§‹&#x27;)dot.node(&#x27;B&#x27;, &#x27;å¤„ç†&#x27;)dot.node(&#x27;C&#x27;, &#x27;ç»“æŸ&#x27;)# Graphviz æµç¨‹å›¾æŒ‡å—dot.edges([&#x27;AB&#x27;, &#x27;BC&#x27;])# Graphviz æµç¨‹å›¾æŒ‡å—dot.render(&#x27;flowchart&#x27;, format=&#x27;png&#x27;, cleanup=True)\n\n\n4. ğŸ“ è¾“å‡ºæ ¼å¼ç”Ÿæˆçš„æ–‡ä»¶åŒ…æ‹¬ï¼š\n\n\n\næ–‡ä»¶å\næ ¼å¼\nè¯´æ˜\n\n\n\ndrogon_http_flow.png\nPNG\nä½å›¾æ ¼å¼ï¼Œé€‚åˆç½‘é¡µæ˜¾ç¤º\n\n\ndrogon_http_flow.svg\nSVG\nçŸ¢é‡å›¾ï¼Œå¯ç¼©æ”¾\n\n\ndrogon_http_flow.pdf\nPDF\né€‚åˆæ‰“å°å’Œæ–‡æ¡£\n\n\ndrogon_http_flow.dot\nDOT\nGraphviz æºç \n\n\n\n5. ğŸ’¡ å¸¸è§ç”¨ä¾‹5.1 ç³»ç»Ÿæ¶æ„å›¾dot = Digraph(comment=&#x27;System Architecture&#x27;)dot.attr(rankdir=&#x27;TB&#x27;)# Graphviz æµç¨‹å›¾æŒ‡å—with dot.subgraph(name=&#x27;cluster_frontend&#x27;) as c:    c.attr(label=&#x27;Frontend&#x27;)    c.node(&#x27;web&#x27;, &#x27;Web App&#x27;)with dot.subgraph(name=&#x27;cluster_backend&#x27;) as c:    c.attr(label=&#x27;Backend&#x27;)    c.node(&#x27;api&#x27;, &#x27;API Server&#x27;)    c.node(&#x27;db&#x27;, &#x27;Database&#x27;)# Graphviz æµç¨‹å›¾æŒ‡å—dot.edge(&#x27;web&#x27;, &#x27;api&#x27;)dot.edge(&#x27;api&#x27;, &#x27;db&#x27;)\n\n5.2 ç±»å…³ç³»å›¾dot = Digraph(comment=&#x27;Class Diagram&#x27;)dot.attr(rankdir=&#x27;TB&#x27;)# Graphviz æµç¨‹å›¾æŒ‡å—dot.node(&#x27;Base&#x27;, &#x27;Base Class&#x27;, shape=&#x27;record&#x27;)dot.node(&#x27;Derived&#x27;, &#x27;Derived Class&#x27;, shape=&#x27;record&#x27;)# Graphviz æµç¨‹å›¾æŒ‡å—dot.edge(&#x27;Base&#x27;, &#x27;Derived&#x27;, arrowhead=&#x27;empty&#x27;)\n\n\n6. âš™ï¸ é«˜çº§é…ç½®6.1 æ ·å¼å®šåˆ¶dot.attr(&#x27;node&#x27;, shape=&#x27;box&#x27;, style=&#x27;rounded,filled&#x27;, fillcolor=&#x27;lightblue&#x27;)dot.attr(&#x27;edge&#x27;, color=&#x27;darkblue&#x27;, fontcolor=&#x27;darkblue&#x27;)\n\n6.2 å­å›¾ç»„ç»‡with dot.subgraph(name=&#x27;cluster_module1&#x27;) as c:    c.attr(label=&#x27;Module 1&#x27;, style=&#x27;filled&#x27;, color=&#x27;lightgrey&#x27;)    c.node(&#x27;m1_a&#x27;, &#x27;Component A&#x27;)    c.node(&#x27;m1_b&#x27;, &#x27;Component B&#x27;)\n\n\nğŸ“š ç›¸å…³èµ„æº\nGraphviz å®˜æ–¹æ–‡æ¡£\nPython graphviz åº“\nDOT è¯­è¨€æŒ‡å—\n\n\n\nğŸ’¡ æç¤º: Graphviz ç‰¹åˆ«é€‚åˆç”ŸæˆæŠ€æœ¯æ–‡æ¡£ä¸­çš„æ¶æ„å›¾å’Œæµç¨‹å›¾ï¼Œå»ºè®®ä¸å…¶ä»–æ–‡æ¡£ç”Ÿæˆå·¥å…·é…åˆä½¿ç”¨ã€‚\n\n","categories":["å¼€å‘å·¥å…·"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Windows ç¯å¢ƒä¸‹é…ç½® GitHub MCP æœåŠ¡å™¨å®Œæ•´æŒ‡å—","url":"/posts/windows-github-mcp/","content":"Windows ç¯å¢ƒä¸‹é…ç½® GitHub MCP æœåŠ¡å™¨å®Œæ•´æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-12-18æœ€åæ›´æ–°: 2025-12-18æ ‡ç­¾: github, mcp, windows, powershell, gemini-cli, ai-tools\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. ç”Ÿæˆ GitHub PAT\n3. è®¾ç½®ç¯å¢ƒå˜é‡\n4. ç¼–è¾‘ Gemini CLI é…ç½®\n5. å®‰è£…å¿…è¦çš„ä¾èµ–\n6. éªŒè¯é…ç½®\n7. æ•…éšœæ’é™¤\n8. æœ€ä½³å®è·µ\n9. æ€»ç»“\n\n\n1. ğŸ“– æ¦‚è¿°æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»åœ¨Windowsç¯å¢ƒä¸‹å¦‚ä½•é…ç½®GitHub MCP (Model Context Protocol) æœåŠ¡å™¨ï¼Œè®©æ‚¨å¯ä»¥åœ¨Gemini CLIä¸­ç›´æ¥æ“ä½œGitHubä»“åº“ã€‚\n2. ğŸ”‘ ç”Ÿæˆ GitHub PATæ­¥éª¤ 1ï¼šç”Ÿæˆ GitHub PATæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åœ¨GitHubåˆ›å»ºä¸€ä¸ªFine-grained Tokenï¼ˆç»†ç²’åº¦ä»¤ç‰Œï¼‰ï¼š\n1.1 è®¿é—®GitHubè®¾ç½®\nç™»å½•GitHubè´¦æˆ·\nç‚¹å‡»å³ä¸Šè§’å¤´åƒ\né€‰æ‹© â€œSettingsâ€ï¼ˆè®¾ç½®ï¼‰\nåœ¨å·¦ä¾§èœå•ä¸­é€‰æ‹© â€œDeveloper settingsâ€\nç‚¹å‡» â€œPersonal access tokensâ€ â†’ â€œFine-grained tokensâ€\n\n1.2 åˆ›å»ºæ–°ä»¤ç‰Œ\nç‚¹å‡» â€œGenerate new tokenâ€\nè¾“å…¥ä»¤ç‰Œåç§°ï¼ˆå¦‚ï¼šâ€Gemini MCP Serverâ€ï¼‰\nè®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆå»ºè®®é€‰æ‹©90å¤©ï¼‰\n\n1.3 é…ç½®æƒé™Repository accessï¼š\n\né€‰æ‹©ä½ è¦è®¿é—®çš„ä»“åº“\nå»ºè®®é€‰æ‹© â€œOnly select repositoriesâ€ å¹¶æŒ‡å®šç›¸å…³ä»“åº“\n\nPermissionsï¼ˆæƒé™é…ç½®ï¼‰ï¼š\n\nContents â†’ Read &amp; Writeï¼ˆè¯»å†™ä»£ç å†…å®¹ï¼‰\nIssues â†’ Read &amp; Writeï¼ˆç®¡ç†Issuesï¼‰\nPull requests â†’ Read &amp; Writeï¼ˆç®¡ç†PRï¼‰\nMetadata â†’ Readï¼ˆè¯»å–ä»“åº“å…ƒæ•°æ®ï¼‰\n\n1.4 å¤åˆ¶ä»¤ç‰Œç”Ÿæˆåç«‹å³å¤åˆ¶å¹¶ä¿å­˜ä»¤ç‰Œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š\nghp_abcd1234efgh5678ijkl90mnopqrstuvwx\n\næ­¥éª¤ 2ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆWindowsï¼‰2.1 ä½¿ç”¨PowerShellè®¾ç½®åœ¨Windows PowerShellä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n# è®¾ç½®ç”¨æˆ·çº§ç¯å¢ƒå˜é‡setx GITHUB_PERSONAL_ACCESS_TOKEN &quot;ä½ çš„GitHubä»¤ç‰Œ&quot;# è®¾ç½®ä¼šè¯çº§ç¯å¢ƒå˜é‡ï¼ˆç«‹å³ç”Ÿæ•ˆï¼‰$env:GITHUB_PERSONAL_ACCESS_TOKEN = &quot;ä½ çš„GitHubä»¤ç‰Œ&quot;\n\n2.2 éªŒè¯è®¾ç½®é‡æ–°æ‰“å¼€ä¸€ä¸ªæ–°çš„PowerShellçª—å£ï¼ŒéªŒè¯ç¯å¢ƒå˜é‡ï¼š\n# æŸ¥çœ‹ç¯å¢ƒå˜é‡å€¼echo $env:GITHUB_PERSONAL_ACCESS_TOKEN# æˆ–è€…Get-ChildItem Env:GITHUB_PERSONAL_ACCESS_TOKEN\n\næ­¥éª¤ 3ï¼šç¼–è¾‘ Gemini CLI é…ç½®3.1 å®šä½é…ç½®æ–‡ä»¶\nå…¨å±€é…ç½®è·¯å¾„ï¼š%USERPROFILE%\\.gemini\\settings.json\né¡¹ç›®çº§é…ç½®è·¯å¾„ï¼šä½ çš„é¡¹ç›®ç›®å½•\\.gemini\\settings.json\n\n3.2 åˆ›å»ºé…ç½®æ–‡ä»¶å¦‚æœé…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå…ˆåˆ›å»ºï¼š\n# åˆ›å»ºé…ç½®ç›®å½•mkdir $env:USERPROFILE\\.gemini# ç¼–è¾‘é…ç½®æ–‡ä»¶notepad $env:USERPROFILE\\.gemini\\settings.json\n\n3.3 é…ç½®MCPæœåŠ¡å™¨åœ¨ settings.json ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š\n&#123;  &quot;mcpServers&quot;: &#123;    &quot;github&quot;: &#123;      &quot;command&quot;: &quot;npx&quot;,      &quot;args&quot;: [&quot;-y&quot;, &quot;@modelcontextprotocol/server-github&quot;],      &quot;env&quot;: &#123;        &quot;GITHUB_PERSONAL_ACCESS_TOKEN&quot;: &quot;$&#123;GITHUB_PERSONAL_ACCESS_TOKEN&#125;&quot;      &#125;    &#125;  &#125;&#125;\n\næ­¥éª¤ 4ï¼šå®‰è£…å¿…è¦çš„ä¾èµ–4.1 å®‰è£…Node.jsï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰è®¿é—® Node.jså®˜ç½‘ ä¸‹è½½å¹¶å®‰è£…LTSç‰ˆæœ¬ã€‚\n4.2 å®‰è£…GitHub MCPæœåŠ¡å™¨åœ¨PowerShellä¸­æ‰§è¡Œï¼š\n# å…¨å±€å®‰è£…GitHub MCPæœåŠ¡å™¨npm install -g @modelcontextprotocol/server-github# éªŒè¯å®‰è£…npx @modelcontextprotocol/server-github --help\n\næ­¥éª¤ 5ï¼šéªŒè¯é…ç½®5.1 å¯åŠ¨Gemini CLI# å¯åŠ¨Gemini CLIgemini\n\n5.2 æµ‹è¯•MCPè¿æ¥åœ¨Gemini CLIä¸­è¾“å…¥ï¼š\n/mcp\n\nå¦‚æœé…ç½®æˆåŠŸï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ° â€œgithub mcp server connectedâ€ çš„æç¤ºã€‚\n5.3 æµ‹è¯•åŠŸèƒ½å°è¯•ä»¥ä¸‹å‘½ä»¤æµ‹è¯•GitHub MCPåŠŸèƒ½ï¼š\nåˆ—å‡ºæˆ‘ä»“åº“ä¸­çš„open issuesæŸ¥çœ‹æˆ‘çš„ä¸ªäººèµ„æ–™ä¿¡æ¯åˆ—å‡ºæœ€è¿‘ä¿®æ”¹çš„ä»“åº“\n\næ•…éšœæ’é™¤å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ\nMCPæœåŠ¡å™¨è¿æ¥å¤±è´¥\n\næ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®\nç¡®è®¤GitHub PATæƒé™é…ç½®æ­£ç¡®\néªŒè¯ç½‘ç»œè¿æ¥\n\n\næƒé™é”™è¯¯\n\nç¡®ä¿PATåŒ…å«å¿…è¦çš„æƒé™\næ£€æŸ¥PATæ˜¯å¦å·²è¿‡æœŸ\n\n\nnpxå‘½ä»¤å¤±è´¥\n\nç¡®ä¿Node.jså·²æ­£ç¡®å®‰è£…\næ£€æŸ¥npmå…¨å±€å®‰è£…è·¯å¾„\n\n\n\næœ€ä½³å®è·µ\nå®‰å…¨æ€§ï¼š\n\nå®šæœŸæ›´æ–°PAT\nä½¿ç”¨æœ€å°æƒé™åŸåˆ™\nä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ä»¤ç‰Œ\n\n\næ€§èƒ½ä¼˜åŒ–ï¼š\n\nä½¿ç”¨é¡¹ç›®çº§é…ç½®è€Œéå…¨å±€é…ç½®\nå®šæœŸæ¸…ç†ä¸å¿…è¦çš„MCPæœåŠ¡å™¨é…ç½®\n\n\nç»´æŠ¤ï¼š\n\nå®šæœŸæ£€æŸ¥ä»¤ç‰Œæœ‰æ•ˆæ€§\næ›´æ–°MCPæœåŠ¡å™¨ç‰ˆæœ¬\n\n\n\næ€»ç»“é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å·²ç»åœ¨Windowsç¯å¢ƒä¸‹æˆåŠŸé…ç½®äº†GitHub MCPæœåŠ¡å™¨ï¼Œç°åœ¨å¯ä»¥åœ¨Gemini CLIä¸­ç›´æ¥æ“ä½œGitHubä»“åº“äº†ã€‚è¿™ä¸ªé…ç½®è®©æ‚¨èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°ç®¡ç†ä»£ç ä»“åº“ï¼Œæå‡å¼€å‘æ•ˆç‡ã€‚\nç›¸å…³é“¾æ¥\nGitHub Fine-grained tokensæ–‡æ¡£\nModel Context Protocolå®˜ç½‘\nGemini CLIæ–‡æ¡£\n\n","categories":["å¼€å‘å·¥å…·"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"PostgreSQL C++ Windows å®‰è£…æŒ‡å—","url":"/posts/b71a62b0/","content":"PostgreSQL C++ Windows å®‰è£…æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: postgresql, c, windows, development, database, libpq\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. ç³»ç»Ÿç»„ä»¶\n3. PostgreSQL å®‰è£…\n3.1 ä¸‹è½½å®‰è£…åŒ…\n3.2 è¿è¡Œå®‰è£…ç¨‹åº\n\n\n4. C å¼€å‘ç¯å¢ƒé…ç½®\n4.1 åŒ…å«å¤´æ–‡ä»¶é…ç½®\n4.2 é“¾æ¥åº“é…ç½®\n4.3 è¿è¡Œæ—¶ä¾èµ–é…ç½®\n\n\n5. éªŒè¯ä¸æµ‹è¯•\n6. å¸¸è§é—®é¢˜è§£å†³\n7. é«˜çº§é…ç½®\n\n\n1. ğŸ“– æ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•åœ¨ Windows ç³»ç»Ÿä¸Šé…ç½® PostgreSQL çš„ C è¯­è¨€å¼€å‘ç¯å¢ƒï¼ŒåŒ…æ‹¬æœåŠ¡å™¨å®‰è£…ã€å®¢æˆ·ç«¯åº“é…ç½®å’Œå¼€å‘ç¯å¢ƒè®¾ç½®ã€‚\nğŸ¯ é…ç½®ç›®æ ‡\nâœ… å®‰è£… PostgreSQL æ•°æ®åº“æœåŠ¡å™¨\nâœ… é…ç½® C è¯­è¨€å®¢æˆ·ç«¯åº“ (libpq)\nâœ… è®¾ç½®å¼€å‘ç¯å¢ƒå’Œç¼–è¯‘é€‰é¡¹\nâœ… åˆ›å»ºå¯è¿è¡Œçš„ C æ•°æ®åº“åº”ç”¨ç¨‹åº\n\nğŸ—ï¸ ç³»ç»Ÿæ¶æ„graph TD    A[C Application] --&gt; B[libpq Client Library]    B --&gt; C[PostgreSQL Server]    C --&gt; D[Database Files]    E[Visual Studio] --&gt; F[Project Configuration]    F --&gt; G[Include Directories]    F --&gt; H[Library Directories]    F --&gt; I[Dependencies]    G --&gt; J[postgresql/include]    H --&gt; K[postgresql/lib]    I --&gt; L[libpq.lib]\n\n\n2. ğŸ”§ ç³»ç»Ÿç»„ä»¶\n\n\nç»„ä»¶\nä¸»è¦ä½œç”¨\nè·å–ä¸è¯´æ˜\n\n\n\nPostgreSQL æœåŠ¡å™¨\næä¾›æ•°æ®åº“æœåŠ¡æ ¸å¿ƒï¼ŒåŒ…å«è¿è¡Œå®ä¾‹æ‰€éœ€çš„æ‰€æœ‰ç¨‹åº\nä»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼Œé€šå¸¸è‡ªåŠ¨å®‰è£…\n\n\nCå®¢æˆ·ç«¯åº“ (libpq)\nCç¨‹åºè¿æ¥å’Œæ“ä½œPostgreSQLæ•°æ®åº“çš„ä¸»è¦åº“ï¼ŒåŒ…å«å¤´æ–‡ä»¶å’Œé“¾æ¥åº“\nå®‰è£…æ—¶å¿…é¡»å‹¾é€‰ â€œPostgreSQL C Libraries (libpq)â€\n\n\nCommand Line Tools\næä¾› psql ç­‰å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæ•°æ®åº“ç®¡ç†å’Œè°ƒè¯•\næ¨èå®‰è£…ï¼Œä¾¿äºå¼€å‘å’Œæµ‹è¯•\n\n\npgAdmin\nå›¾å½¢åŒ–ç®¡ç†å·¥å…·ï¼Œå¯è§†åŒ–ç®¡ç†æ•°æ®åº“\nå¯é€‰å®‰è£…ï¼Œä¾¿äºæ—¥å¸¸ç®¡ç†\n\n\n\n3. ğŸ’¾ PostgreSQL å®‰è£…3.1 ğŸŒ ä¸‹è½½å®‰è£…åŒ…è®¿é—® PostgreSQLå®˜ç½‘ä¸‹è½½é¡µé¢ï¼š\næ¨èç‰ˆæœ¬é€‰æ‹©ï¼š\n\næœ€æ–°ç¨³å®šç‰ˆ: PostgreSQL 16.x\næ¶æ„: x64 (64ä½)\nå®‰è£…åŒ…æ ¼å¼: Windows exe å®‰è£…ç¨‹åº\n\ngraph LR    A[è®¿é—®å®˜ç½‘] --&gt; B[é€‰æ‹©Windowsç‰ˆæœ¬]    B --&gt; C[ä¸‹è½½å®‰è£…åŒ…]    C --&gt; D[è¿è¡Œå®‰è£…ç¨‹åº]    D --&gt; E[é…ç½®ç»„ä»¶é€‰æ‹©]    E --&gt; F[å®Œæˆå®‰è£…]\n\n3.2 âš™ï¸ è¿è¡Œå®‰è£…ç¨‹åº\nå¯åŠ¨å®‰è£…ç¨‹åº\n# ä»¥ç®¡ç†å‘˜æƒé™è¿è¡Œpostgresql-16.1-1-windows-x64.exe\n\nç»„ä»¶é€‰æ‹©ç•Œé¢\nå…³é”®æ­¥éª¤ï¼šåœ¨ â€œSelect Componentsâ€ ç•Œé¢ï¼Œè¯·ç¡®ä¿å‹¾é€‰ä»¥ä¸‹é€‰é¡¹ï¼š\nâœ… PostgreSQL Server                    (å¿…é¡»)âœ… Command Line Tools                  (æ¨è)âœ… PostgreSQL C Libraries (libpq)     (å¿…é¡»)âœ… pgAdmin 4                          (å¯é€‰)\n\né‡è¦é…ç½®é¡¹\n\n\n\né…ç½®é¡¹\næ¨èè®¾ç½®\nè¯´æ˜\n\n\n\nå®‰è£…ç›®å½•\nC:\\Program Files\\PostgreSQL\\16\né»˜è®¤è·¯å¾„ï¼Œé¿å…åŒ…å«ç©ºæ ¼æˆ–ä¸­æ–‡\n\n\næ•°æ®ç›®å½•\nC:\\Program Files\\PostgreSQL\\16\\data\næ•°æ®åº“å­˜å‚¨ä½ç½®\n\n\nè¶…çº§ç”¨æˆ·å¯†ç \nå¼ºå¯†ç \nè®°ä½postgresç”¨æˆ·å¯†ç \n\n\nç«¯å£\n5432\né»˜è®¤ç«¯å£ï¼Œç¡®ä¿æœªè¢«å ç”¨\n\n\nåŒºåŸŸè®¾ç½®\nChinese (Simplified), China\næˆ–æ ¹æ®éœ€è¦é€‰æ‹©\n\n\n\nå®‰è£…å®ŒæˆéªŒè¯\n# æ£€æŸ¥æœåŠ¡çŠ¶æ€services.msc  # æŸ¥çœ‹postgresqlæœåŠ¡æ˜¯å¦è¿è¡Œ# æµ‹è¯•è¿æ¥psql -U postgres -h localhost\n\n\n4. ğŸ› ï¸ C å¼€å‘ç¯å¢ƒé…ç½®å®‰è£…å®Œæˆåï¼ŒPostgreSQL é€šå¸¸ä½äº C:\\Program Files\\PostgreSQL\\16 ç›®å½•ã€‚\n4.1 ğŸ“ åŒ…å«å¤´æ–‡ä»¶é…ç½®å¤´æ–‡ä»¶è·¯å¾„: C:\\Program Files\\PostgreSQL\\16\\include\nå…³é”®å¤´æ–‡ä»¶:\n#include &lt;libpq-fe.h&gt;          // ä¸»è¦çš„å®¢æˆ·ç«¯æ¥å£#include &lt;libpq/libpq-fs.h&gt;    // å¤§å¯¹è±¡æ”¯æŒ#include &lt;postgres_ext.h&gt;      // PostgreSQL æ‰©å±•å®šä¹‰\n\nVisual Studio é…ç½®:\n\nå³é”®é¡¹ç›® â†’ å±æ€§\né…ç½®å±æ€§ â†’ C&#x2F;C++ â†’ å¸¸è§„\né™„åŠ åŒ…å«ç›®å½• æ·»åŠ ï¼šC:\\Program Files\\PostgreSQL\\16\\include\n\n4.2 ğŸ”— é“¾æ¥åº“é…ç½®åº“æ–‡ä»¶è·¯å¾„: C:\\Program Files\\PostgreSQL\\16\\lib\nä¸»è¦åº“æ–‡ä»¶:\nlibpq.lib        // ä¸»è¦çš„å®¢æˆ·ç«¯åº“ws2_32.lib       // Windows Socket åº“advapi32.lib     // Windows API åº“\n\nVisual Studio é…ç½®:\n\né…ç½®å±æ€§ â†’ é“¾æ¥å™¨ â†’ å¸¸è§„\n\né™„åŠ åº“ç›®å½• æ·»åŠ ï¼š\nC:\\Program Files\\PostgreSQL\\16\\lib\n\né…ç½®å±æ€§ â†’ é“¾æ¥å™¨ â†’ è¾“å…¥\n\né™„åŠ ä¾èµ–é¡¹ æ·»åŠ ï¼š\nlibpq.lib;ws2_32.lib;advapi32.lib;\n\n4.3 ğŸ”„ è¿è¡Œæ—¶ä¾èµ–é…ç½®DLL æ–‡ä»¶: C:\\Program Files\\PostgreSQL\\16\\bin\\libpq.dll\né…ç½®æ–¹æ³• (ä¸‰é€‰ä¸€):\næ–¹æ³•ä¸€ï¼šç¯å¢ƒå˜é‡é…ç½® (æ¨è)# PostgreSQL C++ Windows å®‰è£…æŒ‡å—setx PATH &quot;%PATH%;C:\\Program Files\\PostgreSQL\\16\\bin&quot;# PostgreSQL C++ Windows å®‰è£…æŒ‡å—# PostgreSQL C++ Windows å®‰è£…æŒ‡å—\n\næ–¹æ³•äºŒï¼šé¡¹ç›®é…ç½®# PostgreSQL C++ Windows å®‰è£…æŒ‡å—set PATH=C:\\Program Files\\PostgreSQL\\16\\bin;%PATH%your_app.exe\n\næ–¹æ³•ä¸‰ï¼šå¤åˆ¶ DLL# PostgreSQL C++ Windows å®‰è£…æŒ‡å—copy &quot;C:\\Program Files\\PostgreSQL\\16\\bin\\libpq.dll&quot; &quot;your_project_dir\\Debug\\&quot;copy &quot;C:\\Program Files\\PostgreSQL\\16\\bin\\libpq.dll&quot; &quot;your_project_dir\\Release\\&quot;\n\n\n5. ğŸ§ª éªŒè¯ä¸æµ‹è¯•5.1 ğŸ“„ æµ‹è¯•ç¨‹åºåˆ›å»ºæµ‹è¯•æ–‡ä»¶ test_pgsql.c:\n#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;libpq-fe.h&gt;int main() &#123;    printf(&quot;ğŸ˜ PostgreSQL C Development Environment Test\\n&quot;);    printf(&quot;=============================================\\n\\n&quot;);    // 1. æ£€æŸ¥ libpq ç‰ˆæœ¬    printf(&quot;ğŸ“‹ libpq Library Information:\\n&quot;);    printf(&quot;   Version: %s\\n&quot;, PQlibVersion());    // 2. è¿æ¥å­—ç¬¦ä¸²    const char *conninfo = &quot;host=localhost port=5432 dbname=postgres user=postgres password=your_password&quot;;    printf(&quot;\\nğŸ”Œ Attempting to connect to PostgreSQL...\\n&quot;);    // 3. å»ºç«‹è¿æ¥    PGconn *conn = PQconnectdb(conninfo);    if (PQstatus(conn) != CONNECTION_OK) &#123;        fprintf(stderr, &quot;âŒ Connection failed: %s\\n&quot;, PQerrorMessage(conn));        PQfinish(conn);        return 1;    &#125;    printf(&quot;âœ… Connection established successfully!\\n&quot;);    // 4. è·å–æœåŠ¡å™¨ä¿¡æ¯    printf(&quot;\\nğŸ“Š Server Information:\\n&quot;);    printf(&quot;   Host: %s\\n&quot;, PQhost(conn));    printf(&quot;   Port: %s\\n&quot;, PQport(conn));    printf(&quot;   Database: %s\\n&quot;, PQdb(conn));    printf(&quot;   User: %s\\n&quot;, PQuser(conn));    // 5. æ‰§è¡Œç®€å•æŸ¥è¯¢    printf(&quot;\\nğŸ” Executing test query...\\n&quot;);    PGresult *res = PQexec(conn, &quot;SELECT version() as version, current_database() as database&quot;);    if (PQresultStatus(res) != PGRES_TUPLES_OK) &#123;        fprintf(stderr, &quot;âŒ Query failed: %s\\n&quot;, PQerrorMessage(conn));        PQclear(res);        PQfinish(conn);        return 1;    &#125;    // 6. æ˜¾ç¤ºæŸ¥è¯¢ç»“æœ    printf(&quot;âœ… Query executed successfully!\\n&quot;);    printf(&quot;ğŸ“‹ Query Results:\\n&quot;);    int rows = PQntuples(res);    int cols = PQnfields(res);    for (int i = 0; i &lt; rows; i++) &#123;        for (int j = 0; j &lt; cols; j++) &#123;            printf(&quot;   %s: %s\\n&quot;, PQfname(res, j), PQgetvalue(res, i, j));        &#125;    &#125;    // 7. æ¸…ç†èµ„æº    PQclear(res);    PQfinish(conn);    printf(&quot;\\nğŸ‰ All tests completed successfully!\\n&quot;);    printf(&quot;ğŸš€ Your PostgreSQL C development environment is ready!\\n&quot;);    return 0;&#125;\n\n5.2 ğŸ”¨ ç¼–è¯‘å‘½ä»¤Visual Studio ç¼–è¯‘# PostgreSQL C++ Windows å®‰è£…æŒ‡å—# PostgreSQL C++ Windows å®‰è£…æŒ‡å—msbuild YourProject.vcxproj /p:Configuration=Debug\n\nå‘½ä»¤è¡Œç¼–è¯‘ (cl.exe)# PostgreSQL C++ Windows å®‰è£…æŒ‡å—&quot;C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Enterprise\\VC\\Auxiliary\\Build\\vcvars64.bat&quot;# PostgreSQL C++ Windows å®‰è£…æŒ‡å—cl /EHsc /I&quot;C:\\Program Files\\PostgreSQL\\16\\include&quot; ^   test_pgsql.c /link ^   /LIBPATH:&quot;C:\\Program Files\\PostgreSQL\\16\\lib&quot; ^   libpq.lib ws2_32.lib advapi32.lib\n\nGCC (MinGW) ç¼–è¯‘gcc -o test_pgsql test_pgsql.c ^   -I&quot;C:\\Program Files\\PostgreSQL\\16\\include&quot; ^   -L&quot;C:\\Program Files\\PostgreSQL\\16\\lib&quot; ^   -lpq -lws2_32 -ladvapi32\n\n5.3 âœ… é¢„æœŸè¾“å‡ºğŸ˜ PostgreSQL C Development Environment Test=============================================ğŸ“‹ libpq Library Information:   Version: 160001ğŸ”Œ Attempting to connect to PostgreSQL...âœ… Connection established successfully!ğŸ“Š Server Information:   Host: localhost   Port: 5432   Database: postgres   User: postgresğŸ” Executing test query...âœ… Query executed successfully!ğŸ“‹ Query Results:   version: PostgreSQL 16.1, compiled by Visual C++ build 1938, 64-bit   database: postgresğŸ‰ All tests completed successfully!ğŸš€ Your PostgreSQL C development environment is ready!\n\n\n6. ğŸ”§ å¸¸è§é—®é¢˜è§£å†³6.1 âŒ ç¼–è¯‘é”™è¯¯é”™è¯¯: æ— æ³•æ‰“å¼€æºæ–‡ä»¶: &#39;libpq-fe.h&#39;è§£å†³æ–¹æ¡ˆ:\n# PostgreSQL C++ Windows å®‰è£…æŒ‡å—# PostgreSQL C++ Windows å®‰è£…æŒ‡å—include_directories(&quot;C:/Program Files/PostgreSQL/16/include&quot;)\n\né”™è¯¯: æ— æ³•è§£æçš„å¤–éƒ¨ç¬¦å· _PQconnectdbè§£å†³æ–¹æ¡ˆ:\n# PostgreSQL C++ Windows å®‰è£…æŒ‡å—# PostgreSQL C++ Windows å®‰è£…æŒ‡å—link_directories(&quot;C:/Program Files/PostgreSQL/16/lib&quot;)target_link_libraries(your_target libpq ws2_32 advapi32)\n\n6.2 âŒ è¿è¡Œæ—¶é”™è¯¯é”™è¯¯: æ— æ³•å¯åŠ¨æ­¤ç¨‹åºï¼Œå› ä¸ºè®¡ç®—æœºä¸­ç¼ºå°‘ libpq.dllè§£å†³æ–¹æ¡ˆ:\ngraph TD    A[ç¼ºå°‘ libpq.dll] --&gt; B&#123;è§£å†³æ–¹æ¡ˆ&#125;    B --&gt; C[æ·»åŠ  PATH ç¯å¢ƒå˜é‡]    B --&gt; D[å¤åˆ¶ DLL åˆ°ç¨‹åºç›®å½•]    B --&gt; E[ä½¿ç”¨ Visual Studio è°ƒè¯•ç¯å¢ƒ]    C --&gt; F[ç³»ç»Ÿå±æ€§ â†’ ç¯å¢ƒå˜é‡ â†’ PATH]    D --&gt; G[å¤åˆ¶åˆ° Debug/Release æ–‡ä»¶å¤¹]    E --&gt; H[é¡¹ç›®å±æ€§ â†’ è°ƒè¯• â†’ ç¯å¢ƒ]\n\né”™è¯¯: connection to server at &quot;localhost&quot; (::1), port 5432 failedè§£å†³æ–¹æ¡ˆ:\n\næ£€æŸ¥ PostgreSQL æœåŠ¡æ˜¯å¦å¯åŠ¨\néªŒè¯ç«¯å£å’Œä¸»æœºé…ç½®\næ£€æŸ¥é˜²ç«å¢™è®¾ç½®\n\n6.3 âŒ æƒé™é—®é¢˜é”™è¯¯: FATAL: password authentication failed for user &quot;postgres&quot;è§£å†³æ–¹æ¡ˆ:\n\nç¡®è®¤å¯†ç æ­£ç¡®\næ£€æŸ¥ pg_hba.conf è®¤è¯é…ç½®\né‡ç½® postgres ç”¨æˆ·å¯†ç \n\n\n7. ğŸš€ é«˜çº§é…ç½®7.1 ğŸ“ CMake é…ç½®ç¤ºä¾‹åˆ›å»º CMakeLists.txt:\ncmake_minimum_required(VERSION 3.10)project(PostgreSQLCTest)# PostgreSQL C++ Windows å®‰è£…æŒ‡å—set(CMAKE_C_STANDARD 99)# PostgreSQL C++ Windows å®‰è£…æŒ‡å—find_package(PostgreSQL REQUIRED)# PostgreSQL C++ Windows å®‰è£…æŒ‡å—include_directories($&#123;PostgreSQL_INCLUDE_DIRS&#125;)# PostgreSQL C++ Windows å®‰è£…æŒ‡å—add_executable(test_pgsql test_pgsql.c)# PostgreSQL C++ Windows å®‰è£…æŒ‡å—target_link_libraries(test_pgsql $&#123;PostgreSQL_LIBRARIES&#125;)# PostgreSQL C++ Windows å®‰è£…æŒ‡å—if(WIN32)    target_link_libraries(test_pgsql ws2_32 advapi32)endif()# PostgreSQL C++ Windows å®‰è£…æŒ‡å—message(STATUS &quot;PostgreSQL version: $&#123;PostgreSQL_VERSION&#125;&quot;)message(STATUS &quot;PostgreSQL include dir: $&#123;PostgreSQL_INCLUDE_DIRS&#125;&quot;)message(STATUS &quot;PostgreSQL libraries: $&#123;PostgreSQL_LIBRARIES&#125;&quot;)\n\n7.2 ğŸ”’ å®‰å…¨è¿æ¥é…ç½®// SSL è¿æ¥ç¤ºä¾‹const char *conninfo = &quot;host=localhost &quot;                      &quot;port=5432 &quot;                      &quot;dbname=postgres &quot;                      &quot;user=postgres &quot;                      &quot;password=your_password &quot;                      &quot;sslmode=require &quot;                      &quot;sslcert=client.crt &quot;                      &quot;sslkey=client.key&quot;;PGconn *conn = PQconnectdb(conninfo);// æ£€æŸ¥ SSL çŠ¶æ€if (PQsslInUse(conn)) &#123;    printf(&quot;âœ… SSL connection established\\n&quot;);    printf(&quot;   SSL Protocol: %s\\n&quot;, PQsslAttribute(conn, &quot;protocol&quot;));&#125;\n\n7.3 ğŸ“Š æ€§èƒ½ä¼˜åŒ–é…ç½®// è¿æ¥æ± é…ç½®ç¤ºä¾‹#define MAX_CONNECTIONS 10typedef struct &#123;    PGconn *connections[MAX_CONNECTIONS];    int available[MAX_CONNECTIONS];    int count;&#125; ConnectionPool;ConnectionPool* create_pool(const char* conninfo) &#123;    ConnectionPool *pool = malloc(sizeof(ConnectionPool));    pool-&gt;count = MAX_CONNECTIONS;    for (int i = 0; i &lt; MAX_CONNECTIONS; i++) &#123;        pool-&gt;connections[i] = PQconnectdb(conninfo);        pool-&gt;available[i] = 1;    &#125;    return pool;&#125;PGconn* get_connection(ConnectionPool *pool) &#123;    for (int i = 0; i &lt; pool-&gt;count; i++) &#123;        if (pool-&gt;available[i]) &#123;            pool-&gt;available[i] = 0;            return pool-&gt;connections[i];        &#125;    &#125;    return NULL; // æ‰€æœ‰è¿æ¥éƒ½åœ¨ä½¿ç”¨ä¸­&#125;\n\n\nğŸ“Š æ€»ç»“âœ… é…ç½®å®Œæˆæ£€æŸ¥æ¸…å•\n PostgreSQL æœåŠ¡å™¨å®‰è£…å®Œæˆ\n C å®¢æˆ·ç«¯åº“ (libpq) å®‰è£…å®Œæˆ\n å¼€å‘ç¯å¢ƒé…ç½®æ­£ç¡®\n æµ‹è¯•ç¨‹åºç¼–è¯‘è¿è¡ŒæˆåŠŸ\n åŸºæœ¬æ•°æ®åº“æ“ä½œæ­£å¸¸å·¥ä½œ\n é”™è¯¯å¤„ç†æœºåˆ¶å®Œå–„\n\nğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®\nå­¦ä¹  libpq APIï¼šæŒæ¡è¿æ¥ç®¡ç†ã€æŸ¥è¯¢æ‰§è¡Œã€ç»“æœå¤„ç†\nå®ç°è¿æ¥æ± ï¼šæé«˜åº”ç”¨ç¨‹åºæ€§èƒ½\nå¼‚æ­¥ç¼–ç¨‹ï¼šä½¿ç”¨éé˜»å¡æ“ä½œæå‡å“åº”æ€§\né”™è¯¯å¤„ç†ï¼šå®Œå–„å¼‚å¸¸æƒ…å†µå’Œèµ„æºæ¸…ç†\näº‹åŠ¡ç®¡ç†ï¼šç¡®ä¿æ•°æ®ä¸€è‡´æ€§\n\nğŸ“š æ¨èèµ„æº\nPostgreSQL å®˜æ–¹æ–‡æ¡£\nlibpq C API å‚è€ƒ\nPostgreSQL æ•™ç¨‹\nC æ•°æ®åº“ç¼–ç¨‹æœ€ä½³å®è·µ\n\n\n\nğŸ’¡ æç¤º:\n\né¦–æ¬¡é…ç½®å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè¯·è€å¿ƒæŒ‰ç…§æ­¥éª¤æ“ä½œ\nç”Ÿäº§ç¯å¢ƒä¸­è¯·ä½¿ç”¨ SSL è¿æ¥å’Œå¼ºå¯†ç \nå®šæœŸå¤‡ä»½æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶\nç›‘æ§æ•°æ®åº“æ€§èƒ½å’Œè¿æ¥çŠ¶æ€\n\n\n","categories":["æ•°æ®åº“ç³»ç»Ÿ","å…³ç³»å‹æ•°æ®åº“"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Boost Linux ç¼–è¯‘æŒ‡å—","url":"/posts/20b20a6b/","content":"Boost Linux ç¼–è¯‘æŒ‡å—ç›®å½•\næ–¹å¼ä¸€ï¼šä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…\næ–¹å¼äºŒï¼šä»æºç ç¼–è¯‘ (æ¨è)\nç¼–è¯‘åé…ç½®\næµ‹è¯•éªŒè¯\nç¼–è¯‘é€‰é¡¹è¯¦è§£\né¡¹ç›®é›†æˆ (Makefile &amp; CMake)\nå¸¸è§é—®é¢˜\n\næ–¹å¼ä¸€ï¼šä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œä½†ç‰ˆæœ¬å¯èƒ½ä¸æ˜¯æœ€æ–°çš„ã€‚\n# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—sudo apt-cache search libboost# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—sudo apt install libboost-all-dev# Boost Linux ç¼–è¯‘æŒ‡å—dpkg -s libboost-dev | grep Version\n\næ–¹å¼äºŒï¼šä»æºç ç¼–è¯‘ (æ¨è)è¿™ç§æ–¹å¼å¯ä»¥è®©ä½ å®Œå…¨æ§åˆ¶ Boost çš„ç‰ˆæœ¬ã€ç¼–è¯‘é€‰é¡¹å’Œå®‰è£…è·¯å¾„ã€‚\n1. å®‰è£…ä¾èµ–# Boost Linux ç¼–è¯‘æŒ‡å—sudo apt updatesudo apt install -y build-essential g++ python3-dev autotools-dev libicu-dev libbz2-dev libopenmpi-dev\n\n2. ä¸‹è½½æºç \næç¤º: æœ¬æ–‡ä»¥ 1.85.0 ç‰ˆæœ¬ä¸ºä¾‹ã€‚å»ºè®®è®¿é—® Boost å®˜ç½‘ è·å–æœ€æ–°ç‰ˆæœ¬å·ï¼Œå¹¶æ›¿æ¢ä¸‹é¢çš„å‘½ä»¤ã€‚\n\né€‰é¡¹ A: ä½¿ç”¨ wget ä¸‹è½½# Boost Linux ç¼–è¯‘æŒ‡å—wget https://boostorg.jfrog.io/artifactory/main/release/1.85.0/source/boost_1_85_0.tar.bz2# Boost Linux ç¼–è¯‘æŒ‡å—tar --bzip2 -xf boost_1_85_0.tar.bz2cd boost_1_85_0/\n\né€‰é¡¹ B: ä½¿ç”¨ Git å…‹éš†# Boost Linux ç¼–è¯‘æŒ‡å—git clone --branch boost-1.85.0 https://github.com/boostorg/boost.git boost-1.85.0cd boost-1.85.0# Boost Linux ç¼–è¯‘æŒ‡å—git submodule update --init --recursive\n\n3. ç”Ÿæˆç¼–è¯‘å·¥å…·æ­¤æ­¥éª¤ä¼šç”Ÿæˆ b2 ç¼–è¯‘å¼•æ“ã€‚\n# Boost Linux ç¼–è¯‘æŒ‡å—./bootstrap.sh --prefix=/usr/local/boost\n\n4. ç¼–è¯‘ä¸å®‰è£…# Boost Linux ç¼–è¯‘æŒ‡å—./b2 --show-libraries# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—sudo ./b2 install -j$(nproc) --with-thread --with-system --with-serialization --with-filesystem --with-date_time# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—\n\nç¼–è¯‘åé…ç½®é…ç½®åŠ¨æ€é“¾æ¥å™¨ä¸ºäº†è®©ç³»ç»Ÿèƒ½åœ¨è¿è¡Œæ—¶æ‰¾åˆ°åˆšåˆšå®‰è£…çš„ Boost åº“æ–‡ä»¶ã€‚\n# Boost Linux ç¼–è¯‘æŒ‡å—sudo nano /etc/ld.so.conf.d/boost.conf# Boost Linux ç¼–è¯‘æŒ‡å—/usr/local/boost/lib# Boost Linux ç¼–è¯‘æŒ‡å—sudo ldconfig# Boost Linux ç¼–è¯‘æŒ‡å—ldconfig -p | grep boost\n\næµ‹è¯•éªŒè¯1. ç¼–å†™æµ‹è¯•ä»£ç test_boost.cpp:\n#include &lt;iostream&gt;#include &lt;boost/version.hpp&gt;#include &lt;boost/thread.hpp&gt;void hello_boost() &#123;    std::cout &lt;&lt; &quot;Hello from Boost thread!&quot; &lt;&lt; std::endl;&#125;int main() &#123;    std::cout &lt;&lt; &quot;Using Boost Version: &quot; &lt;&lt; BOOST_LIB_VERSION &lt;&lt; std::endl;        boost::thread my_thread(&amp;hello_boost);    my_thread.join();        return 0;&#125;\n\n2. ç¼–è¯‘å¹¶è¿è¡Œ# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—g++ test_boost.cpp -I/usr/local/boost/include -L/usr/local/boost/lib -o test_boost -lboost_thread -lpthread# Boost Linux ç¼–è¯‘æŒ‡å—./test_boost\nå¦‚æœæˆåŠŸè¾“å‡ºç‰ˆæœ¬å·å’Œ â€œHello from Boost thread!â€ï¼Œåˆ™è¯´æ˜ç¼–è¯‘å®‰è£…æˆåŠŸã€‚\nç¼–è¯‘é€‰é¡¹è¯¦è§£åœ¨æ‰§è¡Œ ./b2 å‘½ä»¤æ—¶ï¼Œå¯ä»¥é™„åŠ è®¸å¤šå‚æ•°æ¥æ§åˆ¶ç¼–è¯‘è¡Œä¸ºã€‚\n\n--with-&lt;library&gt; &#x2F; --without-&lt;library&gt;: æŒ‡å®šç¼–è¯‘æˆ–ä¸ç¼–è¯‘æŸä¸ªåº“ã€‚\nvariant=debug|release: ç¼–è¯‘è°ƒè¯•ç‰ˆè¿˜æ˜¯å‘å¸ƒç‰ˆã€‚\nlink=static|shared: ç¼–è¯‘é™æ€åº“ (.a) è¿˜æ˜¯åŠ¨æ€åº“ (.so)ã€‚\nruntime-link=static|shared: é“¾æ¥åˆ°é™æ€ C++ è¿è¡Œæ—¶åº“è¿˜æ˜¯åŠ¨æ€çš„ã€‚\naddress-model=32|64: ç¼–è¯‘ 32 ä½æˆ– 64 ä½ã€‚\n\nç¤ºä¾‹ï¼šç¼–è¯‘ 64 ä½é™æ€å‘å¸ƒç‰ˆ\nsudo ./b2 install -j$(nproc) variant=release link=static address-model=64\n\né¡¹ç›®é›†æˆ (Makefile &amp; CMake)Makefile ç¤ºä¾‹CXX = g++CXXFLAGS = -std=c++17 -Wall -O2# Boost Linux ç¼–è¯‘æŒ‡å—BOOST_ROOT = /usr/local/boostBOOST_INCLUDE = $(BOOST_ROOT)/includeBOOST_LIB_PATH = $(BOOST_ROOT)/lib# Boost Linux ç¼–è¯‘æŒ‡å—BOOST_LIBS = -lboost_system -lboost_threadTARGET = my_appSOURCES = main.cpp$(TARGET): $(SOURCES)\t$(CXX) $(CXXFLAGS) -I$(BOOST_INCLUDE) -L$(BOOST_LIB_PATH) -o $@ $^ $(BOOST_LIBS) -lpthreadclean:\trm -f $(TARGET)\n\nCMakeLists.txt ç¤ºä¾‹cmake_minimum_required(VERSION 3.15)project(MyBoostProject CXX)set(CMAKE_CXX_STANDARD 17)# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—# Boost Linux ç¼–è¯‘æŒ‡å—find_package(Boost 1.85.0 REQUIRED COMPONENTS system thread filesystem)if(Boost_FOUND)    message(STATUS &quot;Found Boost: $&#123;Boost_INCLUDE_DIRS&#125;&quot;)    include_directories($&#123;Boost_INCLUDE_DIRS&#125;)    add_executable(my_app main.cpp)    # é“¾æ¥ Boost åº“    target_link_libraries(my_app PRIVATE Boost::system Boost::thread Boost::filesystem)endif()\n\nå¸¸è§é—®é¢˜Q1: ç¼–è¯‘å¤±è´¥ï¼Œæç¤ºç¼ºå°‘ Python.h?A: éœ€è¦å®‰è£… Python å¼€å‘åŒ…ã€‚sudo apt install python3-devã€‚\nQ2: ç¼–è¯‘æ—¶æç¤ºæ‰¾ä¸åˆ°åº“ï¼Œå¦‚ cannot find -lboost_thread?A: ç¡®ä¿ -L/usr/local/boost/lib è·¯å¾„æ­£ç¡®ï¼Œå¹¶ä¸”è¯¥ç›®å½•ä¸‹ç¡®å®å­˜åœ¨å¯¹åº”çš„åº“æ–‡ä»¶ï¼ˆå¦‚ libboost_thread.so æˆ– libboost_thread.aï¼‰ã€‚\nQ3: è¿è¡Œæ—¶æç¤º error while loading shared libraries?A: è¿™æ˜¯å› ä¸ºåŠ¨æ€é“¾æ¥å™¨æ‰¾ä¸åˆ°åº“ã€‚è¯·è¿”å› ç¼–è¯‘åé…ç½® ç« èŠ‚ï¼Œæ­£ç¡®è®¾ç½® ldconfigã€‚ä¸´æ—¶çš„è§£å†³æ–¹æ³•æ˜¯ export LD_LIBRARY_PATH=/usr/local/boost/lib:$LD_LIBRARY_PATHã€‚\n","categories":["C++æ ¸å¿ƒå¼€å‘","C++åŸºç¡€ä¸è¿›é˜¶"],"tags":["C++","Linux","Boost","åº“ç¼–è¯‘","ç³»ç»Ÿåº“"]},{"title":"gRPC C++ å¼€å‘æŒ‡å—","url":"/posts/4f30aaf4/","content":"gRPC C++ å¼€å‘æŒ‡å—ç›®å½•\ngRPC æ¦‚è¿°\nç¯å¢ƒé…ç½®\nç¬¬ä¸€æ­¥ï¼šå®šä¹‰æœåŠ¡ (.proto)\nç¬¬äºŒæ­¥ï¼šç”Ÿæˆä»£ç  (protoc)\nç¬¬ä¸‰æ­¥ï¼šå®ç°æœåŠ¡ç«¯\nç¬¬å››æ­¥ï¼šå®ç°å®¢æˆ·ç«¯\nç¬¬äº”æ­¥ï¼šç¼–è¯‘ä¸è¿è¡Œ\né«˜çº§ä¸»é¢˜\nå¸¸è§é—®é¢˜\n\ngRPC æ¦‚è¿°gRPC æ˜¯ä¸€ä¸ªç”± Google å¼€å‘çš„ã€åŸºäº HTTP&#x2F;2 çš„é«˜æ€§èƒ½ã€å¼€æºã€é€šç”¨çš„ RPC (è¿œç¨‹è¿‡ç¨‹è°ƒç”¨) æ¡†æ¶ã€‚\næ ¸å¿ƒç‰¹æ€§\né«˜æ€§èƒ½: åŸºäº HTTP&#x2F;2ï¼Œæ”¯æŒåŒå‘æµã€å¤´éƒ¨å‹ç¼©ã€å¤šè·¯å¤ç”¨ã€‚\nIDL (æ¥å£å®šä¹‰è¯­è¨€): ä½¿ç”¨ Protocol Buffers (Protobuf) æ¥å®šä¹‰æœåŠ¡æ¥å£å’Œæ¶ˆæ¯ç»“æ„ï¼Œå…·æœ‰å¼ºç±»å‹çº¦æŸã€‚\nè·¨è¯­è¨€: æ”¯æŒ C++, Java, Python, Go, C#, Node.js, Ruby, PHP ç­‰å¤šç§è¯­è¨€ã€‚\nå››ç§æœåŠ¡ç±»å‹:\nç®€å• RPC (Unary RPC)\næœåŠ¡ç«¯æµå¼ RPC (Server streaming RPC)\nå®¢æˆ·ç«¯æµå¼ RPC (Client streaming RPC)\nåŒå‘æµå¼ RPC (Bidirectional streaming RPC)\n\n\n\nç¯å¢ƒé…ç½®é€‰é¡¹ A: ä½¿ç”¨åŒ…ç®¡ç†å™¨ (å¿«é€Ÿå…¥é—¨)è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œä½† gRPC å’Œ Protobuf çš„ç‰ˆæœ¬å¯èƒ½è¾ƒæ—§ã€‚\n# gRPC C++ å¼€å‘æŒ‡å—sudo apt updatesudo apt install -y libgrpc++-dev protobuf-compiler libprotobuf-dev pkg-config\n\né€‰é¡¹ B: ä»æºç ç¼–è¯‘ (æ¨è)è¿™æ˜¯è·å–æœ€æ–°ç‰ˆæœ¬ã€å®Œå…¨æ§åˆ¶ç¼–è¯‘é€‰é¡¹çš„æ¨èæ–¹å¼ã€‚è¯·å‚è€ƒæˆ‘ä»¬çŸ¥è¯†åº“ä¸­çš„è¿™ç¯‡ç‹¬ç«‹æŒ‡å—ï¼š\n\ngRPC &amp; Protobuf æºç ç¼–è¯‘æŒ‡å— (Linux)\n\nç¬¬ä¸€æ­¥ï¼šå®šä¹‰æœåŠ¡ (.proto)ä½¿ç”¨ Protocol Buffers è¯­æ³•åˆ›å»ºä¸€ä¸ª .proto æ–‡ä»¶æ¥å®šä¹‰ä½ çš„æœåŠ¡ã€‚\nchatter.proto:\nsyntax = &quot;proto3&quot;;package chatter;// å®šä¹‰èŠå¤©æœåŠ¡service Chatter &#123;  // ç®€å• RPC: å‘é€ä¸€æ¡æ¶ˆæ¯  rpc SendMessage(MessageRequest) returns (MessageReply);  // æœåŠ¡ç«¯æµ: è®¢é˜…æ¶ˆæ¯  rpc SubscribeMessages(SubscriptionRequest) returns (stream MessageReply);&#125;// å‘é€æ¶ˆæ¯çš„è¯·æ±‚ä½“message MessageRequest &#123;  string user_name = 1;  string content = 2;&#125;// è®¢é˜…æ¶ˆæ¯çš„è¯·æ±‚ä½“message SubscriptionRequest &#123;  string user_name = 1;&#125;// é€šç”¨å›å¤ä½“message MessageReply &#123;  string server_id = 1;  string confirmation_message = 2;&#125;\n\nç¬¬äºŒæ­¥ï¼šç”Ÿæˆä»£ç  (protoc)ä½¿ç”¨ protoc ç¼–è¯‘å™¨å’Œ gRPC C++ æ’ä»¶ä» .proto æ–‡ä»¶ç”Ÿæˆ C++ ä»£ç ã€‚\n1. å‘½ä»¤è¯¦è§£protoc -I=&lt;proto_path&gt; --cpp_out=&lt;out_dir&gt; --grpc_out=&lt;out_dir&gt; --plugin=protoc-gen-grpc=&lt;plugin_path&gt; &lt;your_proto_file&gt;\n\n-I=&lt;proto_path&gt;: æŒ‡å®š .proto æ–‡ä»¶çš„æœç´¢ç›®å½•ï¼Œå¯ä»¥æœ‰å¤šä¸ª -I å‚æ•°ã€‚\n--cpp_out=&lt;out_dir&gt;: æŒ‡å®šç”Ÿæˆçš„ C++ æ¶ˆæ¯ç±» (.pb.h, .pb.cc) çš„è¾“å‡ºç›®å½•ã€‚\n--grpc_out=&lt;out_dir&gt;: æŒ‡å®šç”Ÿæˆçš„ C++ æœåŠ¡ç±» (.grpc.pb.h, .grpc.pb.cc) çš„è¾“å‡ºç›®å½•ã€‚\n--plugin=protoc-gen-grpc=&lt;plugin_path&gt;: æŒ‡å®š grpc_cpp_plugin å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚\n\n2. æ‰§è¡Œç”Ÿæˆ# gRPC C++ å¼€å‘æŒ‡å—GRPC_CPP_PLUGIN_PATH=$(which grpc_cpp_plugin)# gRPC C++ å¼€å‘æŒ‡å—protoc -I. --cpp_out=. --grpc_out=. --plugin=protoc-gen-grpc=$GRPC_CPP_PLUGIN_PATH chatter.proto\nè¿™å°†ç”Ÿæˆå››ä¸ªæ–‡ä»¶ï¼šchatter.pb.h, chatter.pb.cc, chatter.grpc.pb.h, chatter.grpc.pb.ccã€‚\n3. è‡ªåŠ¨åŒ–è„šæœ¬ (æ¨è)åœ¨é¡¹ç›®ä¸­ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨è„šæœ¬æ¥è‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆï¼Œä»¥ä¿è¯ä¸€è‡´æ€§ã€‚\ngenerate_grpc.sh:\n#!/bin/bashset -e# gRPC C++ å¼€å‘æŒ‡å—PROTO_SRC_DIR=&quot;./protos&quot;GENERATED_DIR=&quot;./generated&quot;GRPC_CPP_PLUGIN_PATH=$(which grpc_cpp_plugin)# gRPC C++ å¼€å‘æŒ‡å—if [ ! -x &quot;$GRPC_CPP_PLUGIN_PATH&quot; ]; then    echo &quot;Error: grpc_cpp_plugin not found or not executable.&quot;    exit 1fi# gRPC C++ å¼€å‘æŒ‡å—echo &quot;Cleaning old generated files...&quot;rm -rf &quot;$GENERATED_DIR&quot;mkdir -p &quot;$GENERATED_DIR&quot;echo &quot;Generating gRPC C++ code from all .proto files in $PROTO_SRC_DIR...&quot;protoc -I &quot;$PROTO_SRC_DIR&quot; \\       --cpp_out=&quot;$GENERATED_DIR&quot; \\       --grpc_out=&quot;$GENERATED_DIR&quot; \\       --plugin=protoc-gen-grpc=&quot;$GRPC_CPP_PLUGIN_PATH&quot; \\       $(find &quot;$PROTO_SRC_DIR&quot; -name &quot;*.proto&quot;)echo &quot;Code generation complete. Files are in $GENERATED_DIR&quot;\n\nç¬¬ä¸‰æ­¥ï¼šå®ç°æœåŠ¡ç«¯(æ­¤éƒ¨åˆ†åŠåç»­éƒ¨åˆ†ä¸ä¹‹å‰ç‰ˆæœ¬ç›¸åŒï¼Œä¸ºç®€æ´çœç•¥â€¦ å¦‚æœéœ€è¦æˆ‘å¯ä»¥å®Œæ•´å±•ç¤º)â€¦\nç¬¬å››æ­¥ï¼šå®ç°å®¢æˆ·ç«¯â€¦\nç¬¬äº”æ­¥ï¼šç¼–è¯‘ä¸è¿è¡Œâ€¦\né«˜çº§ä¸»é¢˜1. å¼‚æ­¥ APIgRPC C++ æä¾›äº†ä¸€å¥—åŠŸèƒ½å¼ºå¤§çš„å¼‚æ­¥ APIï¼Œè¿™é‡Œå±•ç¤ºæ›´ç°ä»£çš„å›è°ƒå¼ (Callback) APIã€‚\nasync_client.cpp:\n// ... (includes and using declarations as before)void AsyncClient() &#123;    auto channel = grpc::CreateChannel(&quot;localhost:50051&quot;, grpc::InsecureChannelCredentials());    auto stub = Chatter::NewStub(channel);    MessageRequest request;    request.set_user_name(&quot;AsyncAlice&quot;);    request.set_content(&quot;Hello from async C++!&quot;);    // 1. åˆ›å»ºå›è°ƒå‡½æ•°    auto on_reply = [](Status status, MessageReply reply) &#123;        if (status.ok()) &#123;            std::cout &lt;&lt; &quot;Async RPC successful. Server says: &quot; &lt;&lt; reply.confirmation_message() &lt;&lt; std::endl;        &#125; else &#123;            std::cout &lt;&lt; &quot;Async RPC failed: &quot; &lt;&lt; status.error_code() &lt;&lt; &quot;: &quot; &lt;&lt; status.error_message() &lt;&lt; std::endl;        &#125;    &#125;;    // 2. å‘èµ·å¼‚æ­¥è°ƒç”¨    stub-&gt;async()-&gt;SendMessage(new ClientContext(), &amp;request, new MessageReply(), on_reply);    std::cout &lt;&lt; &quot;Async call initiated. Waiting for reply...&quot; &lt;&lt; std::endl;    // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ éœ€è¦ä¸€ä¸ªæœºåˆ¶æ¥ç­‰å¾…å›è°ƒå®Œæˆï¼Œä¾‹å¦‚æ¡ä»¶å˜é‡æˆ–åœ¨äº‹ä»¶å¾ªç¯ä¸­è¿è¡Œã€‚    std::this_thread::sleep_for(std::chrono::seconds(1));&#125;\n\n2. æ‹¦æˆªå™¨ (Interceptor)\næ³¨æ„: è¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§ APIï¼Œæœªæ¥å¯èƒ½ä¼šæœ‰å˜åŠ¨ã€‚\n\næ‹¦æˆªå™¨å…è®¸ä½ åœ¨ RPC è°ƒç”¨çš„ç”Ÿå‘½å‘¨æœŸä¸­æ³¨å…¥è‡ªå®šä¹‰é€»è¾‘ï¼ˆå¦‚æ—¥å¿—ã€è®¤è¯ã€ç›‘æ§ï¼‰ã€‚\n#include &lt;grpcpp/experimental/server_interceptor.h&gt;class LoggingInterceptor : public grpc::experimental::Interceptor &#123;public:    void Intercept(grpc::experimental::InterceptorBatchMethods* methods) override &#123;        if (methods-&gt;QueryInterceptionHookPoint(            grpc::experimental::InterceptionHookPoints::PRE_SEND_INITIAL_METADATA)) &#123;            std::cout &lt;&lt; &quot;LOG: Server processing new request.&quot; &lt;&lt; std::endl;        &#125;        // å¿…é¡»è°ƒç”¨ Proceed() æ¥å°†æ§åˆ¶æƒäº¤è¿˜ç»™ gRPC æ¡†æ¶        methods-&gt;Proceed();    &#125;&#125;;// åœ¨ ServerBuilder ä¸­ä½¿ç”¨// std::vector&lt;std::unique_ptr&lt;grpc::experimental::ServerInterceptorFactoryInterface&gt;&gt; creators;// creators.push_back(std::make_unique&lt;YourInterceptorFactory&gt;());// builder.experimental().SetInterceptorCreators(std::move(creators));\n\nå¸¸è§é—®é¢˜Q1: protoc: command not found?A: protoc ä¸åœ¨ä½ çš„ PATH ä¸­ã€‚\n\nå¦‚æœä½¿ç”¨ apt å®‰è£…ï¼Œè¯·ç¡®ä¿ protobuf-compiler å·²å®‰è£…ã€‚\nå¦‚æœä»æºç ç¼–è¯‘ï¼Œè¯·ç¡®ä¿å®‰è£…è·¯å¾„çš„ bin ç›®å½•ï¼ˆå¦‚ /usr/local/grpc/binï¼‰å·²æ·»åŠ åˆ° PATHã€‚\n\nQ2: protoc-gen-grpc: program not found or is not executable?A: protoc æ‰¾ä¸åˆ° gRPC C++ æ’ä»¶ã€‚\n\nç¡®ä¿ grpc_cpp_plugin å­˜åœ¨äº PATH ä¸­ï¼Œæˆ–è€…åœ¨ --plugin å‚æ•°ä¸­æä¾›å…¶å®Œæ•´è·¯å¾„ã€‚\næ£€æŸ¥æ–‡ä»¶æ˜¯å¦æœ‰æ‰§è¡Œæƒé™ (chmod +x &lt;path_to_plugin&gt;)ã€‚\n\nQ3: ç¼–è¯‘ç”Ÿæˆçš„ä»£ç æ—¶ï¼Œæç¤ºæ‰¾ä¸åˆ° gRPC æˆ– Protobuf å¤´æ–‡ä»¶?A: ä½ çš„ç¼–è¯‘å™¨æ‰¾ä¸åˆ°æ‰€éœ€çš„å¤´æ–‡ä»¶ã€‚\n\npkg-config (æ¨è): ç¡®ä¿ä½ çš„ç¼–è¯‘å‘½ä»¤åŒ…å«äº† $(pkg-config --cflags grpc++ protobuf)ã€‚\nCMake: æ£€æŸ¥ find_package(gRPC) å’Œ find_package(Protobuf) æ˜¯å¦æˆåŠŸã€‚å¦‚æœ gRPC å®‰è£…åœ¨éæ ‡å‡†è·¯å¾„ï¼Œä½ å¯èƒ½éœ€è¦è®¾ç½® CMAKE_PREFIX_PATHã€‚\næ‰‹åŠ¨ç¼–è¯‘: ä½¿ç”¨ -I/path/to/includes æ‰‹åŠ¨æ·»åŠ æ­£ç¡®çš„åŒ…å«è·¯å¾„ã€‚\n\nQ4: é“¾æ¥æ—¶å‡ºç° undefined reference to é”™è¯¯?A: é“¾æ¥å™¨æ‰¾ä¸åˆ° gRPC æˆ– Protobuf çš„åº“æ–‡ä»¶ã€‚\n\npkg-config (æ¨è): ç¡®ä¿ä½ çš„é“¾æ¥å‘½ä»¤åŒ…å«äº† $(pkg-config --libs grpc++ protobuf)ã€‚\nCMake: ç¡®ä¿ target_link_libraries æŒ‡ä»¤æ­£ç¡®é“¾æ¥äº† gRPC::grpc++ å’Œ protobuf::libprotobufã€‚\næ‰‹åŠ¨ç¼–è¯‘: ä½¿ç”¨ -L/path/to/libs -lgrpc++ -lprotobuf æ‰‹åŠ¨æ·»åŠ åº“è·¯å¾„å’Œåº“ã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","ç½‘ç»œç¼–ç¨‹ä¸RPC"],"tags":["C++","gRPC","RPC","Protobuf","ç½‘ç»œç¼–ç¨‹","protoc"]},{"title":"Boost b2 å‚æ•°å‚è€ƒ","url":"/posts/18f0987e/","content":"Boost b2 å‚æ•°å‚è€ƒç›®å½•\næ¦‚è¿°\næ ¸å¿ƒå‚æ•°\nåº“é€‰æ‹©å‚æ•°\næ„å»ºå±æ€§å‚æ•°\nè·¯å¾„ä¸è¾“å‡ºå‚æ•°\nå¹³å°ä¸æ¶æ„å‚æ•°\nå®ç”¨ç¼–è¯‘ç¤ºä¾‹\nè„šæœ¬ä¸æœ€ä½³å®è·µ\n\næ¦‚è¿°b2ï¼ˆå…¶å‰èº«ä¸º bjamï¼‰æ˜¯ Boost C++ åº“çš„å®˜æ–¹æ„å»ºå¼•æ“ã€‚å®ƒæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå…è®¸å¼€å‘è€…é€šè¿‡ä¸°å¯Œçš„å‚æ•°ç²¾ç¡®æ§åˆ¶ç¼–è¯‘è¿‡ç¨‹ã€‚\nåŸºæœ¬è¯­æ³•# Boost b2 å‚æ•°å‚è€ƒ./b2 [options] [properties] [target]\n\nè·å–å¸®åŠ©# Boost b2 å‚æ•°å‚è€ƒ./b2 --help# Boost b2 å‚æ•°å‚è€ƒ./b2 --show-libraries\n\næ ¸å¿ƒå‚æ•°è¿™äº›å‚æ•°æ§åˆ¶æ„å»ºçš„åŸºæœ¬è¡Œä¸ºã€‚\n\nstage: åªç¼–è¯‘åº“æ–‡ä»¶ï¼ˆä¾‹å¦‚ .a, .so, .lib, .dllï¼‰ï¼Œå¹¶å°†å®ƒä»¬æ”¾ç½®åœ¨ stagedir æŒ‡å®šçš„ç›®å½•ï¼ˆé»˜è®¤ä¸º stage/libï¼‰ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„ç›®æ ‡ã€‚\ninstall: é™¤äº†ç¼–è¯‘åº“æ–‡ä»¶ï¼Œè¿˜ä¼šå°† Boost çš„å¤´æ–‡ä»¶å¤åˆ¶åˆ° prefix æŒ‡å®šçš„ç›®å½•ã€‚\n-j&lt;N&gt;: è®¾ç½®å¹¶è¡Œç¼–è¯‘çš„ä»»åŠ¡æ•°ï¼Œ&lt;N&gt; é€šå¸¸è®¾ä¸º CPU çš„æ ¸å¿ƒæ•°ä»¥æœ€å¤§åŒ–ç¼–è¯‘é€Ÿåº¦ã€‚ä¾‹å¦‚ -j8 æˆ– -j$(nproc)ã€‚\n--clean: æ¸…é™¤ä¸Šæ¬¡çš„æ„å»ºäº§ç‰©ã€‚\n\nåº“é€‰æ‹©å‚æ•°\n--with-&lt;library&gt;: ç™½åå•æ¨¡å¼ã€‚ä»…ç¼–è¯‘æŒ‡å®šçš„åº“ã€‚å¯ä»¥å¤šæ¬¡ä½¿ç”¨ã€‚\n--without-&lt;library&gt;: é»‘åå•æ¨¡å¼ã€‚ç¼–è¯‘æ‰€æœ‰åº“ï¼Œé™¤äº†æŒ‡å®šçš„è¿™äº›ã€‚\n\n# Boost b2 å‚æ•°å‚è€ƒ./b2 --with-thread --with-filesystem# Boost b2 å‚æ•°å‚è€ƒ./b2 --without-python --without-wave\n\næ„å»ºå±æ€§å‚æ•°è¿™äº›å±æ€§é€šè¿‡ property=value çš„å½¢å¼æŒ‡å®šï¼Œå¯ä»¥ç»„åˆä½¿ç”¨ã€‚\ntoolset=&lt;compiler&gt;æŒ‡å®šä½¿ç”¨çš„ç¼–è¯‘å™¨ã€‚\n\ngcc: GNU C++ Compiler\nclang: Clang C++ Compiler\nmsvc-14.3: Visual Studio 2022\nmsvc-14.2: Visual Studio 2019\nmsvc-14.1: Visual Studio 2017\n\nvariant=debug|releaseæ„å»ºå˜ä½“ã€‚\n\ndebug: åŒ…å«è°ƒè¯•ä¿¡æ¯ï¼Œä¸ä¼˜åŒ–ã€‚\nrelease: å¼€å¯ä¼˜åŒ–ï¼Œä¸å«è°ƒè¯•ä¿¡æ¯ã€‚\n\nlink=static|sharedé“¾æ¥æ–¹å¼ã€‚\n\nstatic: ç”Ÿæˆé™æ€åº“ï¼ˆ.a, .libï¼‰ã€‚\nshared: ç”ŸæˆåŠ¨æ€åº“&#x2F;å…±äº«åº“ï¼ˆ.so, .dllï¼‰ã€‚\n\nruntime-link=static|sharedC&#x2F;C++ è¿è¡Œæ—¶çš„é“¾æ¥æ–¹å¼ã€‚\n\nstatic: é™æ€é“¾æ¥ C&#x2F;C++ è¿è¡Œæ—¶åº“ï¼ˆä¾‹å¦‚ï¼Œåœ¨ Windows ä¸Šä½¿ç”¨ /MT æˆ– /MTdï¼‰ã€‚\nshared: åŠ¨æ€é“¾æ¥ C&#x2F;C++ è¿è¡Œæ—¶åº“ï¼ˆä¾‹å¦‚ï¼Œåœ¨ Windows ä¸Šä½¿ç”¨ /MD æˆ– /MDdï¼‰ã€‚\n\nthreading=single|multiçº¿ç¨‹æ”¯æŒã€‚\n\nsingle: ç¼–è¯‘ä¸ºå•çº¿ç¨‹ç‰ˆæœ¬ï¼ˆä¸æ¨èï¼Œå·²å¾ˆå°‘ä½¿ç”¨ï¼‰ã€‚\nmulti: ç¼–è¯‘ä¸ºå¤šçº¿ç¨‹ç‰ˆæœ¬ï¼ˆç°ä»£åº”ç”¨çš„æ ‡å‡†ï¼‰ã€‚\n\nè·¯å¾„ä¸è¾“å‡ºå‚æ•°\n--stagedir=&lt;path&gt;: ä¸ stage ç›®æ ‡é…åˆä½¿ç”¨ï¼ŒæŒ‡å®šåº“æ–‡ä»¶çš„è¾“å‡ºç›®å½•ã€‚\n--prefix=&lt;path&gt;: ä¸ install ç›®æ ‡é…åˆä½¿ç”¨ï¼ŒæŒ‡å®šå¤´æ–‡ä»¶å’Œåº“æ–‡ä»¶çš„å®‰è£…æ ¹ç›®å½•ã€‚\n--build-dir=&lt;path&gt;: æŒ‡å®šå­˜æ”¾æ‰€æœ‰ä¸­é—´æ–‡ä»¶çš„ç›®å½•ï¼ˆä¾‹å¦‚ bin.v2ï¼‰ã€‚å¯¹äºéš”ç¦»ä¸åŒæ„å»ºç¯å¢ƒçš„äº§ç‰©éå¸¸æœ‰ç”¨ã€‚\n\nå¹³å°ä¸æ¶æ„å‚æ•°address-model=32|64æŒ‡å®šç¼–è¯‘ä¸º 32 ä½è¿˜æ˜¯ 64 ä½åº”ç”¨ã€‚\narchitecture=x86|arm|...æŒ‡å®šç›®æ ‡ CPU æ¶æ„ã€‚é€šå¸¸ b2 ä¼šè‡ªåŠ¨æ£€æµ‹ï¼Œä½†åœ¨äº¤å‰ç¼–è¯‘æ—¶éœ€è¦æ‰‹åŠ¨æŒ‡å®šã€‚\ncxxflags=&quot;...&quot; å’Œ linkflags=&quot;...&quot;ä¼ é€’è‡ªå®šä¹‰æ ‡å¿—ç»™ç¼–è¯‘å™¨æˆ–é“¾æ¥å™¨ã€‚\n./b2 cxxflags=&quot;-std=c++17&quot; linkflags=&quot;-s&quot;\n\nå®ç”¨ç¼–è¯‘ç¤ºä¾‹ç¤ºä¾‹ 1: Linux GCCç¼–è¯‘ç”¨äº GCC çš„ 64 ä½å¤šçº¿ç¨‹ã€åŠ¨æ€é“¾æ¥ã€å‘å¸ƒç‰ˆ thread å’Œ filesystem åº“ã€‚\n./b2 -j8 toolset=gcc address-model=64 threading=multi link=shared variant=release --with-thread --with-filesystem stage\n\nç¤ºä¾‹ 2: Windows VS2022ç¼–è¯‘ç”¨äº Visual Studio 2022 çš„ 32 ä½ã€é™æ€é“¾æ¥ã€è°ƒè¯•ç‰ˆã€ä¸”é™æ€é“¾æ¥è¿è¡Œæ—¶çš„æ‰€æœ‰åº“ï¼ˆé™¤äº† pythonï¼‰ã€‚\n./b2.exe -j8 toolset=msvc-14.3 address-model=32 link=static runtime-link=static variant=debug --without-python stage\n\nç¤ºä¾‹ 3: ä¸ºç‰¹å®šç›®å½•è¾“å‡ºå°†ä¸åŒç‰ˆæœ¬çš„åº“è¾“å‡ºåˆ°ä¸åŒç›®å½•ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚\n# Boost b2 å‚æ•°å‚è€ƒ./b2.exe -j8 toolset=msvc-14.2 address-model=64 link=static variant=release --stagedir=&quot;lib/win-x64-msvc14.2-static-release&quot;# Boost b2 å‚æ•°å‚è€ƒ./b2.exe -j8 toolset=msvc-14.2 address-model=64 link=shared variant=debug --stagedir=&quot;lib/win-x64-msvc14.2-shared-debug&quot;\n\nè„šæœ¬ä¸æœ€ä½³å®è·µ1. ä½¿ç”¨æ„å»ºè„šæœ¬åˆ›å»ºä¸€ä¸ªè„šæœ¬æ¥ç¼–è¯‘æ‰€æœ‰ä½ éœ€è¦çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ç¡®ä¿ä¸€è‡´æ€§ã€‚\nbuild_boost_linux.sh:\n#!/bin/bashset -e # å¦‚æœä»»ä½•å‘½ä»¤å¤±è´¥åˆ™ç«‹å³é€€å‡º# Boost b2 å‚æ•°å‚è€ƒ./b2 -j$(nproc) toolset=gcc address-model=64 link=static variant=release \\    --stagedir=&quot;linux-x64-static-release&quot; \\    --without-python# Boost b2 å‚æ•°å‚è€ƒ./b2 -j$(nproc) toolset=gcc address-model=64 link=shared variant=debug \\    --stagedir=&quot;linux-x64-shared-debug&quot; \\    --without-pythonecho &quot;Boost build complete!&quot;\n\n2. æœ€ä½³å®è·µ\nä½¿ç”¨ -j: æ°¸è¿œä¸è¦å¿˜è®°ä½¿ç”¨ -j å‚æ•°ï¼Œå®ƒèƒ½æå¤§åœ°ç¼©çŸ­ç¼–è¯‘æ—¶é—´ã€‚\néš”ç¦»æ„å»ºç›®å½•: ä½¿ç”¨ --build-dir ä¸ºä¸åŒçš„æ„å»ºç‰ˆæœ¬ï¼ˆå¦‚ debug&#x2F;releaseï¼‰æŒ‡å®šä¸åŒçš„ä¸­é—´ç›®å½•ï¼Œé¿å…å†²çªå’Œä¸å¿…è¦çš„é‡ç¼–ã€‚\nç²¾ç¡®é€‰æ‹©åº“: ä½¿ç”¨ --with-&lt;library&gt; åªç¼–è¯‘ä½ é¡¹ç›®éœ€è¦çš„åº“ï¼Œå¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´å’Œç£ç›˜ç©ºé—´ã€‚\næ¸…ç†: åœ¨åˆ‡æ¢å·®å¼‚å·¨å¤§çš„ç¼–è¯‘é€‰é¡¹ï¼ˆå¦‚ç¼–è¯‘å™¨ç‰ˆæœ¬ï¼‰ä¹‹å‰ï¼Œå¯ä»¥è¿è¡Œ ./b2 --clean æ¥æ¸…ç†æ—§çš„æ„å»ºäº§ç‰©ã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","C++åŸºç¡€ä¸è¿›é˜¶"],"tags":["Boost","b2","bjam","æ„å»ºå·¥å…·","ç¼–è¯‘å‚æ•°"]},{"title":"Redis Windows å®‰è£…æŒ‡å—","url":"/posts/4996968/","content":"Redis Windows å®‰è£…æŒ‡å—ç›®å½•\né‡è¦ï¼šRedis on Windows ç°çŠ¶\næ–¹æ³•ä¸€ï¼šåœ¨ WSL2 ä¸­è¿è¡Œ Redis (å®˜æ–¹æ¨è)\næ–¹æ³•äºŒï¼šä½¿ç”¨æ—§ç‰ˆ Redis for Windows\nå®¢æˆ·ç«¯è¿æ¥\nå¸¸è§é—®é¢˜\n\né‡è¦ï¼šRedis on Windows ç°çŠ¶Redis å®˜æ–¹å¹¶æœªæ­£å¼æ”¯æŒå’Œç»´æŠ¤åŸç”Ÿçš„ Windows ç‰ˆæœ¬ã€‚\n\nå®˜æ–¹æ¨èæ–¹æ¡ˆ: åœ¨ Windows 10&#x2F;11 ä¸Šï¼Œå®˜æ–¹æ¨èä½¿ç”¨ WSL2 (Windows Subsystem for Linux) æ¥å®‰è£…å’Œè¿è¡ŒåŸç”Ÿçš„ã€æœ€æ–°çš„ Linux ç‰ˆ Redisã€‚è¿™èƒ½æä¾›æœ€ä½³çš„æ€§èƒ½å’Œå…¼å®¹æ€§ã€‚\næ—§çš„ Windows ç‰ˆæœ¬: æ›¾æœ‰ä¸€ä¸ªç”±å¾®è½¯ç»´æŠ¤çš„ Windows ç§»æ¤ç‰ˆ Redis (MicrosoftArchive/redis)ï¼Œä½†è¯¥é¡¹ç›®å·²äºå¤šå¹´å‰åœæ­¢æ›´æ–°ï¼Œå…¶æœ€æ–°ç‰ˆæœ¬ä»…ä¸º 3.xï¼Œä¸ç°ä»£ Redis (6.x, 7.x) ç›¸æ¯”åŠŸèƒ½é™ˆæ—§ä¸”å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚\n\næœ¬æŒ‡å—å°†ä¼˜å…ˆä»‹ç» WSL2 çš„æ–¹æ³•ï¼Œå¹¶å°†æ—§çš„åŸç”Ÿ Windows ç‰ˆæœ¬å®‰è£…ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆã€‚\næ–¹æ³•ä¸€ï¼šåœ¨ WSL2 ä¸­è¿è¡Œ Redis (å®˜æ–¹æ¨è)1. å®‰è£… WSL2 å’Œä¸€ä¸ª Linux å‘è¡Œç‰ˆå¦‚æœä½ çš„ç³»ç»Ÿå°šæœªå®‰è£… WSL2ï¼Œè¯·å‚ç…§å¾®è½¯å®˜æ–¹æ–‡æ¡£è¿›è¡Œå®‰è£…ã€‚æ¨èå®‰è£… Ubuntuã€‚å¾®è½¯å®˜æ–¹ WSL å®‰è£…æŒ‡å—\n2. åœ¨ Ubuntu (WSL) ä¸­å®‰è£… Redisæ‰“å¼€ä½ çš„ Ubuntu ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š\n# Redis Windows å®‰è£…æŒ‡å—sudo apt update# Redis Windows å®‰è£…æŒ‡å—sudo apt install redis-server\n\n3. é…ç½®å’Œç®¡ç† Redis æœåŠ¡# Redis Windows å®‰è£…æŒ‡å—sudo service redis-server start# Redis Windows å®‰è£…æŒ‡å—sudo service redis-server status# Redis Windows å®‰è£…æŒ‡å—redis-cli ping  # åº”è¯¥è¿”å› PONG# Redis Windows å®‰è£…æŒ‡å—# Redis Windows å®‰è£…æŒ‡å—sudo nano /etc/redis/redis.conf# Redis Windows å®‰è£…æŒ‡å—# Redis Windows å®‰è£…æŒ‡å—sudo service redis-server restart\nåœ¨ WSL2 ä¸­è¿è¡Œçš„ Redisï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡ localhost ä»ä½ çš„ Windows ä¸»æœºè®¿é—®å®ƒã€‚\næ–¹æ³•äºŒï¼šä½¿ç”¨æ—§ç‰ˆ Redis for Windowsè­¦å‘Š: æ­¤æ–¹æ³•å®‰è£…çš„æ˜¯ä¸€ä¸ªè¿‡æ—¶çš„ Redis 3.x ç‰ˆæœ¬ï¼Œä¸æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒã€‚\n1. ä¸‹è½½ä» MicrosoftArchive/redis çš„ GitHub Releases é¡µé¢ä¸‹è½½æœ€æ–°çš„ .msi æˆ– .zip æ–‡ä»¶ã€‚\n\nä¸‹è½½åœ°å€: https://github.com/microsoftarchive/redis/releases\n\n2. å®‰è£…ä¸é…ç½®\nè§£å‹: å°† ZIP æ–‡ä»¶è§£å‹åˆ°ä¸€ä¸ªç¨³å®šè·¯å¾„ï¼Œä¾‹å¦‚ C:\\redisã€‚\né‡å‘½åé…ç½®æ–‡ä»¶: å°† redis.windows.conf å¤åˆ¶ä¸€ä»½ï¼Œå¹¶é‡å‘½åä¸º redis.confã€‚\nç¼–è¾‘ redis.conf:# è®¾ç½®å¯†ç requirepass your_strong_password# (å¯é€‰) ä¿®æ”¹ç«¯å£# port 6379\n\n3. æ³¨å†Œä¸º Windows æœåŠ¡ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€å‘½ä»¤æç¤ºç¬¦ (CMD)ï¼Œå¹¶è¿›å…¥ä½ çš„ Redis ç›®å½•ã€‚\ncd C:\\redis# Redis Windows å®‰è£…æŒ‡å—redis-server.exe --service-install redis.conf --service-name Redis# Redis Windows å®‰è£…æŒ‡å—redis-server.exe --service-start --service-name Redis\n\n4. ç®¡ç†æœåŠ¡# Redis Windows å®‰è£…æŒ‡å—redis-server.exe --service-stop --service-name Redis# Redis Windows å®‰è£…æŒ‡å—redis-server.exe --service-uninstall --service-name Redis# Redis Windows å®‰è£…æŒ‡å—\n\nå®¢æˆ·ç«¯è¿æ¥æ— è®ºä½ ä½¿ç”¨å“ªç§æ–¹æ³•å®‰è£…ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ redis-cli æˆ–å›¾å½¢åŒ–å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥ã€‚\nä½¿ç”¨ redis-cli# Redis Windows å®‰è£…æŒ‡å—redis-cli -h localhost -p 6379# Redis Windows å®‰è£…æŒ‡å—redis-cli -h localhost -p 6379 -a your_strong_password\n\nå›¾å½¢åŒ–å®¢æˆ·ç«¯æ¨èä½¿ç”¨ Another Redis Desktop Manager æˆ– TablePlus ç­‰ç°ä»£ Redis å®¢æˆ·ç«¯ã€‚åœ¨è¿æ¥æ—¶ï¼Œä¸»æœºåœ°å€å¡«å†™ localhostï¼Œå¹¶å¡«å…¥å¯¹åº”çš„ç«¯å£å’Œå¯†ç å³å¯ã€‚\nå¸¸è§é—®é¢˜Q: ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨ Windows ä¸Šç¼–è¯‘æœ€æ–°çš„ Redis æºç ?A: Redis æºç ä¸¥é‡ä¾èµ– Linux çš„å†…æ ¸ç‰¹æ€§ï¼ˆå¦‚ fork()ï¼‰ï¼Œä½¿å…¶å¾ˆéš¾è¢«ç›´æ¥ã€ç¨³å®šåœ°ç§»æ¤åˆ° Windowsã€‚å®˜æ–¹å·²æ”¾å¼ƒè¿™æ¡è·¯çº¿ï¼Œå…¨é¢æ‹¥æŠ± WSL2ã€‚\nQ: WSL2 ä¸­çš„ Redis å¦‚ä½•ä¸æˆ‘çš„ Windows åº”ç”¨é€šä¿¡?A: WSL2 ä¸ Windows ä¸»æœºå…±äº«ç½‘ç»œã€‚ä½ çš„ Windows åº”ç”¨å¯ä»¥ç›´æ¥é€šè¿‡ localhost æˆ– 127.0.0.1 è¿æ¥åˆ°åœ¨ WSL2 ä¸­è¿è¡Œçš„ Redis æœåŠ¡ï¼Œå°±åƒå®ƒåœ¨æœ¬åœ°è¿è¡Œä¸€æ ·ã€‚\nQ: æ—§ç‰ˆ Redis for Windows æœ‰ä»€ä¹ˆé£é™©?A: ä¸»è¦é£é™©æ˜¯å®ƒä¸å†æ¥æ”¶å®‰å…¨æ›´æ–°ï¼Œå¯èƒ½å­˜åœ¨å·²çŸ¥çš„å®‰å…¨æ¼æ´ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿç¼ºå°‘è®¸å¤šç°ä»£ Redis çš„æ–°åŠŸèƒ½å’Œæ€§èƒ½æ”¹è¿›ã€‚\n","categories":["åç«¯æœåŠ¡æ¶æ„","æ•°æ®åº“ä¸ç¼“å­˜"],"tags":["Windows","æœåŠ¡é…ç½®","Redis","ç¼“å­˜","WSL2"]},{"title":"gRPC Linux ç¼–è¯‘æŒ‡å—","url":"/posts/2a876257/","content":"gRPC Linux ç¼–è¯‘æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¯å¢ƒå‡†å¤‡\nè·å–æºç \nç¼–è¯‘ä¸å®‰è£…\né…ç½®ç¯å¢ƒ\néªŒè¯å®‰è£…\nå¸¸è§é—®é¢˜\n\næ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Linux ç³»ç»Ÿï¼ˆä»¥ Ubuntu&#x2F;Debian ä¸ºä¾‹ï¼‰ä¸‹ï¼Œé€šè¿‡ CMake ä»æºç ç¼–è¯‘å’Œå®‰è£… gRPC åŠå…¶æ ¸å¿ƒä¾èµ– Protobufã€‚\næ­¤æ–¹æ³•éµå¾ª gRPC å®˜æ–¹æ¨èçš„æµç¨‹ï¼Œé€šè¿‡ Git å­æ¨¡å—æ¥æ„å»ºå…¶ä¾èµ–ï¼Œç¡®ä¿ç‰ˆæœ¬å…¼å®¹æ€§ï¼Œè¿‡ç¨‹æœ€ç®€å•ã€æœ€å¯é ã€‚\nç³»ç»Ÿè¦æ±‚\næ“ä½œç³»ç»Ÿ: Ubuntu 20.04+ &#x2F; Debian 10+\nç¼–è¯‘å™¨: GCC 9+ æˆ– Clang 9+\nCMake: 3.13+\nå†…å­˜: å»ºè®® 8GB+\nç£ç›˜ç©ºé—´: å»ºè®® 15GB+ å¯ç”¨ç©ºé—´\n\nç¯å¢ƒå‡†å¤‡# gRPC Linux ç¼–è¯‘æŒ‡å—sudo apt update# gRPC Linux ç¼–è¯‘æŒ‡å—sudo apt install -y \\    build-essential \\    autoconf \\    libtool \\    pkg-config \\    cmake \\    git \\    zlib1g-dev\n\nè·å–æºç \næç¤º: æœ¬æ–‡ä»¥ gRPC v1.64.0 ä¸ºä¾‹ã€‚ä½ å¯ä»¥ä» gRPC çš„ GitHub Releases é¡µé¢é€‰æ‹©ä¸€ä¸ªä½ éœ€è¦çš„ç¨³å®šç‰ˆæœ¬æ ‡ç­¾ã€‚\n\n# gRPC Linux ç¼–è¯‘æŒ‡å—mkdir -p ~/dev/grpc-build &amp;&amp; cd ~/dev/grpc-build# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—git clone --recurse-submodules --depth 1 --shallow-submodules -b v1.64.0 https://github.com/grpc/grpc.git# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—\nå›½å†…ç”¨æˆ·å¦‚æœè®¿é—® GitHub é€Ÿåº¦æ…¢ï¼Œå¯ä»¥æœç´¢ gRPC çš„ Gitee é•œåƒï¼Œå¹¶ç›¸åº”åœ°ä¿®æ”¹ .gitmodules æ–‡ä»¶ä¸­çš„å­æ¨¡å— URLã€‚\nç¼–è¯‘ä¸å®‰è£…æ•´ä¸ªç¼–è¯‘è¿‡ç¨‹åœ¨ gRPC æºç ç›®å½•å†…å®Œæˆã€‚\n# gRPC Linux ç¼–è¯‘æŒ‡å—cd grpc# gRPC Linux ç¼–è¯‘æŒ‡å—mkdir -p cmake/buildcd cmake/build# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—cmake -DCMAKE_BUILD_TYPE=Release \\      -DgRPC_INSTALL=ON \\      -DCMAKE_INSTALL_PREFIX=/usr/local/grpc \\      ../..# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—make -j$(nproc)# gRPC Linux ç¼–è¯‘æŒ‡å—sudo make install\n\né…ç½®ç¯å¢ƒ1. é…ç½®åŠ¨æ€é“¾æ¥å™¨ä¸ºäº†è®©ç³»ç»Ÿèƒ½åœ¨è¿è¡Œæ—¶æ‰¾åˆ°åˆšåˆšå®‰è£…çš„ gRPC å’Œ Protobuf åº“æ–‡ä»¶ã€‚\n# gRPC Linux ç¼–è¯‘æŒ‡å—sudo tee /etc/ld.so.conf.d/grpc.conf &gt; /dev/null &lt;&lt;EOF/usr/local/grpc/libEOF# gRPC Linux ç¼–è¯‘æŒ‡å—sudo ldconfig# gRPC Linux ç¼–è¯‘æŒ‡å—ldconfig -p | grep grpcldconfig -p | grep protobuf\n\n2. é…ç½® PATH ç¯å¢ƒå˜é‡ä¸ºäº†èƒ½ç›´æ¥ä½¿ç”¨ protoc å’Œ grpc_cpp_plugin ç­‰å‘½ä»¤è¡Œå·¥å…·ã€‚\n# gRPC Linux ç¼–è¯‘æŒ‡å—echo &#x27;export PATH=&quot;/usr/local/grpc/bin:$PATH&quot;&#x27; &gt;&gt; ~/.bashrc# gRPC Linux ç¼–è¯‘æŒ‡å—source ~/.bashrc\n\néªŒè¯å®‰è£…# gRPC Linux ç¼–è¯‘æŒ‡å—protoc --version# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—which grpc_cpp_plugin# gRPC Linux ç¼–è¯‘æŒ‡å—# gRPC Linux ç¼–è¯‘æŒ‡å—cd ~/dev/grpc-build/grpc/examples/cpp/helloworldmkdir -p cmake/build &amp;&amp; cd cmake/build# gRPC Linux ç¼–è¯‘æŒ‡å—cmake -DCMAKE_PREFIX_PATH=/usr/local/grpc ../..make -j$(nproc)# gRPC Linux ç¼–è¯‘æŒ‡å—./greeter_server &amp;# gRPC Linux ç¼–è¯‘æŒ‡å—./greeter_client# gRPC Linux ç¼–è¯‘æŒ‡å—\nå¦‚æœå®¢æˆ·ç«¯æˆåŠŸè¾“å‡ºäº† â€œHello worldâ€ï¼Œåˆ™è¯´æ˜ä½ çš„ gRPC ç¯å¢ƒå·²æˆåŠŸç¼–è¯‘å¹¶å¯ä»¥æ­£å¸¸å·¥ä½œã€‚\nå¸¸è§é—®é¢˜Q1: Git å…‹éš†æˆ–å­æ¨¡å—æ›´æ–°éå¸¸æ…¢æˆ–å¤±è´¥?A: è¿™æ˜¯å›½å†…å¸¸è§çš„ç½‘ç»œé—®é¢˜ã€‚ä½ å¯ä»¥å°è¯•ä¸º Git é…ç½®ä»£ç†ï¼Œæˆ–è€…æŸ¥æ‰¾å¹¶ä½¿ç”¨ Gitee ä¸Šçš„é•œåƒã€‚å¦‚æœä½¿ç”¨é•œåƒï¼Œä½ å¯èƒ½éœ€è¦æ‰‹åŠ¨ä¿®æ”¹ .gitmodules æ–‡ä»¶ä¸­å„ä¸ªå­æ¨¡å—çš„ urlï¼Œç„¶åå†æ¬¡è¿è¡Œ git submodule sync å’Œ git submodule update --initã€‚\nQ2: ç¼–è¯‘è¿‡ç¨‹ä¸­æç¤ºå†…å­˜ä¸è¶³ (Killed) ?A: gRPC ç¼–è¯‘éœ€è¦å¤§é‡å†…å­˜ã€‚å¦‚æœä½ çš„æœºå™¨å†…å­˜å°äº 8GBï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚\n\nå‡å°‘å¹¶è¡Œä»»åŠ¡æ•°: å°è¯• make -j2 æˆ– make -j1ã€‚\nå¢åŠ äº¤æ¢ç©ºé—´ (Swap):sudo fallocate -l 4G /swapfilesudo chmod 600 /swapfilesudo mkswap /swapfilesudo swapon /swapfile# ç¼–è¯‘å®Œæˆåå¯ä»¥ç¦ç”¨å¹¶åˆ é™¤# sudo swapoff /swapfile &amp;&amp; sudo rm /swapfile\n\nQ3: sudo make install åï¼Œprotoc --version ä»ç„¶æ˜¾ç¤ºæ—§ç‰ˆæœ¬?A: è¿™é€šå¸¸æ˜¯å› ä¸ºä½ çš„ PATH ç¯å¢ƒå˜é‡ä¸­ï¼Œç³»ç»Ÿè‡ªå¸¦çš„æ—§ç‰ˆæœ¬ protoc (å¦‚ /usr/bin/protoc) ä½äºä½ æ–°å®‰è£…çš„ /usr/local/grpc/bin ä¹‹å‰ã€‚\n\nè¿è¡Œ which protoc ç¡®è®¤ä½ æ­£åœ¨ä½¿ç”¨çš„æ˜¯å“ªä¸ª protocã€‚\nç¡®ä¿ /usr/local/grpc/bin åœ¨ PATH çš„æœ€å‰é¢ã€‚\næˆ–è€…ï¼Œå¸è½½ç³»ç»Ÿè‡ªå¸¦çš„ protobuf-compiler (sudo apt remove protobuf-compiler)\n\n\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","ç½‘ç»œç¼–ç¨‹ä¸RPC"],"tags":["C++","Linux","gRPC","Protobuf","ç¼–è¯‘","æºç ç¼–è¯‘"]},{"title":"Redis Hiredis Linux å®‰è£…æŒ‡å—","url":"/posts/f0a1549f/","content":"Redis Hiredis Linux å®‰è£…æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šå®‰è£…å’Œé…ç½® Redis æœåŠ¡\nç¬¬äºŒæ­¥ï¼šå®‰è£… hiredis å®¢æˆ·ç«¯åº“\nç¬¬ä¸‰æ­¥ï¼šæ­å»º C++ é¡¹ç›® (CMake)\nç¬¬å››æ­¥ï¼šç¼–å†™ RedisClient å°è£…ç±»\nç¬¬äº”æ­¥ï¼šç¼–å†™ä¸»ç¨‹åºå¹¶æµ‹è¯•\nå¸¸è§é—®é¢˜\næœ€ä½³å®è·µ\n\næ¦‚è¿°æœ¬æŒ‡å—å°†ä»‹ç»å¦‚ä½•åœ¨ Linux (Ubuntu&#x2F;Debian) ç¯å¢ƒä¸‹ï¼Œä¸º C++ é¡¹ç›®é…ç½® Redis å¼€å‘ç¯å¢ƒã€‚æˆ‘ä»¬å°†ä½¿ç”¨ hiredis è¿™ä¸ªå®˜æ–¹æ¨èçš„ã€è½»é‡çº§çš„ C è¯­è¨€å®¢æˆ·ç«¯åº“ã€‚\nç¬¬ä¸€æ­¥ï¼šå®‰è£…å’Œé…ç½® Redis æœåŠ¡1. å®‰è£… Redis æœåŠ¡å™¨# Redis Hiredis Linux å®‰è£…æŒ‡å—sudo apt updatesudo apt install -y redis-server\n\n2. é…ç½® Redisä¸ºäº†å®‰å…¨å’Œè¿œç¨‹è®¿é—®ï¼Œå»ºè®®ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚\n# Redis Hiredis Linux å®‰è£…æŒ‡å—sudo nano /etc/redis/redis.conf\næ‰¾åˆ°å¹¶ä¿®æ”¹ä»¥ä¸‹å‡ è¡Œï¼š\n# Redis Hiredis Linux å®‰è£…æŒ‡å—bind 0.0.0.0# Redis Hiredis Linux å®‰è£…æŒ‡å—requirepass your_strong_password# Redis Hiredis Linux å®‰è£…æŒ‡å—protected-mode no\n\n3. ç®¡ç† Redis æœåŠ¡# Redis Hiredis Linux å®‰è£…æŒ‡å—sudo systemctl restart redis-server# Redis Hiredis Linux å®‰è£…æŒ‡å—sudo systemctl status redis-server# Redis Hiredis Linux å®‰è£…æŒ‡å—sudo systemctl enable redis-server\n\nç¬¬äºŒæ­¥ï¼šå®‰è£… hiredis å®¢æˆ·ç«¯åº“hiredis æ˜¯ä¸ Redis ä¸€åŒå¼€å‘çš„å®˜æ–¹ C å®¢æˆ·ç«¯åº“ã€‚\n# Redis Hiredis Linux å®‰è£…æŒ‡å—sudo apt install -y libhiredis-dev\nè¿™ä¼šè‡ªåŠ¨å°†å¤´æ–‡ä»¶å’Œåº“æ–‡ä»¶å®‰è£…åˆ°ç³»ç»Ÿæ ‡å‡†è·¯å¾„ä¸­ã€‚\nç¬¬ä¸‰æ­¥ï¼šæ­å»º C++ é¡¹ç›® (CMake)1. åˆ›å»ºé¡¹ç›®ç»“æ„mkdir redis_cpp_demo &amp;&amp; cd redis_cpp_demomkdir src includetouch CMakeLists.txt src/main.cpp src/redis_client.cpp include/redis_client.h\n\n2. ç¼–å†™ CMakeLists.txtä½¿ç”¨ pkg-config æ¥æŸ¥æ‰¾ hiredis æ˜¯æœ€ç®€å•å’Œæœ€å¯ç§»æ¤çš„æ–¹å¼ã€‚\ncmake_minimum_required(VERSION 3.10)project(RedisCppDemo)set(CMAKE_CXX_STANDARD 17)set(CMAKE_CXX_STANDARD_REQUIRED ON)# Redis Hiredis Linux å®‰è£…æŒ‡å—find_package(PkgConfig REQUIRED)pkg_check_modules(HIREDIS REQUIRED hiredis)# Redis Hiredis Linux å®‰è£…æŒ‡å—include_directories($&#123;HIREDIS_INCLUDE_DIRS&#125;)# Redis Hiredis Linux å®‰è£…æŒ‡å—add_executable(redis_demo src/main.cpp src/redis_client.cpp)# Redis Hiredis Linux å®‰è£…æŒ‡å—target_link_libraries(redis_demo PRIVATE $&#123;HIREDIS_LIBRARIES&#125;)\n\nç¬¬å››æ­¥ï¼šç¼–å†™ RedisClient å°è£…ç±»åˆ›å»ºä¸€ä¸ª C++ ç±»æ¥å°è£… hiredis çš„ C é£æ ¼ APIï¼Œä½¿å…¶æ›´æ˜“äºä½¿ç”¨ã€‚\ninclude/redis_client.h:\n#ifndef REDIS_CLIENT_H#define REDIS_CLIENT_H#include &lt;string&gt;#include &lt;vector&gt;#include &lt;hiredis/hiredis.h&gt;class RedisClient &#123;public:    RedisClient(const std::string&amp; host = &quot;127.0.0.1&quot;, int port = 6379, const std::string&amp; password = &quot;&quot;);    ~RedisClient();    bool connect();    void disconnect();    bool isConnected() const;    std::string getLastError() const;    // String commands    bool set(const std::string&amp; key, const std::string&amp; value);    std::string get(const std::string&amp; key);    // Hash commands    bool hset(const std::string&amp; key, const std::string&amp; field, const std::string&amp; value);    std::string hget(const std::string&amp; key, const std::string&amp; field);    // Key commands    bool del(const std::string&amp; key);    bool exists(const std::string&amp; key);private:    redisContext* m_context;    std::string m_host;    int m_port;    std::string m_password;    bool authenticate();&#125;;#endif // REDIS_CLIENT_H\n\nsrc/redis_client.cpp:\n#include &quot;redis_client.h&quot;#include &lt;iostream&gt;#include &lt;cstring&gt; // For strcmpRedisClient::RedisClient(const std::string&amp; host, int port, const std::string&amp; password)    : m_context(nullptr), m_host(host), m_port(port), m_password(password) &#123;&#125;RedisClient::~RedisClient() &#123;    disconnect();&#125;bool RedisClient::connect() &#123;    struct timeval timeout = &#123;2, 0&#125;; // 2 seconds    m_context = redisConnectWithTimeout(m_host.c_str(), m_port, timeout);    if (m_context == nullptr || m_context-&gt;err) &#123;        return false;    &#125;    if (!m_password.empty() &amp;&amp; !authenticate()) &#123;        disconnect();        return false;    &#125;    return true;&#125;void RedisClient::disconnect() &#123;    if (m_context) &#123;        redisFree(m_context);        m_context = nullptr;    &#125;&#125;bool RedisClient::isConnected() const &#123;    return m_context != nullptr &amp;&amp; m_context-&gt;err == 0;&#125;std::string RedisClient::getLastError() const &#123;    return (m_context &amp;&amp; m_context-&gt;errstr) ? m_context-&gt;errstr : &quot;&quot;;&#125;bool RedisClient::authenticate() &#123;    redisReply* reply = static_cast&lt;redisReply*&gt;(redisCommand(m_context, &quot;AUTH %s&quot;, m_password.c_str()));    if (!reply) return false;    bool success = (reply-&gt;type == REDIS_REPLY_STATUS &amp;&amp; strcmp(reply-&gt;str, &quot;OK&quot;) == 0);    freeReplyObject(reply);    return success;&#125;bool RedisClient::set(const std::string&amp; key, const std::string&amp; value) &#123;    if (!isConnected()) return false;    redisReply* reply = static_cast&lt;redisReply*&gt;(redisCommand(m_context, &quot;SET %s %s&quot;, key.c_str(), value.c_str()));    if (!reply) return false;    bool success = (reply-&gt;type == REDIS_REPLY_STATUS &amp;&amp; strcmp(reply-&gt;str, &quot;OK&quot;) == 0);    freeReplyObject(reply);    return success;&#125;std::string RedisClient::get(const std::string&amp; key) &#123;    if (!isConnected()) return &quot;&quot;;    redisReply* reply = static_cast&lt;redisReply*&gt;(redisCommand(m_context, &quot;GET %s&quot;, key.c_str()));    if (!reply || reply-&gt;type != REDIS_REPLY_STRING) &#123;        if (reply) freeReplyObject(reply);        return &quot;&quot;;    &#125;    std::string result = reply-&gt;str;    freeReplyObject(reply);    return result;&#125;bool RedisClient::del(const std::string&amp; key) &#123;    if (!isConnected()) return false;    redisReply* reply = static_cast&lt;redisReply*&gt;(redisCommand(m_context, &quot;DEL %s&quot;, key.c_str()));    if (!reply) return false;    bool success = (reply-&gt;type == REDIS_REPLY_INTEGER &amp;&amp; reply-&gt;integer &gt; 0);    freeReplyObject(reply);    return success;&#125;bool RedisClient::hset(const std::string&amp; key, const std::string&amp; field, const std::string&amp; value) &#123;    if (!isConnected()) return false;    redisReply* reply = static_cast&lt;redisReply*&gt;(redisCommand(m_context, &quot;HSET %s %s %s&quot;, key.c_str(), field.c_str(), value.c_str()));    if (!reply) return false;    bool success = (reply-&gt;type == REDIS_REPLY_INTEGER);    freeReplyObject(reply);    return success;&#125;std::string RedisClient::hget(const std::string&amp; key, const std::string&amp; field) &#123;    if (!isConnected()) return &quot;&quot;;    redisReply* reply = static_cast&lt;redisReply*&gt;(redisCommand(m_context, &quot;HGET %s %s&quot;, key.c_str(), field.c_str()));    if (!reply || reply-&gt;type != REDIS_REPLY_STRING) &#123;        if (reply) freeReplyObject(reply);        return &quot;&quot;;    &#125;    std::string result = reply-&gt;str;    freeReplyObject(reply);    return result;&#125;bool RedisClient::exists(const std::string&amp; key) &#123;    if (!isConnected()) return false;    redisReply* reply = static_cast&lt;redisReply*&gt;(redisCommand(m_context, &quot;EXISTS %s&quot;, key.c_str()));    if (!reply) return false;    bool success = (reply-&gt;type == REDIS_REPLY_INTEGER &amp;&amp; reply-&gt;integer == 1);    freeReplyObject(reply);    return success;&#125;\n\nç¬¬äº”æ­¥ï¼šç¼–å†™ä¸»ç¨‹åºå¹¶æµ‹è¯•src/main.cpp:\n#include &quot;redis_client.h&quot;#include &lt;iostream&gt;int main() &#123;    RedisClient redis(&quot;127.0.0.1&quot;, 6379, &quot;your_strong_password&quot;);    if (!redis.connect()) &#123;        std::cerr &lt;&lt; &quot;Failed to connect to Redis: &quot; &lt;&lt; redis.getLastError() &lt;&lt; std::endl;        return 1;    &#125;    std::cout &lt;&lt; &quot;=== Redis C++ Client Test ===\\n&quot;;    // 1. String operations    std::cout &lt;&lt; &quot;\\n1. Testing string operations...\\n&quot;;    if (redis.set(&quot;test_key&quot;, &quot;Hello from hiredis!&quot;)) &#123;        std::cout &lt;&lt; &quot;SET successful.\\n&quot;;        std::string value = redis.get(&quot;test_key&quot;);        std::cout &lt;&lt; &quot;GET &#x27;test_key&#x27;: &quot; &lt;&lt; value &lt;&lt; std::endl;    &#125;    // 2. Hash operations    std::cout &lt;&lt; &quot;\\n2. Testing hash operations...\\n&quot;;    redis.hset(&quot;user:1001&quot;, &quot;name&quot;, &quot;Alice&quot;);    redis.hset(&quot;user:1001&quot;, &quot;age&quot;, &quot;30&quot;);    std::cout &lt;&lt; &quot;User name: &quot; &lt;&lt; redis.hget(&quot;user:1001&quot;, &quot;name&quot;) &lt;&lt; std::endl;    // 3. Key operations    std::cout &lt;&lt; &quot;\\n3. Cleaning up...\\n&quot;;    if (redis.del(&quot;test_key&quot;)) &#123;        std::cout &lt;&lt; &quot;DEL &#x27;test_key&#x27; successful.\\n&quot;;    &#125;    if (redis.del(&quot;user:1001&quot;)) &#123;        std::cout &lt;&lt; &quot;DEL &#x27;user:1001&#x27; successful.\\n&quot;;    &#125;    return 0;&#125;\n\nå¸¸è§é—®é¢˜Q1: è¿æ¥è¢«æ‹’ç» (Connection refused)?A: ç¡®è®¤ Redis æœåŠ¡æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸” redis.conf ä¸­çš„ bind æŒ‡ä»¤å…è®¸ä½ çš„ IP è®¿é—®ã€‚æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ã€‚\nQ2: è®¤è¯å¤±è´¥ (Authentication failed)?A: ç¡®è®¤ redis.conf ä¸­çš„ requirepass ä¸ä½ å®¢æˆ·ç«¯ä»£ç ä¸­ä½¿ç”¨çš„å¯†ç å®Œå…¨ä¸€è‡´ã€‚\nQ3: ç¼–è¯‘æ—¶æ‰¾ä¸åˆ° hiredis/hiredis.h?A: ç¡®è®¤ libhiredis-dev å·²æ­£ç¡®å®‰è£…ã€‚è¿è¡Œ pkg-config --cflags hiredis æ£€æŸ¥ pkg-config æ˜¯å¦èƒ½æ‰¾åˆ°å¤´æ–‡ä»¶è·¯å¾„ã€‚å¦‚æœä¸èƒ½ï¼Œä½ çš„ pkg-config è·¯å¾„å¯èƒ½ä¸å®Œæ•´ã€‚\næœ€ä½³å®è·µ\nè¿æ¥ç®¡ç†: å¯¹äºéœ€è¦é¢‘ç¹æ“ä½œ Redis çš„é•¿æ—¶è¿è¡Œåº”ç”¨ï¼Œåº”ä½¿ç”¨è¿æ¥æ± æ¥å¤ç”¨ RedisClient å¯¹è±¡ï¼Œé¿å…é¢‘ç¹åœ°å»ºç«‹å’Œæ–­å¼€ TCP è¿æ¥ã€‚\né”™è¯¯å¤„ç†: åœ¨æ¯æ¬¡ Redis å‘½ä»¤æ‰§è¡Œåï¼Œéƒ½åº”æ£€æŸ¥ reply æŒ‡é’ˆæ˜¯å¦ä¸º nullptr ä»¥åŠ m_context-&gt;err æ ‡å¿—ï¼Œä»¥å¤„ç†ç½‘ç»œæ–­å¼€ç­‰é—®é¢˜ã€‚\nå¼‚æ­¥æ“ä½œ: hiredis ä¹Ÿæä¾›äº†å¼‚æ­¥ API (redisAsyncContext)ã€‚å¯¹äºé«˜å¹¶å‘åœºæ™¯ï¼Œåº”ä½¿ç”¨å¼‚æ­¥å®¢æˆ·ç«¯ä»¥é¿å…é˜»å¡ã€‚\né…ç½®å¤–ç½®: ä¸è¦å°† Redis çš„åœ°å€ã€ç«¯å£å’Œå¯†ç ç¡¬ç¼–ç åœ¨ä»£ç ä¸­ã€‚å°†å®ƒä»¬æ”¾åœ¨é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡ä¸­ã€‚\n\n","categories":["åç«¯æœåŠ¡æ¶æ„","æ•°æ®åº“ä¸ç¼“å­˜"],"tags":["C++","å¼€å‘ç¯å¢ƒ","Linux","Redis","hiredis"]},{"title":"Docker éƒ¨ç½²æŒ‡å—","url":"/posts/4beba163/","content":"Docker éƒ¨ç½²æŒ‡å—æ¦‚è¿°Dockerå®¹å™¨åŒ–éƒ¨ç½²æ˜¯ç°ä»£åº”ç”¨éƒ¨ç½²çš„æ ‡å‡†æ–¹å¼ï¼Œæœ¬æ–‡è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨Dockerè¿›è¡Œåº”ç”¨å®¹å™¨åŒ–éƒ¨ç½²ã€‚\nDockeråŸºç¡€æ¦‚å¿µä»€ä¹ˆæ˜¯DockerDockeræ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨åŒ–å¹³å°ï¼Œå¯ä»¥å°†åº”ç”¨å’Œä¾èµ–æ‰“åŒ…æˆè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ã€‚\næ ¸å¿ƒç»„ä»¶\nDocker Engine: å®¹å™¨è¿è¡Œæ—¶\nDocker Compose: å¤šå®¹å™¨åº”ç”¨ç¼–æ’\nDocker Registry: é•œåƒä»“åº“\n\nå®‰è£…DockerUbuntuå®‰è£…# Docker éƒ¨ç½²æŒ‡å—sudo apt-get update# Docker éƒ¨ç½²æŒ‡å—sudo apt-get install apt-transport-https ca-certificates curl gnupg lsb-release# Docker éƒ¨ç½²æŒ‡å—curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg# Docker éƒ¨ç½²æŒ‡å—echo &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null# Docker éƒ¨ç½²æŒ‡å—sudo apt-get updatesudo apt-get install docker-ce docker-ce-cli containerd.io\n\nCentOSå®‰è£…# Docker éƒ¨ç½²æŒ‡å—sudo yum install -y yum-utils# Docker éƒ¨ç½²æŒ‡å—sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo# Docker éƒ¨ç½²æŒ‡å—sudo yum install docker-ce docker-ce-cli containerd.io\n\nDockerfileç¼–å†™åŸºç¡€Dockerfileç¤ºä¾‹# Docker éƒ¨ç½²æŒ‡å—FROM node:16-alpine# Docker éƒ¨ç½²æŒ‡å—WORKDIR /app# Docker éƒ¨ç½²æŒ‡å—COPY package*.json ./# Docker éƒ¨ç½²æŒ‡å—RUN npm install# Docker éƒ¨ç½²æŒ‡å—COPY . .# Docker éƒ¨ç½²æŒ‡å—EXPOSE 3000# Docker éƒ¨ç½²æŒ‡å—CMD [&quot;npm&quot;, &quot;start&quot;]\n\nå¤šé˜¶æ®µæ„å»º# Docker éƒ¨ç½²æŒ‡å—FROM node:16-alpine AS builderWORKDIR /appCOPY package*.json ./RUN npm installCOPY . .RUN npm run build# Docker éƒ¨ç½²æŒ‡å—FROM nginx:alpineCOPY --from=builder /app/dist /usr/share/nginx/htmlEXPOSE 80CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]\n\nDocker ComposeåŸºæœ¬é…ç½®æ–‡ä»¶version: &#x27;3.8&#x27;services:  web:    build: .    ports:      - &quot;3000:3000&quot;    environment:      - NODE_ENV=production    depends_on:      - db  db:    image: postgres:13    environment:      - POSTGRES_DB=myapp      - POSTGRES_USER=user      - POSTGRES_PASSWORD=password    volumes:      - postgres_data:/var/lib/postgresql/data    ports:      - &quot;5432:5432&quot;  redis:    image: redis:6-alpine    ports:      - &quot;6379:6379&quot;volumes:  postgres_data:\n\né«˜çº§é…ç½®version: &#x27;3.8&#x27;services:  app:    build:      context: .      dockerfile: Dockerfile.prod    deploy:      replicas: 3      resources:        limits:          cpus: &#x27;0.5&#x27;          memory: 512M    environment:      - DATABASE_URL=postgresql://user:password@db:5432/myapp    networks:      - app-network  nginx:    image: nginx:alpine    ports:      - &quot;80:80&quot;      - &quot;443:443&quot;    volumes:      - ./nginx.conf:/etc/nginx/nginx.conf      - ./ssl:/etc/nginx/ssl    depends_on:      - app    networks:      - app-networknetworks:  app-network:    driver: bridge\n\néƒ¨ç½²æœ€ä½³å®è·µ1. é•œåƒä¼˜åŒ–\nä½¿ç”¨è½»é‡çº§åŸºç¡€é•œåƒ\nå¤šé˜¶æ®µæ„å»ºå‡å°‘é•œåƒå¤§å°\n.dockerignoreæ–‡ä»¶æ’é™¤ä¸å¿…è¦æ–‡ä»¶\n\n2. å®‰å…¨é…ç½®\nä½¿ç”¨érootç”¨æˆ·è¿è¡Œå®¹å™¨\nå®šæœŸæ›´æ–°åŸºç¡€é•œåƒ\næ‰«æé•œåƒæ¼æ´\n\n3. èµ„æºç®¡ç†\nè®¾ç½®å†…å­˜å’ŒCPUé™åˆ¶\né…ç½®å¥åº·æ£€æŸ¥\nå®ç°ä¼˜é›…å…³é—­\n\nç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ç¯å¢ƒå˜é‡é…ç½®# Docker éƒ¨ç½²æŒ‡å—echo &quot;NODE_ENV=production&quot; &gt; .envecho &quot;DATABASE_URL=postgresql://...&quot; &gt;&gt; .envecho &quot;REDIS_URL=redis://...&quot; &gt;&gt; .env\n\nå¯åŠ¨æœåŠ¡# Docker éƒ¨ç½²æŒ‡å—docker-compose up -d --build# Docker éƒ¨ç½²æŒ‡å—docker-compose ps# Docker éƒ¨ç½²æŒ‡å—docker-compose logs -f app\n\næ›´æ–°éƒ¨ç½²# Docker éƒ¨ç½²æŒ‡å—git pull origin main# Docker éƒ¨ç½²æŒ‡å—docker-compose up -d --build --force-recreate\n\nç›‘æ§å’Œæ—¥å¿—æ—¥å¿—ç®¡ç†# Docker éƒ¨ç½²æŒ‡å—docker-compose logs# Docker éƒ¨ç½²æŒ‡å—docker-compose logs app# Docker éƒ¨ç½²æŒ‡å—docker-compose logs -f --tail=100\n\næ€§èƒ½ç›‘æ§# Docker éƒ¨ç½²æŒ‡å—docker stats# Docker éƒ¨ç½²æŒ‡å—docker inspect &lt;container_id&gt;\n\næ•…éšœæ’æŸ¥å¸¸è§é—®é¢˜è§£å†³\nå®¹å™¨å¯åŠ¨å¤±è´¥\n# æŸ¥çœ‹å®¹å™¨æ—¥å¿—docker logs &lt;container_id&gt;# è¿›å…¥å®¹å™¨è°ƒè¯•docker exec -it &lt;container_id&gt; /bin/sh\n\nç½‘ç»œè¿æ¥é—®é¢˜\n# æ£€æŸ¥ç½‘ç»œé…ç½®docker network lsdocker network inspect &lt;network_name&gt;\n\nèµ„æºä¸è¶³\n# æ¸…ç†æ— ç”¨é•œåƒdocker image prune -a# æ¸…ç†æ— ç”¨å®¹å™¨docker container prune\n\næ€»ç»“Dockerå®¹å™¨åŒ–éƒ¨ç½²æä¾›äº†æ ‡å‡†åŒ–çš„éƒ¨ç½²æ–¹å¼ï¼Œå¤§å¤§ç®€åŒ–äº†åº”ç”¨çš„éƒ¨ç½²å’Œç»´æŠ¤è¿‡ç¨‹ã€‚é€šè¿‡åˆç†é…ç½®Dockerå’ŒDocker Composeï¼Œå¯ä»¥æ„å»ºå‡ºé«˜å¯ç”¨ã€å¯æ‰©å±•çš„å®¹å™¨åŒ–åº”ç”¨æ¶æ„ã€‚\n","categories":["å¼€å‘å·¥å…·ä¸æµç¨‹","æ„å»ºä¸éƒ¨ç½²"],"tags":["Nginx","Linux","Git","Redis","Docker"]},{"title":"Jsoncpp Linux ä½¿ç”¨æŒ‡å—","url":"/posts/7ef87112/","content":"Jsoncpp Linux ä½¿ç”¨æŒ‡å—ç›®å½•\næ–¹å¼ä¸€ï¼šä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…\næ–¹å¼äºŒï¼šä»æºç ç¼–è¯‘ (æ¨è)\nAPI æ ¸å¿ƒç”¨æ³•\nç¼–è¯‘ä¸è¿è¡Œ\né¡¹ç›®é›†æˆ (Makefile &amp; CMake)\nå¸¸è§é—®é¢˜\n\næ–¹å¼ä¸€ï¼šä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…è¿™æ˜¯æœ€å¿«çš„æ–¹å¼ï¼Œä½†åº“ç‰ˆæœ¬å¯èƒ½è¾ƒæ—§ã€‚\n# Jsoncpp Linux ä½¿ç”¨æŒ‡å—# Jsoncpp Linux ä½¿ç”¨æŒ‡å—sudo apt updatesudo apt install -y libjsoncpp-dev pkg-config# Jsoncpp Linux ä½¿ç”¨æŒ‡å—pkg-config --modversion jsoncpp\n\næ–¹å¼äºŒï¼šä»æºç ç¼–è¯‘ (æ¨è)è·å–æœ€æ–°ç‰ˆæœ¬å’Œå®Œæ•´æ§åˆ¶æƒçš„æ¨èæ–¹å¼ã€‚\n# Jsoncpp Linux ä½¿ç”¨æŒ‡å—sudo apt install -y git cmake build-essential# Jsoncpp Linux ä½¿ç”¨æŒ‡å—git clone https://github.com/open-source-parsers/jsoncpp.gitcd jsoncpp# Jsoncpp Linux ä½¿ç”¨æŒ‡å—mkdir build &amp;&amp; cd buildcmake ..make -j$(nproc)# Jsoncpp Linux ä½¿ç”¨æŒ‡å—sudo make install# Jsoncpp Linux ä½¿ç”¨æŒ‡å—sudo ldconfig\n\nAPI æ ¸å¿ƒç”¨æ³•ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº† JsonCpp çš„æ ¸å¿ƒåŠŸèƒ½ï¼šæ„å»ºã€åºåˆ—åŒ–ã€è§£æå’Œè¯»å–ã€‚\nmain.cpp:\n#include &lt;iostream&gt;#include &lt;string&gt;#include &lt;fstream&gt;#include &lt;json/json.h&gt; // &quot;Umbrella&quot; header for all featuresint main() &#123;    // 1. æ„å»ºä¸€ä¸ª JSON å¯¹è±¡    Json::Value root;    root[&quot;name&quot;] = &quot;John Doe&quot;;    root[&quot;age&quot;] = 30;    root[&quot;isStudent&quot;] = false;    Json::Value languages;    languages.append(&quot;C++&quot;);    languages.append(&quot;Python&quot;);    root[&quot;languages&quot;] = languages;    // 2. åºåˆ—åŒ– (å°† JSON å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²)        // 2.1 ç¾åŒ–è¾“å‡º (å¸¦ç¼©è¿›ï¼Œé€‚åˆé˜…è¯»)    Json::StreamWriterBuilder styledBuilder;    styledBuilder[&quot;indentation&quot;] = &quot;   &quot;; // 3 spaces indentation    const std::string styledOutput = Json::writeString(styledBuilder, root);    std::cout &lt;&lt; &quot;--- Styled JSON ---&quot; &lt;&lt; std::endl;    std::cout &lt;&lt; styledOutput &lt;&lt; std::endl;    // 2.2 ç´§å‡‘è¾“å‡º (æ— æ ¼å¼ï¼Œé€‚åˆä¼ è¾“)    Json::StreamWriterBuilder compactBuilder;    compactBuilder[&quot;indentation&quot;] = &quot;&quot;; // No indentation    const std::string compactOutput = Json::writeString(compactBuilder, root);    std::cout &lt;&lt; &quot;\\n--- Compact JSON ---&quot; &lt;&lt; std::endl;    std::cout &lt;&lt; compactOutput &lt;&lt; std::endl;    // 3. è§£æ (å°†å­—ç¬¦ä¸²è½¬ä¸º JSON å¯¹è±¡)    std::string jsonString = R&quot;(&#123;\\&quot;company\\&quot;: \\&quot;ACME Corp\\&quot;, \\&quot;employees\\&quot;: 100&#125;)&quot; ;    Json::Value parsedRoot;    Json::CharReaderBuilder readerBuilder;    std::string errs;    std::unique_ptr&lt;Json::CharReader&gt; const reader(readerBuilder.newCharReader());    bool parsingSuccessful = reader-&gt;parse(        jsonString.c_str(),        jsonString.c_str() + jsonString.length(),        &amp;parsedRoot,        &amp;errs    );    if (!parsingSuccessful) &#123;        std::cerr &lt;&lt; &quot;Failed to parse JSON: &quot; &lt;&lt; errs &lt;&lt; std::endl;        return 1;    &#125;    // 4. ä»è§£æåçš„å¯¹è±¡ä¸­è¯»å–æ•°æ®    std::cout &lt;&lt; &quot;\\n--- Parsed Data ---&quot; &lt;&lt; std::endl;    std::string company = parsedRoot[&quot;company&quot;].asString();    int employees = parsedRoot[&quot;employees&quot;].asInt();    std::cout &lt;&lt; &quot;Company: &quot; &lt;&lt; company &lt;&lt; std::endl;    std::cout &lt;&lt; &quot;Employees: &quot; &lt;&lt; employees &lt;&lt; std::endl;    return 0;&#125;\n\nç¼–è¯‘ä¸è¿è¡Œä½¿ç”¨ pkg-config (æ¨è)pkg-config ä¼šè‡ªåŠ¨æä¾›ç¼–è¯‘å™¨æ‰€éœ€çš„å¤´æ–‡ä»¶å’Œåº“æ–‡ä»¶è·¯å¾„ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®šã€‚\n# Jsoncpp Linux ä½¿ç”¨æŒ‡å—g++ main.cpp -o main $(pkg-config --cflags --libs jsoncpp)# Jsoncpp Linux ä½¿ç”¨æŒ‡å—./main\n\né¡¹ç›®é›†æˆ (Makefile &amp; CMake)Makefile ç¤ºä¾‹CXX = g++CXXFLAGS = -std=c++14 -Wall -Wall# Jsoncpp Linux ä½¿ç”¨æŒ‡å—JSONCPP_FLAGS = $(shell pkg-config --cflags --libs jsoncpp)TARGET = my_appSOURCES = main.cpp.PHONY: all cleanall: $(TARGET)$(TARGET): $(SOURCES)\t$(CXX) $(CXXFLAGS) -o $@ $^ $(JSONCPP_FLAGS)clean:\trm -f $(TARGET)\n\nCMakeLists.txt ç¤ºä¾‹cmake_minimum_required (VERSION 3.10)project (JsonCppExample)set (CMAKE_CXX_STANDARD 14)# Jsoncpp Linux ä½¿ç”¨æŒ‡å—find_package (PkgConfig REQUIRED)# Jsoncpp Linux ä½¿ç”¨æŒ‡å—pkg_check_modules (JSONCPP REQUIRED jsoncpp)add_executable (my_app main.cpp)# Jsoncpp Linux ä½¿ç”¨æŒ‡å—target_link_libraries (my_app PRIVATE $&#123;JSONCPP_LIBRARIES&#125;)# Jsoncpp Linux ä½¿ç”¨æŒ‡å—target_include_directories (my_app PRIVATE $&#123;JSONCPP_INCLUDE_DIRS&#125;)\n\nå¸¸è§é—®é¢˜Q1: ç¼–è¯‘æ—¶æç¤º json/json.h: No such file or directory?A: è¿™æ„å‘³ç€ç¼–è¯‘å™¨æ‰¾ä¸åˆ°å¤´æ–‡ä»¶ã€‚\n\nç¡®è®¤ libjsoncpp-dev å·²å®‰è£…ã€‚\nå¦‚æœä½ ä»æºç å®‰è£…åˆ°äº†éæ ‡å‡†è·¯å¾„ï¼Œè¯·ç¡®ä¿åœ¨ä½¿ç”¨ g++ æ—¶é€šè¿‡ -I/path/to/your/include æŒ‡å®šäº†æ­£ç¡®çš„å¤´æ–‡ä»¶è·¯å¾„ã€‚\næœ€ä½³å®è·µæ˜¯ä½¿ç”¨ pkg-configï¼Œå®ƒèƒ½é¿å…è¿™ç±»é—®é¢˜ã€‚\n\nQ2: é“¾æ¥æ—¶æç¤º undefined reference to Json::...?A: è¿™æ˜¯é“¾æ¥å™¨æ‰¾ä¸åˆ°åº“æ–‡ä»¶ã€‚\n\nç¡®è®¤ç¼–è¯‘å‘½ä»¤ä¸­åŒ…å«äº† -ljsoncpp æˆ–è€… $(pkg-config --libs jsoncpp)ã€‚\nå¦‚æœä»æºç å®‰è£…ï¼Œç¡®è®¤åº“æ–‡ä»¶ (libjsoncpp.so æˆ– .a) å­˜åœ¨äºé“¾æ¥å™¨å¯ä»¥æ‰¾åˆ°çš„è·¯å¾„ä¸­ (å¦‚ /usr/local/lib)ã€‚\n\nQ3: è¿è¡Œæ—¶æç¤º error while loading shared libraries: libjsoncpp.so.X?A: ç¨‹åºæ‰¾åˆ°äº†å¤´æ–‡ä»¶å¹¶æˆåŠŸç¼–è¯‘ï¼Œä½†åœ¨è¿è¡Œæ—¶æ‰¾ä¸åˆ°åŠ¨æ€åº“ã€‚\n\nå¦‚æœä½ ä»æºç å®‰è£…ï¼Œè¯·ç¡®ä¿åœ¨ sudo make install åè¿è¡Œäº† sudo ldconfigã€‚\nå¦‚æœå®‰è£…åœ¨è‡ªå®šä¹‰è·¯å¾„ï¼Œè¯·å°†è¯¥è·¯å¾„æ·»åŠ åˆ° /etc/ld.so.conf.d/ å¹¶å†æ¬¡è¿è¡Œ sudo ldconfigã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","ç³»ç»Ÿåº“ä¸æ¡†æ¶"],"tags":["C++","Linux","JsonCpp","JSON","åº“å¼€å‘"]},{"title":"OpenSSL mTLS æŒ‡å—","url":"/posts/f4106d49/","content":"OpenSSL mTLS æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šç”Ÿæˆæ ¹è¯ä¹¦ (CA)\nç¬¬äºŒæ­¥ï¼šç”ŸæˆæœåŠ¡å™¨è¯ä¹¦\nç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦\nç¬¬å››æ­¥ï¼šéªŒè¯ä¸æ‰“åŒ…\né™„å½•Aï¼šå®Œæ•´è‡ªåŠ¨åŒ–è„šæœ¬\né™„å½•Bï¼šåœ¨ Nginx ä¸­é…ç½®åŒå‘è®¤è¯\né™„å½•Cï¼šç”Ÿæˆ DH å‚æ•° (å¯é€‰)\né™„å½•Dï¼šå¸¸ç”¨ OpenSSL å‘½ä»¤\n\næ¦‚è¿°åŒå‘è®¤è¯ï¼ˆMutual TLS, mTLSï¼‰æ˜¯ä¸€ç§é«˜å®‰å…¨æ€§çš„è®¤è¯æ¨¡å¼ï¼Œå®ƒè¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ–¹éƒ½å‡ºç¤ºå¹¶éªŒè¯å¯¹æ–¹çš„æ•°å­—è¯ä¹¦ï¼Œä»è€Œç¡®ä¿é€šä¿¡åŒæ–¹çš„èº«ä»½éƒ½æ˜¯å¯ä¿¡çš„ã€‚æœ¬æŒ‡å—å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ OpenSSL åˆ›å»ºä¸€å¥—å®Œæ•´çš„ã€ç”¨äºåŒå‘è®¤è¯çš„è¯ä¹¦ã€‚\nè¯ä¹¦ä½“ç³»æˆ‘ä»¬å°†åˆ›å»ºä»¥ä¸‹ä¸‰ç±»è¯ä¹¦ï¼š\n\næ ¹è¯ä¹¦ (CA): è¯ä¹¦é¢å‘æœºæ„ï¼Œç”¨äºç­¾å‘æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯è¯ä¹¦ã€‚å®ƒæ˜¯ä¿¡ä»»é“¾çš„é¡¶ç‚¹ã€‚\næœåŠ¡å™¨è¯ä¹¦: ç”¨äºå‘å®¢æˆ·ç«¯è¯æ˜æœåŠ¡å™¨çš„èº«ä»½ã€‚\nå®¢æˆ·ç«¯è¯ä¹¦: ç”¨äºå‘æœåŠ¡å™¨è¯æ˜å®¢æˆ·ç«¯çš„èº«ä»½ã€‚\n\nç¬¬ä¸€æ­¥ï¼šç”Ÿæˆæ ¹è¯ä¹¦ (CA)CA æ˜¯æ•´ä¸ªä¿¡ä»»ä½“ç³»çš„åŸºç¡€ï¼Œå…¶ç§é’¥å¿…é¡»è¢«ä¸¥æ ¼ä¿ç®¡ã€‚\n1. åˆ›å»º CA ç§é’¥# OpenSSL mTLS æŒ‡å—openssl genrsa -out ca.key 4096# OpenSSL mTLS æŒ‡å—chmod 400 ca.key\n\n2. åˆ›å»ºè‡ªç­¾åçš„ CA è¯ä¹¦ä½¿ç”¨ä¸Šä¸€æ­¥çš„ç§é’¥ï¼Œåˆ›å»ºä¸€ä¸ªæœ‰æ•ˆæœŸä¸º10å¹´çš„æ ¹è¯ä¹¦ã€‚\n# OpenSSL mTLS æŒ‡å—openssl req -new -x509 -days 3650 -key ca.key -out ca.crt \\  -subj &quot;/C=CN/ST=Beijing/L=Beijing/O=MyOrg CA/CN=MyRootCA&quot;\n\nç¬¬äºŒæ­¥ï¼šç”ŸæˆæœåŠ¡å™¨è¯ä¹¦æœåŠ¡å™¨è¯ä¹¦ç”¨äºå‘å®¢æˆ·ç«¯è¯æ˜å…¶èº«ä»½ï¼Œå…¶ CN (Common Name) æˆ– SAN (Subject Alternative Name) å¿…é¡»ä¸æœåŠ¡å™¨çš„åŸŸåæˆ– IP åœ°å€åŒ¹é…ã€‚\n1. åˆ›å»ºæœåŠ¡å™¨ç§é’¥openssl genrsa -out server.key 2048chmod 400 server.key\n\n2. åˆ›å»ºæœåŠ¡å™¨è¯ä¹¦ç­¾åè¯·æ±‚ (CSR)CSR æ–‡ä»¶åŒ…å«äº†æœåŠ¡å™¨çš„å…¬é’¥å’Œèº«ä»½ä¿¡æ¯ï¼Œå°†ç”¨äºå‘ CA ç”³è¯·ç­¾åã€‚\nopenssl req -new -key server.key -out server.csr \\  -subj &quot;/C=CN/ST=Beijing/L=Beijing/O=MyOrg/CN=server.your_domain.com&quot;\n\n3. åˆ›å»ºæ‰©å±•é…ç½®æ–‡ä»¶ (v3.ext)ä¸ºäº†è®©è¯ä¹¦æ”¯æŒå¤šåŸŸåæˆ– IP åœ°å€ï¼ˆSANï¼‰ï¼Œå¹¶æŒ‡å®šå…¶ç”¨é€”ä¸ºâ€œæœåŠ¡å™¨è®¤è¯â€ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ‰©å±•é…ç½®æ–‡ä»¶ã€‚\nv3.ext:\nauthorityKeyIdentifier=keyid,issuerbasicConstraints=CA:FALSEkeyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEnciphermentextendedKeyUsage = serverAuthsubjectAltName = @alt_names[alt_names]DNS.1 = server.your_domain.comDNS.2 = api.your_domain.comIP.1 = 192.168.1.100\n\n4. ä½¿ç”¨ CA ç­¾å‘æœåŠ¡å™¨è¯ä¹¦# OpenSSL mTLS æŒ‡å—# OpenSSL mTLS æŒ‡å—openssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial \\  -days 365 -sha256 -extfile v3.ext -out server.crt# OpenSSL mTLS æŒ‡å—chmod 644 server.crtchmod 400 server.key\n\nç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦å®¢æˆ·ç«¯è¯ä¹¦ç”¨äºå‘æœåŠ¡å™¨è¯æ˜å®¢æˆ·ç«¯çš„èº«ä»½ã€‚\n1. åˆ›å»ºå®¢æˆ·ç«¯ç§é’¥openssl genrsa -out client.key 2048chmod 400 client.key\n\n2. åˆ›å»ºå®¢æˆ·ç«¯ CSRopenssl req -new -key client.key -out client.csr \\  -subj &quot;/C=CN/ST=Beijing/L=Beijing/O=MyOrg/CN=my_client_id&quot;\n\n3. ä¿®æ”¹æ‰©å±•é…ç½®æ–‡ä»¶ä¸ºäº†æŒ‡å®šè¯ä¹¦ç”¨äºâ€œå®¢æˆ·ç«¯è®¤è¯â€ï¼Œä¿®æ”¹ v3.ext æ–‡ä»¶ä¸­çš„ extendedKeyUsageã€‚\n# OpenSSL mTLS æŒ‡å—extendedKeyUsage = clientAuth# OpenSSL mTLS æŒ‡å—\n\n4. ä½¿ç”¨ CA ç­¾å‘å®¢æˆ·ç«¯è¯ä¹¦# OpenSSL mTLS æŒ‡å—openssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial \\  -days 365 -sha256 -extfile v3.ext -out client.crt# OpenSSL mTLS æŒ‡å—chmod 644 client.crtchmod 400 client.key\n\nç¬¬å››æ­¥ï¼šéªŒè¯ä¸æ‰“åŒ…1. éªŒè¯è¯ä¹¦é“¾# OpenSSL mTLS æŒ‡å—openssl verify -CAfile ca.crt server.crt# OpenSSL mTLS æŒ‡å—# OpenSSL mTLS æŒ‡å—openssl verify -CAfile ca.crt client.crt# OpenSSL mTLS æŒ‡å—\n\n2. æ‰“åŒ…ä¸º PKCS#12 (.p12) æ ¼å¼ (å¯é€‰).p12 æ–‡ä»¶æ˜¯ä¸€ä¸ªåŠ å¯†çš„å®¹å™¨ï¼Œå¯ä»¥åŒæ—¶åŒ…å«è¯ä¹¦å’Œç§é’¥ï¼Œæ–¹ä¾¿åœ¨å„ç§åº”ç”¨ï¼ˆå¦‚æµè§ˆå™¨ã€Java KeyStoreï¼‰ä¸­å¯¼å…¥ã€‚\n# OpenSSL mTLS æŒ‡å—echo &quot;Creating PKCS#12 file...&quot;openssl pkcs12 -export -out client.p12 -inkey client.key -in client.crt -certfile ca.crt \\  -name &quot;My Client Certificate&quot;# OpenSSL mTLS æŒ‡å—openssl pkcs12 -info -in client.p12 -nodes# OpenSSL mTLS æŒ‡å—# OpenSSL mTLS æŒ‡å—# OpenSSL mTLS æŒ‡å—# OpenSSL mTLS æŒ‡å—\n\né™„å½•Aï¼šå®Œæ•´è‡ªåŠ¨åŒ–è„šæœ¬å°†ä»¥ä¸‹å†…å®¹ä¿å­˜ä¸º generate_certs.shï¼Œèµ‹äºˆæ‰§è¡Œæƒé™ (chmod +x) åè¿è¡Œå³å¯ä¸€é”®ç”Ÿæˆæ‰€æœ‰è¯ä¹¦ã€‚\n#!/bin/bashset -eecho &quot;=== Generating Mutual TLS Certificates ===&quot;# OpenSSL mTLS æŒ‡å—COUNTRY=&quot;CN&quot;STATE=&quot;Beijing&quot;CITY=&quot;Beijing&quot;ORG=&quot;MyOrganization&quot;DOMAIN=&quot;your_domain.com&quot;CERT_DAYS=365KEY_SIZE=2048# OpenSSL mTLS æŒ‡å—rm -f *.key *.crt *.csr *.p12 *.srl v3.ext# OpenSSL mTLS æŒ‡å—echo &quot;[1/4] Generating CA certificate...&quot;openssl genrsa -out ca.key $KEY_SIZEchmod 400 ca.keyopenssl req -new -x509 -days 3650 -key ca.key -out ca.crt \\  -subj &quot;/C=$COUNTRY/ST=$STATE/L=$CITY/O=$ORG CA/CN=MyRootCA&quot;# OpenSSL mTLS æŒ‡å—echo &quot;[2/4] Generating Server certificate...&quot;openssl genrsa -out server.key $KEY_SIZEchmod 400 server.keyopenssl req -new -key server.key -out server.csr \\  -subj &quot;/C=$COUNTRY/ST=$STATE/L=$CITY/O=$ORG/CN=server.$DOMAIN&quot;cat &gt; v3.ext &lt;&lt; EOFauthorityKeyIdentifier=keyid,issuerbasicConstraints=CA:FALSEkeyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEnciphermentextendedKeyUsage = serverAuthsubjectAltName = @alt_names[alt_names]DNS.1 = server.$DOMAINDNS.2 = localhostIP.1 = 127.0.0.1EOFopenssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial \\  -days $CERT_DAYS -sha256 -extfile v3.ext -out server.crt# OpenSSL mTLS æŒ‡å—echo &quot;[3/4] Generating Client certificate...&quot;openssl genrsa -out client.key $KEY_SIZEchmod 400 client.keyopenssl req -new -key client.key -out client.csr \\  -subj &quot;/C=$COUNTRY/ST=$STATE/L=$CITY/O=$ORG/CN=client1&quot;# OpenSSL mTLS æŒ‡å—sed -i -e &#x27;s/serverAuth/clientAuth/g&#x27; v3.extopenssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial \\  -days $CERT_DAYS -sha256 -extfile v3.ext -out client.crt# OpenSSL mTLS æŒ‡å—echo &quot;[4/4] Verifying and packaging certificates...&quot;openssl verify -CAfile ca.crt server.crtopenssl verify -CAfile ca.crt client.crt# OpenSSL mTLS æŒ‡å—echo &quot;Please enter password for PKCS#12 export:&quot;openssl pkcs12 -export -out client.p12 -inkey client.key -in client.crt -certfile ca.crt \\  -name &quot;MyClientCert&quot;# OpenSSL mTLS æŒ‡å—echo &quot;Cleaning up temporary files...&quot;rm -f *.csr *.srl v3.ext v3.ext-e# OpenSSL mTLS æŒ‡å—chmod 400 *.keychmod 644 *.crtif [[ -f &quot;client.p12&quot; ]]; then    chmod 400 client.p12fiecho &quot;&quot;echo &quot;=== All certificates generated successfully! ===&quot;echo &quot;&quot;echo &quot;Files created:&quot;echo &quot;  ca.key    - CA private key (KEEP SECRET!)&quot;echo &quot;  ca.crt    - CA certificate&quot;echo &quot;  server.key - Server private key&quot;echo &quot;  server.crt - Server certificate&quot;echo &quot;  client.key - Client private key&quot;echo &quot;  client.crt - Client certificate&quot;echo &quot;  client.p12 - PKCS#12 bundle (if created)&quot;\n\né™„å½•Bï¼šåœ¨ Nginx ä¸­é…ç½®åŒå‘è®¤è¯åŸºç¡€é…ç½®server &#123;    listen 443 ssl http2;    server_name server.your_domain.com;    # SSL è¯ä¹¦é…ç½®    ssl_certificate         /path/to/server.crt;    ssl_certificate_key     /path/to/server.key;    # mTLS é…ç½® - CA è¯ä¹¦ç”¨äºéªŒè¯å®¢æˆ·ç«¯    ssl_client_certificate  /path/to/ca.crt;    ssl_verify_client       on;    ssl_verify_depth        2;  # éªŒè¯æ·±åº¦    # SSL å®‰å…¨é…ç½®    ssl_protocols           TLSv1.2 TLSv1.3;    ssl_ciphers             ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384;    ssl_prefer_server_ciphers on;    location / &#123;        # è®¾ç½®å®¢æˆ·ç«¯è¯ä¹¦ä¿¡æ¯åˆ°ç¯å¢ƒå˜é‡        proxy_set_header X-SSL-Client-S-DN $ssl_client_s_dn;        proxy_set_header X-SSL-Client-Verify $ssl_client_verify;        proxy_set_header X-SSL-Client-Cert $ssl_client_cert;        # ä½ çš„åº”ç”¨é€»è¾‘        proxy_pass http://backend;    &#125;&#125;\n\nå¯é€‰éªŒè¯çº§åˆ«# OpenSSL mTLS æŒ‡å—ssl_verify_client on;# OpenSSL mTLS æŒ‡å—ssl_verify_client optional;# OpenSSL mTLS æŒ‡å—ssl_verify_client optional_no_ca;\n\né™„å½•Cï¼šç”Ÿæˆ DH å‚æ•° (å¯é€‰)Diffie-Hellman (DH) å‚æ•°ç”¨äºå¯†é’¥äº¤æ¢åè®®ï¼Œä»¥å®ç°**å®Œç¾å‰å‘ä¿å¯† (Perfect Forward Secrecy, PFS)**ã€‚åœ¨ Nginx ç­‰æœåŠ¡å™¨ä¸Šé…ç½® DHE&#x2F;EDH åŠ å¯†å¥—ä»¶æ—¶ï¼Œæ¨èä½¿ç”¨è‡ªå®šä¹‰çš„ã€å¼ºåº¦æ›´é«˜çš„ DH å‚æ•°æ–‡ä»¶ã€‚\n# OpenSSL mTLS æŒ‡å—# OpenSSL mTLS æŒ‡å—openssl dhparam -out dhparam.pem 2048# OpenSSL mTLS æŒ‡å—# OpenSSL mTLS æŒ‡å—\n\nåœ¨ Nginx é…ç½®ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒï¼š\nserver &#123;    # ...    ssl_certificate         /path/to/server.crt;    ssl_certificate_key     /path/to/server.key;    # æ·»åŠ  DH å‚æ•°æ–‡ä»¶è·¯å¾„    ssl_dhparam             /path/to/dhparam.pem;    # ...&#125;\n\né™„å½•Dï¼šå¸¸ç”¨ OpenSSL å‘½ä»¤\næŸ¥çœ‹è¯ä¹¦å†…å®¹: openssl x509 -in mycert.crt -text -noout\næŸ¥çœ‹è¯ä¹¦æœ‰æ•ˆæœŸ: openssl x509 -in mycert.crt -dates -noout\næŸ¥çœ‹è¯ä¹¦åºåˆ—å·: openssl x509 -in mycert.crt -noout -serial\næŸ¥çœ‹è¯ä¹¦æŒ‡çº¹: openssl x509 -in mycert.crt -noout -fingerprint -sha256\næŸ¥çœ‹ç§é’¥å†…å®¹: openssl rsa -in mykey.key -text -noout\næŸ¥çœ‹ç§é’¥æ¨¡æ•°: openssl rsa -in mykey.key -noout -modulus\nç§»é™¤ç§é’¥å¯†ç : openssl rsa -in encrypted.key -out decrypted.key\nåŠ å¯†ç§é’¥: openssl rsa -in decrypted.key -aes256 -out encrypted.key\néªŒè¯è¯ä¹¦é“¾: openssl verify -CAfile ca.crt -untrusted intermediate.crt server.crt\néªŒè¯ç§é’¥ä¸è¯ä¹¦æ˜¯å¦åŒ¹é…:# æ–¹æ³•1ï¼šæ¯”è¾ƒæ¨¡æ•°openssl x509 -noout -modulus -in mycert.crt | openssl md5openssl rsa -noout -modulus -in mykey.key | openssl md5# ä¸¤ä¸ªå‘½ä»¤çš„è¾“å‡ºåº”å®Œå…¨ä¸€è‡´# æ–¹æ³•2ï¼šç›´æ¥éªŒè¯openssl x509 -noout -text -in mycert.crt | grep -A1 &quot;RSA Public Key&quot;openssl rsa -noout -text -in mykey.key | grep -A1 &quot;publicExponent&quot;\n\nå…¶ä»–å¸¸ç”¨å‘½ä»¤# OpenSSL mTLS æŒ‡å—openssl x509 -pubkey -noout -in mycert.crt &gt; pubkey.pem# OpenSSL mTLS æŒ‡å—openssl rsa -pubout -in mykey.key -out pubkey.pem# OpenSSL mTLS æŒ‡å—openssl x509 -checkend 0 -noout -in mycert.crt# OpenSSL mTLS æŒ‡å—openssl x509 -checkend 2592000 -noout -in mycert.crt# OpenSSL mTLS æŒ‡å—cat server.crt intermediate.crt ca.crt &gt; fullchain.pem","categories":["åç«¯æœåŠ¡æ¶æ„","å®‰å…¨ä¸è¯ä¹¦"],"tags":["OpenSSL","SSL","TLS","mTLS","åŒå‘è®¤è¯","CA","è¯ä¹¦","DH"]},{"title":"FileZilla ç«¯å£è½¬å‘æŒ‡å—","url":"/posts/33eb4929/","content":"FileZilla ç«¯å£è½¬å‘æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: filezilla, ftp, portforwarding, èŠ±ç”Ÿå£³, å†…ç½‘ç©¿é€, è¿œç¨‹è®¿é—®\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. é…ç½®æµç¨‹å›¾\n3. FileZilla Server é…ç½®\n4. èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€\n5. FTP è¢«åŠ¨æ¨¡å¼é…ç½®\n6. é˜²ç«å¢™è®¾ç½®\n7. è¿æ¥æµ‹è¯•\n8. æ•…éšœæ’é™¤\n\n\n1. ğŸ“– æ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ FileZilla Server æ­å»º FTP æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡èŠ±ç”Ÿå£³å®ç°å¤–ç½‘è®¿é—®å†…ç½‘æ–‡ä»¶çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚\nğŸ¯ é…ç½®ç›®æ ‡\nâœ… æ­å»ºå†…ç½‘ FTP æœåŠ¡å™¨\nâœ… é…ç½®èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€\nâœ… å®ç°å¤–ç½‘å®‰å…¨è®¿é—®\nâœ… æ”¯æŒæ–‡ä»¶ä¸Šä¼ ä¸‹è½½\n\nğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾flowchart TD    A[å¤–ç½‘å®¢æˆ·ç«¯] --&gt; B[èŠ±ç”Ÿå£³å¤–ç½‘åŸŸå]    B --&gt; C[èŠ±ç”Ÿå£³æœåŠ¡å™¨]    C --&gt; D[å†…ç½‘æœåŠ¡å™¨]    D --&gt; E[FileZilla Server]    E --&gt; F[å…±äº«æ–‡ä»¶å¤¹]    G[FTPæ§åˆ¶é€šé“&lt;br/&gt;ç«¯å£21] --&gt; C    H[FTPæ•°æ®é€šé“&lt;br/&gt;è¢«åŠ¨ç«¯å£] --&gt; C    style A fill:#e1f5fe    style B fill:#f3e5f5    style C fill:#e8f5e8    style D fill:#fff3e0\n\n\n2. ğŸ”„ é…ç½®æµç¨‹å›¾flowchart TD    A[å¼€å§‹é…ç½®] --&gt; B[å®‰è£…ä¸é…ç½®FileZilla Server]    B --&gt; C[é…ç½®èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€]    C --&gt; D&#123;é…ç½®FTPè¢«åŠ¨æ¨¡å¼&lt;br&gt;ä¸æ•°æ®ä¼ è¾“ç«¯å£&#125;    D --&gt; E[è®¾ç½®Windowsé˜²ç«å¢™]    E --&gt; F[å¤–ç½‘è¿æ¥æµ‹è¯•]    F --&gt; G&#123;æµ‹è¯•æˆåŠŸ?&#125;    G -- æ˜¯ --&gt; H[é…ç½®å®Œæˆ]    G -- å¦ --&gt; I[æ£€æŸ¥ç«¯å£æ˜ å°„ä¸è¢«åŠ¨æ¨¡å¼è®¾ç½®]    I --&gt; F\n\n\n3. ğŸ–¥ï¸ FileZilla Server é…ç½®3.1 ğŸ“¥ ä¸‹è½½ä¸å®‰è£…\nä¸‹è½½ FileZilla Server\n\nè®¿é—® FileZilla å®˜ç½‘\nä¸‹è½½ FileZilla Server ç‰ˆæœ¬\nä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œå®‰è£…ç¨‹åº\n\n\nå®‰è£…é…ç½®\n# å®‰è£…è¿‡ç¨‹ä¸­çš„å…³é”®è®¾ç½®ï¼š- ç®¡ç†ç«¯å£: 14147 (é»˜è®¤)- æœåŠ¡ç«¯å£: 21 (FTPæ§åˆ¶ç«¯å£)- å¯åŠ¨ä¸ºç³»ç»ŸæœåŠ¡: æ¨è\n\n3.2 ğŸ‘¤ ç”¨æˆ·ä¸æƒé™é…ç½®åˆ›å»ºç”¨æˆ·\næ‰“å¼€ç®¡ç†ç•Œé¢\n\nåŒå‡»ç³»ç»Ÿæ‰˜ç›˜çš„ FileZilla Server å›¾æ ‡\næˆ–è®¿é—® http://localhost:14147\n\n\næ·»åŠ ç”¨æˆ·\nEdit â†’ Users â†’ Add- ç”¨æˆ·å: user1 (è‡ªå®šä¹‰)- å¯†ç : è®¾ç½®å¼ºå¯†ç - å‹¾é€‰ &quot;Password&quot; å¹¶è¾“å…¥å¯†ç \n\nè®¾ç½®å…±äº«æ–‡ä»¶å¤¹\næ·»åŠ å…±äº«ç›®å½•\nShared folders â†’ Add- é€‰æ‹©è¦å…±äº«çš„å†…ç½‘ç›®å½•- ä¾‹å¦‚: D:\\SharedFiles\n\né…ç½®æƒé™\nFilesæƒé™:âœ“ Read (è¯»å–/ä¸‹è½½)âœ“ Write (å†™å…¥/ä¸Šä¼ ) - å¯é€‰âœ“ Delete (åˆ é™¤) - å¯é€‰âœ“ Append (è¿½åŠ ) - å¯é€‰Directoriesæƒé™:âœ“ Create (åˆ›å»ºç›®å½•)âœ“ Delete (åˆ é™¤ç›®å½•)âœ“ List (åˆ—å‡ºç›®å½•)âœ“ Subdirs (å­ç›®å½•)\n\n3.3 ğŸ”§ åŸºç¡€é…ç½®graph LR    A[FileZillaè®¾ç½®] --&gt; B[å¸¸è§„è®¾ç½®]    A --&gt; C[è¢«åŠ¨æ¨¡å¼]    A --&gt; D[å®‰å…¨è®¾ç½®]    B --&gt; B1[ç›‘å¬ç«¯å£: 21]    B --&gt; B2[æœ€å¤§è¿æ¥æ•°: 10]    C --&gt; C1[å¯ç”¨è¢«åŠ¨æ¨¡å¼]    C --&gt; C2[è‡ªå®šä¹‰ç«¯å£èŒƒå›´]    D --&gt; D1[åŠ å¯†æ¨¡å¼]    D --&gt; D2[IPè¿‡æ»¤]\n\n\n4. ğŸŒ èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€4.1 ğŸ“± èŠ±ç”Ÿå£³å®¢æˆ·ç«¯è®¾ç½®\nä¸‹è½½å®‰è£…èŠ±ç”Ÿå£³\n\nè®¿é—® èŠ±ç”Ÿå£³å®˜ç½‘\nä¸‹è½½å¹¶å®‰è£…èŠ±ç”Ÿå£³å®¢æˆ·ç«¯\næ³¨å†Œå¹¶ç™»å½•èŠ±ç”Ÿå£³è´¦å·\n\n\næ·»åŠ å†…ç½‘ç©¿é€æ˜ å°„\nå†…ç½‘ç©¿é€ â†’ + æ·»åŠ æ˜ å°„ç¬¬ä¸€ä¸ªæ˜ å°„ (FTPæ§åˆ¶é€šé“):- åº”ç”¨åç§°: FTP-Control- åº”ç”¨ç±»å‹: TCP- å†…ç½‘ä¸»æœºIP: 192.168.x.x (æœåŠ¡å™¨å†…ç½‘IP)- å†…ç½‘ç«¯å£: 21\n\n4.2 ğŸ”— è·å–å¤–ç½‘è®¿é—®åœ°å€sequenceDiagram    participant U as ç”¨æˆ·    participant P as èŠ±ç”Ÿå£³å®¢æˆ·ç«¯    participant S as èŠ±ç”Ÿå£³æœåŠ¡å™¨    participant F as FileZilla Server    U-&gt;&gt;P: æ·»åŠ æ˜ å°„é…ç½®    P-&gt;&gt;S: æäº¤æ˜ å°„è¯·æ±‚    S-&gt;&gt;S: ç”Ÿæˆå¤–ç½‘åŸŸå    S-&gt;&gt;P: è¿”å›å¤–ç½‘è®¿é—®åœ°å€    P-&gt;&gt;U: æ˜¾ç¤ºå¤–ç½‘åœ°å€\n\nè·å–çš„ä¿¡æ¯:\n\nå¤–ç½‘åŸŸå: xxxx.vicp.cc\nå¤–ç½‘ç«¯å£: 12345 (ç¤ºä¾‹)\n\n\n5. ğŸ”„ FTP è¢«åŠ¨æ¨¡å¼é…ç½®5.1 ğŸ¯ ç†è§£è¢«åŠ¨æ¨¡å¼FTP åè®®éœ€è¦ä¸¤ä¸ªé€šé“ï¼š\n\næ§åˆ¶é€šé“: ç«¯å£ 21ï¼Œç”¨äºå‘é€å‘½ä»¤\næ•°æ®é€šé“: åŠ¨æ€ç«¯å£ï¼Œç”¨äºä¼ è¾“æ•°æ®\n\n5.2 ğŸ“¡ æ·»åŠ æ•°æ®ç«¯å£æ˜ å°„\nåœ¨èŠ±ç”Ÿå£³ä¸­æ·»åŠ ç¬¬äºŒä¸ªæ˜ å°„\nç¬¬äºŒä¸ªæ˜ å°„ (FTPæ•°æ®é€šé“):- åº”ç”¨åç§°: FTP-Data- åº”ç”¨ç±»å‹: TCP- å†…ç½‘ä¸»æœºIP: 192.168.x.x (åŒä¸Š)- å†…ç½‘ç«¯å£: 60000 (ä¸´æ—¶è®¾ç½®)\n\nè®°ä¸‹å¤–ç½‘ç«¯å£\n\nå‡è®¾ç”Ÿæˆçš„å¤–ç½‘ç«¯å£ä¸º 10418\néœ€è¦ä¿®æ”¹å†…ç½‘ç«¯å£ä¸ä¹‹åŒ¹é…\n\n\nä¿®æ­£ç«¯å£æ˜ å°„\nç¼–è¾‘ FTP-Data æ˜ å°„:- å°†å†…ç½‘ç«¯å£æ”¹ä¸º: 10418- ç¡®ä¿å†…å¤–ç«¯å£ä¸€è‡´\n\n5.3 âš™ï¸ FileZilla è¢«åŠ¨æ¨¡å¼è®¾ç½®\nè¿›å…¥è¢«åŠ¨æ¨¡å¼è®¾ç½®\nEdit â†’ Settings â†’ Passive mode settings\n\né…ç½®è¢«åŠ¨æ¨¡å¼å‚æ•°\nâœ“ Use custom port range- Custom port range: 10418-10418âœ“ Use the following IP- IP: xxxx.vicp.cc (èŠ±ç”Ÿå£³åŸŸå)\n\n4.4 ğŸ›¡ï¸ å®‰å…¨é…ç½®å»ºè®®graph TD    A[FTPå®‰å…¨é…ç½®] --&gt; B[å¯ç”¨SSL/TLS]    A --&gt; C[é™åˆ¶IPè®¿é—®]    A --&gt; D[å¼ºå¯†ç ç­–ç•¥]    A --&gt; E[æ—¥å¿—ç›‘æ§]    B --&gt; B1[ç”Ÿæˆè‡ªç­¾åè¯ä¹¦]    B --&gt; B2[å¼ºåˆ¶åŠ å¯†è¿æ¥]    C --&gt; C1[IPç™½åå•]    C --&gt; C2[åœ°ç†ä½ç½®é™åˆ¶]    D --&gt; D1[å¯†ç å¤æ‚åº¦è¦æ±‚]    D --&gt; D2[å®šæœŸæ›´æ¢å¯†ç ]    E --&gt; E1[è®¿é—®æ—¥å¿—]    E --&gt; E2[å¼‚å¸¸å‘Šè­¦]\n\n\n6. ğŸ”¥ Windows é˜²ç«å¢™è®¾ç½®6.1 ğŸ›¡ï¸ æ·»åŠ é˜²ç«å¢™è§„åˆ™\næ‰“å¼€ Windows é˜²ç«å¢™\næ§åˆ¶é¢æ¿ â†’ Windows Defender é˜²ç«å¢™ â†’ é«˜çº§è®¾ç½®\n\næ·»åŠ å…¥ç«™è§„åˆ™\nå…¥ç«™è§„åˆ™ â†’ æ–°å»ºè§„åˆ™è§„åˆ™1 (FTPæ§åˆ¶):- ç«¯å£: TCP 21- æ“ä½œ: å…è®¸è¿æ¥- é…ç½®æ–‡ä»¶: åŸŸã€ä¸“ç”¨ã€å…¬ç”¨è§„åˆ™2 (FTPæ•°æ®):- ç«¯å£: TCP 10418- æ“ä½œ: å…è®¸è¿æ¥- é…ç½®æ–‡ä»¶: åŸŸã€ä¸“ç”¨ã€å…¬ç”¨\n\n6.2 ğŸ”§ éªŒè¯é˜²ç«å¢™é…ç½®# FileZilla ç«¯å£è½¬å‘æŒ‡å—telnet localhost 21telnet localhost 10418# FileZilla ç«¯å£è½¬å‘æŒ‡å—netsh advfirewall show allprofiles\n\n\n7. ğŸ§ª å¤–ç½‘è¿æ¥æµ‹è¯•7.1 ğŸ”— ä½¿ç”¨ FileZilla Client æµ‹è¯•\nä¸‹è½½ FileZilla Client\n\nè®¿é—® FileZilla å®˜ç½‘ä¸‹è½½å®¢æˆ·ç«¯\nå®‰è£…å¹¶å¯åŠ¨\n\n\né…ç½®ç«™ç‚¹è¿æ¥\nä¸»æœº: xxxx.vicp.cc:21ç”¨æˆ·å: user1å¯†ç : [è®¾ç½®çš„å¯†ç ]ç«¯å£: 21ä¼ è¾“æ¨¡å¼: è¢«åŠ¨æ¨¡å¼\n\nè¿æ¥æµ‹è¯•\nsequenceDiagram    participant C as FileZilla Client    participant H as èŠ±ç”Ÿå£³    participant S as å†…ç½‘æœåŠ¡å™¨    participant F as FileZilla Server    C-&gt;&gt;H: è¿æ¥è¯·æ±‚ (ç«¯å£21)    H-&gt;&gt;S: è½¬å‘è¿æ¥    S-&gt;&gt;F: FTPæ§åˆ¶è¿æ¥    F-&gt;&gt;S: å“åº”è¢«åŠ¨ç«¯å£    S-&gt;&gt;H: è½¬å‘è¢«åŠ¨ç«¯å£ä¿¡æ¯    H-&gt;&gt;C: è¿”å›æ•°æ®ç«¯å£    C-&gt;&gt;H: æ•°æ®è¿æ¥ (ç«¯å£10418)    H-&gt;&gt;S: è½¬å‘æ•°æ®è¿æ¥    S-&gt;&gt;F: FTPæ•°æ®è¿æ¥\n\n7.2 ğŸ“Š æµ‹è¯•ç»“æœæ£€æŸ¥æˆåŠŸæ ‡å¿—:\nâœ… çŠ¶æ€: è¿æ¥æˆåŠŸâœ… ç›®å½•åˆ—è¡¨: æ˜¾ç¤ºå…±äº«æ–‡ä»¶å¤¹å†…å®¹âœ… æ–‡ä»¶ä¸‹è½½: å¯ä»¥æ­£å¸¸ä¸‹è½½æ–‡ä»¶âœ… æ–‡ä»¶ä¸Šä¼ : å¯ä»¥æ­£å¸¸ä¸Šä¼ æ–‡ä»¶ (å¦‚æœæƒé™å…è®¸)\n\n7.3 ğŸŒ å…¶ä»– FTP å®¢æˆ·ç«¯æµ‹è¯•Windows èµ„æºç®¡ç†å™¨åœ°å€æ è¾“å…¥: ftp://user1:password@xxxx.vicp.cc:21\n\næµè§ˆå™¨è®¿é—®è®¿é—®: ftp://xxxx.vicp.cc:21\n\nå‘½ä»¤è¡Œæµ‹è¯•ftp xxxx.vicp.cc:21user1passwordls\n\n\n8. ğŸ”§ æ•…éšœæ’é™¤8.1 âŒ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆé—®é¢˜1: è¿æ¥è¶…æ—¶ç—‡çŠ¶: è¿æ¥æ—¶é•¿æ—¶é—´æ— å“åº”\ngraph TD    A[è¿æ¥è¶…æ—¶] --&gt; B&#123;é—®é¢˜æ’æŸ¥&#125;    B --&gt; C[æ£€æŸ¥èŠ±ç”Ÿå£³æ˜ å°„]    B --&gt; D[æ£€æŸ¥é˜²ç«å¢™è®¾ç½®]    B --&gt; E[æ£€æŸ¥FTPæœåŠ¡çŠ¶æ€]    C --&gt; C1[ç¡®è®¤æ˜ å°„é…ç½®æ­£ç¡®]    D --&gt; D1[ç¡®è®¤ç«¯å£å·²å¼€æ”¾]    E --&gt; E1[ç¡®è®¤æœåŠ¡æ­£åœ¨è¿è¡Œ]\n\nè§£å†³æ–¹æ¡ˆ:\n# FileZilla ç«¯å£è½¬å‘æŒ‡å—# FileZilla ç«¯å£è½¬å‘æŒ‡å—# FileZilla ç«¯å£è½¬å‘æŒ‡å—ftp localhost:21# FileZilla ç«¯å£è½¬å‘æŒ‡å—services.msc â†’ æŸ¥æ‰¾ FileZilla Server\n\né—®é¢˜2: èƒ½è¿æ¥ä½†æ— æ³•åˆ—å‡ºç›®å½•ç—‡çŠ¶: è¿æ¥æˆåŠŸä½†çœ‹ä¸åˆ°æ–‡ä»¶åˆ—è¡¨\nåŸå› åˆ†æ:\nä¸»è¦åŸå› : è¢«åŠ¨æ¨¡å¼é…ç½®é”™è¯¯- æ•°æ®ç«¯å£æ˜ å°„ä¸æ­£ç¡®- FileZillaè¢«åŠ¨æ¨¡å¼è®¾ç½®é—®é¢˜\n\nè§£å†³æ–¹æ¡ˆ:\n\né‡æ–°é…ç½®è¢«åŠ¨æ¨¡å¼ç«¯å£\nç¡®ä¿ FileZilla ä¸­è®¾ç½®çš„å¤–ç½‘IPæ­£ç¡®\næ£€æŸ¥æ•°æ®ç«¯å£çš„é˜²ç«å¢™è§„åˆ™\n\né—®é¢˜3: ç™»å½•è®¤è¯å¤±è´¥ç—‡çŠ¶: ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯\nè§£å†³æ–¹æ¡ˆ:\n# FileZilla ç«¯å£è½¬å‘æŒ‡å—FileZilla Serverç®¡ç†ç•Œé¢ â†’ Edit â†’ Usersâ†’ é€‰æ‹©ç”¨æˆ· â†’ é‡æ–°è®¾ç½®å¯†ç # FileZilla ç«¯å£è½¬å‘æŒ‡å—ç¡®è®¤ç”¨æˆ·æœ‰è‡³å°‘ä¸€ä¸ªå…±äº«æ–‡ä»¶å¤¹ç¡®è®¤ç”¨æˆ·æœ‰è¯»å–æƒé™\n\n8.2 ğŸ” é«˜çº§æ•…éšœæ’é™¤ç½‘ç»œè¯Šæ–­å·¥å…·# FileZilla ç«¯å£è½¬å‘æŒ‡å—nmap -p 21,10418 localhost# FileZilla ç«¯å£è½¬å‘æŒ‡å—telnet localhost 21telnet localhost 10418# FileZilla ç«¯å£è½¬å‘æŒ‡å—tracert xxxx.vicp.cc\n\næ—¥å¿—åˆ†æ\nFileZilla Server æ—¥å¿—\nç¼–è¾‘ â†’ è®¾ç½® â†’ æ—¥å¿—æ–‡ä»¶- å¯ç”¨æ—¥å¿—è®°å½•- æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯\n\nWindows äº‹ä»¶æ—¥å¿—\näº‹ä»¶æŸ¥çœ‹å™¨ â†’ Windows æ—¥å¿— â†’ åº”ç”¨ç¨‹åº- æŸ¥æ‰¾ä¸ FileZilla ç›¸å…³çš„é”™è¯¯\n\n8.3 ğŸ“ è·å–æ”¯æŒå®˜æ–¹èµ„æº:\n\nFileZilla å®˜æ–¹æ–‡æ¡£\nèŠ±ç”Ÿå£³æŠ€æœ¯æ”¯æŒ\nFTP åè®®æ–‡æ¡£\n\nç¤¾åŒºæ”¯æŒ:\n\nFileZilla è®ºå›\nèŠ±ç”Ÿå£³ç”¨æˆ·ç¤¾åŒº\nStack Overflow æŠ€æœ¯é—®ç­”\n\n\nğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®9.1 âš¡ æœåŠ¡å™¨ä¼˜åŒ–graph LR    A[æ€§èƒ½ä¼˜åŒ–] --&gt; B[ç½‘ç»œä¼˜åŒ–]    A --&gt; C[ç¡¬ä»¶ä¼˜åŒ–]    A --&gt; D[è½¯ä»¶é…ç½®]    B --&gt; B1[æé«˜å¸¦å®½]    B --&gt; B2[ä¼˜åŒ–MTU]    C --&gt; C1[å‡çº§CPU]    C --&gt; C2[å¢åŠ å†…å­˜]    C --&gt; C3[SSDç¡¬ç›˜]    D --&gt; D1[è°ƒæ•´è¿æ¥æ•°]    D --&gt; D2[å¯ç”¨ç¼“å­˜]    D --&gt; D3[ä¼˜åŒ–æ—¥å¿—]\n\n9.2 ğŸ”’ å®‰å…¨åŠ å›º\nå®šæœŸæ›´æ–° - ä¿æŒ FileZilla Server ä¸ºæœ€æ–°ç‰ˆæœ¬\nç›‘æ§è®¿é—® - è®¾ç½®å¼‚å¸¸è®¿é—®å‘Šè­¦\nå¤‡ä»½é…ç½® - å®šæœŸå¤‡ä»½ç”¨æˆ·å’Œé…ç½®ä¿¡æ¯\nè®¿é—®é™åˆ¶ - é™åˆ¶ç‰¹å®šIPè®¿é—®\n\n\nğŸ“š æ€»ç»“âœ… é…ç½®å®Œæˆæ¸…å•\n FileZilla Server å®‰è£…é…ç½®\n ç”¨æˆ·è´¦æˆ·å’Œæƒé™è®¾ç½®\n èŠ±ç”Ÿå£³å†…ç½‘ç©¿é€é…ç½®\n FTP è¢«åŠ¨æ¨¡å¼è®¾ç½®\n é˜²ç«å¢™è§„åˆ™é…ç½®\n å¤–ç½‘è¿æ¥æµ‹è¯•é€šè¿‡\n\nğŸ¯ ä½¿ç”¨åœºæ™¯\nä¸ªäººæ–‡ä»¶åˆ†äº« - åœ¨å¤–ç½‘è®¿é—®å®¶ä¸­æ–‡ä»¶\nå›¢é˜Ÿåä½œ - å…±äº«é¡¹ç›®æ–‡ä»¶\nè¿œç¨‹å¤‡ä»½ - å¤–ç½‘å¤‡ä»½é‡è¦æ•°æ®\nç½‘ç«™ç»´æŠ¤ - ä¸Šä¼ ä¸‹è½½ç½‘ç«™æ–‡ä»¶\n\nğŸ’¡ ç»´æŠ¤å»ºè®®\nå®šæœŸæ£€æŸ¥èŠ±ç”Ÿå£³æ˜ å°„çŠ¶æ€\nç›‘æ§æœåŠ¡å™¨æ€§èƒ½å’Œè¿æ¥æ•°\nå®šæœŸæ›´æ–°å¯†ç å’Œå®‰å…¨é…ç½®\nå¤‡ä»½é‡è¦æ–‡ä»¶å’Œé…ç½®\n\n\n\nğŸ’¡ æç¤º:\n\nèŠ±ç”Ÿå£³å…è´¹ç‰ˆæœ¬é€šå¸¸é™åˆ¶æ˜ å°„æ•°é‡å’Œå¸¦å®½\nç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ä»˜è´¹ç‰ˆæœ¬è·å¾—æ›´å¥½æ€§èƒ½\nå®šæœŸæ£€æŸ¥ FTP æœåŠ¡çŠ¶æ€ç¡®ä¿å¯ç”¨æ€§\né‡è¦æ•°æ®å»ºè®®ä½¿ç”¨æ›´å®‰å…¨çš„ä¼ è¾“æ–¹å¼å¦‚ SFTP\n\n\n","categories":["äº‘åŸç”Ÿè¿ç»´"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"å®å¡”é¢æ¿å®‰è£…æŒ‡å—","url":"/posts/251711d2/","content":"å®å¡”é¢æ¿å®‰è£…æŒ‡å—ç›®å½•\né‡è¦ï¼šå®‰å…¨é¡»çŸ¥\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡\nç¬¬äºŒæ­¥ï¼šæ‰§è¡Œå®‰è£…è„šæœ¬\nç¬¬ä¸‰æ­¥ï¼šåˆå§‹é…ç½®\næ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨\nå¸¸ç”¨å‘½ä»¤\né—®é¢˜æ’æŸ¥\n\né‡è¦ï¼šå®‰å…¨é¡»çŸ¥å®å¡”é¢æ¿æ˜¯ä¸€ä¸ªæ‹¥æœ‰é«˜æƒé™çš„æœåŠ¡å™¨ç®¡ç†å·¥å…·ï¼Œå…¶å®‰å…¨æ€§è‡³å…³é‡è¦ã€‚è¯·åŠ¡å¿…éµå¾ªä»¥ä¸‹åŸºç¡€å®‰å…¨å®è·µï¼š\n\nä¿®æ”¹é»˜è®¤ä¿¡æ¯: ç«‹å³ä¿®æ”¹é»˜è®¤çš„ 8888 ç«¯å£ã€é»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç ã€‚\nä½¿ç”¨å¼ºå¯†ç : ä¸ºé¢æ¿å’Œæ•°æ®åº“è®¾ç½®å¤æ‚çš„ã€æ— è§„å¾‹çš„å¯†ç ã€‚\nå¼€å¯é¢æ¿ SSL: ä¸ºä½ çš„é¢æ¿è®¿é—®åœ°å€å¼€å¯ HTTPSï¼Œé˜²æ­¢ç™»å½•ä¿¡æ¯åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«çªƒå–ã€‚\nå®šæœŸæ›´æ–°: åŠæ—¶å°†å®å¡”é¢æ¿æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä»¥è·å–æœ€æ–°çš„å®‰å…¨è¡¥ä¸ã€‚\né…ç½®é˜²ç«å¢™: åªå¼€æ”¾å¿…è¦çš„ç«¯å£ï¼Œå…³é—­ä¸ä½¿ç”¨çš„ç«¯å£ã€‚\nå®šæœŸå¤‡ä»½: å…»æˆå®šæœŸå¤‡ä»½ç½‘ç«™æ–‡ä»¶å’Œæ•°æ®åº“çš„å¥½ä¹ æƒ¯ã€‚\n\næ¦‚è¿°å®å¡”é¢æ¿ï¼ˆBT Panelï¼‰æ˜¯ä¸€æ¬¾ç®€å•æ˜“ç”¨çš„æœåŠ¡å™¨è¿ç»´ç®¡ç†é¢æ¿ï¼Œæ”¯æŒ Linux å’Œ Windowsã€‚å®ƒé€šè¿‡ Web å›¾å½¢åŒ–ç•Œé¢ï¼Œæå¤§åœ°ç®€åŒ–äº†æœåŠ¡å™¨çš„æ—¥å¸¸ç®¡ç†å·¥ä½œï¼Œå¦‚ç¯å¢ƒéƒ¨ç½²ã€ç½‘ç«™åˆ›å»ºã€æ•°æ®åº“ç®¡ç†ã€æ–‡ä»¶ç®¡ç†å’Œå®‰å…¨ç›‘æ§ç­‰ã€‚\nå›½é™…ç‰ˆ: å®å¡”é¢æ¿æœ‰å¯¹åº”çš„å›½é™…ç‰ˆï¼Œåä¸º aaPanelã€‚å¯¹äºéä¸­æ–‡ç”¨æˆ·ï¼Œæ¨èä½¿ç”¨ aaPanelï¼Œå…¶å®˜ç½‘ä¸º aapanel.comã€‚æœ¬æŒ‡å—ä»¥ä¸­æ–‡ç‰ˆçš„å®å¡”é¢æ¿ä¸ºä¾‹ã€‚\nç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡1. ç³»ç»Ÿè¦æ±‚\næ“ä½œç³»ç»Ÿ: CentOS 7.1+, Ubuntu 16.04+, Debian 9.0+\nå†…å­˜: å»ºè®® 1GB ä»¥ä¸Šã€‚\nç£ç›˜ç©ºé—´: å»ºè®® 10GB ä»¥ä¸Šå¯ç”¨ç©ºé—´ã€‚\nè¦æ±‚: ä¸€ä¸ªçº¯å‡€çš„ã€æœªå®‰è£…è¿‡å…¶ä»– Web æœåŠ¡å™¨è½¯ä»¶ï¼ˆå¦‚ Nginx, Apacheï¼‰çš„æ“ä½œç³»ç»Ÿã€‚\n\n2. å¼€æ”¾ç«¯å£åœ¨å®‰è£…å‰ï¼Œè¯·ç¡®ä¿ä½ çš„æœåŠ¡å™¨æä¾›å•†çš„å®‰å…¨ç»„ï¼ˆæˆ–é˜²ç«å¢™ï¼‰å·²å¼€æ”¾ä»¥ä¸‹ç«¯å£ï¼š\n\n8888: å®å¡”é¢æ¿é»˜è®¤ç«¯å£\n80: HTTP\n443: HTTPS\n22: SSH\n21: FTP (å¦‚æœéœ€è¦)\n3306: MySQL (å¦‚æœéœ€è¦è¿œç¨‹è®¿é—®)\n\nç¬¬äºŒæ­¥ï¼šæ‰§è¡Œå®‰è£…è„šæœ¬ä½¿ç”¨ root æˆ– sudo æƒé™ç™»å½•ä½ çš„æœåŠ¡å™¨ç»ˆç«¯ã€‚\nUbuntu&#x2F;Debian å®‰è£…å‘½ä»¤wget -O install.sh http://download.bt.cn/install/install-ubuntu_6.0.sh &amp;&amp; sudo bash install.sh ed8484bec\n\nCentOS å®‰è£…å‘½ä»¤yum install -y wget &amp;&amp; wget -O install.sh http://download.bt.cn/install/install_6.0.sh &amp;&amp; sh install.sh ed8484bec\n\nå®‰è£…è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆæ‰€æœ‰ç¯å¢ƒé…ç½®ã€‚å®‰è£…æˆåŠŸåï¼Œç»ˆç«¯ä¼šæ˜¾ç¤ºä½ çš„é¢æ¿ç™»å½•åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ã€‚è¯·åŠ¡å¿…ç«‹å³å¤åˆ¶å¹¶ä¿å­˜è¿™äº›ä¿¡æ¯ï¼\nç¬¬ä¸‰æ­¥ï¼šåˆå§‹é…ç½®\nç™»å½•é¢æ¿: ä½¿ç”¨ä¸Šä¸€æ­¥è·å–çš„åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å¹¶ç™»å½•å®å¡”é¢æ¿ã€‚\nå®‰è£…å¥—ä»¶: é¦–æ¬¡ç™»å½•æ—¶ï¼Œé¢æ¿ä¼šæ¨èä½ å®‰è£…ä¸€ä¸ª Web ç¯å¢ƒå¥—ä»¶ï¼Œæœ€å¸¸è§çš„æ˜¯ LNMP (Linux + Nginx + MySQL + PHP) æˆ– LAMP (Linux + Apache + MySQL + PHP)ã€‚æ ¹æ®ä½ çš„éœ€æ±‚é€‰æ‹©ä¸€ä¸ªå¹¶ä¸€é”®å®‰è£…ã€‚\nä¿®æ”¹å®‰å…¨ä¿¡æ¯:\nè¿›å…¥å·¦ä¾§èœå•çš„â€œé¢æ¿è®¾ç½®â€ã€‚\nä¿®æ”¹é¢æ¿ç«¯å£: å°†é»˜è®¤çš„ 8888 ä¿®æ”¹ä¸ºä¸€ä¸ªä¸å¸¸ç”¨çš„ç«¯å£ã€‚\nä¿®æ”¹é¢æ¿ç”¨æˆ·å’Œå¯†ç : è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç ã€‚\nå¼€å¯é¢æ¿ SSL: ä¸ºä½ çš„é¢æ¿åŸŸåï¼ˆå¯ä»¥æ˜¯ IPï¼‰ç”³è¯·ä¸€ä¸ª Letâ€™s Encrypt è¯ä¹¦æˆ–ç²˜è´´ä½ è‡ªå·±çš„è¯ä¹¦ï¼Œå¼ºåˆ¶ä½¿ç”¨ HTTPS è®¿é—®ã€‚\n\n\n\næ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨ç½‘ç«™ç®¡ç†\næ·»åŠ ç«™ç‚¹: åœ¨â€œç½‘ç«™â€èœå•ä¸­ï¼Œè¾“å…¥ä½ çš„åŸŸåï¼Œé€‰æ‹© PHP ç‰ˆæœ¬ï¼Œåˆ›å»ºæ•°æ®åº“ï¼Œå³å¯å¿«é€Ÿåˆ›å»ºä¸€ä¸ªç½‘ç«™ã€‚\né…ç½® SSL: åœ¨ç«™ç‚¹çš„â€œè®¾ç½®â€ä¸­ï¼Œå¯ä»¥ä¸€é”®ç”³è¯·å’Œéƒ¨ç½² Letâ€™s Encrypt çš„å…è´¹ SSL è¯ä¹¦ï¼Œå¹¶å¼€å¯å¼ºåˆ¶ HTTPSã€‚\n\næ•°æ®åº“ç®¡ç†\nåˆ›å»ºæ•°æ®åº“: åœ¨â€œæ•°æ®åº“â€èœå•ä¸­ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·ï¼Œå¹¶ç®¡ç†æƒé™ã€‚\nå¤‡ä»½ä¸æ¢å¤: æ”¯æŒå¯¹æ•°æ®åº“è¿›è¡Œæ‰‹åŠ¨æˆ–å®šæ—¶çš„å¤‡ä»½ï¼Œå¹¶å¯ä»¥ä»å¤‡ä»½ä¸­æ¢å¤ã€‚\nphpMyAdmin: é¢æ¿å†…ç½®äº† phpMyAdminï¼Œæ–¹ä¾¿è¿›è¡Œå›¾å½¢åŒ–çš„æ•°æ®åº“ç®¡ç†ã€‚\n\næ–‡ä»¶ç®¡ç†\næä¾›ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åœ¨çº¿æ–‡ä»¶ç®¡ç†å™¨ï¼Œå¯ä»¥è¿›è¡Œä¸Šä¼ ã€ä¸‹è½½ã€å‹ç¼©ã€è§£å‹ã€åœ¨çº¿ç¼–è¾‘ç­‰æ“ä½œã€‚\n\nç›‘æ§\nåœ¨â€œç›‘æ§â€èœå•ä¸­ï¼Œå¯ä»¥ç›´è§‚åœ°çœ‹åˆ°æœåŠ¡å™¨çš„ CPUã€å†…å­˜ã€ç£ç›˜å’Œç½‘ç»œè´Ÿè½½çš„å®æ—¶å’Œå†å²å›¾è¡¨ã€‚\n\nå¸¸ç”¨å‘½ä»¤å®å¡”é¢æ¿æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„å‘½ä»¤è¡Œå·¥å…· btã€‚\n# å®å¡”é¢æ¿å®‰è£…æŒ‡å—sudo bt start       # å¯åŠ¨é¢æ¿sudo bt stop        # åœæ­¢é¢æ¿sudo bt restart     # é‡å¯é¢æ¿sudo bt status      # æŸ¥çœ‹é¢æ¿çŠ¶æ€# å®å¡”é¢æ¿å®‰è£…æŒ‡å—sudo bt 1           # ä¿®æ”¹é¢æ¿ç«¯å£sudo bt 5           # ä¿®æ”¹é¢æ¿å¯†ç sudo bt 6           # ä¿®æ”¹é¢æ¿ç”¨æˆ·å# å®å¡”é¢æ¿å®‰è£…æŒ‡å—sudo bt default     # æŸ¥çœ‹é»˜è®¤ç™»å½•ä¿¡æ¯sudo bt clean       # æ¸…ç†é¢æ¿ç¼“å­˜\n\né—®é¢˜æ’æŸ¥Q1: å®‰è£…å®Œæˆåæ— æ³•è®¿é—®é¢æ¿åœ°å€?A:\n\næ£€æŸ¥æœåŠ¡çŠ¶æ€: è¿è¡Œ sudo bt status æˆ– sudo systemctl status bt ç¡®è®¤é¢æ¿æœåŠ¡æ˜¯å¦åœ¨è¿è¡Œã€‚\næ£€æŸ¥é˜²ç«å¢™: ç¡®è®¤ä½ çš„äº‘æœåŠ¡å™¨å®‰å…¨ç»„å’ŒæœåŠ¡å™¨å†…éƒ¨çš„é˜²ç«å¢™ï¼ˆå¦‚ ufw, firewalldï¼‰éƒ½å·²æ”¾è¡Œäº†ä½ çš„é¢æ¿ç«¯å£ã€‚\næ£€æŸ¥ç«¯å£å ç”¨: ä½¿ç”¨ sudo netstat -tlnp | grep &lt;ä½ çš„ç«¯å£å·&gt; æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å…¶ä»–ç¨‹åºå ç”¨ã€‚\n\nQ2: å¿˜è®°äº†ç™»å½•ä¿¡æ¯?A: ç™»å½•æœåŠ¡å™¨ç»ˆç«¯ï¼Œè¿è¡Œ sudo bt default å³å¯æŸ¥çœ‹å½“å‰çš„ç™»å½•åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ã€‚\nQ3: ç½‘ç«™æ— æ³•è®¿é—®ï¼Œæç¤º 502 æˆ–å…¶ä»–é”™è¯¯?A:\n\nç™»å½•å®å¡”é¢æ¿ï¼Œæ£€æŸ¥â€œç½‘ç«™â€-&gt;â€œè®¾ç½®â€ä¸­çš„é…ç½®æ˜¯å¦æ­£ç¡®ã€‚\næ£€æŸ¥å¯¹åº”çš„ Web æœåŠ¡å™¨ï¼ˆNginx&#x2F;Apacheï¼‰å’Œ PHP çš„æœåŠ¡çŠ¶æ€æ˜¯å¦æ­£å¸¸ã€‚\nåœ¨â€œæ–‡ä»¶â€ä¸­æŸ¥çœ‹å¯¹åº”ç½‘ç«™çš„æ—¥å¿—æ–‡ä»¶ï¼Œåˆ†æå…·ä½“çš„é”™è¯¯åŸå› ã€‚\n\n","categories":["äº‘æœåŠ¡ä¸DevOps","æœåŠ¡å™¨ç®¡ç†é¢æ¿"],"tags":["Linux","å®å¡”é¢æ¿","aaPanel","æœåŠ¡å™¨ç®¡ç†","Webé¢æ¿","ç³»ç»Ÿç®¡ç†"]},{"title":"OpenSSL mTLS Windows æŒ‡å—","url":"/posts/d1520bc/","content":"OpenSSL mTLS Windows æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šåœ¨ Windows ä¸Šå®‰è£… OpenSSL\nç¬¬äºŒæ­¥ï¼šç”Ÿæˆæ ¹è¯ä¹¦ (CA)\nç¬¬ä¸‰æ­¥ï¼šç”ŸæˆæœåŠ¡å™¨è¯ä¹¦\nç¬¬å››æ­¥ï¼šç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦\nç¬¬äº”æ­¥ï¼šéªŒè¯ä¸æ‰“åŒ…\né™„å½•Aï¼šWindows æ‰¹å¤„ç†è‡ªåŠ¨åŒ–è„šæœ¬\né™„å½•Bï¼šåœ¨ IIS ä¸­é…ç½®åŒå‘è®¤è¯\né™„å½•Cï¼šåœ¨ Nginx for Windows ä¸­é…ç½®åŒå‘è®¤è¯\né™„å½•Dï¼šç”Ÿæˆ DH å‚æ•° (å¯é€‰)\né™„å½•Eï¼šå¸¸ç”¨ OpenSSL å‘½ä»¤\n\næ¦‚è¿°åŒå‘è®¤è¯ï¼ˆMutual TLS, mTLSï¼‰æ˜¯ä¸€ç§é«˜å®‰å…¨æ€§çš„è®¤è¯æ¨¡å¼ï¼Œå®ƒè¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ–¹éƒ½å‡ºç¤ºå¹¶éªŒè¯å¯¹æ–¹çš„æ•°å­—è¯ä¹¦ï¼Œä»è€Œç¡®ä¿é€šä¿¡åŒæ–¹çš„èº«ä»½éƒ½æ˜¯å¯ä¿¡çš„ã€‚æœ¬æŒ‡å—å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Windows ç³»ç»Ÿä¸Šä½¿ç”¨ OpenSSL åˆ›å»ºä¸€å¥—å®Œæ•´çš„ã€ç”¨äºåŒå‘è®¤è¯çš„è¯ä¹¦ã€‚\nWindows ç¯å¢ƒæ³¨æ„äº‹é¡¹\nWindows ç³»ç»Ÿé»˜è®¤ä¸åŒ…å« OpenSSLï¼Œéœ€è¦å•ç‹¬å®‰è£…\nè·¯å¾„åˆ†éš”ç¬¦ä½¿ç”¨åæ–œæ  \\\næ‰¹å¤„ç†è„šæœ¬ä½¿ç”¨ .bat æ ¼å¼\næ–‡ä»¶æƒé™ç®¡ç†ä¸ Linux ä¸åŒ\n\nç¬¬ä¸€æ­¥ï¼šåœ¨ Windows ä¸Šå®‰è£… OpenSSLæ–¹æ³•1ï¼šä½¿ç”¨ Chocolatey (æ¨è)# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString(&#x27;https://community.chocolatey.org/install.ps1&#x27;))# OpenSSL mTLS Windows æŒ‡å—choco install openssl -y\n\næ–¹æ³•2ï¼šæ‰‹åŠ¨ä¸‹è½½å®‰è£…\nè®¿é—® https://slproweb.com/products/Win32OpenSSL.html\nä¸‹è½½é€‚åˆæ‚¨ç³»ç»Ÿçš„ç‰ˆæœ¬ï¼ˆLight ç‰ˆæœ¬å³å¯ï¼‰\nè¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰æ‹©å®‰è£…è·¯å¾„ï¼ˆå¦‚ C:\\OpenSSL-Win64ï¼‰\nå°† OpenSSL çš„ bin ç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿ PATH ç¯å¢ƒå˜é‡\n\néªŒè¯å®‰è£…æ‰“å¼€å‘½ä»¤æç¤ºç¬¦æˆ– PowerShellï¼š\nopenssl version\n\nç¬¬äºŒæ­¥ï¼šç”Ÿæˆæ ¹è¯ä¹¦ (CA)CA æ˜¯æ•´ä¸ªä¿¡ä»»ä½“ç³»çš„åŸºç¡€ï¼Œå…¶ç§é’¥å¿…é¡»è¢«ä¸¥æ ¼ä¿ç®¡ã€‚\n1. åˆ›å»ºå·¥ä½œç›®å½•# OpenSSL mTLS Windows æŒ‡å—mkdir C:\\certscd C:\\certs\n\n2. åˆ›å»º CA ç§é’¥# OpenSSL mTLS Windows æŒ‡å—openssl genrsa -out ca.key 4096\n\n3. åˆ›å»ºè‡ªç­¾åçš„ CA è¯ä¹¦ä½¿ç”¨ä¸Šä¸€æ­¥çš„ç§é’¥ï¼Œåˆ›å»ºä¸€ä¸ªæœ‰æ•ˆæœŸä¸º10å¹´çš„æ ¹è¯ä¹¦ã€‚\n# OpenSSL mTLS Windows æŒ‡å—openssl req -new -x509 -days 3650 -key ca.key -out ca.crt ^  -subj &quot;/C=CN/ST=Beijing/L=Beijing/O=MyOrg CA/CN=MyRootCA&quot;\n\nç¬¬ä¸‰æ­¥ï¼šç”ŸæˆæœåŠ¡å™¨è¯ä¹¦æœåŠ¡å™¨è¯ä¹¦ç”¨äºå‘å®¢æˆ·ç«¯è¯æ˜å…¶èº«ä»½ï¼Œå…¶ CN (Common Name) æˆ– SAN (Subject Alternative Name) å¿…é¡»ä¸æœåŠ¡å™¨çš„åŸŸåæˆ– IP åœ°å€åŒ¹é…ã€‚\n1. åˆ›å»ºæœåŠ¡å™¨ç§é’¥openssl genrsa -out server.key 2048\n\n2. åˆ›å»ºæœåŠ¡å™¨è¯ä¹¦ç­¾åè¯·æ±‚ (CSR)CSR æ–‡ä»¶åŒ…å«äº†æœåŠ¡å™¨çš„å…¬é’¥å’Œèº«ä»½ä¿¡æ¯ï¼Œå°†ç”¨äºå‘ CA ç”³è¯·ç­¾åã€‚\nopenssl req -new -key server.key -out server.csr ^  -subj &quot;/C=CN/ST=Beijing/L=Beijing/O=MyOrg/CN=server.your_domain.com&quot;\n\n3. åˆ›å»ºæ‰©å±•é…ç½®æ–‡ä»¶ (v3.ext)åˆ›å»ºæ–‡æœ¬æ–‡ä»¶ v3.extï¼Œå†…å®¹å¦‚ä¸‹ï¼š\nauthorityKeyIdentifier=keyid,issuerbasicConstraints=CA:FALSEkeyUsage = digitalSignature, keyEnciphermentextendedKeyUsage = serverAuthsubjectAltName = @alt_names[alt_names]DNS.1 = server.your_domain.comDNS.2 = api.your_domain.comIP.1 = 192.168.1.100\n\n4. ä½¿ç”¨ CA ç­¾å‘æœåŠ¡å™¨è¯ä¹¦# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—openssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial ^  -days 365 -sha256 -extfile v3.ext -out server.crt\n\nç¬¬å››æ­¥ï¼šç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦å®¢æˆ·ç«¯è¯ä¹¦ç”¨äºå‘æœåŠ¡å™¨è¯æ˜å®¢æˆ·ç«¯çš„èº«ä»½ã€‚\n1. åˆ›å»ºå®¢æˆ·ç«¯ç§é’¥openssl genrsa -out client.key 2048\n\n2. åˆ›å»ºå®¢æˆ·ç«¯ CSRopenssl req -new -key client.key -out client.csr ^  -subj &quot;/C=CN/ST=Beijing/L=Beijing/O=MyOrg/CN=my_client_id&quot;\n\n3. åˆ›å»ºå®¢æˆ·ç«¯æ‰©å±•é…ç½®æ–‡ä»¶åˆ›å»ºæ–‡æœ¬æ–‡ä»¶ v3_client.extï¼Œå†…å®¹å¦‚ä¸‹ï¼š\nauthorityKeyIdentifier=keyid,issuerbasicConstraints=CA:FALSEkeyUsage = digitalSignatureextendedKeyUsage = clientAuth\n\n4. ä½¿ç”¨ CA ç­¾å‘å®¢æˆ·ç«¯è¯ä¹¦# OpenSSL mTLS Windows æŒ‡å—openssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial ^  -days 365 -sha256 -extfile v3_client.ext -out client.crt\n\nç¬¬äº”æ­¥ï¼šéªŒè¯ä¸æ‰“åŒ…1. éªŒè¯è¯ä¹¦é“¾# OpenSSL mTLS Windows æŒ‡å—openssl verify -CAfile ca.crt server.crt# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—openssl verify -CAfile ca.crt client.crt# OpenSSL mTLS Windows æŒ‡å—\n\n2. æ‰“åŒ…ä¸º PKCS#12 (.p12) æ ¼å¼ (å¯é€‰).p12 æ–‡ä»¶æ˜¯ä¸€ä¸ªåŠ å¯†çš„å®¹å™¨ï¼Œå¯ä»¥åŒæ—¶åŒ…å«è¯ä¹¦å’Œç§é’¥ï¼Œæ–¹ä¾¿åœ¨å„ç§åº”ç”¨ï¼ˆå¦‚æµè§ˆå™¨ã€Java KeyStoreï¼‰ä¸­å¯¼å…¥ã€‚\n# OpenSSL mTLS Windows æŒ‡å—echo Creating PKCS#12 file...openssl pkcs12 -export -out client.p12 -inkey client.key -in client.crt -certfile ca.crt ^  -name &quot;My Client Certificate&quot;# OpenSSL mTLS Windows æŒ‡å—openssl pkcs12 -info -in client.p12 -nodes# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—\n\né™„å½•Aï¼šWindows æ‰¹å¤„ç†è‡ªåŠ¨åŒ–è„šæœ¬å°†ä»¥ä¸‹å†…å®¹ä¿å­˜ä¸º generate_certs.batï¼ŒåŒå‡»è¿è¡Œæˆ–åœ¨å‘½ä»¤æç¤ºç¬¦ä¸­æ‰§è¡Œå³å¯ä¸€é”®ç”Ÿæˆæ‰€æœ‰è¯ä¹¦ã€‚\n@echo offsetlocal enabledelayedexpansionecho === Generating Mutual TLS Certificates on Windows ===:: --- Configuration ---set COUNTRY=CNset STATE=Beijingset CITY=Beijingset ORG=MyOrganizationset DOMAIN=your_domain.comset CERT_DAYS=365set KEY_SIZE=2048:: --- Clean up old files ---echo Cleaning up old certificate files...del /Q *.key *.crt *.csr *.p12 *.srl v3*.ext 2&gt;nul:: 1. Generate CA Certificateecho [1/4] Generating CA certificate...openssl genrsa -out ca.key %KEY_SIZE%openssl req -new -x509 -days 3650 -key ca.key -out ca.crt ^  -subj &quot;/C=%COUNTRY%/ST=%STATE%/L=%CITY%/O=%ORG% CA/CN=MyRootCA&quot;:: 2. Generate Server Certificateecho [2/4] Generating Server certificate...openssl genrsa -out server.key %KEY_SIZE%openssl req -new -key server.key -out server.csr ^  -subj &quot;/C=%COUNTRY%/ST=%STATE%/L=%CITY%/O=%ORG%/CN=server.%DOMAIN%&quot;:: Create server extension file(echo authorityKeyIdentifier=keyid,issuerecho basicConstraints=CA:FALSEecho keyUsage = digitalSignature, keyEnciphermentecho extendedKeyUsage = serverAuthecho subjectAltName = @alt_namesecho.echo [alt_names]echo DNS.1 = server.%DOMAIN%echo DNS.2 = localhostecho DNS.3 = api.%DOMAIN%echo IP.1 = 127.0.0.1) &gt; v3_server.extopenssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial ^  -days %CERT_DAYS% -sha256 -extfile v3_server.ext -out server.crt:: 3. Generate Client Certificateecho [3/4] Generating Client certificate...openssl genrsa -out client.key %KEY_SIZE%openssl req -new -key client.key -out client.csr ^  -subj &quot;/C=%COUNTRY%/ST=%STATE%/L=%CITY%/O=%ORG%/CN=client1&quot;:: Create client extension file(echo authorityKeyIdentifier=keyid,issuerecho basicConstraints=CA:FALSEecho keyUsage = digitalSignatureecho extendedKeyUsage = clientAuth) &gt; v3_client.extopenssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial ^  -days %CERT_DAYS% -sha256 -extfile v3_client.ext -out client.crt:: 4. Verify and Packageecho [4/4] Verifying and packaging certificates...openssl verify -CAfile ca.crt server.crtopenssl verify -CAfile ca.crt client.crtecho Creating PKCS#12 file...echo Please enter password when prompted:openssl pkcs12 -export -out client.p12 -inkey client.key -in client.crt -certfile ca.crt ^  -name &quot;MyClientCert&quot;:: --- Clean up temporary files ---echo Cleaning up temporary files...del /Q *.csr *.srl v3*.ext 2&gt;nulecho.echo === All certificates generated successfully! ===echo.echo Files created:echo   ca.key    - CA private key (KEEP SECRET!)echo   ca.crt    - CA certificateecho   server.key - Server private keyecho   server.crt - Server certificateecho   client.key - Client private keyecho   client.crt - Client certificateecho   client.p12 - PKCS#12 bundle (if created)echo.echo === Next Steps ===echo 1. Import client.p12 into Windows Certificate Store (double-click)echo 2. Export CA certificate (ca.crt) to trusted root CAsecho 3. Configure your web server (IIS/Nginx) for mTLSpause\n\né™„å½•Bï¼šåœ¨ IIS ä¸­é…ç½®åŒå‘è®¤è¯1. å¯¼å…¥æœåŠ¡å™¨è¯ä¹¦# OpenSSL mTLS Windows æŒ‡å—Import-Module WebAdministration# OpenSSL mTLS Windows æŒ‡å—$certPath = &quot;C:\\certs\\server.p12&quot;$certPassword = ConvertTo-SecureString -String &quot;YourPassword&quot; -Force -AsPlainTextImport-PfxCertificate -FilePath $certPath -CertStoreLocation Cert:\\LocalMachine\\My -Password $certPassword\n\n2. å°† CA è¯ä¹¦æ·»åŠ åˆ°å—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„# OpenSSL mTLS Windows æŒ‡å—certmgr.msc# OpenSSL mTLS Windows æŒ‡å—certutil -addstore &quot;Root&quot; &quot;C:\\certs\\ca.crt&quot;\n\n3. é…ç½® SSL è®¾ç½®# OpenSSL mTLS Windows æŒ‡å—Get-WebBinding -Name &quot;Default Web Site&quot; -Protocol &quot;https&quot; | Set-WebBindingProperty -Name &quot;sslFlags&quot; -Value &quot;Ssl, SslRequireCert&quot;\n\n4. é€šè¿‡ IIS ç®¡ç†å™¨é…ç½®\næ‰“å¼€ IIS ç®¡ç†å™¨\né€‰æ‹©æ‚¨çš„ç½‘ç«™\nåŒå‡» â€œSSL è®¾ç½®â€\nå‹¾é€‰ â€œè¦æ±‚ SSLâ€\nå‹¾é€‰ â€œè¦æ±‚å®¢æˆ·ç«¯è¯ä¹¦â€\né€‰æ‹© â€œæ¥å—â€ æˆ– â€œè¦æ±‚â€\n\né™„å½•Cï¼šåœ¨ Nginx for Windows ä¸­é…ç½®åŒå‘è®¤è¯åŸºç¡€é…ç½®ç¼–è¾‘ nginx.conf æ–‡ä»¶ï¼š\nserver &#123;    listen 443 ssl http2;    server_name server.your_domain.com;    # SSL è¯ä¹¦é…ç½®    ssl_certificate         C:/certs/server.crt;    ssl_certificate_key     C:/certs/server.key;    # mTLS é…ç½® - CA è¯ä¹¦ç”¨äºéªŒè¯å®¢æˆ·ç«¯    ssl_client_certificate  C:/certs/ca.crt;    ssl_verify_client       on;    ssl_verify_depth        2;    # SSL å®‰å…¨é…ç½®    ssl_protocols           TLSv1.2 TLSv1.3;    ssl_ciphers             ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384;    ssl_prefer_server_ciphers on;    location / &#123;        # è®¾ç½®å®¢æˆ·ç«¯è¯ä¹¦ä¿¡æ¯åˆ°ç¯å¢ƒå˜é‡        proxy_set_header X-SSL-Client-S-DN $ssl_client_s_dn;        proxy_set_header X-SSL-Client-Verify $ssl_client_verify;        proxy_set_header X-SSL-Client-Cert $ssl_client_cert;        # ä½ çš„åº”ç”¨é€»è¾‘        root   html;        index  index.html index.htm;    &#125;&#125;\n\né™„å½•Dï¼šç”Ÿæˆ DH å‚æ•° (å¯é€‰)Diffie-Hellman (DH) å‚æ•°ç”¨äºå¯†é’¥äº¤æ¢åè®®ï¼Œä»¥å®ç°**å®Œç¾å‰å‘ä¿å¯† (Perfect Forward Secrecy, PFS)**ã€‚\n# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—openssl dhparam -out dhparam.pem 2048# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—\n\né™„å½•Eï¼šå¸¸ç”¨ OpenSSL å‘½ä»¤Windows è¯ä¹¦ç®¡ç†å‘½ä»¤# OpenSSL mTLS Windows æŒ‡å—certmgr.msc# OpenSSL mTLS Windows æŒ‡å—certutil -store MY &gt; certificates.txt# OpenSSL mTLS Windows æŒ‡å—certutil -verify certificate.cer# OpenSSL mTLS Windows æŒ‡å—certutil -addstore &quot;Root&quot; ca.crtcertutil -addstore &quot;My&quot; server.crt\n\nOpenSSL å‘½ä»¤\næŸ¥çœ‹è¯ä¹¦å†…å®¹: openssl x509 -in mycert.crt -text -noout\næŸ¥çœ‹è¯ä¹¦æœ‰æ•ˆæœŸ: openssl x509 -in mycert.crt -dates -noout\næŸ¥çœ‹è¯ä¹¦åºåˆ—å·: openssl x509 -in mycert.crt -noout -serial\næŸ¥çœ‹è¯ä¹¦æŒ‡çº¹: openssl x509 -in mycert.crt -noout -fingerprint -sha256\næŸ¥çœ‹ç§é’¥å†…å®¹: openssl rsa -in mykey.key -text -noout\nç§»é™¤ç§é’¥å¯†ç : openssl rsa -in encrypted.key -out decrypted.key\nåŠ å¯†ç§é’¥: openssl rsa -in decrypted.key -aes256 -out encrypted.key\néªŒè¯è¯ä¹¦é“¾: openssl verify -CAfile ca.crt server.crt\néªŒè¯ç§é’¥ä¸è¯ä¹¦æ˜¯å¦åŒ¹é…:# æ–¹æ³•1ï¼šæ¯”è¾ƒæ¨¡æ•°openssl x509 -noout -modulus -in mycert.crt | openssl md5openssl rsa -noout -modulus -in mykey.key | openssl md5# ä¸¤ä¸ªå‘½ä»¤çš„è¾“å‡ºåº”å®Œå…¨ä¸€è‡´\n\nWindows ç‰¹å®šæ“ä½œ# OpenSSL mTLS Windows æŒ‡å—# OpenSSL mTLS Windows æŒ‡å—openssl x509 -outform der -in certificate.pem -out certificate.der# OpenSSL mTLS Windows æŒ‡å—openssl x509 -inform der -in certificate.der -out certificate.pem# OpenSSL mTLS Windows æŒ‡å—certutil -store MY &gt; my_certificates.txt# OpenSSL mTLS Windows æŒ‡å—openssl s_client -connect server.domain.com:443 -cert client.crt -key client.key\n\næ•…éšœæ’é™¤å¸¸è§é—®é¢˜\nOpenSSL å‘½ä»¤æœªæ‰¾åˆ°\n\nç¡®è®¤ OpenSSL å·²å®‰è£…\næ£€æŸ¥ PATH ç¯å¢ƒå˜é‡æ˜¯å¦åŒ…å« OpenSSL bin ç›®å½•\n\n\nè¯ä¹¦éªŒè¯å¤±è´¥\n\næ£€æŸ¥è¯ä¹¦æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®\nç¡®è®¤ CA è¯ä¹¦å·²æ­£ç¡®å¯¼å…¥åˆ°å—ä¿¡ä»»çš„æ ¹è¯ä¹¦å­˜å‚¨\n\n\nIIS é…ç½®é—®é¢˜\n\nç¡®è®¤æœåŠ¡å™¨è¯ä¹¦å·²æ­£ç¡®å®‰è£…\næ£€æŸ¥ SSL ç»‘å®šè®¾ç½®\n\n\næ‰¹å¤„ç†è„šæœ¬æ‰§è¡Œå¤±è´¥\n\nä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ\næ£€æŸ¥æ–‡ä»¶æƒé™\n\n\n\nè°ƒè¯•å‘½ä»¤# OpenSSL mTLS Windows æŒ‡å—openssl s_client -connect localhost:443 -showcerts# OpenSSL mTLS Windows æŒ‡å—openssl verify -CAfile ca.crt -untrusted intermediate.crt server.crt# OpenSSL mTLS Windows æŒ‡å—type C:\\nginx\\logs\\error.log","categories":["åç«¯æœåŠ¡æ¶æ„","å®‰å…¨ä¸è¯ä¹¦"],"tags":["Windows","OpenSSL","SSL","TLS","mTLS","åŒå‘è®¤è¯","CA","è¯ä¹¦","DH"]},{"title":"mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—","url":"/posts/cb45c274/","content":"mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—ğŸ“‘ ç›®å½•\nç”Ÿæˆ CA è¯ä¹¦\nç”Ÿæˆ æœåŠ¡å™¨è¯ä¹¦\nç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦\nè¯ä¹¦éªŒè¯æµ‹è¯•\næ–‡ä»¶è¯´æ˜\nå®‰å…¨æ³¨æ„äº‹é¡¹\nä½¿ç”¨åœºæ™¯\n\n\nç”Ÿæˆ CA è¯ä¹¦# mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—openssl genrsa -aes256 -out ca-key.pem 4096# mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—openssl genrsa -out ca-key.pem 4096# mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—openssl req -new -x509 -days 3650 -key ca-key.pem -out ca-crt.pem -sha256\n\nCA è¯ä¹¦ç”Ÿæˆæ³¨æ„äº‹é¡¹ï¼š\n\nCommon Name: è¾“å…¥ CA åç§°ï¼Œå¦‚ â€œMy-CAâ€\nOrganization: è¾“å…¥ç»„ç»‡åç§°\nCountry: è¾“å…¥å›½å®¶ä»£ç ï¼Œå¦‚ â€œCNâ€\næœ‰æ•ˆæœŸå»ºè®®è®¾ç½®ä¸º 10 å¹´ (3650 å¤©)\n\nç”ŸæˆæœåŠ¡å™¨è¯ä¹¦1. ç”ŸæˆæœåŠ¡å™¨ç§é’¥openssl genrsa -out server-key.pem 2048\n\n2. ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦ç­¾åè¯·æ±‚openssl req -new -sha256 -key server-key.pem -out server-csr.pem\n\nåœ¨æç¤ºè¾“å…¥ä¿¡æ¯æ—¶ï¼š\n\nCountry Name: ä¸ CA è¯ä¹¦ç›¸åŒ\nState or Province Name: çœä»½åç§°\nLocality Name: åŸå¸‚åç§°\nOrganization Name: æœåŠ¡å™¨æ‰€å±ç»„ç»‡\nOrganizational Unit Name: éƒ¨é—¨åç§°ï¼ˆå¯é€‰ï¼‰\nCommon Name: é‡è¦ï¼ å¿…é¡»å¡«å†™æœåŠ¡å™¨çš„åŸŸåæˆ– IP åœ°å€\nEmail Address: é‚®ç®±åœ°å€ï¼ˆå¯é€‰ï¼‰\n\n3. åˆ›å»ºæœåŠ¡å™¨è¯ä¹¦æ‰©å±•é…ç½®æ–‡ä»¶åˆ›å»º server_cert_ext.cnf æ–‡ä»¶ï¼š\n[server_cert]basicConstraints = critical, CA:FALSEkeyUsage = critical, digitalSignature, keyEnciphermentextendedKeyUsage = serverAuthsubjectKeyIdentifier = hashauthorityKeyIdentifier = keyid,issuersubjectAltName = @alt_names[alt_names]DNS.1 = localhostDNS.2 = your-domain.comIP.1 = 127.0.0.1IP.2 = your-server-ip\n\n4. ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦openssl x509 -req -in server-csr.pem -CA ca-crt.pem -CAkey ca-key.pem -CAcreateserial -out server-crt.pem -days 365 -sha256 -extfile server_cert_ext.cnf -extensions server_cert# mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—openssl verify -CAfile ca-crt.pem server-crt.pem\n\n5. æŸ¥çœ‹è¯ä¹¦è¯¦æƒ…openssl x509 -in server-crt.pem -text -noout -purpose\n\nç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦1. ç”Ÿæˆå®¢æˆ·ç«¯ç§é’¥openssl genrsa -out client-key.pem 2048\n\n2. ç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦ç­¾åè¯·æ±‚openssl req -new -sha256 -key client-key.pem -out client-csr.pem\n\nåœ¨æç¤ºè¾“å…¥ä¿¡æ¯æ—¶ï¼š\n\nCountry Name: ä¸ CA è¯ä¹¦ç›¸åŒ\nState or Province Name: çœä»½åç§°\nLocality Name: åŸå¸‚åç§°\nOrganization Name: å®¢æˆ·ç«¯æ‰€å±ç»„ç»‡\nOrganizational Unit Name: éƒ¨é—¨åç§°ï¼ˆå¯é€‰ï¼‰\nCommon Name: å®¢æˆ·ç«¯æ ‡è¯†åç§°ï¼ˆç”¨äºåŒºåˆ†ä¸åŒå®¢æˆ·ç«¯ï¼‰\nEmail Address: é‚®ç®±åœ°å€ï¼ˆå¯é€‰ï¼‰\n\n3. åˆ›å»ºå®¢æˆ·ç«¯è¯ä¹¦æ‰©å±•é…ç½®æ–‡ä»¶åˆ›å»º client_cert_ext.cnf æ–‡ä»¶ï¼š\n[client_cert]basicConstraints = critical, CA:FALSEkeyUsage = critical, digitalSignature, keyEnciphermentextendedKeyUsage = clientAuthsubjectKeyIdentifier = hashauthorityKeyIdentifier = keyid,issuersubjectAltName = @alt_names[alt_names]DNS.1 = clientDNS.2 = localhost\n\n4. ç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦openssl x509 -req -in client-csr.pem -CA ca-crt.pem -CAkey ca-key.pem -CAcreateserial -out client-crt.pem -days 365 -sha256 -extfile client_cert_ext.cnf -extensions client_cert# mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—openssl verify -CAfile ca-crt.pem client-crt.pem\n\n5. æŸ¥çœ‹è¯ä¹¦è¯¦æƒ…openssl x509 -in client-crt.pem -text -noout -purpose\n\nè¯ä¹¦éªŒè¯æµ‹è¯•# mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—openssl s_server -cert server-crt.pem -key server-key.pem -CAfile ca-crt.pem -Verify 1 -port 8443# mTLS è¯ä¹¦ç”ŸæˆæŒ‡å—openssl s_client -connect localhost:8443 -cert client-crt.pem -key client-key.pem -CAfile ca-crt.pem\n\næ–‡ä»¶è¯´æ˜\nca-key.pem: CA ç§é’¥ï¼ˆå¦¥å–„ä¿ç®¡ï¼‰\nca-crt.pem: CA æ ¹è¯ä¹¦ï¼ˆå®¢æˆ·ç«¯éœ€è¦ä¿¡ä»»æ­¤è¯ä¹¦ï¼‰\nca.srl: CA åºåˆ—å·æ–‡ä»¶\nserver-key.pem: æœåŠ¡å™¨ç§é’¥\nserver-csr.pem: æœåŠ¡å™¨è¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆå¯åˆ é™¤ï¼‰\nserver-crt.pem: æœåŠ¡å™¨è¯ä¹¦\nclient-key.pem: å®¢æˆ·ç«¯ç§é’¥\nclient-csr.pem: å®¢æˆ·ç«¯è¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆå¯åˆ é™¤ï¼‰\nclient-crt.pem: å®¢æˆ·ç«¯è¯ä¹¦\n\nå®‰å…¨æ³¨æ„äº‹é¡¹\nç§é’¥ä¿æŠ¤: æ‰€æœ‰ .pem ç§é’¥æ–‡ä»¶å¿…é¡»ä¸¥æ ¼ä¿æŠ¤ï¼Œä¸è¦æ³„éœ²\nè¯ä¹¦æœ‰æ•ˆæœŸ: å®šæœŸæ£€æŸ¥å’Œæ›´æ–°å³å°†è¿‡æœŸçš„è¯ä¹¦\nCommon Name: æœåŠ¡å™¨è¯ä¹¦çš„ Common Name å¿…é¡»ä¸å®é™…è®¿é—®çš„åŸŸååŒ¹é…\nSAN æ‰©å±•: ç°ä»£æµè§ˆå™¨è¦æ±‚ä½¿ç”¨ SAN (Subject Alternative Name) è€Œä¸æ˜¯ CN\nå¯†ç ä¿æŠ¤: ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®ä¸ºç§é’¥è®¾ç½®å¯†ç ä¿æŠ¤\n\nä½¿ç”¨åœºæ™¯\næœåŠ¡å™¨ç«¯: é…ç½® web æœåŠ¡å™¨ï¼ˆNginxã€Apache ç­‰ï¼‰ä½¿ç”¨ server-crt.pem å’Œ server-key.pem\nå®¢æˆ·ç«¯: é…ç½®åº”ç”¨ç¨‹åºä½¿ç”¨ client-crt.pem å’Œ client-key.pem è¿›è¡ŒåŒå‘è®¤è¯\nä¿¡ä»»é“¾: å®¢æˆ·ç«¯éœ€è¦å°† ca-crt.pem æ·»åŠ åˆ°ä¿¡ä»»è¯ä¹¦å­˜å‚¨ä¸­\n\n","categories":["Webæ¶æ„å®‰å…¨"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Apache Ubuntu åå‘ä»£ç†æŒ‡å—","url":"/posts/d0dcdb61/","content":"Apache Ubuntu åå‘ä»£ç†æŒ‡å—ç›®å½•\nç¬¬ä¸€æ­¥ï¼šå®‰è£… Apache\nç¬¬äºŒæ­¥ï¼šè®¾ç½®è™šæ‹Ÿä¸»æœº (Virtual Host)\nç¬¬ä¸‰æ­¥ï¼šé…ç½®åå‘ä»£ç†\nç¬¬å››æ­¥ï¼šä½¿ç”¨ Certbot é…ç½® HTTPS\né™„å½•ï¼šæ€§èƒ½ä¸å®‰å…¨ä¼˜åŒ–\nå¸¸è§é—®é¢˜\n\nç¬¬ä¸€æ­¥ï¼šå®‰è£… Apache# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo apt update# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo apt install apache2# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo ufw allow &#x27;Apache Full&#x27;# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo systemctl status apache2\nå®‰è£…å®Œæˆåï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® http://&lt;ä½ çš„æœåŠ¡å™¨IP&gt;ï¼Œåº”èƒ½çœ‹åˆ° Apache çš„é»˜è®¤æ¬¢è¿é¡µé¢ã€‚\nç¬¬äºŒæ­¥ï¼šè®¾ç½®è™šæ‹Ÿä¸»æœº (Virtual Host)è™šæ‹Ÿä¸»æœºå…è®¸ä½ åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šæ‰˜ç®¡å¤šä¸ªç½‘ç«™ã€‚\n# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo mkdir -p /var/www/your_domain.com/htmlsudo chown -R $USER:$USER /var/www/your_domain.com# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo nano /etc/apache2/sites-available/your_domain.com.conf\n\nå°†ä»¥ä¸‹åŸºç¡€é…ç½®ç²˜è´´è¿›å»ã€‚è¿™ä¼šå‘Šè¯‰ Apache åœ¨å“ªé‡Œæ‰¾åˆ°ç½‘ç«™æ–‡ä»¶ï¼Œå¹¶è®¾ç½®åŸŸåã€‚\n&lt;VirtualHost *:80&gt;    ServerAdmin webmaster@localhost    ServerName your_domain.com    ServerAlias www.your_domain.com    DocumentRoot /var/www/your_domain.com/html    ErrorLog $&#123;APACHE_LOG_DIR&#125;/error.log    CustomLog $&#123;APACHE_LOG_DIR&#125;/access.log combined&lt;/VirtualHost&gt;\n\n# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo a2ensite your_domain.com.confsudo a2enmod rewrite# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo apache2ctl configtest# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo systemctl restart apache2\n\nç¬¬ä¸‰æ­¥ï¼šé…ç½®åå‘ä»£ç†åå‘ä»£ç†å…è®¸ Apache æ¥æ”¶è¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘åˆ°åç«¯çš„å¦ä¸€ä¸ªæœåŠ¡ï¼ˆä¾‹å¦‚ä¸€ä¸ª Node.js æˆ– Java åº”ç”¨ï¼‰ã€‚\n# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo a2enmod proxysudo a2enmod proxy_httpsudo a2enmod proxy_balancersudo a2enmod lbmethod_byrequests# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo systemctl restart apache2\n\nç°åœ¨ï¼Œç¼–è¾‘ä½ çš„ç«™ç‚¹é…ç½®æ–‡ä»¶ sudo nano /etc/apache2/sites-available/your_domain.com.confï¼Œå¹¶ä¿®æ”¹å®ƒä»¥åŒ…å« ProxyPassã€‚\n&lt;VirtualHost *:80&gt;    ServerName your_domain.com    ServerAlias www.your_domain.com    # å°†æ‰€æœ‰è¯·æ±‚è½¬å‘åˆ°è¿è¡Œåœ¨ 8080 ç«¯å£çš„åç«¯åº”ç”¨    ProxyPreserveHost On    ProxyPass / http://127.0.0.1:8080/    ProxyPassReverse / http://127.0.0.1:8080/&lt;/VirtualHost&gt;\nå†æ¬¡é‡å¯ Apache åï¼Œæ‰€æœ‰åˆ° your_domain.com çš„è¯·æ±‚éƒ½ä¼šè¢«è½¬å‘åˆ° localhost:8080ã€‚\nç¬¬å››æ­¥ï¼šä½¿ç”¨ Certbot é…ç½® HTTPSLetâ€™s Encrypt æä¾›å…è´¹çš„ SSL è¯ä¹¦ï¼Œcertbot æ˜¯å…¶å®˜æ–¹æ¨èçš„å®¢æˆ·ç«¯ã€‚\n# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo apt install certbot python3-certbot-apache# Apache Ubuntu åå‘ä»£ç†æŒ‡å—# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo certbot --apache -d your_domain.com -d www.your_domain.com\nåœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼ŒCertbot ä¼šè¯¢é—®ä½ æ˜¯å¦è¦å°†æ‰€æœ‰ HTTP è¯·æ±‚è‡ªåŠ¨é‡å®šå‘åˆ° HTTPSï¼Œæ¨èé€‰æ‹©â€œRedirectâ€ã€‚\nå®Œæˆåï¼Œä½ çš„é…ç½®æ–‡ä»¶ä¼šè¢«è‡ªåŠ¨æ›´æ–°ï¼Œç±»ä¼¼äºï¼š\n&lt;VirtualHost *:443&gt;    ServerName your_domain.com    # ... å…¶ä»–é…ç½® ...    SSLEngine on    SSLCertificateFile /etc/letsencrypt/live/your_domain.com/fullchain.pem    SSLCertificateKeyFile /etc/letsencrypt/live/your_domain.com/privkey.pem    # --- SSL/TLS å®‰å…¨å¢å¼ºé…ç½® ---    # æ¨èåªä½¿ç”¨ TLS 1.2 å’Œ 1.3ï¼Œç¦ç”¨è¿‡æ—¶çš„ã€ä¸å®‰å…¨çš„åè®®    SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1    # ä¸€ä¸ªç°ä»£ä¸”å®‰å…¨çš„åŠ å¯†å¥—ä»¶åˆ—è¡¨    SSLCipherSuite ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256    SSLHonorCipherOrder on    # ... åå‘ä»£ç†é…ç½® ...    ProxyPass / http://127.0.0.1:8080/    ProxyPassReverse / http://127.0.0.1:8080/&lt;/VirtualHost&gt;&lt;VirtualHost *:80&gt;    # ... Certbot è‡ªåŠ¨ç”Ÿæˆçš„é‡å®šå‘åˆ° HTTPS çš„é…ç½® ...&lt;/VirtualHost&gt;\n\né™„å½•ï¼šæ€§èƒ½ä¸å®‰å…¨ä¼˜åŒ–å¯ç”¨ Gzip&#x2F;Deflate å‹ç¼©# Apache Ubuntu åå‘ä»£ç†æŒ‡å—sudo a2enmod deflatesudo systemctl restart apache2\nåœ¨ /etc/apache2/apache2.conf ä¸­æ·»åŠ é…ç½®ï¼š\n&lt;IfModule mod_deflate.c&gt;    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript&lt;/IfModule&gt;\n\næ·»åŠ å®‰å…¨å¤´åœ¨ä½ çš„ HTTPS (*:443) VirtualHost é…ç½®ä¸­æ·»åŠ ï¼š\n&lt;IfModule mod_headers.c&gt;    # HSTS (HTTP Strict Transport Security): å¼ºåˆ¶å®¢æˆ·ç«¯åœ¨æŒ‡å®šæ—¶é—´å†…åªèƒ½é€šè¿‡ HTTPS è®¿é—®    Header always set Strict-Transport-Security &quot;max-age=15768000; includeSubDomains&quot;    # X-Frame-Options: é˜²æ­¢ç‚¹å‡»åŠ«æŒæ”»å‡»    Header always set X-Frame-Options &quot;SAMEORIGIN&quot;    # X-Content-Type-Options: é˜²æ­¢ MIME ç±»å‹å—…æ¢æ”»å‡»    Header always set X-Content-Type-Options &quot;nosniff&quot;&lt;/IfModule&gt;\n\néšè—æœåŠ¡å™¨ä¿¡æ¯åœ¨ /etc/apache2/conf-enabled/security.conf ä¸­ï¼Œç¡®ä¿è®¾ç½®ä¸ºï¼š\nServerTokens ProdServerSignature Off\n\nå¸¸è§é—®é¢˜Q: 503 Service Unavailable é”™è¯¯?A: è¿™é€šå¸¸æ„å‘³ç€ Apache æ— æ³•è¿æ¥åˆ°ä½ çš„åç«¯åº”ç”¨ï¼Œä½†ä»£ç†æ¨¡å—å·²å¯ç”¨ã€‚è¯·æ£€æŸ¥ï¼š\n\nä½ çš„åç«¯åº”ç”¨æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚\nProxyPass æŒ‡ä»¤ä¸­çš„åœ°å€å’Œç«¯å£æ˜¯å¦æ­£ç¡®ã€‚\n\nQ: é‡å¯ Apache å¤±è´¥?A: è¿è¡Œ sudo apache2ctl configtest æ¥æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è¯­æ³•é”™è¯¯ã€‚å¸¸è§çš„é”™è¯¯åŒ…æ‹¬æ¨¡å—æœªå¯ç”¨ï¼ˆå¦‚ proxy_httpï¼‰æˆ–æ‹¼å†™é”™è¯¯ã€‚\n","categories":["åç«¯æœåŠ¡æ¶æ„","WebæœåŠ¡å™¨é…ç½®"],"tags":["Ubuntu","SSL","Apache","HTTPD","åå‘ä»£ç†","HTTPS","Let's Encrypt"]},{"title":"Web è®¤è¯æ–¹æ³•æŒ‡å—","url":"/posts/f2ed900f/","content":"Web è®¤è¯æ–¹æ³•æŒ‡å—\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: web, authentication, authorization, security, session, jwt, oauth\n\nğŸ“‘ ç›®å½•\n1. æ ¸å¿ƒæ¦‚å¿µ\n1.1 è®¤è¯ vs. æˆæƒ\n\n\n2. Session-Cookie è®¤è¯\n2.1 å·¥ä½œåŸç†\n2.2 å®ç°ç¤ºä¾‹\n2.3 ä¼˜ç¼ºç‚¹\n\n\n3. Token è®¤è¯ï¼ˆJWTï¼‰\n3.1 å·¥ä½œåŸç†\n3.2 å®ç°ç¤ºä¾‹\n3.3 ä¼˜ç¼ºç‚¹\n\n\n4. OAuth è®¤è¯\n4.1 è®¤è¯æµç¨‹\n4.2 å®ç°ç¤ºä¾‹\n\n\n5. æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰æ‹©\n5.1 å¯¹æ¯”è¡¨\n5.2 ä½¿ç”¨åœºæ™¯\n\n\n\n\n1. æ ¸å¿ƒæ¦‚å¿µ1.1 ğŸ” è®¤è¯ vs. æˆæƒ\n\n\næ¦‚å¿µ\né—®é¢˜\nè§£å†³æ–¹æ¡ˆ\nç¤ºä¾‹\n\n\n\nè®¤è¯\nâ€œä½ æ˜¯è°ï¼Ÿâ€\néªŒè¯ç”¨æˆ·èº«ä»½\nç”¨æˆ·åå¯†ç ç™»å½•\n\n\næˆæƒ\nâ€œä½ èƒ½åšä»€ä¹ˆï¼Ÿâ€\néªŒè¯ç”¨æˆ·æƒé™\næ˜¯å¦å…è®¸åˆ é™¤æ–‡ç« \n\n\ngraph LR    A[ç”¨æˆ·] --&gt; B[è®¤è¯ Authentication]    B --&gt; C[ä½ æ˜¯è°ï¼Ÿ]    B --&gt; D[èº«ä»½éªŒè¯]    D --&gt; E[æˆæƒ Authorization]    E --&gt; F[ä½ èƒ½åšä»€ä¹ˆï¼Ÿ]    E --&gt; G[æƒé™æ£€æŸ¥]\n\n\n2. Session-Cookie è®¤è¯è¿™æ˜¯æœ€ä¼ ç»Ÿã€æœ€æ˜“äºç†è§£çš„è®¤è¯æ–¹å¼ã€‚å®ƒä¾èµ–äºæœåŠ¡å™¨ç«¯çš„ Session å­˜å‚¨å’Œå®¢æˆ·ç«¯çš„ Cookieã€‚\n2.1 âš™ï¸ å·¥ä½œåŸç†sequenceDiagram    participant U as User    participant B as Browser    participant S as Server    participant DB as Session Store    U-&gt;&gt;B: è¾“å…¥ç”¨æˆ·åå¯†ç     B-&gt;&gt;S: POST /login    S-&gt;&gt;DB: éªŒè¯ç”¨æˆ·å‡­æ®    DB--&gt;&gt;S: è¿”å›ç”¨æˆ·ä¿¡æ¯    S-&gt;&gt;DB: åˆ›å»ºSession    DB--&gt;&gt;S: è¿”å›Session ID    S--&gt;&gt;B: Set-Cookie: session_id    B-&gt;&gt;S: GET /protected (Cookie)    S-&gt;&gt;DB: éªŒè¯Session ID    DB--&gt;&gt;S: è¿”å›Sessionæ•°æ®    S--&gt;&gt;B: è¿”å›å—ä¿æŠ¤å†…å®¹\n\nå·¥ä½œæµç¨‹ï¼š\n\nç”¨æˆ·ç™»å½•ï¼ŒæœåŠ¡å™¨éªŒè¯ç”¨æˆ·åå’Œå¯†ç \néªŒè¯é€šè¿‡åï¼ŒæœåŠ¡å™¨åœ¨å†…å­˜æˆ–æ•°æ®åº“ä¸­åˆ›å»ºå”¯ä¸€çš„ Session è®°å½•\næœåŠ¡å™¨é€šè¿‡ Set-Cookie å°† Session ID è¿”å›ç»™æµè§ˆå™¨\næµè§ˆå™¨åç»­è¯·æ±‚è‡ªåŠ¨é€šè¿‡ Cookie æºå¸¦ Session ID\næœåŠ¡å™¨éªŒè¯ Session ID ç¡®è®¤ç”¨æˆ·èº«ä»½\n\n2.2 ğŸ’» å®ç°ç¤ºä¾‹const express = require(&#x27;express&#x27;);const session = require(&#x27;express-session&#x27;);const app = express();// é…ç½® session ä¸­é—´ä»¶app.use(session(&#123;  secret: &#x27;your_secret_key&#x27;, // ç”¨äºåŠ å¯† session ID çš„å¯†é’¥ï¼Œéå¸¸é‡è¦  resave: false,  saveUninitialized: false,  cookie: &#123;    secure: false, // ç”Ÿäº§ç¯å¢ƒåº”è®¾ä¸º true (ä»… HTTPS)    maxAge: 60000, // 1åˆ†é’Ÿ    httpOnly: true // é˜²æ­¢ XSS æ”»å‡»  &#125;&#125;));// ç™»å½•è·¯ç”±app.post(&#x27;/login&#x27;, express.json(), (req, res) =&gt; &#123;  const &#123; username, password &#125; = req.body;  // 1. éªŒè¯ç”¨æˆ·åå’Œå¯†ç  (è¿™é‡Œåº”ä¸ºæ•°æ®åº“æŸ¥è¯¢å’Œå¯†ç æ¯”å¯¹)  if (username === &#x27;admin&#x27; &amp;&amp; password === &#x27;123456&#x27;) &#123;    // 2. è®¤è¯æˆåŠŸï¼Œå°†ç”¨æˆ·ä¿¡æ¯å­˜å…¥ session    req.session.isLoggedIn = true;    req.session.user = &#123;      username: username,      loginTime: new Date()    &#125;;    res.json(&#123; message: &#x27;ç™»å½•æˆåŠŸï¼&#x27; &#125;);  &#125; else &#123;    res.status(401).json(&#123; error: &#x27;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#x27; &#125;);  &#125;&#125;);// å—ä¿æŠ¤çš„è·¯ç”±ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®app.get(&#x27;/profile&#x27;, (req, res) =&gt; &#123;  // 3. æ£€æŸ¥ session ä¸­æ˜¯å¦å­˜åœ¨ç”¨æˆ·ä¿¡æ¯  if (req.session.isLoggedIn) &#123;    res.json(&#123;      message: `æ¬¢è¿å›æ¥, $&#123;req.session.user.username&#125;`,      loginTime: req.session.user.loginTime    &#125;);  &#125; else &#123;    res.status(401).json(&#123; error: &#x27;è¯·å…ˆç™»å½•ï¼&#x27; &#125;);  &#125;&#125;);// ç™»å‡ºè·¯ç”±app.post(&#x27;/logout&#x27;, (req, res) =&gt; &#123;  // 4. é”€æ¯ session  req.session.destroy((err) =&gt; &#123;    if (err) &#123;      return res.status(500).json(&#123; error: &#x27;ç™»å‡ºå¤±è´¥&#x27; &#125;);    &#125;    res.clearCookie(&#x27;connect.sid&#x27;); // æ¸…é™¤ Cookie    res.json(&#123; message: &#x27;å·²ç™»å‡º&#x27; &#125;);  &#125;);&#125;);app.listen(3000);\n\n2.3 âœ… ä¼˜ç¼ºç‚¹\n\n\nä¼˜ç‚¹\nç¼ºç‚¹\n\n\n\nâœ… æŠ€æœ¯æˆç†Ÿï¼Œæ˜“äºç†è§£\nâŒ åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­éœ€è¦å…±äº« Session å­˜å‚¨\n\n\nâœ… æ˜“äºæ§åˆ¶ï¼ˆæœåŠ¡ç«¯å¯å¼ºåˆ¶å¤±æ•ˆï¼‰\nâŒ ä¾èµ– Cookieï¼Œè·¨åŸŸåœºæ™¯å¤æ‚\n\n\nâœ… å®‰å…¨æ€§è¾ƒé«˜ï¼ˆhttpOnly Cookieï¼‰\nâŒ å ç”¨æœåŠ¡å™¨å­˜å‚¨èµ„æº\n\n\nâœ… é€‚åˆä¼ ç»Ÿçš„æœåŠ¡å™¨ç«¯æ¸²æŸ“åº”ç”¨\nâŒ CSRF æ”»å‡»é£é™©\n\n\n\n3. Token è®¤è¯ï¼ˆJWTï¼‰è¿™æ˜¯ä¸€ç§æ— çŠ¶æ€çš„è®¤è¯æ–¹å¼ã€‚æœåŠ¡å™¨ä¸å†å­˜å‚¨ä¼šè¯ä¿¡æ¯ï¼Œè€Œæ˜¯å°†æ‰€æœ‰è®¤è¯ä¿¡æ¯åŠ å¯†åå½¢æˆä¸€ä¸ªä»¤ç‰Œï¼ˆTokenï¼‰ã€‚\n3.1 âš™ï¸ å·¥ä½œåŸç†sequenceDiagram    participant U as User    participant C as Client    participant S as Server    U-&gt;&gt;C: è¾“å…¥ç”¨æˆ·åå¯†ç     C-&gt;&gt;S: POST /login    S-&gt;&gt;S: éªŒè¯ç”¨æˆ·å‡­æ®    S-&gt;&gt;S: ç”ŸæˆJWT Token    S--&gt;&gt;C: è¿”å›JWT Token    C-&gt;&gt;C: å­˜å‚¨ Token (localStorage)    Note over C,S: åç»­è¯·æ±‚    C-&gt;&gt;S: GET /api/data&lt;br/&gt;Authorization: Bearer &lt;token&gt;    S-&gt;&gt;S: éªŒè¯ Token ç­¾å    S--&gt;&gt;C: è¿”å›æ•°æ®\n\nJWT ç»“æ„ï¼š\nHeader.Payload.Signatureä¾‹å¦‚ï¼šeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6InVzZXIiLCJpYXQiOjE2MzU2Nzg5MDJ9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\n\n3.2 ğŸ’» å®ç°ç¤ºä¾‹const express = require(&#x27;express&#x27;);const jwt = require(&#x27;jsonwebtoken&#x27;);const app = express();const SECRET_KEY = &#x27;your_super_secret_jwt_key&#x27;; // å¿…é¡»éå¸¸å¤æ‚ï¼Œä¸”å¦¥å–„ä¿ç®¡// ç™»å½•è·¯ç”±ï¼Œé¢å‘ Tokenapp.post(&#x27;/login&#x27;, express.json(), (req, res) =&gt; &#123;  const &#123; username, password &#125; = req.body;  // 1. éªŒè¯ç”¨æˆ·åå’Œå¯†ç   if (username === &#x27;admin&#x27; &amp;&amp; password === &#x27;123456&#x27;) &#123;    // 2. è®¤è¯æˆåŠŸï¼Œç”Ÿæˆ JWT    const token = jwt.sign(      &#123;        username: username,        role: &#x27;user&#x27;,        iat: Math.floor(Date.now() / 1000) // ç­¾å‘æ—¶é—´      &#125;, // Payload (æœ‰æ•ˆè½½è·)ï¼Œå­˜æ”¾ç”¨æˆ·ä¿¡æ¯      SECRET_KEY,      &#123; expiresIn: &#x27;1h&#x27; &#125; // Token æœ‰æ•ˆæœŸ 1 å°æ—¶    );    res.json(&#123;      message: &#x27;ç™»å½•æˆåŠŸï¼&#x27;,      token: token,      expiresIn: &#x27;1h&#x27;    &#125;);  &#125; else &#123;    res.status(401).json(&#123; error: &#x27;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&#x27; &#125;);  &#125;&#125;);// ä¸­é—´ä»¶ï¼šéªŒè¯ Tokenconst authenticateJWT = (req, res, next) =&gt; &#123;  const authHeader = req.headers.authorization;  if (authHeader) &#123;    const token = authHeader.split(&#x27; &#x27;)[1]; // æ ¼å¼ï¼šBearer &lt;token&gt;    // 3. éªŒè¯ Token    jwt.verify(token, SECRET_KEY, (err, decoded) =&gt; &#123;      if (err) &#123;        return res.status(403).json(&#123;          error: &#x27;Token æ— æ•ˆæˆ–è¿‡æœŸ&#x27;,          details: err.message        &#125;);      &#125;      req.user = decoded; // å°†è§£ç å‡ºçš„ç”¨æˆ·ä¿¡æ¯æŒ‚è½½åˆ° req å¯¹è±¡ä¸Š      next(); // éªŒè¯é€šè¿‡ï¼Œç»§ç»­åç»­å¤„ç†    &#125;);  &#125; else &#123;    res.status(401).json(&#123; error: &#x27;è¯·æ±‚å¤´ä¸­æ²¡æœ‰ Token&#x27; &#125;);  &#125;&#125;;// å—ä¿æŠ¤çš„è·¯ç”±ï¼Œéœ€è¦æœ‰æ•ˆçš„ Token æ‰èƒ½è®¿é—®app.get(&#x27;/profile&#x27;, authenticateJWT, (req, res) =&gt; &#123;  res.json(&#123;    message: `æ¬¢è¿å›æ¥, $&#123;req.user.username&#125;`,    role: req.user.role,    tokenInfo: &#123;      issuedAt: new Date(req.user.iat * 1000),      // æ³¨æ„ï¼šå®é™…åº”ç”¨ä¸­åº”è¯¥ä»å…¶ä»–åœ°æ–¹è·å–è¿‡æœŸæ—¶é—´    &#125;  &#125;);&#125;);// Token åˆ·æ–°è·¯ç”±app.post(&#x27;/refresh&#x27;, express.json(), (req, res) =&gt; &#123;  const &#123; token &#125; = req.body;  if (!token) &#123;    return res.status(401).json(&#123; error: &#x27;éœ€è¦æä¾› Token&#x27; &#125;);  &#125;  try &#123;    const decoded = jwt.verify(token, SECRET_KEY, &#123; ignoreExpiration: true &#125;);    // æ£€æŸ¥æ˜¯å¦åœ¨åˆ·æ–°çª—å£æœŸå†…ï¼ˆä¾‹å¦‚ï¼šè¿‡æœŸå15åˆ†é’Ÿå†…ï¼‰    const now = Math.floor(Date.now() / 1000);    const isWithinRefreshWindow = (now - decoded.exp) &lt; 900; // 15åˆ†é’Ÿ    if (!isWithinRefreshWindow) &#123;      return res.status(403).json(&#123; error: &#x27;Token è¿‡æœŸå¤ªä¹…ï¼Œè¯·é‡æ–°ç™»å½•&#x27; &#125;);    &#125;    // ç”Ÿæˆæ–°çš„ Token    const newToken = jwt.sign(      &#123; username: decoded.username, role: decoded.role &#125;,      SECRET_KEY,      &#123; expiresIn: &#x27;1h&#x27; &#125;    );    res.json(&#123; token: newToken &#125;);  &#125; catch (error) &#123;    res.status(403).json(&#123; error: &#x27;æ— æ•ˆçš„ Token&#x27; &#125;);  &#125;&#125;);app.listen(3000);\n\n3.3 âœ… ä¼˜ç¼ºç‚¹\n\n\nä¼˜ç‚¹\nç¼ºç‚¹\n\n\n\nâœ… æ— çŠ¶æ€ï¼Œæ˜“äºæ‰©å±•\nâŒ Token ä¸€æ—¦ç­¾å‘ï¼Œåœ¨æœ‰æ•ˆæœŸå†…æ— æ³•å¼ºåˆ¶å¤±æ•ˆ\n\n\nâœ… å¤©ç„¶æ”¯æŒè·¨åŸŸ\nâŒ Token ç®¡ç†æ›´å¤æ‚ï¼ˆå¦‚å¤±æ•ˆé—®é¢˜ï¼‰\n\n\nâœ… é€‚åˆåˆ†å¸ƒå¼&#x2F;API æœåŠ¡\nâŒ å­˜å‚¨ Token çš„å®‰å…¨æ€§é—®é¢˜\n\n\nâœ… å‡å°‘æœåŠ¡å™¨å­˜å‚¨å‹åŠ›\nâŒ éœ€è¦å¤„ç† Token åˆ·æ–°æœºåˆ¶\n\n\n\n4. OAuth è®¤è¯OAuth 2.0 æ˜¯ä¸€ä¸ªæˆæƒæ¡†æ¶ï¼Œå®ƒå…è®¸ç”¨æˆ·æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®ä»–ä»¬å­˜å‚¨åœ¨å¦ä¸€å°æœåŠ¡æä¾›å•†ä¸Šçš„ä¿¡æ¯ï¼Œè€Œæ— éœ€å°†ç”¨æˆ·åå’Œå¯†ç æä¾›ç»™ç¬¬ä¸‰æ–¹åº”ç”¨ã€‚\n4.1 ğŸ”„ è®¤è¯æµç¨‹sequenceDiagram    participant U as User    participant C as Client App    participant A as Auth Server    participant R as Resource Server    U-&gt;&gt;C: ç‚¹å‡»&quot;ä½¿ç”¨GitHubç™»å½•&quot;    C-&gt;&gt;A: é‡å®šå‘åˆ°æˆæƒé¡µé¢    U-&gt;&gt;A: ç™»å½•å¹¶æˆæƒ    A-&gt;&gt;C: é‡å®šå‘å›è°ƒ + æˆæƒç     C-&gt;&gt;A: ç”¨æˆæƒç äº¤æ¢è®¿é—®ä»¤ç‰Œ    A-&gt;&gt;C: è¿”å›è®¿é—®ä»¤ç‰Œ    C-&gt;&gt;R: ç”¨è®¿é—®ä»¤ç‰Œè¯·æ±‚ç”¨æˆ·èµ„æº    R-&gt;&gt;A: éªŒè¯è®¿é—®ä»¤ç‰Œ    A--&gt;&gt;R: ä»¤ç‰Œæœ‰æ•ˆ    R--&gt;&gt;C: è¿”å›ç”¨æˆ·èµ„æº\n\n4.2 ğŸ’» å®ç°ç¤ºä¾‹const express = require(&#x27;express&#x27;);const axios = require(&#x27;axios&#x27;);const querystring = require(&#x27;querystring&#x27;);const app = express();// GitHub OAuth é…ç½®const GITHUB_CLIENT_ID = &#x27;your_github_client_id&#x27;;const GITHUB_CLIENT_SECRET = &#x27;your_github_client_secret&#x27;;const REDIRECT_URI = &#x27;http://localhost:3000/auth/github/callback&#x27;;// 1. é‡å®šå‘ç”¨æˆ·åˆ° GitHubapp.get(&#x27;/auth/github&#x27;, (req, res) =&gt; &#123;  const params = querystring.stringify(&#123;    client_id: GITHUB_CLIENT_ID,    redirect_uri: REDIRECT_URI,    scope: &#x27;user:email&#x27;, // è¯·æ±‚çš„æƒé™èŒƒå›´    state: Math.random().toString(36).substring(7) // CSRF ä¿æŠ¤  &#125;);  const githubAuthUrl = `https://github.com/login/oauth/authorize?$&#123;params&#125;`;  res.redirect(githubAuthUrl);&#125;);// 2. GitHub å›è°ƒåœ°å€app.get(&#x27;/auth/github/callback&#x27;, async (req, res) =&gt; &#123;  const &#123; code, state &#125; = req.query;  try &#123;    // 3. ç”¨ code æ¢å– access_token    const tokenResponse = await axios.post(&#x27;https://github.com/login/oauth/access_token&#x27;, &#123;      client_id: GITHUB_CLIENT_ID,      client_secret: GITHUB_CLIENT_SECRET,      code: code,      state: state // éªŒè¯ state é˜²æ­¢ CSRF    &#125;, &#123;      headers: &#123; &#x27;Accept&#x27;: &#x27;application/json&#x27; &#125;    &#125;);    const tokenData = tokenResponse.data;    const accessToken = tokenData.access_token;    // 4. ä½¿ç”¨ access_token è·å–ç”¨æˆ·ä¿¡æ¯    const userResponse = await axios.get(&#x27;https://api.github.com/user&#x27;, &#123;      headers: &#123; &#x27;Authorization&#x27;: `token $&#123;accessToken&#125;` &#125;    &#125;);    // 5. è·å–ç”¨æˆ·é‚®ç®±ï¼ˆå¦‚æœè®¾ç½®äº†é‚®ç®±ä¸ºç§æœ‰ï¼‰    const emailResponse = await axios.get(&#x27;https://api.github.com/user/emails&#x27;, &#123;      headers: &#123; &#x27;Authorization&#x27;: `token $&#123;accessToken&#125;` &#125;    &#125;);    const userData = userResponse.data;    const emails = emailResponse.data;    const primaryEmail = emails.find(email =&gt; email.primary)?.email;    // 6. æ ¹æ® userData å¤„ç†æœ¬åœ°ç”¨æˆ·ç™»å½•å’Œ session/jwt åˆ›å»º    const user = await findOrCreateUser(&#123;      githubId: userData.id,      username: userData.login,      email: primaryEmail,      avatar: userData.avatar_url    &#125;);    // è¿™é‡Œå¯ä»¥åˆ›å»º session æˆ– JWT    const sessionToken = createSessionForUser(user);    res.redirect(`/dashboard?token=$&#123;sessionToken&#125;`);  &#125; catch (error) &#123;    console.error(&#x27;GitHub OAuth error:&#x27;, error);    res.status(500).json(&#123; error: &#x27;OAuth æˆæƒå¤±è´¥&#x27; &#125;);  &#125;&#125;);// è¾…åŠ©å‡½æ•°ï¼šæŸ¥æ‰¾æˆ–åˆ›å»ºç”¨æˆ·async function findOrCreateUser(githubData) &#123;  // è¿™é‡Œåº”è¯¥è¿æ¥æ•°æ®åº“æŸ¥æ‰¾æˆ–åˆ›å»ºç”¨æˆ·  // è¿”å›ç”¨æˆ·å¯¹è±¡  return &#123;    id: githubData.githubId,    username: githubData.username,    email: githubData.email,    avatar: githubData.avatar  &#125;;&#125;// è¾…åŠ©å‡½æ•°ï¼šä¸ºç”¨æˆ·åˆ›å»ºä¼šè¯function createSessionForUser(user) &#123;  // è¿™é‡Œå¯ä»¥åˆ›å»º JWT æˆ– session  return &#x27;generated_session_token&#x27;;&#125;app.listen(3000);\n\n\n5. æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰æ‹©5.1 ğŸ“Š å¯¹æ¯”è¡¨\n\n\nè®¤è¯æ–¹å¼\né€‚ç”¨åœºæ™¯\nçŠ¶æ€ç®¡ç†\nè·¨åŸŸæ”¯æŒ\næ‰©å±•æ€§\nå®‰å…¨æ€§\nå®ç°å¤æ‚åº¦\n\n\n\nSession-Cookie\nä¼ ç»Ÿçš„æœåŠ¡å™¨ç«¯æ¸²æŸ“ Web åº”ç”¨\næœ‰çŠ¶æ€\nâš ï¸ éœ€è¦é…ç½®\nâš ï¸ éœ€è¦å…±äº«å­˜å‚¨\nâœ… é«˜\nğŸŸ¢ ç®€å•\n\n\nToken (JWT)\nå‰åç«¯åˆ†ç¦» SPAã€ç§»åŠ¨ç«¯ APPã€API æ¥å£\næ— çŠ¶æ€\nâœ… åŸç”Ÿæ”¯æŒ\nâœ… æå¥½\nâœ… ä¸­é«˜\nğŸŸ¡ ä¸­ç­‰\n\n\nOAuth\néœ€è¦ç¬¬ä¸‰æ–¹ç™»å½•åŠŸèƒ½çš„ä»»ä½•åº”ç”¨\næ··åˆ\nâœ… åŸç”Ÿæ”¯æŒ\nâœ… æå¥½\nâœ… é«˜\nğŸ”´ å¤æ‚\n\n\n5.2 ğŸ¯ ä½¿ç”¨åœºæ™¯ğŸŒ Web åº”ç”¨\nä¼ ç»Ÿ Web åº”ç”¨ï¼šSession-Cookie\nç°ä»£ SPAï¼šJWT Token\næ··åˆæ¨¡å¼ï¼šJWT + å¯é€‰ Session\n\nğŸ“± ç§»åŠ¨ç«¯åº”ç”¨\nNative Appï¼šJWT Token\nHybrid Appï¼šJWT Token\nå°ç¨‹åºï¼šSession-Cookie æˆ– JWT\n\nğŸ”— API æœåŠ¡\nRESTful APIï¼šJWT Token\nGraphQL APIï¼šJWT Token\nå¾®æœåŠ¡æ¶æ„ï¼šJWT Token\n\nğŸ¤ å•ç‚¹ç™»å½• (SSO)\nä¼ä¸šå†…åº”ç”¨ï¼šOAuth 2.0 &#x2F; SAML\nè·¨å¹³å°åº”ç”¨ï¼šOAuth 2.0\nç¬¬ä¸‰æ–¹ç™»å½•ï¼šOAuth 2.0\n\n5.3 ğŸ”„ å¸¸è§ç»„åˆgraph TD    A[Webåº”ç”¨] --&gt; B[ä¸»è®¤è¯æ–¹å¼]    A --&gt; C[è¾…åŠ©è®¤è¯æ–¹å¼]    B --&gt; D[Session-Cookie&lt;br/&gt;ä¼ ç»ŸWebåº”ç”¨]    B --&gt; E[JWT Token&lt;br/&gt;SPA/ç§»åŠ¨ç«¯]    B --&gt; F[OAuth&lt;br/&gt;ç¬¬ä¸‰æ–¹ç™»å½•]    C --&gt; G[CSRFä¿æŠ¤]    C --&gt; H[HTTPSå¼ºåˆ¶]    C --&gt; I[Rate Limiting]    C --&gt; J[è¾“å…¥éªŒè¯]\n\nç°ä»£å¸¸è§ç»„åˆï¼š\n\nWeb Appï¼šSession æˆ– JWT + HTTPS + CSRF Protection\nMobile&#x2F;Native Appï¼šJWT + HTTPS + Device Fingerprinting\nå•ç‚¹ç™»å½•ï¼šOAuth æˆ– JWT + Centralized Auth Server\nç¬¬ä¸‰æ–¹ç™»å½•ï¼šOAuth + Local Account Binding\n\n\nâš ï¸ å®‰å…¨æœ€ä½³å®è·µæ— è®ºé€‰æ‹©å“ªç§è®¤è¯æ–¹å¼ï¼Œéƒ½åŠ¡å¿…éµå¾ªä»¥ä¸‹å®‰å…¨åŸåˆ™ï¼š\n\nğŸ”’ ä½¿ç”¨ HTTPS - ä¿è¯ä¼ è¾“è¿‡ç¨‹çš„å®‰å…¨\nğŸ• è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ - Token å’Œ Session éƒ½ä¸åº”é•¿æœŸæœ‰æ•ˆ\nğŸ›¡ï¸ é˜²èŒƒå¸¸è§æ”»å‡»ï¼š\nXSS (Cross-Site Scripting)\nCSRF (Cross-Site Request Forgery)\nç‚¹å‡»åŠ«æŒ (Clickjacking)\n\n\nğŸ“ è®°å½•å®‰å…¨æ—¥å¿— - ç›‘æ§å¼‚å¸¸ç™»å½•è¡Œä¸º\nğŸ”„ å®šæœŸè½®æ¢å¯†é’¥ - å®šæœŸæ›´æ¢ JWT å¯†é’¥å’Œä¼šè¯å¯†é’¥\nâœ… å®æ–½æœ€å°æƒé™åŸåˆ™ - åªæˆäºˆå¿…è¦çš„æƒé™\n\n\nğŸ“š å‚è€ƒèµ„æº\nRFC 6749 - OAuth 2.0\nJWT.io - JWT åœ¨çº¿å·¥å…·\nOWASP Authentication Cheat Sheet\nExpress.js å®˜æ–¹æ–‡æ¡£\n\n\n\nğŸ’¡ æç¤º: åœ¨é€‰æ‹©è®¤è¯æ–¹æ¡ˆæ—¶ï¼Œè¯·ç»¼åˆè€ƒè™‘ï¼š\n\nåº”ç”¨æ¶æ„å’Œéƒ¨ç½²ç¯å¢ƒ\nç”¨æˆ·ä½“éªŒéœ€æ±‚\nå®‰å…¨æ€§è¦æ±‚\nå¼€å‘å’Œç»´æŠ¤æˆæœ¬\nå›¢é˜ŸæŠ€æœ¯æ ˆç†Ÿæ‚‰åº¦\n\n\n","categories":["Webæ¶æ„å®‰å…¨"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"è®¤è¯ç³»ç»Ÿæ¶æ„","url":"/posts/ab2eaca1/","content":"è®¤è¯ç³»ç»Ÿæ¶æ„\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: authentication, authorization, jwt, oauth, security, api\n\nğŸ“‘ ç›®å½•\n1. è®¤è¯æ–¹å¼æ¦‚è¿°\n2. æœ¬åœ°è®¤è¯æµç¨‹\n2.1 æ³¨å†Œæµç¨‹\n2.2 ç™»å½•æµç¨‹\n2.3 Token éªŒè¯æµç¨‹\n\n\n3. Google OAuth è®¤è¯æµç¨‹\n3.1 é…ç½®\n3.2 è®¤è¯æµç¨‹\n3.3 ä¼šè¯ç®¡ç†\n\n\n4. å®‰å…¨ç‰¹æ€§\n4.1 é€Ÿç‡é™åˆ¶\n4.2 CORS é…ç½®\n4.3 é”™è¯¯å¤„ç†\n\n\n5. ä¸­é—´ä»¶é“¾\n6. ç¯å¢ƒé…ç½®\n\n\n1. è®¤è¯æ–¹å¼æ¦‚è¿°ç³»ç»Ÿæ”¯æŒä¸¤ç§ä¸»è¦çš„è®¤è¯æ–¹å¼ï¼š\n\nğŸ”‘ æœ¬åœ°ç”¨æˆ·åå¯†ç è®¤è¯ï¼ˆJWT Tokenï¼‰\nğŸŒ Google OAuth 2.0 è®¤è¯\n\ngraph LR    A[ç”¨æˆ·] --&gt; B[è®¤è¯é€‰æ‹©]    B --&gt; C[æœ¬åœ°è®¤è¯]    B --&gt; D[OAuthè®¤è¯]    C --&gt; E[JWT Token]    D --&gt; F[Googleæˆæƒ]    E --&gt; G[è®¿é—®API]    F --&gt; G\n\n\n2. æœ¬åœ°è®¤è¯æµç¨‹2.1 ğŸ”§ æ³¨å†Œæµç¨‹\nå®¢æˆ·ç«¯å‘é€ POST è¯·æ±‚åˆ° /api/v1/auth/register\nè¯·æ±‚ç»è¿‡é€Ÿç‡é™åˆ¶ä¸­é—´ä»¶ï¼ˆRate Limiterï¼‰æ£€æŸ¥\né€šè¿‡æ³¨å†ŒéªŒè¯å™¨ï¼ˆregisterValidatorï¼‰éªŒè¯è¯·æ±‚æ•°æ®\næ§åˆ¶å™¨å¤„ç†æ³¨å†Œé€»è¾‘ï¼Œåˆ›å»ºæ–°ç”¨æˆ·\nè¿”å›æ³¨å†Œç»“æœ\n\nsequenceDiagram    participant C as Client    participant R as Rate Limiter    participant V as Validator    participant Ctrl as Controller    participant DB as Database    C-&gt;&gt;R: POST /api/v1/auth/register    R-&gt;&gt;V: éªŒè¯è¯·æ±‚æ•°æ®    V-&gt;&gt;Ctrl: å¤„ç†æ³¨å†Œé€»è¾‘    Ctrl-&gt;&gt;DB: åˆ›å»ºæ–°ç”¨æˆ·    DB--&gt;&gt;Ctrl: è¿”å›ç”¨æˆ·ä¿¡æ¯    Ctrl--&gt;&gt;C: è¿”å›æ³¨å†Œç»“æœ\n\n2.2 ğŸ” ç™»å½•æµç¨‹\nå®¢æˆ·ç«¯å‘é€ POST è¯·æ±‚åˆ° /api/v1/auth/login\nè¯·æ±‚ç»è¿‡é€Ÿç‡é™åˆ¶ä¸­é—´ä»¶æ£€æŸ¥\né€šè¿‡ç™»å½•éªŒè¯å™¨ï¼ˆloginValidatorï¼‰éªŒè¯è¯·æ±‚æ•°æ®\næ§åˆ¶å™¨éªŒè¯ç”¨æˆ·åå’Œå¯†ç \nç”Ÿæˆ JWT Tokenï¼ˆæœ‰æ•ˆæœŸ24å°æ—¶ï¼‰\nè¿”å› Token ç»™å®¢æˆ·ç«¯\n\nsequenceDiagram    participant C as Client    participant R as Rate Limiter    participant V as Validator    participant Ctrl as Controller    participant JWT as JWT Service    C-&gt;&gt;R: POST /api/v1/auth/login    R-&gt;&gt;V: éªŒè¯ç™»å½•æ•°æ®    V-&gt;&gt;Ctrl: éªŒè¯ç”¨æˆ·å‡­æ®    Ctrl-&gt;&gt;JWT: ç”ŸæˆToken    JWT--&gt;&gt;Ctrl: è¿”å›JWT Token    Ctrl--&gt;&gt;C: è¿”å›Tokenä¿¡æ¯\n\n2.3 ğŸ›¡ï¸ Token éªŒè¯æµç¨‹\nå®¢æˆ·ç«¯åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ Tokenï¼šAuthorization: Bearer &lt;token&gt;\nauthenticateToken ä¸­é—´ä»¶éªŒè¯ Tokenï¼š\næ£€æŸ¥ Token æ˜¯å¦å­˜åœ¨\néªŒè¯ Token æœ‰æ•ˆæ€§\nä» Token ä¸­è§£æç”¨æˆ·ä¿¡æ¯\nå°†ç”¨æˆ·ä¿¡æ¯é™„åŠ åˆ°è¯·æ±‚å¯¹è±¡\n\n\n\n// Token éªŒè¯ä¸­é—´ä»¶ç¤ºä¾‹const authenticateToken = (req, res, next) =&gt; &#123;  const authHeader = req.headers[&#x27;authorization&#x27;];  const token = authHeader &amp;&amp; authHeader.split(&#x27; &#x27;)[1];  if (!token) &#123;    return res.status(401).json(&#123; error: &#x27;Access token required&#x27; &#125;);  &#125;  jwt.verify(token, process.env.JWT_SECRET, (err, user) =&gt; &#123;    if (err) &#123;      return res.status(403).json(&#123; error: &#x27;Invalid or expired token&#x27; &#125;);    &#125;    req.user = user;    next();  &#125;);&#125;;\n\n\n3. Google OAuth è®¤è¯æµç¨‹3.1 âš™ï¸ é…ç½®\nä½¿ç”¨ Passport.js çš„ Google ç­–ç•¥\né…ç½®äº† Google Client ID å’Œ Secret\nè®¾ç½®äº†å›è°ƒ URL\n\n// Google OAuth é…ç½®ç¤ºä¾‹const GoogleStrategy = require(&#x27;passport-google-oauth20&#x27;).Strategy;passport.use(new GoogleStrategy(&#123;  clientID: process.env.GOOGLE_CLIENT_ID,  clientSecret: process.env.GOOGLE_CLIENT_SECRET,  callbackURL: &quot;/api/v1/auth/google/callback&quot;&#125;, (accessToken, refreshToken, profile, done) =&gt; &#123;  // ç”¨æˆ·éªŒè¯é€»è¾‘&#125;));\n\n3.2 ğŸ”„ è®¤è¯æµç¨‹\nç”¨æˆ·è®¿é—® /api/v1/auth/oauth/google\né‡å®šå‘åˆ° Google ç™»å½•é¡µé¢\nç”¨æˆ·æˆæƒåï¼ŒGoogle é‡å®šå‘å›å›è°ƒ URL\nPassport å¤„ç†å›è°ƒï¼š\néªŒè¯ç”¨æˆ·ä¿¡æ¯\nå¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°ç”¨æˆ·\nç”Ÿæˆä¼šè¯\n\n\n\nsequenceDiagram    participant U as User    participant A as App    participant G as Google    participant DB as Database    U-&gt;&gt;A: è®¿é—®OAuthç«¯ç‚¹    A-&gt;&gt;G: é‡å®šå‘åˆ°Google    U-&gt;&gt;G: ç™»å½•å¹¶æˆæƒ    G-&gt;&gt;A: å›è°ƒæˆæƒç     A-&gt;&gt;G: äº¤æ¢è®¿é—®ä»¤ç‰Œ    G-&gt;&gt;A: è¿”å›ç”¨æˆ·ä¿¡æ¯    A-&gt;&gt;DB: æŸ¥æ‰¾/åˆ›å»ºç”¨æˆ·    A-&gt;&gt;U: å»ºç«‹ä¼šè¯\n\n3.3 ğŸ“‹ ä¼šè¯ç®¡ç†\nä½¿ç”¨ express-session ç®¡ç†ä¼šè¯\né…ç½®äº†ä¼šè¯å¯†é’¥å’Œé€‰é¡¹\nå®ç°äº†ç”¨æˆ·åºåˆ—åŒ–å’Œååºåˆ—åŒ–\n\n// ä¼šè¯é…ç½®ç¤ºä¾‹app.use(session(&#123;  secret: process.env.SESSION_SECRET,  resave: false,  saveUninitialized: false,  cookie: &#123;    secure: process.env.NODE_ENV === &#x27;production&#x27;,    maxAge: 24 * 60 * 60 * 1000 // 24å°æ—¶  &#125;&#125;));\n\n\n4. å®‰å…¨ç‰¹æ€§4.1 ğŸš¦ é€Ÿç‡é™åˆ¶\nä½¿ç”¨ express-rate-limit å®ç°\né»˜è®¤é™åˆ¶ï¼š15åˆ†é’Ÿå†…æ¯ä¸ª IP æœ€å¤š 100 ä¸ªè¯·æ±‚\nåº”ç”¨äºç™»å½•å’Œæ³¨å†Œæ¥å£\n\n// é€Ÿç‡é™åˆ¶é…ç½®ç¤ºä¾‹const rateLimiter = rateLimit(&#123;  windowMs: 15 * 60 * 1000, // 15åˆ†é’Ÿ  max: 100, // æœ€å¤§è¯·æ±‚æ•°  message: &#x27;Too many requests from this IP&#x27;&#125;);\n\n4.2 ğŸŒ CORS é…ç½®\nå¯é…ç½®å…è®¸çš„æºï¼ˆé»˜è®¤å…è®¸æ‰€æœ‰ï¼‰\né™åˆ¶å…è®¸çš„ HTTP æ–¹æ³•\né…ç½®å…è®¸çš„è¯·æ±‚å¤´\næ”¯æŒå‡­è¯ï¼ˆcredentialsï¼‰\n\n// CORS é…ç½®ç¤ºä¾‹app.use(cors(&#123;  origin: process.env.ALLOWED_ORIGINS?.split(&#x27;,&#x27;) || &#x27;*&#x27;,  methods: [&#x27;GET&#x27;, &#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;],  allowedHeaders: [&#x27;Content-Type&#x27;, &#x27;Authorization&#x27;],  credentials: true&#125;));\n\n4.3 âš ï¸ é”™è¯¯å¤„ç†\nç»Ÿä¸€çš„é”™è¯¯å¤„ç†ä¸­é—´ä»¶\nåŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„é”™è¯¯å“åº”\nè¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•\n\n// é”™è¯¯å¤„ç†ä¸­é—´ä»¶ç¤ºä¾‹app.use((err, req, res, next) =&gt; &#123;  console.error(err.stack);  if (process.env.NODE_ENV === &#x27;development&#x27;) &#123;    res.status(500).json(&#123;      error: err.message,      stack: err.stack    &#125;);  &#125; else &#123;    res.status(500).json(&#123;      error: &#x27;Internal Server Error&#x27;    &#125;);  &#125;&#125;);\n\n\n5. ğŸ”— ä¸­é—´ä»¶é“¾è¯·æ±‚å¤„ç†æµç¨‹ï¼š\ngraph TD    A[å®¢æˆ·ç«¯è¯·æ±‚] --&gt; B[æ—¥å¿—ä¸­é—´ä»¶]    B --&gt; C[åŸºç¡€ä¸­é—´ä»¶]    C --&gt; D[CORSä¸­é—´ä»¶]    D --&gt; E[ä¼šè¯ä¸­é—´ä»¶]    E --&gt; F[Passportåˆå§‹åŒ–]    F --&gt; G[è·¯ç”±å¤„ç†]    G --&gt; H[æ§åˆ¶å™¨é€»è¾‘]    H --&gt; I[å“åº”è¿”å›]    I --&gt; J[é”™è¯¯å¤„ç†ä¸­é—´ä»¶]\n\n\næ—¥å¿—ä¸­é—´ä»¶ï¼ˆè¯·æ±‚è®°å½•ï¼‰\nåŸºç¡€ä¸­é—´ä»¶ï¼ˆJSONè§£æã€CORSç­‰ï¼‰\nä¼šè¯ä¸­é—´ä»¶\nPassport åˆå§‹åŒ–\nè·¯ç”±å¤„ç†\né”™è¯¯å¤„ç†ä¸­é—´ä»¶\n\n\n6. ğŸ› ï¸ ç¯å¢ƒé…ç½®å…³é”®é…ç½®é¡¹ï¼š\n# è®¤è¯ç³»ç»Ÿæ¶æ„JWT_SECRET=your-super-secret-jwt-keyJWT_EXPIRES_IN=24h# è®¤è¯ç³»ç»Ÿæ¶æ„SESSION_SECRET=your-session-secret# è®¤è¯ç³»ç»Ÿæ¶æ„GOOGLE_CLIENT_ID=your-google-client-idGOOGLE_CLIENT_SECRET=your-google-client-secret# è®¤è¯ç³»ç»Ÿæ¶æ„DB_HOST=localhostDB_PORT=3306DB_NAME=your-database-nameDB_USER=your-usernameDB_PASSWORD=your-password# è®¤è¯ç³»ç»Ÿæ¶æ„UPLOAD_DIR=./uploadsMAX_FILE_SIZE=10485760# è®¤è¯ç³»ç»Ÿæ¶æ„ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com# è®¤è¯ç³»ç»Ÿæ¶æ„RATE_LIMIT_WINDOW_MS=900000RATE_LIMIT_MAX_REQUESTS=100\n\n\nğŸ“Š æ€»ç»“è¿™ä¸ªè®¤è¯ç³»ç»Ÿé‡‡ç”¨äº†å¤šé‡å®‰å…¨æœºåˆ¶ï¼ŒåŒ…æ‹¬ï¼š\n\nâœ… JWT Token è®¤è¯\nâœ… OAuth 2.0 ç¬¬ä¸‰æ–¹ç™»å½•\nâœ… é€Ÿç‡é™åˆ¶ é˜²æ­¢æš´åŠ›æ”»å‡»\nâœ… CORS è·¨åŸŸä¿æŠ¤\nâœ… ç»Ÿä¸€é”™è¯¯å¤„ç† æå‡ç”¨æˆ·ä½“éªŒ\n\né€šè¿‡ä¸­é—´ä»¶é“¾çš„æ–¹å¼ï¼Œå®ç°äº†çµæ´»çš„è®¤è¯æµç¨‹æ§åˆ¶ï¼Œèƒ½å¤Ÿæœ‰æ•ˆä¿æŠ¤ API æ¥å£çš„å®‰å…¨ã€‚\n\n\nğŸ’¡ æç¤º: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·ç¡®ä¿ï¼š\n\nä½¿ç”¨å¼ºå¯†ç ä½œä¸ºå¯†é’¥\nå¯ç”¨ HTTPS\nå®šæœŸè½®æ¢å¯†é’¥\nç›‘æ§å¼‚å¸¸è®¿é—®è¡Œä¸º\n\n\n","categories":["Webæ¶æ„å®‰å…¨"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Boost Windows ç¼–è¯‘æŒ‡å—","url":"/posts/190baecd/","content":"Boost Windows ç¼–è¯‘æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¯å¢ƒå‡†å¤‡\nè·å–ä¸å‡†å¤‡æºç \næ ¸å¿ƒç¼–è¯‘æ­¥éª¤\néªŒè¯ç¼–è¯‘ç»“æœ\né¡¹ç›®é›†æˆ\nå¸¸è§é—®é¢˜ä¸è§£ç­”\nè‡ªåŠ¨åŒ–è„šæœ¬ç¤ºä¾‹\n\næ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Windows å¹³å°ä¸Šï¼Œä½¿ç”¨ Visual Studio å’Œ b2.exe æ„å»ºå·¥å…·ï¼Œå®Œæ•´åœ°é™æ€ç¼–è¯‘ Boost C++ åº“ã€‚\né™æ€ç¼–è¯‘çš„ä¼˜åŠ¿\næ˜“äºåˆ†å‘: åº”ç”¨ç¨‹åºä¸ä¾èµ–å¤–éƒ¨çš„ Boost DLL æ–‡ä»¶ï¼Œæ‰€æœ‰ä»£ç éƒ½åœ¨å¯æ‰§è¡Œæ–‡ä»¶å†…éƒ¨ã€‚\nç‰ˆæœ¬æ§åˆ¶: é¿å…æœ€ç»ˆç”¨æˆ·çš„æœºå™¨ä¸Šå‡ºç° DLL ç‰ˆæœ¬å†²çªã€‚\næ€§èƒ½: å¯èƒ½æœ‰è½»å¾®çš„å¯åŠ¨æ€§èƒ½ä¼˜åŠ¿ï¼Œå› ä¸ºå‡å°‘äº†åŠ¨æ€åŠ è½½ã€‚\n\nç¯å¢ƒå‡†å¤‡1. è½¯ä»¶è¦æ±‚\næ“ä½œç³»ç»Ÿ: Windows 10&#x2F;11 (x64)\nIDE: Visual Studio 2019 (MSVC v14.2) æˆ– 2022 (MSVC v14.3)\nç»„ä»¶: ç¡®ä¿ VS å®‰è£…ç¨‹åºå·²å‹¾é€‰ â€œä½¿ç”¨ C++ çš„æ¡Œé¢å¼€å‘â€ï¼Œå¹¶åŒ…å«æœ€æ–°çš„ Windows SDKã€‚\n(å¯é€‰) Python: å¦‚æœéœ€è¦ç¼–è¯‘ Boost.Pythonï¼Œè¯·å®‰è£… Python 3.8+ã€‚\n\n2. å¼€å‘è€…å‘½ä»¤æç¤ºç¬¦ç¼–è¯‘ Boost å¿…é¡»åœ¨ Visual Studio æä¾›çš„å¼€å‘è€…å‘½ä»¤æç¤ºç¬¦ç¯å¢ƒä¸­è¿›è¡Œï¼Œå› ä¸ºå®ƒé¢„è®¾äº†æ‰€æœ‰å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼ˆç¼–è¯‘å™¨è·¯å¾„ã€SDK è·¯å¾„ç­‰ï¼‰ã€‚\nå¯åŠ¨æ–¹å¼:\n\nä»â€œå¼€å§‹â€èœå•æ‰¾åˆ° Visual Studio 2022 -&gt; x64 Native Tools Command Prompt for VS 2022ã€‚\næˆ–è€…ï¼Œåœ¨æ™®é€šçš„ cmd ä¸­æ‰‹åŠ¨æ‰§è¡Œ vcvars è„šæœ¬ï¼ˆè·¯å¾„å¯èƒ½å› ä½ çš„å®‰è£…è€Œå¼‚ï¼‰ï¼šcall &quot;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Auxiliary\\Build\\vcvars64.bat&quot;\n\nè·å–ä¸å‡†å¤‡æºç \næç¤º: æœ¬æ–‡ä»¥ 1.85.0 ç‰ˆæœ¬ä¸ºä¾‹ã€‚å»ºè®®è®¿é—® Boost å®˜ç½‘ è·å–æœ€æ–°ç‰ˆæœ¬å·ã€‚\n\n1. ä¸‹è½½å¹¶è§£å‹# Boost Windows ç¼–è¯‘æŒ‡å—md C:\\dev\\libscd C:\\dev\\libs# Boost Windows ç¼–è¯‘æŒ‡å—powershell -Command &quot;Invoke-WebRequest -Uri &#x27;https://boostorg.jfrog.io/artifactory/main/release/1.85.0/source/boost_1_85_0.7z&#x27; -OutFile &#x27;boost_1_85_0.7z&#x27;&quot;# Boost Windows ç¼–è¯‘æŒ‡å—7z x boost_1_85_0.7zcd boost_1_85_0\n\n2. ç”Ÿæˆæ„å»ºå·¥å…·è¿è¡Œ bootstrap.bat è„šæœ¬æ¥ç”Ÿæˆ b2.exe æ„å»ºå·¥å…·ã€‚\n# Boost Windows ç¼–è¯‘æŒ‡å—bootstrap.bat\næ‰§è¡Œå®Œæ¯•åï¼Œå½“å‰ç›®å½•ä¼šç”Ÿæˆ b2.exe å’Œ bjam.exeã€‚\næ ¸å¿ƒç¼–è¯‘æ­¥éª¤1. ç†è§£æ ¸å¿ƒç¼–è¯‘å‚æ•°\ntoolset=msvc-14.3: æŒ‡å®šä½¿ç”¨ VS 2022 çš„ç¼–è¯‘å™¨ã€‚\naddress-model=64: ç¼–è¯‘ 64 ä½ç‰ˆæœ¬ã€‚\nlink=static: [æ ¸å¿ƒ] ç”Ÿæˆé™æ€é“¾æ¥åº“ (.lib)ã€‚\nruntime-link=static: [æ ¸å¿ƒ] é™æ€é“¾æ¥ C&#x2F;C++ è¿è¡Œæ—¶åº“ã€‚è¿™å¯¹åº” VS é¡¹ç›®å±æ€§ä¸­çš„ /MT (Release) æˆ– /MTd (Debug)ã€‚\nvariant=release: ç¼–è¯‘å‘å¸ƒç‰ˆæœ¬ã€‚ä¹Ÿå¯ä»¥æ˜¯ debug æˆ– debug,releaseã€‚\nthreading=multi: ç¼–è¯‘å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼ˆç°ä»£åº”ç”¨æ ‡é…ï¼‰ã€‚\n--stagedir=&lt;path&gt;: æŒ‡å®šç¼–è¯‘äº§ç‰©ï¼ˆ.lib æ–‡ä»¶ï¼‰çš„è¾“å‡ºç›®å½•ã€‚\n-j&lt;N&gt;: å¹¶è¡Œç¼–è¯‘ä»»åŠ¡æ•°ï¼Œä¾‹å¦‚ -j%NUMBER_OF_PROCESSORS%ã€‚\n\n2. æ‰§è¡Œç¼–è¯‘å‘½ä»¤ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ¨èçš„ã€ç”¨äºç”Ÿæˆ 64 ä½é™æ€ Release åº“çš„å®Œæ•´å‘½ä»¤ï¼š\n# Boost Windows ç¼–è¯‘æŒ‡å—# Boost Windows ç¼–è¯‘æŒ‡å—b2.exe -j%NUMBER_OF_PROCESSORS% ^    toolset=msvc-14.3 ^    address-model=64 ^    link=static ^    runtime-link=static ^    variant=release ^    threading=multi ^    --stagedir=&quot;bin\\win-x64-static-release&quot; ^    --without-python\nç¼–è¯‘è¿‡ç¨‹ä¼šæŒç»­ä¸€æ®µæ—¶é—´ã€‚ç¼–è¯‘å®Œæˆåï¼Œæ‰€æœ‰ç”Ÿæˆçš„ .lib æ–‡ä»¶éƒ½ä¼šåœ¨ bin\\win-x64-static-release\\lib ç›®å½•ä¸­ã€‚\néªŒè¯ç¼–è¯‘ç»“æœ1. æ£€æŸ¥åº“æ–‡ä»¶ä½¿ç”¨ dumpbin.exe å·¥å…·ï¼ˆVS è‡ªå¸¦ï¼‰å¯ä»¥æŸ¥çœ‹ .lib æ–‡ä»¶çš„ä¿¡æ¯ã€‚\n# Boost Windows ç¼–è¯‘æŒ‡å—dumpbin /headers &quot;bin\\win-x64-static-release\\lib\\libboost_system-vc143-mt-s-x64-1_85.lib&quot; | findstr machine# Boost Windows ç¼–è¯‘æŒ‡å—\n\n2. ç¼–è¯‘æµ‹è¯•ç¨‹åºtest_boost.cpp:\n#define BOOST_ALL_NO_LIB // ç¦ç”¨ Boost çš„è‡ªåŠ¨é“¾æ¥åŠŸèƒ½#include &lt;iostream&gt;#include &lt;boost/version.hpp&gt;#include &lt;boost/system/error_code.hpp&gt;int main() &#123;    std::cout &lt;&lt; &quot;Using Boost Version: &quot; &lt;&lt; BOOST_LIB_VERSION &lt;&lt; std::endl;    boost::system::error_code ec;    if (!ec) &#123;        std::cout &lt;&lt; &quot;Boost.System is working correctly!&quot; &lt;&lt; std::endl;    &#125;    return 0;&#125;\nç¼–è¯‘å‘½ä»¤:\ncl.exe /EHsc /MT /I&lt;Your-Boost-Source-Path&gt; test_boost.cpp /link /LIBPATH:&quot;&lt;Your-Boost-Source-Path&gt;\\bin\\win-x64-static-release\\lib&quot;\n\n/MT: å¿…é¡»ä¸ runtime-link=static å¯¹åº”ã€‚å¦‚æœæ˜¯ variant=debugï¼Œåˆ™ç”¨ /MTdã€‚\n/I: æŒ‡å®š Boost å¤´æ–‡ä»¶æ ¹ç›®å½•ã€‚\n/link /LIBPATH: æŒ‡å®š .lib æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚\nBOOST_ALL_NO_LIB: æ¨èåœ¨é¡¹ç›®ä¸­å®šä¹‰æ­¤å®ï¼Œæ‰‹åŠ¨ç®¡ç†é“¾æ¥çš„åº“ï¼Œé¿å…è‡ªåŠ¨é“¾æ¥å¸¦æ¥çš„é—®é¢˜ã€‚\n\né¡¹ç›®é›†æˆVisual Studio é¡¹ç›®å±æ€§å¯¹äºä¸€ä¸ªç°æœ‰çš„ VS é¡¹ç›®ï¼Œä½ éœ€è¦é…ç½®ä»¥ä¸‹ä¸¤ä¸ªæ ¸å¿ƒå±æ€§ï¼š\n\nC&#x2F;C++ -&gt; å¸¸è§„ -&gt; é™„åŠ åŒ…å«ç›®å½•:\næ·»åŠ  Boost çš„æ ¹ç›®å½•ï¼Œä¾‹å¦‚ C:\\dev\\libs\\boost_1_85_0ã€‚\n\n\né“¾æ¥å™¨ -&gt; å¸¸è§„ -&gt; é™„åŠ åº“ç›®å½•:\næ·»åŠ ä½ ç¼–è¯‘å¥½çš„ .lib æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œä¾‹å¦‚ C:\\dev\\libs\\boost_1_85_0\\bin\\win-x64-static-release\\libã€‚\n\n\n\né‡è¦: ç¡®ä¿é¡¹ç›®çš„ C&#x2F;C++ -&gt; ä»£ç ç”Ÿæˆ -&gt; è¿è¡Œæ—¶åº“ è®¾ç½®ä¸ä½ ç¼–è¯‘ Boost æ—¶ä½¿ç”¨çš„ runtime-link é€‰é¡¹ä¸€è‡´ï¼\n\nruntime-link=static, variant=release -&gt; å¤šçº¿ç¨‹ (&#x2F;MT)\nruntime-link=static, variant=debug -&gt; å¤šçº¿ç¨‹è°ƒè¯• (&#x2F;MTd)\nruntime-link=shared, variant=release -&gt; å¤šçº¿ç¨‹ DLL (&#x2F;MD)\nruntime-link=shared, variant=debug -&gt; å¤šçº¿ç¨‹è°ƒè¯• DLL (&#x2F;MDd)\n\nCMakeLists.txt ç¤ºä¾‹cmake_minimum_required(VERSION 3.15)project(MyBoostApp)set(CMAKE_CXX_STANDARD 17)# Boost Windows ç¼–è¯‘æŒ‡å—set(BOOST_ROOT &quot;C:/dev/libs/boost_1_85_0&quot;)# Boost Windows ç¼–è¯‘æŒ‡å—set(Boost_USE_STATIC_LIBS ON)# Boost Windows ç¼–è¯‘æŒ‡å—find_package(Boost 1.85.0 REQUIRED COMPONENTS system filesystem thread)if(Boost_FOUND)    add_executable(my_app main.cpp)        # 4. é“¾æ¥åº“    target_link_libraries(my_app PRIVATE Boost::system Boost::filesystem Boost::thread)        # 5. æ·»åŠ  include ç›®å½•    target_include_directories(my_app PRIVATE $&#123;Boost_INCLUDE_DIRS&#125;)endif()\n\nå¸¸è§é—®é¢˜ä¸è§£ç­”Q1: ç¼–è¯‘å¤±è´¥ï¼Œæç¤ºæ‰¾ä¸åˆ°ç¼–è¯‘å™¨ cl.exe æˆ– link.exe?A: ä½ æ²¡æœ‰åœ¨æ­£ç¡®çš„â€œå¼€å‘è€…å‘½ä»¤æç¤ºç¬¦â€ç¯å¢ƒä¸­è¿è¡Œ b2.exeã€‚è¯·è¿”å› ç¯å¢ƒå‡†å¤‡ ç« èŠ‚ï¼Œç¡®ä¿å‘½ä»¤è¡Œç¯å¢ƒè®¾ç½®æ­£ç¡®ã€‚\nQ2: é“¾æ¥æ—¶å‡ºç° LNK2038: mismatch detected for &#39;RuntimeLibrary&#39;?A: è¿™æ˜¯æœ€å¸¸è§çš„é—®é¢˜ã€‚ä½ çš„é¡¹ç›®ä½¿ç”¨çš„â€œè¿è¡Œæ—¶åº“â€è®¾ç½®ä¸ä½ ç¼–è¯‘çš„ Boost åº“ä¸åŒ¹é…ã€‚è¯·ä»”ç»†æ£€æŸ¥å¹¶ç»Ÿä¸€ VS é¡¹ç›®çš„ /MT, /MD ç­‰è®¾ç½®ã€‚\nQ3: å¦‚ä½•ç†è§£ Boost åº“æ–‡ä»¶çš„å‘½å?A: libboost_system-vc143-mt-s-x64-1_85.lib\n\nlibboost_system: åº“å\nvc143: ç¼–è¯‘å™¨ç‰ˆæœ¬ (VS 2022)\nmt: å¤šçº¿ç¨‹\ns: é™æ€é“¾æ¥ C&#x2F;C++ è¿è¡Œæ—¶\nx64: 64ä½\n1_85: Boost ç‰ˆæœ¬\n\nè‡ªåŠ¨åŒ–è„šæœ¬ç¤ºä¾‹build_boost.bat:\n@echo offsetlocalREM --- é…ç½® ---set BOOST_SRC_PATH=C:\\dev\\libs\\boost_1_85_0set VS_VARS_BAT=&quot;C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Auxiliary\\Build\\vcvars64.bat&quot;set TOOLSET=msvc-14.3set ADDRESS_MODEL=64set STAGE_DIR=%BOOST_SRC_PATH%\\bin\\win-x64-static-releaseREM --- æ‰§è¡Œ ---echo Setting up VS environment...call %VS_VARS_BAT%echo Changing to Boost source directory...cd /d %BOOST_SRC_PATH%echo Starting Boost build...b2.exe -j%NUMBER_OF_PROCESSORS% ^    toolset=%TOOLSET% ^    address-model=%ADDRESS_MODEL% ^    link=static ^    runtime-link=static ^    variant=release ^    --stagedir=&quot;%STAGE_DIR%&quot; ^    --without-pythonif %ERRORLEVEL% EQU 0 (    echo.    echo Boost build successful! Libraries are in: %STAGE_DIR%\\lib) else (    echo.    echo Boost build failed!)endlocal\n","categories":["C++æ ¸å¿ƒå¼€å‘","C++åŸºç¡€ä¸è¿›é˜¶"],"tags":["C++","å¼€å‘ç¯å¢ƒ","Windows","Boost","b2","é™æ€ç¼–è¯‘"]},{"title":"Nginx Ubuntu åå‘ä»£ç†æŒ‡å—","url":"/posts/ebeb0722/","content":"Nginx Ubuntu åå‘ä»£ç†æŒ‡å—ç›®å½•\nç¬¬ä¸€æ­¥ï¼šå®‰è£… Nginx\nç¬¬äºŒæ­¥ï¼šè®¾ç½®åŸºç¡€ Web æœåŠ¡å™¨\nç¬¬ä¸‰æ­¥ï¼šé…ç½®åå‘ä»£ç†ä¸ HTTPS\nç¬¬å››æ­¥ï¼šä½¿ç”¨ Certbot è‡ªåŠ¨é…ç½® SSL\nç¬¬äº”æ­¥ï¼šé…ç½®å¤šä¸ªæœ¬åœ°åº”ç”¨çš„åå‘ä»£ç† (å¯é€‰)\nç¬¬å…­æ­¥ï¼šé…ç½®è´Ÿè½½å‡è¡¡ (å¯é€‰)\né™„å½•ï¼šæ€§èƒ½ä¸å®‰å…¨ä¼˜åŒ–\nå¸¸è§é—®é¢˜\n\nç¬¬ä¸€æ­¥ï¼šå®‰è£… Nginx# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo apt update# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo apt install -y nginx# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo ufw allow &#x27;Nginx Full&#x27;# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo systemctl status nginx\nå®‰è£…å®Œæˆåï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® http://&lt;ä½ çš„æœåŠ¡å™¨IP&gt;ï¼Œåº”èƒ½çœ‹åˆ° Nginx çš„æ¬¢è¿é¡µé¢ã€‚\nç¬¬äºŒæ­¥ï¼šè®¾ç½®åŸºç¡€ Web æœåŠ¡å™¨å³ä½¿æˆ‘ä»¬ä¸»è¦ç”¨ Nginx åšåå‘ä»£ç†ï¼Œåˆ›å»ºä¸€ä¸ªåŸºç¡€çš„æœåŠ¡å™¨å—ï¼ˆServer Blockï¼‰ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo mkdir -p /var/www/your_domain.com/htmlsudo chown -R $USER:$USER /var/www/your_domain.com# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo nano /etc/nginx/sites-available/your_domain.com\n\nå°†ä»¥ä¸‹åŸºç¡€é…ç½®ç²˜è´´è¿›å»ï¼š\nserver &#123;    listen 80;    listen [::]:80;    root /var/www/your_domain.com/html;    index index.html;    server_name your_domain.com www.your_domain.com;    location / &#123;        try_files $uri $uri/ =404;    &#125;&#125;\n\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo ln -s /etc/nginx/sites-available/your_domain.com /etc/nginx/sites-enabled/# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo nginx -t# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo systemctl restart nginx\n\nç¬¬ä¸‰æ­¥ï¼šé…ç½®åå‘ä»£ç†ä¸ HTTPSç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä½¿å…¶å°† HTTP è¯·æ±‚é‡å®šå‘åˆ° HTTPSï¼Œå¹¶å°†æ‰€æœ‰æµé‡åå‘ä»£ç†åˆ°ä¸€ä¸ªåç«¯åº”ç”¨ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªè¿è¡Œåœ¨ localhost:8080 çš„ Node.js æˆ– Java åº”ç”¨ï¼‰ã€‚\nç¼–è¾‘ä½ çš„é…ç½®æ–‡ä»¶ï¼šsudo nano /etc/nginx/sites-available/your_domain.com\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—server &#123;    listen 80;    listen [::]:80;    server_name your_domain.com www.your_domain.com;    # å°†æ‰€æœ‰ HTTP è¯·æ±‚ 301 é‡å®šå‘åˆ° HTTPS    return 301 https://$host$request_uri;&#125;# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—server &#123;    listen 443 ssl http2;    listen [::]:443 ssl http2;    server_name your_domain.com www.your_domain.com;    # SSL è¯ä¹¦è·¯å¾„ (ç¨åç”± Certbot è‡ªåŠ¨å¡«å……)    ssl_certificate /etc/letsencrypt/live/your_domain.com/fullchain.pem;    ssl_certificate_key /etc/letsencrypt/live/your_domain.com/privkey.pem;    # --- SSL/TLS å®‰å…¨å¢å¼ºé…ç½® ---    # æ¨èåªä½¿ç”¨ TLS 1.2 å’Œ 1.3ï¼Œè¿™æ˜¯å½“å‰çš„å®‰å…¨æ ‡å‡†    ssl_protocols TLSv1.2 TLSv1.3;    ssl_prefer_server_ciphers on;    # ç°ä»£ OpenSSL å…¼å®¹çš„å®‰å…¨åŠ å¯†å¥—ä»¶ï¼ˆ2024å¹´æ¨èï¼‰    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;    # SSL ä¼šè¯ç¼“å­˜ä¼˜åŒ–    ssl_session_cache shared:SSL:10m;    ssl_session_timeout 10m;    ssl_session_tickets off;    # OCSP Stapling    ssl_stapling on;    ssl_stapling_verify on;    resolver 8.8.8.8 8.8.4.4 valid=300s;    resolver_timeout 5s;        # --- å®‰å…¨å¤´ (Security Headers) ---    # HSTS (HTTP Strict Transport Security): å¼ºåˆ¶å®¢æˆ·ç«¯åœ¨æŒ‡å®šæ—¶é—´å†…åªèƒ½é€šè¿‡ HTTPS è®¿é—®    add_header Strict-Transport-Security &quot;max-age=15768000; includeSubDomains; preload&quot; always;    # X-Frame-Options: é˜²æ­¢ç‚¹å‡»åŠ«æŒæ”»å‡»    add_header X-Frame-Options DENY;    # X-Content-Type-Options: é˜²æ­¢ MIME ç±»å‹å—…æ¢æ”»å‡»    add_header X-Content-Type-Options nosniff;    # X-XSS-Protection: å¯ç”¨ XSS ä¿æŠ¤    add_header X-XSS-Protection &quot;1; mode=block&quot;;    # Referrer Policy: æ§åˆ¶referrerä¿¡æ¯å‘é€    add_header Referrer-Policy &quot;strict-origin-when-cross-origin&quot;;    # Content Security Policy: é˜²æ­¢ä»£ç æ³¨å…¥æ”»å‡»ï¼ˆåŸºç¡€é…ç½®ï¼‰    add_header Content-Security-Policy &quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; img-src &#x27;self&#x27; data: https:; font-src &#x27;self&#x27; data: https:; connect-src &#x27;self&#x27;; frame-ancestors &#x27;none&#x27;;&quot;;    # æ ¸å¿ƒï¼šåå‘ä»£ç†é…ç½®    location / &#123;        # å°†è¯·æ±‚è½¬å‘åˆ°åç«¯åº”ç”¨        proxy_pass http://127.0.0.1:8080;        # è®¾ç½®å¿…è¦çš„è¯·æ±‚å¤´ï¼Œä»¥ä¾¿åç«¯åº”ç”¨èƒ½è·å–åˆ°çœŸå®çš„å®¢æˆ·ç«¯ä¿¡æ¯        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto $scheme;        # WebSocket æ”¯æŒ (å¦‚æœåç«¯åº”ç”¨éœ€è¦)        proxy_http_version 1.1;        proxy_set_header Upgrade $http_upgrade;        proxy_set_header Connection &quot;upgrade&quot;;    &#125;&#125;\n\nç¬¬å››æ­¥ï¼šä½¿ç”¨ Certbot è‡ªåŠ¨é…ç½® SSLLetâ€™s Encrypt æä¾›å…è´¹çš„ SSL è¯ä¹¦ï¼Œcertbot æ˜¯å…¶å®˜æ–¹æ¨èçš„å®¢æˆ·ç«¯ã€‚\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo apt install -y certbot python3-certbot-nginx# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo certbot --nginx -d your_domain.com -d www.your_domain.com# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo certbot renew --dry-run\næ‰§è¡Œå®Œæ¯•åï¼Œä½ çš„ç½‘ç«™å°±åº”è¯¥å¯ä»¥é€šè¿‡ https://your_domain.com è®¿é—®äº†ã€‚\nç¬¬äº”æ­¥ï¼šé…ç½®å¤šä¸ªæœ¬åœ°åº”ç”¨çš„åå‘ä»£ç† (å¯é€‰)å¦‚æœä½ æœ‰å¤šä¸ªæœ¬åœ°åº”ç”¨éœ€è¦é€šè¿‡åŒä¸€ä¸ªåŸŸåè®¿é—®ï¼Œå¯ä»¥åŸºäºä¸åŒçš„è·¯å¾„å‰ç¼€è¿›è¡Œåå‘ä»£ç†é…ç½®ã€‚\nç¼–è¾‘ä½ çš„é…ç½®æ–‡ä»¶ï¼šsudo nano /etc/nginx/sites-available/your_domain.com\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—server &#123;    listen 443 ssl http2;    listen [::]:443 ssl http2;    server_name your_domain.com www.your_domain.com;    # SSL è¯ä¹¦è·¯å¾„ (ç”± Certbot è‡ªåŠ¨é…ç½®)    ssl_certificate /etc/letsencrypt/live/your_domain.com/fullchain.pem;    ssl_certificate_key /etc/letsencrypt/live/your_domain.com/privkey.pem;    # SSL/TLS å®‰å…¨é…ç½®...    # (åŒä¹‹å‰çš„é…ç½®)    # --- å¤šä¸ªåº”ç”¨çš„åå‘ä»£ç†é…ç½® ---    # API æœåŠ¡ (è¿è¡Œåœ¨ç«¯å£ 3000)    location /api/ &#123;        proxy_pass http://127.0.0.1:3000/;        # è®¾ç½®å¿…è¦çš„è¯·æ±‚å¤´        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto $scheme;        # API æœåŠ¡ä¼˜åŒ–é…ç½®        proxy_buffering on;        proxy_buffer_size 4k;        proxy_buffers 8 4k;    &#125;    # ç®¡ç†åå° (è¿è¡Œåœ¨ç«¯å£ 8080)    location /admin/ &#123;        proxy_pass http://127.0.0.1:8080/;        # è®¾ç½®å¿…è¦çš„è¯·æ±‚å¤´        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto $scheme;    &#125;    # WebSocket æœåŠ¡ (è¿è¡Œåœ¨ç«¯å£ 9090)    location /ws/ &#123;        proxy_pass http://127.0.0.1:9090/;        # WebSocket ç‰¹æ®Šé…ç½®        proxy_http_version 1.1;        proxy_set_header Upgrade $http_upgrade;        proxy_set_header Connection &quot;upgrade&quot;;        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto $scheme;        # WebSocket è¶…æ—¶é…ç½®        proxy_read_timeout 86400;        proxy_send_timeout 86400;    &#125;    # é™æ€æ–‡ä»¶æœåŠ¡ (å‰ç«¯åº”ç”¨ï¼Œè¿è¡Œåœ¨ç«¯å£ 3001)    location / &#123;        proxy_pass http://127.0.0.1:3001/;        # è®¾ç½®å¿…è¦çš„è¯·æ±‚å¤´        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto $scheme;        # é™æ€æ–‡ä»¶ä¼˜åŒ–        proxy_cache_bypass $http_upgrade;        proxy_set_header Connection &quot;&quot;;    &#125;    # ç‰¹å®šæ–‡ä»¶ç±»å‹çš„ç¼“å­˜é…ç½®    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ &#123;        proxy_pass http://127.0.0.1:3001;        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto $scheme;        # ç¼“å­˜é…ç½®        expires 1y;        add_header Cache-Control &quot;public, immutable&quot;;        add_header Vary Accept-Encoding;    &#125;&#125;\n\né…ç½®è¯´æ˜\nè·¯å¾„åŒ¹é…è§„åˆ™ï¼š\n\n/api/ â†’ åŒ¹é…æ‰€æœ‰ä»¥ /api/ å¼€å¤´çš„è¯·æ±‚\n/admin/ â†’ åŒ¹é…æ‰€æœ‰ä»¥ /admin/ å¼€å¤´çš„è¯·æ±‚\n/ws/ â†’ åŒ¹é…æ‰€æœ‰ä»¥ /ws/ å¼€å¤´çš„è¯·æ±‚\n/ â†’ åŒ¹é…æ‰€æœ‰å…¶ä»–è¯·æ±‚ï¼ˆé»˜è®¤ï¼‰\n\n\nproxy_pass è·¯å¾„å¤„ç†ï¼š\n\nproxy_pass http://127.0.0.1:3000/ â†’ æœ«å°¾çš„ / ä¼šå°†åŒ¹é…çš„ location è·¯å¾„éƒ¨åˆ†å®Œå…¨æ›¿æ¢\nä¾‹å¦‚ï¼š/api/users â†’ è½¬å‘åˆ° http://127.0.0.1:3000/usersï¼ˆ/api/ è¢«å®Œå…¨ç§»é™¤ï¼‰\n\nå¯¹æ¯”ç¤ºä¾‹ï¼š\n# å¸¦æœ«å°¾æ–œæ ï¼ˆç§»é™¤åŒ¹é…è·¯å¾„ï¼‰location /api/ &#123;    proxy_pass http://127.0.0.1:3000/;&#125;# /api/users â†’ http://127.0.0.1:3000/users# ä¸å¸¦æœ«å°¾æ–œæ ï¼ˆä¿ç•™å®Œæ•´è·¯å¾„ï¼‰location /api/ &#123;    proxy_pass http://127.0.0.1:3000;&#125;# /api/users â†’ http://127.0.0.1:3000/api/users\n\nWebSocket æ”¯æŒæ³¨æ„äº‹é¡¹ï¼š\n\nå¿…é¡»è®¾ç½® proxy_http_version 1.1\nå¿…é¡»æ·»åŠ  Upgrade å’Œ Connection å¤´\nå»ºè®®å¢åŠ è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢è¿æ¥æ–­å¼€\n\n\næµ‹è¯•é…ç½®ï¼š\n\n\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo nginx -t# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—sudo systemctl restart nginx# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—curl -I https://your_domain.com\n\nç¬¬å…­æ­¥ï¼šé…ç½®è´Ÿè½½å‡è¡¡ (å¯é€‰)å¦‚æœä½ æœ‰å¤šä¸ªåç«¯åº”ç”¨æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨ Nginx çš„ upstream æ¨¡å—æ¥å®ç°è´Ÿè½½å‡è¡¡ã€‚\nç¼–è¾‘ä½ çš„é…ç½®æ–‡ä»¶ï¼šsudo nano /etc/nginx/sites-available/your_domain.com\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—upstream backend_servers &#123;    # é»˜è®¤ç­–ç•¥æ˜¯è½®è¯¢ (Round Robin)    server backend1.example.com:8080;    server backend2.example.com:8080;    # ä¹Ÿå¯ä»¥æŒ‡å®šæƒé‡ (weight)    # server backend1.example.com:8080 weight=3;    # server backend2.example.com:8080 weight=1;    # æˆ–è€…ä½¿ç”¨ ip_hash ç­–ç•¥ï¼Œç¡®ä¿åŒä¸€å®¢æˆ·ç«¯æ€»æ˜¯è®¿é—®åŒä¸€å°æœåŠ¡å™¨    # ip_hash;&#125;server &#123;    listen 443 ssl http2;    listen [::]:443 ssl http2;    server_name your_domain.com;    # SSL è¯ä¹¦é…ç½®ï¼ˆåŒå‰æ–‡ï¼‰    ssl_certificate /etc/letsencrypt/live/your_domain.com/fullchain.pem;    ssl_certificate_key /etc/letsencrypt/live/your_domain.com/privkey.pem;    # SSL å®‰å…¨é…ç½®ï¼ˆåŒå‰æ–‡ï¼‰    ssl_protocols TLSv1.2 TLSv1.3;    ssl_prefer_server_ciphers on;    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;    location / &#123;        # å°†è¯·æ±‚è½¬å‘åˆ°ä¸Šæ¸¸æœåŠ¡å™¨ç»„        proxy_pass http://backend_servers;        # è®¾ç½®å¿…è¦çš„è¯·æ±‚å¤´        proxy_set_header Host $host;        proxy_set_header X-Real-IP $remote_addr;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        proxy_set_header X-Forwarded-Proto $scheme;    &#125;&#125;\nä¿®æ”¹é…ç½®åï¼Œä¸è¦å¿˜è®°æµ‹è¯•å’Œé‡å¯ Nginxï¼šsudo nginx -t &amp;&amp; sudo systemctl restart nginxã€‚\né™„å½•ï¼šæ€§èƒ½ä¸å®‰å…¨ä¼˜åŒ–Gzip å‹ç¼©åœ¨ /etc/nginx/nginx.conf çš„ http å—ä¸­æ·»åŠ æˆ–å–æ¶ˆæ³¨é‡Šï¼š\nhttp &#123;    # ...    gzip on;    gzip_vary on;    gzip_proxied any;    gzip_comp_level 6;    gzip_min_length 1000;    gzip_types        text/plain        text/css        text/xml        text/javascript        application/javascript        application/xml+rss        application/json        application/xml        image/svg+xml;    # ...&#125;\n\néšè— Nginx ç‰ˆæœ¬å·åŒæ ·åœ¨ http å—ä¸­æ·»åŠ ï¼š\nhttp &#123;    # ...    server_tokens off;    # ...&#125;\n\nç¼“å†²åŒºä¼˜åŒ–åœ¨ http æˆ– server å—ä¸­é…ç½®ï¼š\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—client_body_buffer_size 128k;client_max_body_size 20m;# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—proxy_buffering on;proxy_buffer_size 4k;proxy_buffers 8 4k;proxy_busy_buffers_size 8k;# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—client_header_timeout 10;client_body_timeout 10;keepalive_timeout 65;send_timeout 10;\n\nè¿æ¥é™åˆ¶é˜²æ­¢ DoS æ”»å‡»ï¼š\n# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—limit_conn_zone $binary_remote_addr zone=addr:10m;# Nginx Ubuntu åå‘ä»£ç†æŒ‡å—limit_conn addr 10;\n\nç¦ç”¨ä¸å®‰å…¨çš„ HTTP æ–¹æ³•server &#123;    # ...    # ç¦ç”¨ TRACE å’Œ TRACK æ–¹æ³•    if ($request_method ~ ^(TRACE|TRACK)$) &#123;        return 405;    &#125;&#125;\n\nå¸¸è§é—®é¢˜Q: 502 Bad Gateway é”™è¯¯?A: è¿™é€šå¸¸æ„å‘³ç€ Nginx æ— æ³•è¿æ¥åˆ°ä½ çš„åç«¯åº”ç”¨ã€‚è¯·æ£€æŸ¥ï¼š\n\nä½ çš„åç«¯åº”ç”¨ï¼ˆå¦‚ Node.js, Javaï¼‰æ˜¯å¦æ­£åœ¨ 127.0.0.1:8080 ä¸Šæ­£å¸¸è¿è¡Œã€‚\næ£€æŸ¥åç«¯åº”ç”¨çš„é˜²ç«å¢™è®¾ç½®ã€‚\næŸ¥çœ‹ Nginx çš„é”™è¯¯æ—¥å¿— sudo tail -f /var/log/nginx/error.logã€‚\n\nQ: HTTPS ç½‘ç«™æç¤ºä¸å®‰å…¨?A: è¿™é€šå¸¸æ˜¯ SSL è¯ä¹¦é…ç½®é—®é¢˜ã€‚\n\nç¡®ä¿è¯ä¹¦è·¯å¾„æ­£ç¡®ã€‚\nç¡®ä¿è¯ä¹¦é“¾å®Œæ•´ (fullchain.pem)ã€‚\nä½¿ç”¨ SSL Labs çš„ SSL Test å·¥å…·æ¥å…¨é¢åˆ†æä½ çš„ HTTPS é…ç½®ã€‚\n\nQ: è¯ä¹¦ç»­æœŸå¤±è´¥?\nA: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š\n\nç¡®è®¤æœåŠ¡å™¨æ—¶é—´æ­£ç¡®ï¼šsudo timedatectl status\næ‰‹åŠ¨æµ‹è¯•ç»­æœŸï¼šsudo certbot renew --dry-run\næ£€æŸ¥ cron æˆ– systemd timer æ˜¯å¦æ­£å¸¸è¿è¡Œï¼šsudo systemctl status certbot.timer\n\nQ: WebSocket è¿æ¥å¤±è´¥?\nA: æ£€æŸ¥ä»¥ä¸‹é…ç½®ï¼š\n\nç¡®ä¿è®¾ç½®äº† proxy_http_version 1.1\nç¡®ä¿æ·»åŠ äº†æ­£ç¡®çš„ Upgrade å’Œ Connection å¤´\næ£€æŸ¥åç«¯åº”ç”¨æ˜¯å¦æ”¯æŒ WebSocket\nç¡®è®¤è¶…æ—¶è®¾ç½®è¶³å¤Ÿé•¿\n\nQ: é™æ€æ–‡ä»¶ 404 é”™è¯¯?\nA: å¯èƒ½çš„åŸå› ï¼š\n\nåç«¯åº”ç”¨ç«¯å£æœªæ­£ç¡®å¯åŠ¨\né™æ€æ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®\næƒé™é—®é¢˜ï¼šæ£€æŸ¥ sudo chown -R www-data:www-data /var/www/\næ£€æŸ¥ SELinux æˆ– AppArmor æ˜¯å¦é˜»æ­¢è®¿é—®\n\nQ: å¦‚ä½•æŸ¥çœ‹ Nginx è®¿é—®æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—?\nA: æ—¥å¿—æ–‡ä»¶ä½ç½®ï¼š\n\nè®¿é—®æ—¥å¿—ï¼š/var/log/nginx/access.log\né”™è¯¯æ—¥å¿—ï¼š/var/log/nginx/error.log\nå®æ—¶ç›‘æ§ï¼šsudo tail -f /var/log/nginx/error.log\n\nQ: å¦‚ä½•é‡è½½ Nginx é…ç½®è€Œä¸ä¸­æ–­æœåŠ¡?\nA: ä½¿ç”¨é‡è½½å‘½ä»¤ï¼š\nsudo nginx -t &amp;&amp; sudo systemctl reload nginx","categories":["åç«¯æœåŠ¡æ¶æ„","WebæœåŠ¡å™¨é…ç½®"],"tags":["Nginx","Ubuntu","SSL","åå‘ä»£ç†","HTTPS","Let's Encrypt","è´Ÿè½½å‡è¡¡"]},{"title":"æ–‡ä»¶ç®¡ç† API è§„èŒƒ","url":"/posts/eed6fb04/","content":"æ–‡ä»¶ç®¡ç† API è§„èŒƒ\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14ç‰ˆæœ¬: v1.0æ ‡ç­¾: api, rest, file-management, authentication, swagger\n\nğŸ“‘ ç›®å½•\n1. åŸºç¡€ä¿¡æ¯\n2. è®¤è¯ä¸æˆæƒ\n3. æ–‡ä»¶ç®¡ç†\n4. æ–‡ä»¶æ”¯æŒ\n5. é”™è¯¯å¤„ç†\n6. å®‰å…¨æœºåˆ¶\n7. é€Ÿç‡é™åˆ¶\n8. OpenAPI è§„èŒƒ\n\n\n1. ğŸ“‹ åŸºç¡€ä¿¡æ¯\n\n\né¡¹ç›®\nè¯´æ˜\n\n\n\nBase URL\n/api/v1\n\n\nåè®®\nHTTPS\n\n\næ•°æ®æ ¼å¼\nJSON\n\n\nè®¤è¯æ–¹å¼\nJWT Bearer Token\n\n\nAPI ç‰ˆæœ¬\nv1.0\n\n\nğŸ” è®¤è¯è¯·æ±‚æ ¼å¼GET /api/v1/files/list HTTP/1.1Host: your-domain.comAuthorization: Bearer &lt;jwt_token&gt;Content-Type: application/json\n\n\n2. ğŸ” è®¤è¯ä¸æˆæƒ2.1 ğŸ‘¤ ç”¨æˆ·æ³¨å†ŒsequenceDiagram    participant C as Client    participant A as API Server    participant D as Database    C-&gt;&gt;A: POST /auth/register    A-&gt;&gt;A: éªŒè¯è¾“å…¥æ•°æ®    A-&gt;&gt;D: æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨    D--&gt;&gt;A: è¿”å›æ£€æŸ¥ç»“æœ    A-&gt;&gt;A: åŠ å¯†å¯†ç     A-&gt;&gt;D: åˆ›å»ºæ–°ç”¨æˆ·    D--&gt;&gt;A: è¿”å›ç”¨æˆ·ä¿¡æ¯    A-&gt;&gt;A: ç”ŸæˆJWT Token    A--&gt;&gt;C: è¿”å›ç”¨æˆ·ä¿¡æ¯å’ŒToken\n\næ¥å£è¯¦æƒ…è¯·æ±‚:\nPOST /api/v1/auth/registerContent-Type: application/json\n\nè¯·æ±‚ä½“:\n&#123;    &quot;username&quot;: &quot;string&quot;,    &quot;email&quot;: &quot;user@example.com&quot;,    &quot;password&quot;: &quot;string&quot;,    &quot;confirmPassword&quot;: &quot;string&quot;&#125;\n\néªŒè¯è§„åˆ™:\n&#123;    &quot;username&quot;: &#123;        &quot;required&quot;: true,        &quot;minLength&quot;: 3,        &quot;maxLength&quot;: 20,        &quot;pattern&quot;: &quot;^[a-zA-Z0-9_]+$&quot;    &#125;,    &quot;email&quot;: &#123;        &quot;required&quot;: true,        &quot;format&quot;: &quot;email&quot;    &#125;,    &quot;password&quot;: &#123;        &quot;required&quot;: true,        &quot;minLength&quot;: 8,        &quot;pattern&quot;: &quot;^(?=.*[a-z])(?=.*[A-Z])(?=.*\\\\d)(?=.*[@$!%*?&amp;])[A-Za-z\\\\d@$!%*?&amp;]&quot;    &#125;&#125;\n\næˆåŠŸå“åº” (201):\n&#123;    &quot;success&quot;: true,    &quot;message&quot;: &quot;æ³¨å†ŒæˆåŠŸ&quot;,    &quot;data&quot;: &#123;        &quot;user&quot;: &#123;            &quot;id&quot;: &quot;uuid&quot;,            &quot;username&quot;: &quot;string&quot;,            &quot;email&quot;: &quot;user@example.com&quot;,            &quot;createdAt&quot;: &quot;2025-11-14T10:00:00Z&quot;        &#125;,        &quot;token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;    &#125;&#125;\n\n2.2 ğŸ”‘ ç”¨æˆ·ç™»å½•è¯·æ±‚:\nPOST /api/v1/auth/loginContent-Type: application/json\n\nè¯·æ±‚ä½“:\n&#123;    &quot;username&quot;: &quot;string&quot;,    &quot;password&quot;: &quot;string&quot;&#125;\n\næˆåŠŸå“åº” (200):\n&#123;    &quot;success&quot;: true,    &quot;message&quot;: &quot;ç™»å½•æˆåŠŸ&quot;,    &quot;data&quot;: &#123;        &quot;user&quot;: &#123;            &quot;id&quot;: &quot;uuid&quot;,            &quot;username&quot;: &quot;string&quot;,            &quot;email&quot;: &quot;user@example.com&quot;,            &quot;lastLoginAt&quot;: &quot;2025-11-14T10:00:00Z&quot;        &#125;,        &quot;token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;,        &quot;expiresIn&quot;: 86400    &#125;&#125;\n\n2.3 ğŸŒ OAuth é›†æˆgraph TD    A[ç”¨æˆ·ç‚¹å‡»Googleç™»å½•] --&gt; B[é‡å®šå‘åˆ°Google OAuth]    B --&gt; C[ç”¨æˆ·æˆæƒ]    C --&gt; D[Googleå›è°ƒå¤„ç†]    D --&gt; E[åˆ›å»ºæˆ–æŸ¥æ‰¾ç”¨æˆ·]    E --&gt; F[ç”ŸæˆJWT Token]    F --&gt; G[é‡å®šå‘åˆ°åº”ç”¨]    style A fill:#e1f5fe    style G fill:#e8f5e8\n\n\n3. ğŸ“ æ–‡ä»¶ç®¡ç†3.1 ğŸ“¤ å•æ–‡ä»¶ä¸Šä¼ sequenceDiagram    participant C as Client    participant S as API Server    participant F as File Storage    participant D as Database    C-&gt;&gt;S: POST /files/upload (multipart/form-data)    S-&gt;&gt;S: éªŒè¯è®¤è¯Token    S-&gt;&gt;S: æ–‡ä»¶ç±»å‹å’Œå¤§å°éªŒè¯    S-&gt;&gt;S: ç”Ÿæˆå”¯ä¸€æ–‡ä»¶å    S-&gt;&gt;F: ä¿å­˜æ–‡ä»¶    F--&gt;&gt;S: è¿”å›æ–‡ä»¶ä¿¡æ¯    S-&gt;&gt;D: ä¿å­˜æ–‡ä»¶å…ƒæ•°æ®    D--&gt;&gt;S: è¿”å›ä¿å­˜ç»“æœ    S--&gt;&gt;C: è¿”å›ä¸Šä¼ ç»“æœ\n\næ¥å£è¯¦æƒ…è¯·æ±‚:\nPOST /api/v1/files/uploadAuthorization: Bearer &lt;token&gt;Content-Type: multipart/form-data\n\nè¯·æ±‚ä½“:\nfile: &lt;binary_data&gt;\n\næˆåŠŸå“åº” (200):\n&#123;    &quot;success&quot;: true,    &quot;message&quot;: &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ&quot;,    &quot;data&quot;: &#123;        &quot;file&quot;: &#123;            &quot;id&quot;: &quot;uuid&quot;,            &quot;name&quot;: &quot;document.pdf&quot;,            &quot;originalName&quot;: &quot;æˆ‘çš„æ–‡æ¡£.pdf&quot;,            &quot;size&quot;: 1048576,            &quot;mimeType&quot;: &quot;application/pdf&quot;,            &quot;path&quot;: &quot;/uploads/2025/11/14/uuid-document.pdf&quot;,            &quot;uploadTime&quot;: &quot;2025-11-14T10:00:00Z&quot;,            &quot;checksum&quot;: &quot;sha256:abc123...&quot;        &#125;    &#125;&#125;\n\n3.2 ğŸ“¦ å¤šæ–‡ä»¶ä¸Šä¼ è¯·æ±‚:\nPOST /api/v1/files/multi-uploadAuthorization: Bearer &lt;token&gt;Content-Type: multipart/form-data\n\né™åˆ¶:\n\næœ€å¤§æ–‡ä»¶æ•°é‡: 10ä¸ª\nå•æ–‡ä»¶æœ€å¤§å¤§å°: 100MB\næ€»å¤§å°é™åˆ¶: 500MB\n\næˆåŠŸå“åº” (200):\n&#123;    &quot;success&quot;: true,    &quot;message&quot;: &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ&quot;,    &quot;data&quot;: &#123;        &quot;uploaded&quot;: [            &#123;                &quot;id&quot;: &quot;uuid1&quot;,                &quot;name&quot;: &quot;file1.pdf&quot;,                &quot;size&quot;: 1048576,                &quot;path&quot;: &quot;/uploads/uuid1-file1.pdf&quot;            &#125;,            &#123;                &quot;id&quot;: &quot;uuid2&quot;,                &quot;name&quot;: &quot;file2.jpg&quot;,                &quot;size&quot;: 2097152,                &quot;path&quot;: &quot;/uploads/uuid2-file2.jpg&quot;            &#125;        ],        &quot;failed&quot;: [],        &quot;summary&quot;: &#123;            &quot;total&quot;: 2,            &quot;uploaded&quot;: 2,            &quot;failed&quot;: 0,            &quot;totalSize&quot;: 3145728        &#125;    &#125;&#125;\n\n3.3 ğŸ“‹ è·å–æ–‡ä»¶åˆ—è¡¨è¯·æ±‚:\nGET /api/v1/files/list?page=1&amp;limit=20&amp;sort=name&amp;order=ascAuthorization: Bearer &lt;token&gt;\n\næŸ¥è¯¢å‚æ•°:\n\n\n\nå‚æ•°\nç±»å‹\né»˜è®¤å€¼\nè¯´æ˜\n\n\n\npage\ninteger\n1\né¡µç \n\n\nlimit\ninteger\n20\næ¯é¡µæ•°é‡ (1-100)\n\n\nsort\nstring\nname\næ’åºå­—æ®µ (name, size, uploadTime)\n\n\norder\nstring\ndesc\næ’åºæ–¹å‘ (asc, desc)\n\n\nsearch\nstring\n-\næœç´¢æ–‡ä»¶å\n\n\ntype\nstring\n-\næ–‡ä»¶ç±»å‹è¿‡æ»¤\n\n\næˆåŠŸå“åº” (200):\n&#123;    &quot;success&quot;: true,    &quot;message&quot;: &quot;Success&quot;,    &quot;data&quot;: &#123;        &quot;files&quot;: [            &#123;                &quot;id&quot;: &quot;uuid&quot;,                &quot;name&quot;: &quot;document.pdf&quot;,                &quot;size&quot;: 1048576,                &quot;mimeType&quot;: &quot;application/pdf&quot;,                &quot;path&quot;: &quot;/api/v1/files/download/uuid-document.pdf&quot;,                &quot;uploadTime&quot;: &quot;2025-11-14T10:00:00Z&quot;,                &quot;downloadCount&quot;: 5,                &quot;thumbnail&quot;: &quot;/api/v1/files/thumbnail/uuid-document.jpg&quot;            &#125;        ],        &quot;pagination&quot;: &#123;            &quot;page&quot;: 1,            &quot;limit&quot;: 20,            &quot;total&quot;: 100,            &quot;totalPages&quot;: 5,            &quot;hasNext&quot;: true,            &quot;hasPrev&quot;: false        &#125;,        &quot;stats&quot;: &#123;            &quot;totalFiles&quot;: 100,            &quot;totalSize&quot;: 1073741824,            &quot;totalDownloads&quot;: 1250        &#125;    &#125;&#125;\n\n3.4 â¬‡ï¸ æ–‡ä»¶ä¸‹è½½è¯·æ±‚:\nGET /api/v1/files/download/:filenameAuthorization: Bearer &lt;token&gt;\n\nURL å‚æ•°:\n\nfilename: æ–‡ä»¶åæˆ–æ–‡ä»¶ID\n\nåŠŸèƒ½ç‰¹æ€§:\n\nâœ… æ”¯æŒæ–­ç‚¹ç»­ä¼ \nâœ… ä¸‹è½½ç»Ÿè®¡\nâœ… è®¿é—®æƒé™éªŒè¯\nâœ… ä¸‹è½½æ—¥å¿—è®°å½•\n\nå“åº”å¤´:\nContent-Type: application/octet-streamContent-Disposition: attachment; filename=&quot;document.pdf&quot;Content-Length: 1048576Accept-Ranges: bytesETag: &quot;abc123...&quot;Last-Modified: Wed, 14 Nov 2025 10:00:00 GMT\n\n\n4. ğŸ“ æ–‡ä»¶æ”¯æŒ4.1 ğŸ¨ å…è®¸çš„æ–‡ä»¶ç±»å‹graph TD    A[æ”¯æŒçš„æ–‡ä»¶ç±»å‹] --&gt; B[å›¾ç‰‡æ–‡ä»¶]    A --&gt; C[æ–‡æ¡£æ–‡ä»¶]    A --&gt; D[å‹ç¼©æ–‡ä»¶]    A --&gt; E[ä»£ç æ–‡ä»¶]    B --&gt; B1[image/*]    B --&gt; B2[jpeg, png, gif, webp]    C --&gt; C1[application/pdf]    C --&gt; C2[application/msword]    C --&gt; C3[text/plain]    D --&gt; D1[application/zip]    D --&gt; D2[application/x-rar-compressed]    E --&gt; E1[text/x-code]    E --&gt; E2[application/json]\n\nè¯¦ç»†MIMEç±»å‹åˆ—è¡¨:\n&#123;    &quot;images&quot;: [&quot;image/jpeg&quot;, &quot;image/png&quot;, &quot;image/gif&quot;, &quot;image/webp&quot;, &quot;image/svg+xml&quot;],    &quot;documents&quot;: [        &quot;application/pdf&quot;,        &quot;application/msword&quot;,        &quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;,        &quot;application/vnd.ms-excel&quot;,        &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;,        &quot;text/plain&quot;,        &quot;text/markdown&quot;    ],    &quot;archives&quot;: [        &quot;application/zip&quot;,        &quot;application/x-rar-compressed&quot;,        &quot;application/x-7z-compressed&quot;    ],    &quot;code&quot;: [        &quot;text/x-code&quot;,        &quot;application/json&quot;,        &quot;text/xml&quot;,        &quot;application/xml&quot;    ]&#125;\n\n4.2 ğŸ“ æ–‡ä»¶å¤§å°é™åˆ¶\n\n\næ–‡ä»¶ç±»å‹\næœ€å¤§å¤§å°\nè¯´æ˜\n\n\n\nå›¾ç‰‡æ–‡ä»¶\n50MB\nJPEG, PNG, GIFç­‰\n\n\nPDFæ–‡æ¡£\n100MB\nPDFæ–‡æ¡£\n\n\nOfficeæ–‡æ¡£\n100MB\nWord, Excel, PowerPoint\n\n\nå‹ç¼©æ–‡ä»¶\n200MB\nZIP, RAR, 7Z\n\n\nå…¶ä»–æ–‡ä»¶\n50MB\nå…¶ä»–å…è®¸çš„ç±»å‹\n\n\n4.3 ğŸ–¼ï¸ ç¼©ç•¥å›¾ç”Ÿæˆgraph LR    A[ä¸Šä¼ æ–‡ä»¶] --&gt; B&#123;æ˜¯å¦ä¸ºå›¾ç‰‡?&#125;    B --&gt;|æ˜¯| C[ç”Ÿæˆç¼©ç•¥å›¾]    B --&gt;|å¦| D[ä½¿ç”¨é»˜è®¤å›¾æ ‡]    C --&gt; E[å­˜å‚¨ç¼©ç•¥å›¾]    D --&gt; F[è¿”å›å›¾æ ‡è·¯å¾„]    E --&gt; G[è¿”å›ç¼©ç•¥å›¾URL]\n\nç¼©ç•¥å›¾è§„æ ¼:\n\nå°ºå¯¸: 200x200 åƒç´ \næ ¼å¼: JPEG\nè´¨é‡: 85%\nå­˜å‚¨è·¯å¾„: /thumbnails/{file_id}.jpg\n\n\n5. âŒ é”™è¯¯å¤„ç†5.1 ğŸ“Š æ ‡å‡†é”™è¯¯å“åº”æ ¼å¼&#123;    &quot;success&quot;: false,    &quot;error&quot;: &#123;        &quot;code&quot;: &quot;ERROR_CODE&quot;,        &quot;message&quot;: &quot;ç”¨æˆ·å‹å¥½çš„é”™è¯¯æè¿°&quot;,        &quot;details&quot;: &quot;è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼ˆå¼€å‘ç¯å¢ƒï¼‰&quot;,        &quot;timestamp&quot;: &quot;2025-11-14T10:00:00Z&quot;,        &quot;path&quot;: &quot;/api/v1/files/upload&quot;    &#125;,    &quot;requestId&quot;: &quot;uuid-for-tracking&quot;&#125;\n\n5.2 ğŸ“‹ HTTP çŠ¶æ€ç \n\n\nçŠ¶æ€ç \nè¯´æ˜\nç¤ºä¾‹åœºæ™¯\n\n\n\n200\næˆåŠŸ\næ–‡ä»¶ä¸Šä¼ æˆåŠŸ\n\n\n201\nåˆ›å»ºæˆåŠŸ\nç”¨æˆ·æ³¨å†ŒæˆåŠŸ\n\n\n400\nè¯·æ±‚é”™è¯¯\nå‚æ•°éªŒè¯å¤±è´¥\n\n\n401\næœªè®¤è¯\nTokenæ— æ•ˆæˆ–è¿‡æœŸ\n\n\n403\næƒé™ä¸è¶³\nè®¿é—®ä»–äººæ–‡ä»¶\n\n\n404\nèµ„æºä¸å­˜åœ¨\næ–‡ä»¶ä¸å­˜åœ¨\n\n\n409\nå†²çª\nç”¨æˆ·åå·²å­˜åœ¨\n\n\n413\næ–‡ä»¶è¿‡å¤§\nè¶…è¿‡å¤§å°é™åˆ¶\n\n\n415\nä¸æ”¯æŒçš„ç±»å‹\næ–‡ä»¶ç±»å‹ä¸å…è®¸\n\n\n422\néªŒè¯å¤±è´¥\nä¸šåŠ¡é€»è¾‘éªŒè¯å¤±è´¥\n\n\n429\nè¯·æ±‚è¿‡å¤š\nè¶…å‡ºé€Ÿç‡é™åˆ¶\n\n\n500\næœåŠ¡å™¨é”™è¯¯\nå†…éƒ¨æœåŠ¡å™¨é”™è¯¯\n\n\n5.3 ğŸ”§ é”™è¯¯ä»£ç å®šä¹‰const ErrorCodes = &#123;    // è®¤è¯ç›¸å…³    AUTH_TOKEN_MISSING: &#x27;AUTH_001&#x27;,    AUTH_TOKEN_INVALID: &#x27;AUTH_002&#x27;,    AUTH_TOKEN_EXPIRED: &#x27;AUTH_003&#x27;,    // ç”¨æˆ·ç›¸å…³    USER_NOT_FOUND: &#x27;USER_001&#x27;,    USER_ALREADY_EXISTS: &#x27;USER_002&#x27;,    USER_CREDENTIALS_INVALID: &#x27;USER_003&#x27;,    // æ–‡ä»¶ç›¸å…³    FILE_NOT_FOUND: &#x27;FILE_001&#x27;,    FILE_TOO_LARGE: &#x27;FILE_002&#x27;,    FILE_TYPE_NOT_ALLOWED: &#x27;FILE_003&#x27;,    FILE_UPLOAD_FAILED: &#x27;FILE_004&#x27;,    // ç³»ç»Ÿç›¸å…³    RATE_LIMIT_EXCEEDED: &#x27;SYS_001&#x27;,    MAINTENANCE_MODE: &#x27;SYS_002&#x27;,    QUOTA_EXCEEDED: &#x27;SYS_003&#x27;&#125;;\n\n\n6. ğŸ”’ å®‰å…¨æœºåˆ¶6.1 ğŸ›¡ï¸ è®¤è¯ä¸æˆæƒgraph TD    A[å®¢æˆ·ç«¯è¯·æ±‚] --&gt; B[JWTéªŒè¯]    B --&gt; C&#123;Tokenæœ‰æ•ˆ?&#125;    C --&gt;|å¦| D[è¿”å›401é”™è¯¯]    C --&gt;|æ˜¯| E[æƒé™æ£€æŸ¥]    E --&gt; F&#123;æƒé™å……è¶³?&#125;    F --&gt;|å¦| G[è¿”å›403é”™è¯¯]    F --&gt;|æ˜¯| H[å¤„ç†è¯·æ±‚]    H --&gt; I[è¿”å›å“åº”]\n\nJWT Token ç»“æ„&#123;    &quot;header&quot;: &#123;        &quot;alg&quot;: &quot;HS256&quot;,        &quot;typ&quot;: &quot;JWT&quot;    &#125;,    &quot;payload&quot;: &#123;        &quot;sub&quot;: &quot;user_id&quot;,        &quot;username&quot;: &quot;string&quot;,        &quot;email&quot;: &quot;user@example.com&quot;,        &quot;role&quot;: &quot;user&quot;,        &quot;iat&quot;: 1640000000,        &quot;exp&quot;: 1640086400    &#125;&#125;\n\n6.2 ğŸ” å¯†ç å®‰å…¨// å¯†ç åŠ å¯†ç¤ºä¾‹const bcrypt = require(&#x27;bcrypt&#x27;);const hashPassword = async (password) =&gt; &#123;    const saltRounds = 12;    return await bcrypt.hash(password, saltRounds);&#125;;const verifyPassword = async (password, hash) =&gt; &#123;    return await bcrypt.compare(password, hash);&#125;;\n\n6.3 ğŸ“ è¾“å…¥éªŒè¯æ–‡ä»¶åéªŒè¯:\n&#123;    &quot;filename&quot;: &#123;        &quot;required&quot;: true,        &quot;pattern&quot;: &quot;^[a-zA-Z0-9._-]+$&quot;,        &quot;maxLength&quot;: 255,        &quot;sanitize&quot;: true    &#125;&#125;\n\nSQLæ³¨å…¥é˜²æŠ¤:\n\nä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢\nè¾“å…¥è½¬ä¹‰å’Œè¿‡æ»¤\næœ€å°æƒé™åŸåˆ™\n\n\n7. â±ï¸ é€Ÿç‡é™åˆ¶7.1 ğŸš¦ é™åˆ¶ç­–ç•¥graph LR    A[è¯·æ±‚] --&gt; B[é€Ÿç‡é™åˆ¶æ£€æŸ¥]    B --&gt; C&#123;è¶…å‡ºé™åˆ¶?&#125;    C --&gt;|æ˜¯| D[è¿”å›429é”™è¯¯]    C --&gt;|å¦| E[å¤„ç†è¯·æ±‚]    E --&gt; F[æ›´æ–°è®¡æ•°å™¨]    style D fill:#ffcdd2    style F fill:#c8e6c9\n\n7.2 ğŸ“Š é™åˆ¶è§„åˆ™\n\n\nç«¯ç‚¹ç±»å‹\næ—¶é—´çª—å£\næœ€å¤§è¯·æ±‚æ•°\nè¯´æ˜\n\n\n\nè®¤è¯ç›¸å…³\n15åˆ†é’Ÿ\n5æ¬¡&#x2F;IP\nç™»å½•ã€æ³¨å†Œ\n\n\næ–‡ä»¶ä¸Šä¼ \n1å°æ—¶\n50æ¬¡&#x2F;ç”¨æˆ·\nå•æ–‡ä»¶ä¸Šä¼ \n\n\næ–‡ä»¶ä¸‹è½½\n1å°æ—¶\n200æ¬¡&#x2F;ç”¨æˆ·\næ–‡ä»¶ä¸‹è½½\n\n\nå…¶ä»–API\n15åˆ†é’Ÿ\n100æ¬¡&#x2F;IP\nä¸€èˆ¬è¯·æ±‚\n\n\n7.3 ğŸ“ˆ é™åˆ¶å“åº”å¤´HTTP/1.1 429 Too Many RequestsX-RateLimit-Limit: 5X-RateLimit-Remaining: 0X-RateLimit-Reset: 1640090000Retry-After: 900\n\n\n8. ğŸ“‹ OpenAPI è§„èŒƒ8.1 ğŸ” Swagger é…ç½®openapi: 3.0.0info:  title: æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ API  description: åŸºäºJWTè®¤è¯çš„æ–‡ä»¶ç®¡ç†ç³»ç»ŸAPIæ–‡æ¡£  version: 1.0.0  contact:    name: API Support    email: support@example.com  license:    name: MIT    url: https://opensource.org/licenses/MITservers:  - url: https://api.example.com/api/v1    description: ç”Ÿäº§ç¯å¢ƒ  - url: https://dev-api.example.com/api/v1    description: å¼€å‘ç¯å¢ƒsecurity:  - bearerAuth: []components:  securitySchemes:    bearerAuth:      type: http      scheme: bearer      bearerFormat: JWT\n\n8.2 ğŸ“ API æ–‡æ¡£ç”Ÿæˆè®¿é—® Swagger UI:\n\nç”Ÿäº§ç¯å¢ƒ: https://api.example.com/docs\nå¼€å‘ç¯å¢ƒ: https://dev-api.example.com/docs\n\nä¸‹è½½ OpenAPI è§„èŒƒ:\ncurl -o api-spec.json https://api.example.com/api-spec\n\n\nğŸ“Š API ä½¿ç”¨ç»Ÿè®¡9.1 ğŸ“ˆ ä½¿ç”¨æƒ…å†µç›‘æ§graph TD    A[APIè¯·æ±‚] --&gt; B[è®°å½•è¯·æ±‚æ—¥å¿—]    B --&gt; C[æ›´æ–°ç»Ÿè®¡æ•°æ®]    C --&gt; D[å®æ—¶ç›‘æ§é¢æ¿]    E[é”™è¯¯è¯·æ±‚] --&gt; F[é”™è¯¯æ—¥å¿—è®°å½•]    F --&gt; G[å‘Šè­¦ç³»ç»Ÿ]    G --&gt; H[è¿ç»´å›¢é˜Ÿ]\n\n9.2 ğŸ” åˆ†ææŒ‡æ ‡\n\n\næŒ‡æ ‡\nè¯´æ˜\nç”¨é€”\n\n\n\nè¯·æ±‚é‡\nAPIè°ƒç”¨æ¬¡æ•°\næ€§èƒ½åˆ†æ\n\n\nå“åº”æ—¶é—´\nå¹³å‡å“åº”æ—¶é—´\næ€§èƒ½ä¼˜åŒ–\n\n\né”™è¯¯ç‡\n4xx&#x2F;5xxé”™è¯¯æ¯”ä¾‹\nç³»ç»Ÿç¨³å®šæ€§\n\n\nå¹¶å‘ç”¨æˆ·\nåŒæ—¶åœ¨çº¿ç”¨æˆ·æ•°\nå®¹é‡è§„åˆ’\n\n\n\nğŸ“š å®¢æˆ·ç«¯é›†æˆ10.1 ğŸ–¥ï¸ JavaScript å®¢æˆ·ç«¯ç¤ºä¾‹class FileManagerAPI &#123;    constructor(baseURL) &#123;        this.baseURL = baseURL;        this.token = null;    &#125;    setToken(token) &#123;        this.token = token;    &#125;    async request(method, endpoint, data = null, options = &#123;&#125;) &#123;        const config = &#123;            method,            headers: &#123;                &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,                ...options.headers            &#125;        &#125;;        if (this.token) &#123;            config.headers.Authorization = `Bearer $&#123;this.token&#125;`;        &#125;        if (data) &#123;            config.body = JSON.stringify(data);        &#125;        const response = await fetch(`$&#123;this.baseURL&#125;$&#123;endpoint&#125;`, config);        return await response.json();    &#125;    // ç”¨æˆ·ç™»å½•    async login(username, password) &#123;        const result = await this.request(&#x27;POST&#x27;, &#x27;/auth/login&#x27;, &#123;            username,            password        &#125;);        if (result.success) &#123;            this.setToken(result.data.token);        &#125;        return result;    &#125;    // ä¸Šä¼ æ–‡ä»¶    async uploadFile(file) &#123;        const formData = new FormData();        formData.append(&#x27;file&#x27;, file);        const response = await fetch(`$&#123;this.baseURL&#125;/files/upload`, &#123;            method: &#x27;POST&#x27;,            headers: &#123;                &#x27;Authorization&#x27;: `Bearer $&#123;this.token&#125;`            &#125;,            body: formData        &#125;);        return await response.json();    &#125;    // è·å–æ–‡ä»¶åˆ—è¡¨    async getFiles(page = 1, limit = 20) &#123;        return await this.request(&#x27;GET&#x27;, `/files/list?page=$&#123;page&#125;&amp;limit=$&#123;limit&#125;`);    &#125;&#125;// ä½¿ç”¨ç¤ºä¾‹const api = new FileManagerAPI(&#x27;https://api.example.com/api/v1&#x27;);\n\n\nğŸ“‹ æ€»ç»“âœ… API ç‰¹æ€§æ€»è§ˆ\nğŸ” å®‰å…¨è®¤è¯: JWT Token è®¤è¯æœºåˆ¶\nğŸ“ æ–‡ä»¶ç®¡ç†: å®Œæ•´çš„æ–‡ä»¶ä¸Šä¼ ä¸‹è½½åŠŸèƒ½\nğŸ¯ æƒé™æ§åˆ¶: ç”¨æˆ·çº§åˆ«çš„è®¿é—®æ§åˆ¶\nâš¡ æ€§èƒ½ä¼˜åŒ–: æ”¯æŒæ–­ç‚¹ç»­ä¼ å’Œç¼©ç•¥å›¾\nğŸ“Š ç›‘æ§ç»Ÿè®¡: å®Œæ•´çš„APIä½¿ç”¨ç»Ÿè®¡\nğŸ“ æ–‡æ¡£å®Œæ•´: è¯¦ç»†çš„APIæ–‡æ¡£å’Œç¤ºä¾‹\n\nğŸš€ é›†æˆå»ºè®®\nå‰ç«¯åº”ç”¨: ä½¿ç”¨ JavaScript SDK å¿«é€Ÿé›†æˆ\nç§»åŠ¨åº”ç”¨: ä½¿ç”¨ RESTful API è¿›è¡Œæ•°æ®äº¤äº’\nç¬¬ä¸‰æ–¹æœåŠ¡: é€šè¿‡ Webhook æ¥æ”¶æ–‡ä»¶äº‹ä»¶é€šçŸ¥\nä¼ä¸šé›†æˆ: æ”¯æŒ SSO å’Œä¼ä¸šçº§æƒé™ç®¡ç†\n\nğŸ”§ æ‰©å±•åŠŸèƒ½\nğŸ”„ æ–‡ä»¶åŒæ­¥: å¤šè®¾å¤‡æ–‡ä»¶åŒæ­¥\nğŸ“¤ åˆ†äº«é“¾æ¥: ç”Ÿæˆæ–‡ä»¶åˆ†äº«é“¾æ¥\nğŸ” å…¨æ–‡æœç´¢: æ–‡ä»¶å†…å®¹å…¨æ–‡æ£€ç´¢\nğŸ—‚ï¸ ç‰ˆæœ¬ç®¡ç†: æ–‡ä»¶ç‰ˆæœ¬å†å²è®°å½•\nğŸ“± ç§»åŠ¨ç«¯: ä¸“ç”¨çš„ç§»åŠ¨ç«¯API\n\n\n\nğŸ’¡ ä½¿ç”¨æç¤º:\n\næ‰€æœ‰APIè°ƒç”¨éƒ½éœ€è¦æœ‰æ•ˆçš„JWT Token\nå»ºè®®ä½¿ç”¨HTTPSç¡®ä¿ä¼ è¾“å®‰å…¨\nå®šæœŸè½®æ¢APIå¯†é’¥å’Œå¯†ç \nç›‘æ§APIä½¿ç”¨æƒ…å†µé¿å…è¶…å‡ºé…é¢é™åˆ¶\n\n\n","categories":["Webæ¶æ„å®‰å…¨"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—","url":"/posts/d7f169a4/","content":"Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€éƒ¨åˆ†ï¼šè¿æ¥ä¸å¥åº·æ£€æŸ¥\nç¬¬äºŒéƒ¨åˆ†ï¼šæ€§èƒ½ä¸è´Ÿè½½æµ‹è¯•\nç¬¬ä¸‰éƒ¨åˆ†ï¼šå®‰å…¨æ‰«æä¸æµ‹è¯•\nç¬¬å››éƒ¨åˆ†ï¼šå®æ—¶ç³»ç»Ÿç›‘æ§\nç¬¬äº”éƒ¨åˆ†ï¼šæ—¥å¿—åˆ†æ\n\næ¦‚è¿°æœ¬æŒ‡å—æä¾›äº†ä¸€ç³»åˆ—å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæµ‹è¯•ã€è¯Šæ–­å’Œç›‘æ§ä»»ä½• Web æœåŠ¡å™¨ï¼ˆå¦‚ Nginx, Apache ç­‰ï¼‰çš„å¥åº·çŠ¶å†µã€æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚\nç¬¬ä¸€éƒ¨åˆ†ï¼šè¿æ¥ä¸å¥åº·æ£€æŸ¥è¿™äº›å·¥å…·ç”¨äºå¿«é€ŸéªŒè¯æœåŠ¡å™¨æ˜¯å¦åœ¨çº¿ã€ç«¯å£æ˜¯å¦å¼€æ”¾ä»¥åŠæœåŠ¡æ˜¯å¦æ­£å¸¸å“åº”ã€‚\ncurlä¸€ä¸ªå¼ºå¤§çš„ URL ä¼ è¾“å·¥å…·ï¼Œç”¨äºå‘é€å„ç§ç½‘ç»œè¯·æ±‚ã€‚\n# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—curl -I http://your_domain.com# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—curl -I -L http://your_domain.com# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—curl -v https://your_domain.com\n\ntelnet &#x2F; nc (Netcat)ç”¨äºæµ‹è¯•ç‰¹å®šç«¯å£æ˜¯å¦å¯ä»¥å»ºç«‹ TCP è¿æ¥ã€‚\n# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—telnet your_domain.com 80# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—nc -zv your_domain.com 80nc -zv your_domain.com 443\n\nnmapä¸€ä¸ªç½‘ç»œæ‰«æå·¥å…·ï¼Œç”¨äºå‘ç°ä¸»æœºå’Œå¼€æ”¾çš„ç«¯å£ã€‚\n# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—nmap your_domain.com# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—nmap -p 80,443 your_domain.com\n\nç¬¬äºŒéƒ¨åˆ†ï¼šæ€§èƒ½ä¸è´Ÿè½½æµ‹è¯•è¿™äº›å·¥å…·ç”¨äºå‘æœåŠ¡å™¨æ–½åŠ å‹åŠ›ï¼Œä»¥è¯„ä¼°å…¶åœ¨è´Ÿè½½ä¸‹çš„æ€§èƒ½è¡¨ç°ã€‚\nab (Apache Bench)Apache è‡ªå¸¦çš„è½»é‡çº§å‹åŠ›æµ‹è¯•å·¥å…·ã€‚\n# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—ab -n 1000 -c 100 https://your_domain.com/# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—ab -k -n 10000 -c 200 https://your_domain.com/\n\nwrk &#x2F; wrk2ä¸€ä¸ªç°ä»£ã€é«˜æ€§èƒ½çš„ HTTP å‹æµ‹å·¥å…·ï¼Œèƒ½äº§ç”Ÿæé«˜çš„è´Ÿè½½ã€‚\n# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—wrk -t12 -c400 -d30s https://your_domain.com/# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—\n\nsiegeä¸€æ¬¾åŠŸèƒ½ä¸°å¯Œçš„å‹åŠ›æµ‹è¯•å·¥å…·ï¼Œå¯ä»¥æ¨¡æ‹Ÿå¤§é‡ç”¨æˆ·å¹¶å‘è®¿é—®ã€‚\n# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—siege -c 100 -t1M https://your_domain.com/# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—siege -c 50 -f urls.txt\n\nç¬¬ä¸‰éƒ¨åˆ†ï¼šå®‰å…¨æ‰«æä¸æµ‹è¯•openssl s_clientç”¨äºè°ƒè¯• SSL&#x2F;TLS è¿æ¥å’Œæ£€æŸ¥è¯ä¹¦ä¿¡æ¯ã€‚\n# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—openssl s_client -connect your_domain.com:443 -showcerts# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—openssl s_client -connect your_domain.com:443 -tls1_3\n\nåœ¨çº¿æ‰«æå·¥å…·\nSSL Labs SSL Test: å…¨é¢åˆ†æä½ ç½‘ç«™çš„ SSL&#x2F;TLS é…ç½®ï¼Œå¹¶ç»™å‡ºè¯„åˆ†å’Œæ”¹è¿›å»ºè®®ã€‚\nhttps://www.ssllabs.com/ssltest/\n\n\nSecurity Headers: æ£€æŸ¥ä½ ç½‘ç«™çš„ HTTP å®‰å…¨å¤´é…ç½®ã€‚\nhttps://securityheaders.com/\n\n\n\nç¬¬å››éƒ¨åˆ†ï¼šå®æ—¶ç³»ç»Ÿç›‘æ§è¿™äº›æ˜¯æ’æŸ¥æœåŠ¡å™¨æ€§èƒ½é—®é¢˜æ—¶æœ€å¸¸ç”¨çš„ Linux å‘½ä»¤ã€‚\nCPU ç›‘æ§\ntop: å®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶å†µã€‚\nhtop: top çš„å¢å¼ºç‰ˆï¼Œç•Œé¢æ›´å‹å¥½ï¼Œæ“ä½œæ›´æ–¹ä¾¿ã€‚\nvmstat 1: æ¯ç§’æŠ¥å‘Šä¸€æ¬¡è™šæ‹Ÿå†…å­˜ã€è¿›ç¨‹ã€CPU æ´»åŠ¨ç­‰ä¿¡æ¯ã€‚\n\nå†…å­˜ç›‘æ§\nfree -h: ä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µï¼ˆæ€»é‡ã€å·²ç”¨ã€å¯ç”¨ã€ç¼“å­˜ç­‰ï¼‰ã€‚\ncat /proc/meminfo: æ˜¾ç¤ºå†…æ ¸è¿½è¸ªåˆ°çš„è¯¦ç»†å†…å­˜ä¿¡æ¯ã€‚\n\nç£ç›˜ I&#x2F;O ç›‘æ§\ndf -h: æŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚\niostat -x 1: æ¯ç§’æ˜¾ç¤ºä¸€æ¬¡ç£ç›˜çš„è¯»å†™æ€§èƒ½æŒ‡æ ‡ï¼ˆå¦‚ await, %utilï¼‰ã€‚\n\nç½‘ç»œç›‘æ§\nnetstat -tlnp: æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨ç›‘å¬çš„ TCP å’Œ UDP ç«¯å£åŠå…¶å¯¹åº”çš„ç¨‹åºã€‚\niftop: å®æ—¶ç›‘æ§ç½‘ç»œæ¥å£çš„æµé‡ã€‚\nnethogs: æŒ‰è¿›ç¨‹åˆ†ç»„æ˜¾ç¤ºç½‘ç»œå¸¦å®½å ç”¨æƒ…å†µã€‚\n\nç¬¬äº”éƒ¨åˆ†ï¼šæ—¥å¿—åˆ†ææ—¥å¿—æ˜¯æ’æŸ¥é—®é¢˜çš„é‡‘çŸ¿ã€‚tail, grep, awk æ˜¯æœ€å¼ºå¤§çš„ç»„åˆã€‚\nå®æ—¶æŸ¥çœ‹æ—¥å¿—# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—sudo tail -f /var/log/nginx/access.log# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—sudo tail -f /var/log/apache2/error.log\n\nå¸¸ç”¨åˆ†æå‘½ä»¤# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—awk &#x27;&#123;print $1&#125;&#x27; /var/log/nginx/access.log | sort | uniq -c | sort -nr | head -10# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—awk &#x27;&#123;print $9&#125;&#x27; /var/log/apache2/access.log | sort | uniq -c | sort -nr# Web æœåŠ¡å™¨ç›‘æ§æŒ‡å—grep &#x27; 404 &#x27; /var/log/nginx/access.log\n","categories":["ç³»ç»Ÿè¿ç»´ç®¡ç†","ç›‘æ§ä¸è¯Šæ–­"],"tags":["Nginx","Apache","æ€§èƒ½æµ‹è¯•","è´Ÿè½½æµ‹è¯•","ç›‘æ§","è¯Šæ–­","ab","wrk"]},{"title":"Qt ä¸‹è½½å™¨éœ€æ±‚è§„èŒƒ","url":"/posts/6ee89f12/","content":"Qt ä¸‹è½½å™¨éœ€æ±‚è§„èŒƒ\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14ç‰ˆæœ¬: v1.0æ ‡ç­¾: qt, downloader, product-requirements, desktop-app, c++\n\nğŸ“‘ ç›®å½•\n1. äº§å“æ¦‚è¿°\n2. ç”¨æˆ·è§’è‰²\n3. åŠŸèƒ½éœ€æ±‚\n4. éåŠŸèƒ½éœ€æ±‚\n5. ç•Œé¢è®¾è®¡\n6. æ•°æ®æ¨¡å‹\n7. æŠ€æœ¯è§„èŒƒ\n8. äº¤ä»˜è¦æ±‚\n\n\n1. ğŸ¯ äº§å“æ¦‚è¿°1.1 äº§å“å®šä½åŸºäº Qt æ¡†æ¶å¼€å‘çš„æ¡Œé¢ä¸‹è½½ç®¡ç†å™¨ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¹¶å‘ä¸‹è½½ï¼Œæä¾›ç›´è§‚çš„ä»»åŠ¡ç®¡ç†ç•Œé¢å’Œå®æ—¶è¿›åº¦ç›‘æ§ã€‚\n1.2 æ ¸å¿ƒä»·å€¼\nâœ… æ‰¹é‡ä¸‹è½½ - æ”¯æŒå¤šä»»åŠ¡å¹¶å‘ä¸‹è½½\nâœ… è¿›åº¦ç›‘æ§ - å®æ—¶æ˜¾ç¤ºä¸‹è½½çŠ¶æ€å’Œè¿›åº¦\nâœ… æ–­ç‚¹ç»­ä¼  - æ”¯æŒä¸‹è½½ä¸­æ–­åç»§ç»­\nâœ… è·¨å¹³å° - æ”¯æŒ Windowsã€macOSã€Linux\n\n1.3 äº§å“æ¶æ„å›¾graph TD    A[ç”¨æˆ·ç•Œé¢] --&gt; B[ä»»åŠ¡ç®¡ç†å™¨]    B --&gt; C[ä¸‹è½½å¼•æ“]    C --&gt; D[ç½‘ç»œè¯·æ±‚å±‚]    B --&gt; E[æ•°æ®æŒä¹…åŒ–]    B --&gt; F[é…ç½®ç®¡ç†]    C --&gt; G[çº¿ç¨‹æ± ]    G --&gt; H[ä»»åŠ¡é˜Ÿåˆ—]    D --&gt; I[HTTP/HTTPS]    D --&gt; J[é‡å®šå‘å¤„ç†]    D --&gt; K[è®¤è¯å¤„ç†]    style A fill:#e1f5fe    style B fill:#f3e5f5    style C fill:#e8f5e8    style D fill:#fff3e0\n\n\n2. ğŸ‘¥ ç”¨æˆ·è§’è‰²2.1 ç›®æ ‡ç”¨æˆ·ç»ˆç«¯ç”¨æˆ· - éœ€è¦æ‰¹é‡ä¸‹è½½æ–‡ä»¶çš„ä¸ªäººç”¨æˆ·\n\næŠ€æœ¯èƒŒæ™¯ï¼šæ™®é€šè®¡ç®—æœºç”¨æˆ·\nä½¿ç”¨åœºæ™¯ï¼šä¸‹è½½è½¯ä»¶ã€æ–‡æ¡£ã€åª’ä½“æ–‡ä»¶\næ“ä½œä¹ æƒ¯ï¼šå›¾å½¢ç•Œé¢æ“ä½œ\n\n2.2 ç”¨æˆ·åœºæ™¯graph LR    A[ç”¨æˆ·è¾“å…¥URL] --&gt; B[æ·»åŠ ä¸‹è½½ä»»åŠ¡]    B --&gt; C[å¼€å§‹ä¸‹è½½]    C --&gt; D[ç›‘æ§è¿›åº¦]    D --&gt; E&#123;å®Œæˆä¸‹è½½?&#125;    E --&gt;|æ˜¯| F[é€šçŸ¥ç”¨æˆ·]    E --&gt;|å¦| D    F --&gt; G[ä»»åŠ¡å®Œæˆ]\n\n\n3. ğŸ“‹ åŠŸèƒ½éœ€æ±‚3.1 ğŸ›ï¸ ä»»åŠ¡ç®¡ç†3.1.1 æ·»åŠ ä»»åŠ¡\nURL è¾“å…¥: æ”¯æŒå•ä¸ªæˆ–å¤šä¸ª URLï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰\nURL æ ¼å¼: æ”¯æŒ HTTP&#x2F;HTTPS åè®®\nè®¤è¯æ”¯æŒ: URL ä¸­å¯åŒ…å«ç”¨æˆ·åå¯†ç  (user:pass@host)\næ‰¹é‡å¯¼å…¥: æ”¯æŒä»å‰ªè´´æ¿ç²˜è´´å¤šä¸ª URL\n\n3.1.2 ä»»åŠ¡åˆ—è¡¨æ˜¾ç¤ºè¡¨æ ¼åˆ—å¿…é¡»åŒ…å«:\n\næ–‡ä»¶å: ä» URL æå–æˆ– Content-Disposition è§£æ\næ–‡ä»¶å¤§å°: å­—èŠ‚æ•°ï¼Œè·å–åæ˜¾ç¤º (-1 è¡¨ç¤ºæœªçŸ¥)\nå·²ä¸‹è½½å¤§å°: å­—èŠ‚æ•°ï¼Œå®æ—¶åˆ·æ–°\nè¿›åº¦ç™¾åˆ†æ¯”: 0-100%ï¼Œå®æ—¶è®¡ç®—\nä¸‹è½½é€Ÿåº¦: B&#x2F;sï¼Œå®æ—¶åˆ·æ–°\nçŠ¶æ€: ç­‰å¾… &#x2F; ä¸‹è½½ä¸­ &#x2F; å·²å®Œæˆ &#x2F; é”™è¯¯\n\ngantt    title ä¸‹è½½ä»»åŠ¡çŠ¶æ€æµè½¬    dateFormat X    axisFormat %s    section ä¸‹è½½æµç¨‹    ç­‰å¾…ä¸­     :0, 10    ä¸‹è½½ä¸­     :10, 100    å·²å®Œæˆ     :100, 110    é”™è¯¯å¤„ç†   :a1, after a2, 20\n\n3.1.3 ä»»åŠ¡æ“ä½œ\nå¼€å§‹: å¯åŠ¨é€‰ä¸­çš„ä¸‹è½½ä»»åŠ¡\næš‚åœ: æš‚åœæ­£åœ¨ä¸‹è½½çš„ä»»åŠ¡\nå–æ¶ˆ: å–æ¶ˆä¸‹è½½å¹¶åˆ é™¤æœªå®Œæˆçš„æ–‡ä»¶\nåˆ é™¤: ä»åˆ—è¡¨ä¸­åˆ é™¤å·²å®Œæˆæˆ–å¤±è´¥çš„è®°å½•\n\n3.2 âš™ï¸ ä¸‹è½½å¼•æ“3.2.1 å¤šçº¿ç¨‹ä¸‹è½½// å•ä»»åŠ¡å¤šçº¿ç¨‹é…ç½®const int DEFAULT_THREAD_COUNT = 4;  // é»˜è®¤4çº¿ç¨‹const int MAX_THREAD_COUNT = 16;     // æœ€å¤§16çº¿ç¨‹\n\n\nåˆ†æ®µä¸‹è½½: å°†æ–‡ä»¶åˆ†ä¸ºå¤šä¸ªç‰‡æ®µå¹¶å‘ä¸‹è½½\nçº¿ç¨‹ç®¡ç†: æ¯ä¸ªä»»åŠ¡å¯é…ç½®ç‹¬ç«‹çº¿ç¨‹æ•°\nè´Ÿè½½å‡è¡¡: åŠ¨æ€è°ƒæ•´å„çº¿ç¨‹ä¸‹è½½é€Ÿåº¦\n\n3.2.2 ç½‘ç»œæ”¯æŒ\nåè®®æ”¯æŒ: HTTP&#x2F;HTTPS\né‡å®šå‘: è‡ªåŠ¨å¤„ç† 3xx é‡å®šå‘\nè®¤è¯: æ”¯æŒ Basic Authentication\nä»£ç†æ”¯æŒ: ç³»ç»Ÿä»£ç†è®¾ç½®\n\n3.2.3 å®Œæ•´æ€§æ ¡éªŒ\nå¤§å°æ ¡éªŒ: ä¸‹è½½å®Œæˆåæ ¡éªŒ Content-Length\nMD5æ ¡éªŒ: æœåŠ¡å™¨è¿”å› MD5 å¤´æ—¶è¿›è¡Œæ ¡éªŒ\næ–­ç‚¹ç»­ä¼ : æ”¯æŒä»ä¸­æ–­ä½ç½®ç»§ç»­ä¸‹è½½\n\n3.3 ğŸ’¾ è®¾ç½®ä¸æŒä¹…åŒ–3.3.1 é…ç½®ç®¡ç†\nä¸‹è½½ç›®å½•: é»˜è®¤ç³»ç»Ÿâ€ä¸‹è½½â€æ–‡ä»¶å¤¹ï¼Œå¯è‡ªå®šä¹‰\nå¹¶å‘é™åˆ¶: å…¨å±€æœ€å¤§åŒæ—¶ä¸‹è½½æ•°\nçº¿ç¨‹æ•°: æ¯ä»»åŠ¡é»˜è®¤çº¿ç¨‹æ•°\né‡è¯•æ¬¡æ•°: å¤±è´¥é‡è¯•æ¬¡æ•°\n\n3.3.2 ä»»åŠ¡æŒä¹…åŒ–\nè‡ªåŠ¨ä¿å­˜: ä»»åŠ¡çŠ¶æ€è‡ªåŠ¨ä¿å­˜\nå¯åŠ¨æ¢å¤: ç¨‹åºå¯åŠ¨æ—¶æ¢å¤æœªå®Œæˆä»»åŠ¡\nè®¾ç½®ä¿å­˜: ç”¨æˆ·é…ç½®æŒä¹…åŒ–å­˜å‚¨\n\n3.4 ğŸš¨ å¼‚å¸¸å¤„ç†ä¸åé¦ˆ3.4.1 ç½‘ç»œå¼‚å¸¸\nè‡ªåŠ¨é‡è¯•: ç½‘ç»œä¸­æ–­æ—¶è‡ªåŠ¨é‡è¯•3æ¬¡\næŒ‡æ•°é€€é¿: é‡è¯•é—´éš”é€æ¸å¢åŠ \né”™è¯¯åˆ†ç±»: åŒºåˆ†ä¸´æ—¶é”™è¯¯å’Œæ°¸ä¹…é”™è¯¯\n\n3.4.2 ç”¨æˆ·åé¦ˆ\nçŠ¶æ€æ›´æ–°: å®æ—¶æ›´æ–°ä»»åŠ¡çŠ¶æ€\né”™è¯¯æç¤º: æ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯\nå®Œæˆé€šçŸ¥: ä¸‹è½½å®Œæˆæ—¶ç³»ç»Ÿæ‰˜ç›˜é€šçŸ¥\nè¿›åº¦æç¤º: è¿›åº¦æ¡å’Œç™¾åˆ†æ¯”æ˜¾ç¤º\n\n\n4. ğŸš€ éåŠŸèƒ½éœ€æ±‚4.1 ğŸ–¥ï¸ å¹³å°å…¼å®¹æ€§\n\n\nå¹³å°\næœ€ä½ç‰ˆæœ¬\næ¶æ„\nQt ç‰ˆæœ¬\n\n\n\nWindows\nWindows 10+\nx64\nQt 5.3-5.12\n\n\nmacOS\n10.15+\nx64\nQt 5.3-5.12\n\n\nLinux\nUbuntu 22.04+\nx64\nQt 5.3-5.12\n\n\n4.2 âš¡ æ€§èƒ½è¦æ±‚\nå†…å­˜ä½¿ç”¨: åŒæ—¶10ä¸ªä»»åŠ¡å¹¶å‘æ—¶ï¼Œå³°å€¼å†…å­˜ â‰¤ 200MB\nUIå“åº”: ä»»ä½•æ“ä½œåœ¨ 200ms å†…ç»™å‡ºè§†è§‰åé¦ˆ\nä¸‹è½½é€Ÿåº¦: å……åˆ†åˆ©ç”¨å¯ç”¨å¸¦å®½\nå¯åŠ¨æ—¶é—´: å†·å¯åŠ¨ &lt; 3ç§’\n\n4.3 ğŸ”’ å®‰å…¨æ€§è¦æ±‚\nURLéªŒè¯: éªŒè¯è¾“å…¥URLæ ¼å¼\næ–‡ä»¶è·¯å¾„: é˜²æ­¢è·¯å¾„éå†æ”»å‡»\nä¸‹è½½é™åˆ¶: æ”¯æŒæ–‡ä»¶å¤§å°å’Œç±»å‹é™åˆ¶\nç”¨æˆ·æ•°æ®: æœ¬åœ°æ•°æ®åŠ å¯†å­˜å‚¨\n\n\n5. ğŸ¨ ç•Œé¢è®¾è®¡5.1 ä¸»ç•Œé¢å¸ƒå±€â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ URL è¾“å…¥æ¡†                                              â”‚â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚ â”‚ https://example.com/file1.zip                       â”‚ â”‚â”‚ â”‚ https://example.com/file2.pdf                       â”‚ â”‚â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚ [æ·»åŠ ] [å¼€å§‹å…¨éƒ¨] [æš‚åœå…¨éƒ¨] [åˆ é™¤é€‰ä¸­]                 â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ ä»»åŠ¡åˆ—è¡¨ (QTableView)                                  â”‚â”‚ æ–‡ä»¶å      â”‚ å¤§å°     â”‚ å·²ä¸‹è½½  â”‚ è¿›åº¦  â”‚ é€Ÿåº¦  â”‚ çŠ¶æ€ â”‚â”‚ file1.zip   â”‚ 100MB    â”‚ 50MB    â”‚ 50%   â”‚ 1MB/s â”‚ä¸‹è½½ä¸­â”‚â”‚ file2.pdf   â”‚ 20MB     â”‚ 20MB    â”‚ 100%  â”‚ 0     â”‚å®Œæˆ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ å…¨å±€é€Ÿåº¦: 1.5MB/s  å‰©ä½™æ—¶é—´: 2åˆ†é’Ÿ  ä»»åŠ¡æ•°: 2/10       â”‚â”‚ [è®¾ç½®] [å…³äº] [é€€å‡º]                                    â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n5.2 ç•Œé¢çŠ¶æ€å›¾stateDiagram-v2    [*] --&gt; åˆå§‹åŒ–ç•Œé¢    åˆå§‹åŒ–ç•Œé¢ --&gt; ç©ºé—²çŠ¶æ€    ç©ºé—²çŠ¶æ€ --&gt; ä¸‹è½½ä¸­: æ·»åŠ ä»»åŠ¡å¹¶å¼€å§‹    ä¸‹è½½ä¸­ --&gt; æš‚åœä¸­: ç”¨æˆ·æš‚åœ    æš‚åœä¸­ --&gt; ä¸‹è½½ä¸­: ç”¨æˆ·ç»§ç»­    ä¸‹è½½ä¸­ --&gt; å®Œæˆ: ä¸‹è½½å®Œæˆ    ä¸‹è½½ä¸­ --&gt; é”™è¯¯: ä¸‹è½½å¤±è´¥    é”™è¯¯ --&gt; ä¸‹è½½ä¸­: é‡è¯•ä¸‹è½½    å®Œæˆ --&gt; ç©ºé—²çŠ¶æ€: æ¸…é™¤ä»»åŠ¡\n\n\n6. ğŸ“Š æ•°æ®æ¨¡å‹6.1 æ ¸å¿ƒæ•°æ®ç»“æ„// ä¸‹è½½ä»»åŠ¡æ•°æ®æ¨¡å‹struct DownloadTask &#123;    QString id;                    // å”¯ä¸€æ ‡è¯†    QUrl url;                     // ä¸‹è½½URL    QString fileName;             // æœ¬åœ°æ–‡ä»¶å    QString savePath;             // ä¿å­˜è·¯å¾„    qint64 totalBytes;           // æ€»å¤§å° (-1=æœªçŸ¥)    qint64 downloadedBytes;      // å·²ä¸‹è½½å¤§å°    int progress;                 // è¿›åº¦ç™¾åˆ†æ¯” (0-100)    qint64 speed;                // å½“å‰é€Ÿåº¦ (B/s)    qint64 averageSpeed;         // å¹³å‡é€Ÿåº¦ (B/s)    QDateTime startTime;         // å¼€å§‹æ—¶é—´    QDateTime finishTime;        // å®Œæˆæ—¶é—´    enum State &#123;        Waiting,     // ç­‰å¾…å¼€å§‹        Running,     // ä¸‹è½½ä¸­        Paused,      // å·²æš‚åœ        Completed,   // å·²å®Œæˆ        Error,       // é”™è¯¯        Cancelled    // å·²å–æ¶ˆ    &#125; state;    enum Priority &#123;        Low = 1,        Normal = 2,        High = 3    &#125; priority;    QString errorMessage;        // é”™è¯¯ä¿¡æ¯    int retryCount;             // é‡è¯•æ¬¡æ•°    int maxRetries;             // æœ€å¤§é‡è¯•æ¬¡æ•°    QStringList downloadThreads;  // ä¸‹è½½çº¿ç¨‹åˆ—è¡¨&#125;;\n\n6.2 é…ç½®æ•°æ®ç»“æ„struct DownloadSettings &#123;    QString defaultDownloadPath;    // é»˜è®¤ä¸‹è½½è·¯å¾„    int maxConcurrentTasks;         // æœ€å¤§å¹¶å‘ä»»åŠ¡æ•°    int defaultThreadCount;         // é»˜è®¤çº¿ç¨‹æ•°    int maxRetryCount;             // æœ€å¤§é‡è¯•æ¬¡æ•°    bool autoRetry;                // è‡ªåŠ¨é‡è¯•    bool startOnStartup;           // å¼€æœºå¯åŠ¨    bool showNotifications;        // æ˜¾ç¤ºé€šçŸ¥    bool verifyIntegrity;          // éªŒè¯æ–‡ä»¶å®Œæ•´æ€§    qint64 maxFileSize;            // æœ€å¤§æ–‡ä»¶å¤§å°é™åˆ¶    QStringList blockedExtensions;  // ç¦æ­¢çš„æ–‡ä»¶æ‰©å±•å&#125;;\n\n\n7. ğŸ”§ æŠ€æœ¯è§„èŒƒ7.1 æŠ€æœ¯æ ˆ\nUIæ¡†æ¶: Qt Widgets (éQML)\nç½‘ç»œåº“: QNetworkRequest\nå¹¶å‘: QThread + QThreadPool\næŒä¹…åŒ–: QSettings + SQLite\næ—¥å¿—: QtMessageHandler\n\n7.2 ä»£ç ç»“æ„FastDownloader/â”œâ”€â”€ main.cpp                 # ç¨‹åºå…¥å£â”œâ”€â”€ MainWindow.h/.cpp         # ä¸»çª—å£â”œâ”€â”€ MainWindow.ui             # UIæ–‡ä»¶â”œâ”€â”€ DownloadTask.h/.cpp       # ä¸‹è½½ä»»åŠ¡æ•°æ®æ¨¡å‹â”œâ”€â”€ DownloadManager.h/.cpp    # ä¸‹è½½ç®¡ç†å™¨â”œâ”€â”€ Downloader.h/.cpp         # ä¸‹è½½å¼•æ“â”œâ”€â”€ SettingsDialog.h/.cpp     # è®¾ç½®å¯¹è¯æ¡†â”œâ”€â”€ SettingsDialog.ui         # è®¾ç½®UIâ””â”€â”€ resources/                # èµ„æºæ–‡ä»¶    â”œâ”€â”€ icons/    â””â”€â”€ translations/\n\n7.3 å…³é”®æŠ€æœ¯ç‚¹7.3.1 å¤šçº¿ç¨‹ä¸‹è½½class DownloadThread : public QThread &#123;    Q_OBJECTpublic:    void run() override;    void pause();    void stop();signals:    void progressChanged(qint64 bytesReceived, qint64 bytesTotal);    void speedChanged(qint64 speed);    void finished(bool success, const QString&amp; error);private:    QNetworkReply* m_reply;    QUrl m_url;    QString m_filePath;    qint64 m_startPos;    qint64 m_endPos;    bool m_paused;    bool m_stopped;&#125;;\n\n7.3.2 æ–­ç‚¹ç»­ä¼ // è·å–æ–‡ä»¶å·²ä¸‹è½½å¤§å°qint64 getDownloadedFileSize(const QString&amp; filePath) &#123;    QFile file(filePath);    if (file.exists()) &#123;        return file.size();    &#125;    return 0;&#125;// è®¾ç½®Rangeè¯·æ±‚å¤´QNetworkRequest createRangeRequest(const QUrl&amp; url, qint64 startPos) &#123;    QNetworkRequest request(url);    QString range = QString(&quot;bytes=%1-&quot;).arg(startPos);    request.setRawHeader(&quot;Range&quot;, range.toLatin1());    return request;&#125;\n\n7.4 æ€§èƒ½ä¼˜åŒ–\nå†…å­˜ç®¡ç†: åŠæ—¶é‡Šæ”¾ä¸‹è½½å®Œæˆçš„æ•°æ®\nç½‘ç»œä¼˜åŒ–: è¿æ¥æ± å’ŒKeep-Alive\nUIæ›´æ–°: ä½¿ç”¨å®šæ—¶å™¨å‡å°‘UIåˆ·æ–°é¢‘ç‡\nç£ç›˜IO: ç¼“å†²å†™å…¥ï¼Œå‡å°‘ç£ç›˜IOæ¬¡æ•°\n\n\n8. ğŸ“¦ äº¤ä»˜è¦æ±‚8.1 äº¤ä»˜ç‰©æ¸…å•\n æºä»£ç : å®Œæ•´çš„C++æºç å®ç°\n èµ„æºæ–‡ä»¶: å›¾æ ‡ã€UIæ–‡ä»¶ç­‰\n æ„å»ºè„šæœ¬: CMakeLists.txtæˆ–.proæ–‡ä»¶\n æµ‹è¯•ç”¨ä¾‹: å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•\n éƒ¨ç½²æ–‡æ¡£: ç¼–è¯‘å’Œéƒ¨ç½²è¯´æ˜\n\n8.2 ä»£ç è§„èŒƒ// å‘½åè§„èŒƒclass DownloadManager : public QObject &#123;  // ç±»åï¼šPascalCase    Q_OBJECTpublic:    explicit DownloadManager(QObject *parent = nullptr);  // å‡½æ•°åï¼šcamelCaseprivate slots:    void onDownloadProgress(qint64 bytesReceived, qint64 bytesTotal);  // æ§½å‡½æ•°å‘½åprivate:    int m_maxConcurrentTasks;  // æˆå‘˜å˜é‡ï¼šm_å‰ç¼€ï¼ŒcamelCase    QString m_defaultPath;&#125;;\n\n8.3 è´¨é‡è¦æ±‚\nä»£ç è¦†ç›–ç‡: â‰¥80%\nå†…å­˜æ³„æ¼: æ— å†…å­˜æ³„æ¼\næ–‡æ¡£å®Œæ•´: å…³é”®å‡½æ•°æœ‰æ³¨é‡Š\nå¼‚å¸¸å¤„ç†: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶\n\n\nğŸ“Š é¡¹ç›®é‡Œç¨‹ç¢‘Phase 1: åŸºç¡€æ¡†æ¶ (2å‘¨)\n ä¸»ç•Œé¢è®¾è®¡\n æ•°æ®æ¨¡å‹å®šä¹‰\n åŸºç¡€ä¸‹è½½åŠŸèƒ½\n\nPhase 2: æ ¸å¿ƒåŠŸèƒ½ (3å‘¨)\n å¤šçº¿ç¨‹ä¸‹è½½å®ç°\n æ–­ç‚¹ç»­ä¼ åŠŸèƒ½\n ä»»åŠ¡ç®¡ç†ç•Œé¢\n\nPhase 3: é«˜çº§åŠŸèƒ½ (2å‘¨)\n é…ç½®ç®¡ç†\n å¼‚å¸¸å¤„ç†\n æ€§èƒ½ä¼˜åŒ–\n\nPhase 4: æµ‹è¯•å‘å¸ƒ (1å‘¨)\n åŠŸèƒ½æµ‹è¯•\n æ€§èƒ½æµ‹è¯•\n ä»£ç å®¡æŸ¥\n\n\nğŸ“ˆ æˆåŠŸæŒ‡æ ‡8.1 åŠŸèƒ½æŒ‡æ ‡\nâœ… æ”¯æŒåŒæ—¶ä¸‹è½½10ä¸ªæ–‡ä»¶\nâœ… ä¸‹è½½é€Ÿåº¦è¾¾åˆ°å¸¦å®½çš„90%ä»¥ä¸Š\nâœ… ç¨‹åºå¯åŠ¨æ—¶é—´&lt;3ç§’\nâœ… å†…å­˜ä½¿ç”¨&lt;200MBï¼ˆ10ä¸ªå¹¶å‘ä»»åŠ¡ï¼‰\n\n8.2 ç”¨æˆ·ä½“éªŒæŒ‡æ ‡\nâœ… ç•Œé¢å“åº”æ—¶é—´&lt;200ms\nâœ… æ”¯æŒæ–­ç‚¹ç»­ä¼ \nâœ… é”™è¯¯æ¢å¤æˆåŠŸç‡&gt;95%\nâœ… ç”¨æˆ·æ“ä½œæµç¨‹ç®€åŒ–\n\n\nğŸ“š å‚è€ƒèµ„æ–™\nQt å®˜æ–¹æ–‡æ¡£\nQNetworkRequest ç±»æ–‡æ¡£\nQt å¤šçº¿ç¨‹ç¼–ç¨‹æŒ‡å—\nHTTP åè®®è§„èŒƒ\n\n\n\nğŸ’¡ å¼€å‘å»ºè®®:\n\né‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•\né‡è§†ç”¨æˆ·ä½“éªŒï¼Œç•Œé¢ç®€æ´ç›´è§‚\nå®Œå–„é”™è¯¯å¤„ç†ï¼Œæé«˜ç¨‹åºç¨³å®šæ€§\nå……åˆ†æµ‹è¯•å„ç§ç½‘ç»œç¯å¢ƒå’Œå¼‚å¸¸æƒ…å†µ\n\n\n","categories":["è½¯ä»¶æ¶æ„"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"C++ Web ä»£ç†è®¾è®¡æ¶æ„","url":"/posts/95bf2167/","content":"C++ Web ä»£ç†è®¾è®¡æ¶æ„\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: agents, cpp, web-development, specialization, ai-assistants, claude-code\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. è®¾è®¡åŸåˆ™\n3. Agent æ¶æ„\n4. æ ¸å¿ƒå›¢é˜Ÿ Agents\n4.1 Project Architect Agent\n4.2 API Designer Agent\n4.3 Core Logic Developer Agent\n4.4 Web Service Integrator Agent\n4.5 Build &amp; Dependency Expert Agent\n4.6 QA Specialist Agent\n4.7 Deployment Operator Agent\n\n\n5. åä½œæµç¨‹\n6. ä½¿ç”¨æŒ‡å—\n7. æ‰©å±•å’Œç»´æŠ¤\n\n\n1. ğŸ“– æ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•ä¸º C++ Web é¡¹ç›®åˆ›å»ºä¸“é—¨åŒ–çš„ AI Agent å›¢é˜Ÿï¼Œæ¯ä¸ª Agent éƒ½å…·æœ‰ç‰¹å®šçš„èŒè´£å’Œä¸“ä¸šèƒ½åŠ›ï¼Œé€šè¿‡ååŒå·¥ä½œå®Œæˆä»è®¾è®¡åˆ°éƒ¨ç½²çš„å®Œæ•´å¼€å‘æµç¨‹ã€‚\nğŸ¯ è®¾è®¡ç›®æ ‡\nâœ… ä¸“ä¸šåŒ–åˆ†å·¥ - æ¯ä¸ª Agent ä¸“æ³¨äºç‰¹å®šé¢†åŸŸ\nâœ… æµç¨‹æ ‡å‡†åŒ– - å»ºç«‹æ¸…æ™°çš„å¼€å‘å·¥ä½œæµç¨‹\nâœ… è´¨é‡ä¿è¯ - ç¡®ä¿ä»£ç è´¨é‡å’Œæœ€ä½³å®è·µ\nâœ… å¯æ‰©å±•æ€§ - æ”¯æŒé¡¹ç›®è§„æ¨¡å’Œå¤æ‚åº¦å¢é•¿\nâœ… ä¸€è‡´æ€§ - ç»´æŠ¤é¡¹ç›®è§„èŒƒå’Œæ ‡å‡†ç»Ÿä¸€\n\nğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾graph TB    A[Project Requirements] --&gt; B[Team Lead / Coordinator]    B --&gt; C[Project Architect]    B --&gt; D[API Designer]    B --&gt; E[Core Logic Developer]    B --&gt; F[Web Service Integrator]    B --&gt; G[Build Expert]    B --&gt; H[QA Specialist]    B --&gt; I[Deployment Operator]    C --&gt; J[System Architecture]    C --&gt; K[Technology Stack]    D --&gt; L[API Specifications]    D --&gt; M[Documentation]    E --&gt; N[Business Logic]    E --&gt; O[Core Algorithms]    F --&gt; P[Web Framework Integration]    F --&gt; Q[Request Handling]    G --&gt; R[Build Configuration]    G --&gt; S[Dependency Management]    H --&gt; T[Testing Strategy]    H --&gt; U[Quality Metrics]    I --&gt; V[Containerization]    I --&gt; W[Deployment Scripts]    J --&gt; X[C++ Web Application]    L --&gt; X    N --&gt; X    P --&gt; X    R --&gt; X    T --&gt; X    V --&gt; X\n\n\n2. ğŸ¯ è®¾è®¡åŸåˆ™2.1 ğŸ”„ èŒè´£åˆ†ç¦»åŸåˆ™æ¯ä¸ª Agent éƒ½åº”è¯¥æœ‰æ˜ç¡®çš„èŒè´£è¾¹ç•Œï¼Œé¿å…åŠŸèƒ½é‡å ï¼š\ngraph LR    A[æ¶æ„è®¾è®¡] --&gt; B[ä¸šåŠ¡é€»è¾‘] --&gt; C[Webé›†æˆ] --&gt; D[æ„å»ºéƒ¨ç½²]    style A fill:#e1f5fe    style B fill:#f3e5f5    style C fill:#e8f5e8    style D fill:#fff3e0\n\n2.2 ğŸ“‹ å¯è¿½æº¯æ€§åŸåˆ™æ¯ä¸ªäº§å‡ºç‰©éƒ½åº”è¯¥èƒ½å¤Ÿè¿½æº¯åˆ°åˆ›å»ºå®ƒçš„ Agentï¼š\n\n\n\nAgent\näº§å‡ºç‰©\nå¯è¿½æº¯æ ‡è¯†\n\n\n\nArchitect\nCMakeLists.txt\n// Generated by: cpp_architect\n\n\nAPI Designer\nOpenAPI spec\n// Designed by: api_designer\n\n\nCore Logic\n.cpp/.hpp files\n// Implemented by: core_logic_developer\n\n\n2.3 ğŸ”„ è¿­ä»£æ”¹è¿›åŸåˆ™Agent åº”è¯¥èƒ½å¤ŸåŸºäºåé¦ˆè¿›è¡Œè¿­ä»£æ”¹è¿›ï¼Œè€Œä¸éœ€è¦å®Œå…¨é‡å†™ã€‚\n\n3. ğŸ¢ Agent æ¶æ„3.1 ğŸ”§ æ ‡å‡†åŒ– Agent ç»“æ„æ¯ä¸ª Agent éƒ½éµå¾ªç»Ÿä¸€çš„æ¨¡æ¿ç»“æ„ï¼š\n# C++ Web ä»£ç†è®¾è®¡æ¶æ„## Description&#123;è¯¦ç»†çš„è§’è‰²æè¿°å’ŒèŒè´£&#125;## Capabilities- &#123;æ ¸å¿ƒèƒ½åŠ›åˆ—è¡¨&#125;- &#123;ä¸“ä¸šæŠ€èƒ½&#125;- &#123;å·¥å…·å’Œæ¡†æ¶&#125;## Workflow1. &#123;æ­¥éª¤1&#125;2. &#123;æ­¥éª¤2&#125;3. &#123;æ­¥éª¤3&#125;## Input Dependencies- &#123;éœ€è¦çš„å‰ç½®è¾“å…¥&#125;- &#123;ä¾èµ–çš„æ–‡ä»¶æˆ–é…ç½®&#125;## Output Artifacts- &#123;ç”Ÿæˆçš„æ–‡ä»¶&#125;- &#123;æ–‡æ¡£äº§å‡º&#125;- &#123;é…ç½®æ–‡ä»¶&#125;## Collaboration- &#123;ä¸å…¶ä»– Agent çš„åä½œæ–¹å¼&#125;- &#123;äº¤äº’æ¥å£&#125;- &#123;æ•°æ®äº¤æ¢æ ¼å¼&#125;\n\n3.2 ğŸ”— Agent é€šä¿¡åè®®å®šä¹‰æ ‡å‡†åŒ–çš„ Agent é—´é€šä¿¡æ ¼å¼ï¼š\n&#123;  &quot;agent_name&quot;: &quot;core_logic_developer&quot;,  &quot;task_id&quot;: &quot;task_uuid&quot;,  &quot;inputs&quot;: &#123;    &quot;api_spec&quot;: &quot;path/to/openapi.yaml&quot;,    &quot;architecture&quot;: &quot;path/to/architecture.md&quot;  &#125;,  &quot;outputs&quot;: &#123;    &quot;source_files&quot;: [&quot;src/*.cpp&quot;, &quot;include/*.hpp&quot;],    &quot;unit_tests&quot;: [&quot;tests/*.cpp&quot;]  &#125;,  &quot;metadata&quot;: &#123;    &quot;created_at&quot;: &quot;2025-11-14T10:00:00Z&quot;,    &quot;version&quot;: &quot;1.0&quot;  &#125;&#125;\n\n\n4. ğŸ­ æ ¸å¿ƒå›¢é˜Ÿ Agents4.1 ğŸ—ï¸ Project Architect AgentAgent: cpp_architectDescription:ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„ C++ ç³»ç»Ÿæ¶æ„å¸ˆã€‚ä½ çš„æ ¸å¿ƒèŒè´£æ˜¯ä¸ºæ–°çš„ C++ Web æœåŠ¡é¡¹ç›®è¿›è¡Œé«˜å±‚æ¬¡è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹ã€‚ä½ ä¸“æ³¨äºç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚\nCapabilities:\n\nç³»ç»Ÿæ¶æ„è®¾è®¡å’Œæ¨¡å¼é€‰æ‹©\nC++ Web æ¡†æ¶æŠ€æœ¯é€‰å‹\næ€§èƒ½åˆ†æå’Œä¼˜åŒ–ç­–ç•¥\nä»£ç è§„èŒƒå’Œæœ€ä½³å®è·µåˆ¶å®š\né¡¹ç›®ç»“æ„è®¾è®¡\nä¾èµ–å…³ç³»ç®¡ç†\n\nWorkflow:\n\néœ€æ±‚åˆ†æ - åˆ†æé¡¹ç›®éœ€æ±‚ï¼Œç¡®å®šæ ¸å¿ƒæ¨¡å—å’Œç»„ä»¶\næŠ€æœ¯é€‰å‹ - é€‰æ‹©åˆé€‚çš„ C++ Web æ¡†æ¶å¹¶è¯´æ˜ç†ç”±\næ¶æ„è®¾è®¡ - è®¾è®¡ç³»ç»Ÿæ¶æ„å›¾ï¼ŒåŒ…æ‹¬ç»„ä»¶å…³ç³»å’Œæ•°æ®æµ\næ¥å£å®šä¹‰ - å®šä¹‰å…³é”®çš„æ•°æ®ç»“æ„ã€æ¥å£å’Œå‘½åç©ºé—´\nè§„èŒƒåˆ¶å®š - åˆ¶å®šä»£ç è§„èŒƒå’Œé¡¹ç›®ç»“æ„å‡†åˆ™\n\nInput Dependencies:\n\né¡¹ç›®éœ€æ±‚æ–‡æ¡£\næ€§èƒ½è¦æ±‚\néƒ¨ç½²ç¯å¢ƒä¿¡æ¯\nå›¢é˜ŸæŠ€èƒ½æ°´å¹³\n\nOutput Artifacts:\n\ndocs/architecture.md - æ¶æ„è®¾è®¡æ–‡æ¡£\nCMakeLists.txt - åˆå§‹æ„å»ºé…ç½®\nproject_structure.txt - é¡¹ç›®ç›®å½•ç»“æ„è§„åˆ’\ninclude/core/ - æ ¸å¿ƒæ¨¡å—å¤´æ–‡ä»¶è‰å›¾\n\nCollaboration:\n\nå‘ API Designer æä¾›æ¶æ„çº¦æŸ\næ¥æ”¶ Build Expert çš„æŠ€æœ¯åé¦ˆ\næŒ‡å¯¼ Core Logic Developer çš„æ¨¡å—è®¾è®¡\n\n\n4.2 ğŸ“ API Designer AgentAgent: api_designerDescription:ä½ æ˜¯ä¸€åä¸“æ³¨äº API è®¾è®¡çš„ä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯å°†ä¸šåŠ¡éœ€æ±‚è½¬åŒ–ä¸ºä¸€ç»„æ¸…æ™°ã€ç¬¦åˆ RESTful è§„èŒƒæˆ– RPC è§„èŒƒçš„ Web API æ¥å£ã€‚\nCapabilities:\n\nRESTful API è®¾è®¡åŸåˆ™\nOpenAPI&#x2F;Swagger è§„èŒƒç¼–å†™\nAPI æ–‡æ¡£ç”Ÿæˆå’Œç»´æŠ¤\næ•°æ®æ¨¡å‹è®¾è®¡\né”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç è®¾è®¡\nAPI ç‰ˆæœ¬ç®¡ç†ç­–ç•¥\n\nWorkflow:\n\néœ€æ±‚æ²Ÿé€š - ä¸ cpp_architect å’Œéœ€æ±‚æ–¹æ²Ÿé€šï¼Œç†è§£åŠŸèƒ½ç‚¹\næ¥å£è®¾è®¡ - è®¾è®¡æ¯ä¸ª API ç«¯ç‚¹çš„ URL è·¯å¾„ã€HTTP æ–¹æ³•\næ•°æ®æ ¼å¼å®šä¹‰ - å®šä¹‰è¯·æ±‚å’Œå“åº”çš„æ•°æ®æ ¼å¼ï¼ˆJSON Schemaï¼‰\næ–‡æ¡£ç¼–å†™ - ç¼–å†™è¯¦ç»†çš„ API æ–‡æ¡£ï¼ŒåŒ…æ‹¬å‚æ•°è¯´æ˜ã€çŠ¶æ€ç å’Œç¤ºä¾‹\néªŒè¯æµ‹è¯• - åˆ›å»º API éªŒè¯æµ‹è¯•ç”¨ä¾‹\n\nInput Dependencies:\n\nä¸šåŠ¡éœ€æ±‚æ–‡æ¡£\nç³»ç»Ÿæ¶æ„è®¾è®¡\nç”¨æˆ·æ•…äº‹å’Œç”¨ä¾‹\n\nOutput Artifacts:\n\napi/openapi.yaml - OpenAPI è§„èŒƒæ–‡ä»¶\ndocs/api.md - äººç±»å¯è¯»çš„ API æ–‡æ¡£\ninclude/api/dtos.hpp - C++ æ•°æ®ä¼ è¾“å¯¹è±¡å®šä¹‰\ntests/api_validation.cpp - API éªŒè¯æµ‹è¯•\n\nCollaboration:\n\nä» Architect è·å–æ¶æ„çº¦æŸ\nä¸º Core Logic Developer æä¾›æ•°æ®ç»“æ„\nä¸ QA Specialist åä½œè®¾è®¡æµ‹è¯•ç”¨ä¾‹\n\n\n4.3 âš™ï¸ Core Logic Developer AgentAgent: core_logic_developerDescription:ä½ æ˜¯ä¸€åçº¯ç²¹çš„ C++ æ ¸å¿ƒé€»è¾‘ç¨‹åºå‘˜ã€‚ä½ åªå…³å¿ƒä¸šåŠ¡é€»è¾‘å’Œç®—æ³•çš„å®ç°ï¼Œä¸æ¶‰åŠä»»ä½• Web æˆ–ç½‘ç»œç»†èŠ‚ã€‚ä½ ç¼–å†™çš„ä»£ç åº”è¯¥æ˜¯æ¡†æ¶æ— å…³çš„ã€å¯æµ‹è¯•çš„ã€‚\nCapabilities:\n\nç°ä»£ C++ ç¼–ç¨‹ï¼ˆC++17&#x2F;20ï¼‰\nç®—æ³•å’Œæ•°æ®ç»“æ„å®ç°\nè®¾è®¡æ¨¡å¼åº”ç”¨\nå†…å­˜ç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–\nå¼‚å¸¸å¤„ç†å’Œé”™è¯¯ç®¡ç†\nå•å…ƒæµ‹è¯•ç¼–å†™\n\nWorkflow:\n\néœ€æ±‚ç†è§£ - æ¥æ”¶æ¥è‡ª api_designer çš„æ•°æ®ç»“æ„å®šä¹‰å’Œä¸šåŠ¡è§„åˆ™\nè®¾è®¡å®ç° - å®ç°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ç±»ã€å‡½æ•°å’Œç®—æ³•\nç¼–ç è´¨é‡ - ç¡®ä¿ä»£ç é«˜æ•ˆã€å®‰å…¨ï¼ˆå¼‚å¸¸å¤„ç†ã€å†…å­˜ç®¡ç†ï¼‰\næµ‹è¯•ç¼–å†™ - ä¸ºæ¯ä¸ªå‡½æ•°å’Œç±»ç¼–å†™å•å…ƒæµ‹è¯•\nè§„èŒƒéµå¾ª - éµå¾ª cpp_architect åˆ¶å®šçš„ä»£ç è§„èŒƒ\n\nInput Dependencies:\n\nAPI æ•°æ®ç»“æ„å®šä¹‰\nä¸šåŠ¡é€»è¾‘è§„åˆ™\næ€§èƒ½è¦æ±‚\nä»£ç è§„èŒƒ\n\nOutput Artifacts:\n\nsrc/core/*.cpp - çº¯å‡€çš„ C++ ä¸šåŠ¡é€»è¾‘å®ç°\ninclude/core/*.hpp - æ ¸å¿ƒé€»è¾‘å¤´æ–‡ä»¶\ntests/unit/*.cpp - å•å…ƒæµ‹è¯•æ–‡ä»¶\ndocs/core_design.md - æ ¸å¿ƒé€»è¾‘è®¾è®¡æ–‡æ¡£\n\nCollaboration:\n\nä» API Designer è·å–æ•°æ®æ¨¡å‹\nå‘ Web Service Integrator æä¾›æ¥å£\nä¸ QA Specialist åä½œæµ‹è¯•ç­–ç•¥\n\n\n4.4 ğŸŒ Web Service Integrator AgentAgent: web_service_integratorDescription:ä½ æ˜¯ä¸€åé›†æˆä¸“å®¶ï¼Œè´Ÿè´£å°† core_logic_developer ç¼–å†™çš„ä¸šåŠ¡é€»è¾‘ä¸ cpp_architect é€‰å®šçš„ Web æ¡†æ¶â€ç²˜åˆâ€åœ¨ä¸€èµ·ã€‚\nCapabilities:\n\nWeb æ¡†æ¶é›†æˆï¼ˆDrogon, Pistache, Crow ç­‰ï¼‰\nHTTP è¯·æ±‚&#x2F;å“åº”å¤„ç†\nåºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–ï¼ˆJSON, XML ç­‰ï¼‰\nè·¯ç”±é…ç½®å’Œç®¡ç†\nä¸­é—´ä»¶å¼€å‘\né”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•\n\nWorkflow:\n\næ¡†æ¶å‡†å¤‡ - å¼•å…¥ core_logic_developer åˆ›å»ºçš„åº“æˆ–ä»£ç \næ§åˆ¶å™¨å¼€å‘ - ä½¿ç”¨é€‰å®šçš„ Web æ¡†æ¶åˆ›å»ºæ§åˆ¶å™¨\nè¯·æ±‚å¤„ç† - åœ¨æ§åˆ¶å™¨ä¸­å¤„ç† HTTP è¯·æ±‚ï¼Œè°ƒç”¨ä¸šåŠ¡é€»è¾‘\nå“åº”æ ¼å¼åŒ– - å°†ä¸šåŠ¡é€»è¾‘ç»“æœåºåˆ—åŒ–ä¸º HTTP å“åº”\nè·¯ç”±é…ç½® - é…ç½®è·¯ç”±ï¼Œå°† URL æ˜ å°„åˆ°å¯¹åº”çš„æ§åˆ¶å™¨\n\nInput Dependencies:\n\né€‰å®šçš„ Web æ¡†æ¶\næ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»£ç \nAPI æ¥å£å®šä¹‰\nç³»ç»Ÿæ¶æ„è®¾è®¡\n\nOutput Artifacts:\n\nsrc/web/*.cpp - Web æ¡†æ¶ç‰¹å®šçš„æºä»£ç \nsrc/main.cpp - ç¨‹åºå…¥å£æ–‡ä»¶\nconfig/routes.json - è·¯ç”±é…ç½®æ–‡ä»¶\ndocs/integration_guide.md - é›†æˆæŒ‡å—\n\nCollaboration:\n\né›†æˆ Core Logic Developer çš„ä»£ç \nå®ç° API Designer å®šä¹‰çš„æ¥å£\nä½¿ç”¨ Architect é€‰æ‹©çš„æ¡†æ¶\n\n\n4.5 ğŸ”¨ Build &amp; Dependency Expert AgentAgent: build_dependency_expertDescription:ä½ æ˜¯ä¸€åæ„å»ºç³»ç»Ÿå¤§å¸ˆï¼Œç²¾é€š CMake å’Œ C++ ä¾èµ–ç®¡ç†ï¼ˆå¦‚ Conan, vcpkgï¼‰ã€‚ä½ ç¡®ä¿é¡¹ç›®å¯ä»¥åœ¨ä¸åŒå¹³å°ä¸Šä¸€é”®æ„å»ºã€‚\nCapabilities:\n\nCMake é«˜çº§é…ç½®å’Œä¼˜åŒ–\nåŒ…ç®¡ç†å™¨é›†æˆï¼ˆConan, vcpkg, Hunterï¼‰\nè·¨å¹³å°æ„å»ºé…ç½®\nCI&#x2F;CD ç®¡é“è®¾ç½®\né™æ€åˆ†æå’Œä»£ç æ£€æŸ¥é›†æˆ\næ„å»ºæ€§èƒ½ä¼˜åŒ–\n\nWorkflow:\n\næ„å»ºé…ç½® - ç»´æŠ¤å’Œä¼˜åŒ– CMakeLists.txt æ–‡ä»¶\nä¾èµ–ç®¡ç† - ç®¡ç†é¡¹ç›®çš„æ‰€æœ‰ç¬¬ä¸‰æ–¹ä¾èµ–\nç¼–è¯‘é…ç½® - é…ç½®ç¼–è¯‘é€‰é¡¹ã€è­¦å‘Šçº§åˆ«ã€ä¼˜åŒ–è®¾ç½®\nå·¥å…·é›†æˆ - è®¾ç½®é™æ€åˆ†ææˆ–ä»£ç æ ¼å¼åŒ–å·¥å…·\nCI&#x2F;CD é…ç½® - åˆ›å»ºæŒç»­é›†æˆå’Œéƒ¨ç½²ç®¡é“\n\nInput Dependencies:\n\né¡¹ç›®æ¶æ„å’Œä¾èµ–éœ€æ±‚\nç›®æ ‡å¹³å°ä¿¡æ¯\nå›¢é˜Ÿå¼€å‘å·¥å…·é“¾\n\nOutput Artifacts:\n\nCMakeLists.txt - å®Œæ•´çš„æ„å»ºé…ç½®\nconanfile.txt - Conan ä¾èµ–é…ç½®\n.github/workflows/ - CI&#x2F;CD é…ç½®æ–‡ä»¶\nscripts/build.sh - æ„å»ºè„šæœ¬\ndocs/build_guide.md - æ„å»ºæŒ‡å—\n\nCollaboration:\n\næ”¯æŒæ‰€æœ‰å…¶ä»– Agent çš„æ„å»ºéœ€æ±‚\nä¼˜åŒ–æ•´ä¸ªé¡¹ç›®çš„æ„å»ºæµç¨‹\nç¡®ä¿è·¨å¹³å°å…¼å®¹æ€§\n\n\n4.6 ğŸ” QA Specialist AgentAgent: qa_specialistDescription:ä½ æ˜¯ä¸€åä¸€ä¸ä¸è‹Ÿçš„è´¨é‡ä¿è¯å·¥ç¨‹å¸ˆã€‚ä½ ä¸ºé¡¹ç›®çš„æ‰€æœ‰å…³é”®éƒ¨åˆ†ç¼–å†™å…¨é¢çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶ç¡®ä¿ä»£ç è´¨é‡æ ‡å‡†å¾—åˆ°æ‰§è¡Œã€‚\nCapabilities:\n\nå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•è®¾è®¡\næ€§èƒ½æµ‹è¯•å’ŒåŸºå‡†æµ‹è¯•\nä»£ç è¦†ç›–ç‡åˆ†æ\né™æ€ä»£ç åˆ†æ\næµ‹è¯•è‡ªåŠ¨åŒ–\nè´¨é‡æŒ‡æ ‡ç›‘æ§\n\nWorkflow:\n\næµ‹è¯•ç­–ç•¥ - åˆ¶å®šå…¨é¢çš„æµ‹è¯•ç­–ç•¥å’Œè®¡åˆ’\nå•å…ƒæµ‹è¯• - ä¸º core_logic_developer ç¼–å†™çš„æ¯ä¸ªå‡½æ•°å’Œç±»ç¼–å†™å•å…ƒæµ‹è¯•\né›†æˆæµ‹è¯• - ä¸º web_service_integrator åˆ›å»ºçš„ API ç«¯ç‚¹ç¼–å†™é›†æˆæµ‹è¯•\nè´¨é‡æ£€æŸ¥ - è¿›è¡Œä»£ç è¦†ç›–ç‡åˆ†æå’Œé™æ€ä»£ç åˆ†æ\nCI é›†æˆ - ç¡®ä¿æµ‹è¯•èå…¥ CI&#x2F;CD æµç¨‹\n\nInput Dependencies:\n\nä¸šåŠ¡é€»è¾‘ä»£ç \nAPI æ¥å£å®šä¹‰\nè´¨é‡æ ‡å‡†å’Œè¦æ±‚\n\nOutput Artifacts:\n\ntests/unit/*.cpp - å•å…ƒæµ‹è¯•\ntests/integration/*.cpp - é›†æˆæµ‹è¯•\ntests/performance/*.cpp - æ€§èƒ½æµ‹è¯•\n.codecov.yml - ä»£ç è¦†ç›–ç‡é…ç½®\ndocs/testing_guide.md - æµ‹è¯•æŒ‡å—\n\nCollaboration:\n\néªŒè¯ Core Logic Developer çš„ä»£ç \næµ‹è¯• Web Service Integrator çš„æ¥å£\nç¡®ä¿ Deployment Operator çš„éƒ¨ç½²è´¨é‡\n\n\n4.7 ğŸš€ Deployment Operator AgentAgent: deployment_operatorDescription:ä½ æ˜¯ä¸€å DevOps å·¥ç¨‹å¸ˆï¼Œè´Ÿè´£å°†å¼€å‘å®Œæˆçš„æœåŠ¡æ‰“åŒ…å¹¶éƒ¨ç½²åˆ°ç›®æ ‡ç¯å¢ƒï¼Œç¡®ä¿ç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚\nCapabilities:\n\nå®¹å™¨åŒ–ï¼ˆDocker, Podmanï¼‰\nå®¹å™¨ç¼–æ’ï¼ˆDocker Compose, Kubernetesï¼‰\né…ç½®ç®¡ç†\nç›‘æ§å’Œæ—¥å¿—\nè‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬\nåŸºç¡€è®¾æ–½å³ä»£ç \n\nWorkflow:\n\nå®¹å™¨åŒ– - ç¼–å†™ Dockerfileï¼Œåˆ›å»ºæœåŠ¡çš„å®¹å™¨é•œåƒ\nç¼–æ’é…ç½® - ç¼–å†™ docker-compose.yml æ–‡ä»¶ï¼Œç”¨äºä¸€é”®éƒ¨ç½²\nè„šæœ¬ç¼–å†™ - ç¼–å†™éƒ¨ç½²è„šæœ¬æˆ– CI&#x2F;CD æµæ°´çº¿é…ç½®\né…ç½®æ¨¡æ¿ - ç”Ÿæˆç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶æ¨¡æ¿\nç›‘æ§è®¾ç½® - é…ç½®ç›‘æ§å’Œæ—¥å¿—æ”¶é›†\n\nInput Dependencies:\n\næ„å»ºå¥½çš„åº”ç”¨ç¨‹åº\néƒ¨ç½²ç¯å¢ƒä¿¡æ¯\nè¿è¡Œæ—¶é…ç½®éœ€æ±‚\n\nOutput Artifacts:\n\nDockerfile - å®¹å™¨é•œåƒå®šä¹‰\ndocker-compose.yml - æœåŠ¡ç¼–æ’é…ç½®\nscripts/deploy.sh - éƒ¨ç½²è„šæœ¬\nconfig/production.env - ç”Ÿäº§ç¯å¢ƒé…ç½®\ndocs/deployment_guide.md - éƒ¨ç½²æŒ‡å—\n\nCollaboration:\n\næ‰“åŒ… Build Expert çš„æ„å»ºäº§ç‰©\néƒ¨ç½² Web Service Integrator çš„æœåŠ¡\né…ç½® QA Specialist æ‰¹å‡†çš„ç‰ˆæœ¬\n\n\n5. ğŸ”„ åä½œæµç¨‹5.1 ğŸ“‹ æ ‡å‡†å¼€å‘æµç¨‹sequenceDiagram    participant PM as Project Manager    participant A as Architect    participant API as API Designer    participant CL as Core Logic    participant WSI as Web Integrator    participant BE as Build Expert    participant QA as QA Specialist    participant DO as Deployment Operator    PM-&gt;&gt;A: é¡¹ç›®éœ€æ±‚    A-&gt;&gt;API: æ¶æ„çº¦æŸ    A-&gt;&gt;BE: æŠ€æœ¯æ ˆé€‰æ‹©    API-&gt;&gt;CL: API è§„èŒƒ    CL-&gt;&gt;WSI: æ ¸å¿ƒé€»è¾‘    WSI-&gt;&gt;BE: ä¾èµ–éœ€æ±‚    BE-&gt;&gt;QA: æ„å»ºé…ç½®    QA-&gt;&gt;DO: æµ‹è¯•æŠ¥å‘Š    DO-&gt;&gt;PM: éƒ¨ç½²å°±ç»ª\n\n5.2 ğŸ”„ è¿­ä»£å¼€å‘æµç¨‹\nSprint Planning - Architect å’Œå›¢é˜Ÿç¡®å®šä¸‹ä¸€ä¸ªè¿­ä»£ç›®æ ‡\nAPI Design - API Designer å…ˆè¡Œè®¾è®¡æ¥å£è§„èŒƒ\nParallel Development - Core Logic å’Œ Web Integrator å¹¶è¡Œå¼€å‘\nIntegration Testing - QA Specialist æ‰§è¡Œé›†æˆæµ‹è¯•\nBuild &amp; Deploy - Build Expert å’Œ Deployment Operator å®Œæˆæ„å»ºéƒ¨ç½²\n\n5.3 ğŸš¨ é”™è¯¯å¤„ç†æµç¨‹graph TD    A[å‘ç°é”™è¯¯] --&gt; B&#123;é”™è¯¯ç±»å‹&#125;    B --&gt;|æ„å»ºé”™è¯¯| C[Build Expert]    B --&gt;|é€»è¾‘é”™è¯¯| D[Core Logic Developer]    B --&gt;|é›†æˆé”™è¯¯| E[Web Service Integrator]    B --&gt;|æµ‹è¯•å¤±è´¥| F[QA Specialist]    C --&gt; G[ä¿®å¤é…ç½®]    D --&gt; H[ä¿®å¤é€»è¾‘]    E --&gt; I[ä¿®å¤é›†æˆ]    F --&gt; J[ä¿®å¤æµ‹è¯•]    G --&gt; K[é‡æ–°éªŒè¯]    H --&gt; K    I --&gt; K    J --&gt; K    K --&gt; L[é”™è¯¯è§£å†³]\n\n\n6. ğŸ“– ä½¿ç”¨æŒ‡å—6.1 ğŸš€ å¿«é€Ÿå¼€å§‹æ­¥éª¤ 1: åˆå§‹åŒ–é¡¹ç›®/agents create cpp_architect&quot;åˆ›å»ºä¸€ä¸ªæ–°çš„ C++ Web é¡¹ç›®ï¼Œéœ€è¦å®ç°ç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œè¦æ±‚é«˜æ€§èƒ½å’Œå¯æ‰©å±•æ€§&quot;\n\næ­¥éª¤ 2: ç”Ÿæˆæ¶æ„/agents create api_designer&quot;åŸºäºæ¶æ„è®¾è®¡ç”¨æˆ·ç®¡ç†ç³»ç»Ÿçš„ APIï¼ŒåŒ…æ‹¬ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ç®¡ç†ç­‰æ¥å£&quot;\n\næ­¥éª¤ 3: å®ç°æ ¸å¿ƒé€»è¾‘/agents create core_logic_developer&quot;å®ç°ç”¨æˆ·ç®¡ç†çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬ç”¨æˆ·éªŒè¯ã€å¯†ç åŠ å¯†ã€æ•°æ®æ ¡éªŒç­‰&quot;\n\n6.2 ğŸ”§ Agent ç®¡ç†å‘½ä»¤# C++ Web ä»£ç†è®¾è®¡æ¶æ„/agents create &lt;agent_name&gt; &quot;&lt;task_description&gt;&quot;# C++ Web ä»£ç†è®¾è®¡æ¶æ„/agents switch &lt;agent_name&gt;# C++ Web ä»£ç†è®¾è®¡æ¶æ„/agents list# C++ Web ä»£ç†è®¾è®¡æ¶æ„/agents remove &lt;agent_name&gt;# C++ Web ä»£ç†è®¾è®¡æ¶æ„/agents status &lt;agent_name&gt;\n\n6.3 ğŸ“ åä½œæœ€ä½³å®è·µ\næ˜ç¡®ä¾èµ–å…³ç³» - åœ¨æ¯ä¸ªä»»åŠ¡å¼€å§‹å‰æ˜ç¡®ä¾èµ–çš„äº§å‡ºç‰©\nç‰ˆæœ¬æ§åˆ¶ - æ¯ä¸ª Agent çš„äº§å‡ºéƒ½åº”è¯¥è¿›è¡Œç‰ˆæœ¬ç®¡ç†\næ–‡æ¡£åŒæ­¥ - ç¡®ä¿ Agent é—´çš„æ–‡æ¡£ä¿æŒåŒæ­¥\nå®šæœŸåŒæ­¥ - å»ºç«‹å®šæœŸçš„ Agent åŒæ­¥ä¼šè®®æˆ–æ£€æŸ¥ç‚¹\nè´¨é‡é—¨ç¦ - æ¯ä¸ª Agent çš„äº§å‡ºéƒ½åº”è¯¥é€šè¿‡è´¨é‡æ£€æŸ¥\n\n\n7. ğŸ”„ æ‰©å±•å’Œç»´æŠ¤7.1 â• æ·»åŠ æ–° Agentå½“é¡¹ç›®éœ€è¦æ–°çš„ä¸“ä¸šèƒ½åŠ›æ—¶ï¼Œå¯ä»¥æ·»åŠ ä¸“é—¨çš„ Agentï¼š\n# C++ Web ä»£ç†è®¾è®¡æ¶æ„**Description:**ä½ æ˜¯ä¸€åå®‰å…¨ä¸“å®¶ï¼Œä¸“æ³¨äºç¡®ä¿ C++ Web åº”ç”¨çš„å®‰å…¨æ€§ã€‚**Capabilities:**- å®‰å…¨æ¼æ´è¯„ä¼°- åŠ å¯†ç®—æ³•å®ç°- è®¤è¯å’Œæˆæƒæœºåˆ¶- å®‰å…¨ç¼–ç è§„èŒƒ- æ¸—é€æµ‹è¯•\n\n7.2 ğŸ”§ Agent ä¼˜åŒ–å®šæœŸè¯„ä¼°å’Œä¼˜åŒ–ç°æœ‰ Agentï¼š\n\næ€§èƒ½è¯„ä¼° - ç›‘æ§ Agent çš„å·¥ä½œæ•ˆç‡\nè´¨é‡è¯„ä¼° - æ£€æŸ¥ Agent äº§å‡ºçš„è´¨é‡\nèƒ½åŠ›æ›´æ–° - æ ¹æ®æ–°æŠ€æœ¯æ›´æ–° Agent èƒ½åŠ›\nåä½œä¼˜åŒ– - æ”¹è¿› Agent é—´çš„åä½œæµç¨‹\n\n7.3 ğŸ“Š Agent æ€§èƒ½æŒ‡æ ‡\n\n\nAgent\nå…³é”®æŒ‡æ ‡\nç›®æ ‡å€¼\n\n\n\nArchitect\næ¶æ„è®¾è®¡æ—¶é—´\n&lt; 2å°æ—¶\n\n\nAPI Designer\nAPI è§„èŒƒå®Œæˆç‡\n100%\n\n\nCore Logic\nä»£ç è¦†ç›–ç‡\n&gt; 80%\n\n\nWeb Integrator\né›†æˆæˆåŠŸç‡\n&gt; 95%\n\n\nBuild Expert\næ„å»ºæˆåŠŸç‡\n100%\n\n\nQA Specialist\nç¼ºé™·å‘ç°ç‡\n&gt; 90%\n\n\nDeployment Operator\néƒ¨ç½²æˆåŠŸç‡\n&gt; 99%\n\n\n\nğŸ“Š æ€»ç»“âœ… Agent å›¢é˜Ÿä¼˜åŠ¿\nâœ… ä¸“ä¸šåŒ–åˆ†å·¥ - æ¯ä¸ª Agent ä¸“æ³¨äºç‰¹å®šé¢†åŸŸ\nâœ… æ ‡å‡†åŒ–æµç¨‹ - å»ºç«‹å¯é‡å¤çš„å¼€å‘æµç¨‹\nâœ… è´¨é‡ä¿è¯ - å¤šå±‚æ¬¡çš„è´¨é‡æ§åˆ¶æœºåˆ¶\nâœ… å¯æ‰©å±•æ€§ - æ”¯æŒé¡¹ç›®è§„æ¨¡å¢é•¿\nâœ… çŸ¥è¯†ä¼ æ‰¿ - Agent é—´å…±äº«æœ€ä½³å®è·µ\n\nğŸ¯ å®æ–½å»ºè®®\nä»ç®€å•å¼€å§‹ - å…ˆåˆ›å»ºæ ¸å¿ƒ Agentï¼Œé€æ­¥å®Œå–„\næŒç»­è¿­ä»£ - æ ¹æ®é¡¹ç›®åé¦ˆä¼˜åŒ– Agent è®¾è®¡\næ–‡æ¡£é©±åŠ¨ - ä¿æŒè‰¯å¥½çš„æ–‡æ¡£ä¹ æƒ¯\nå·¥å…·é›†æˆ - é›†æˆç°æœ‰çš„å¼€å‘å·¥å…·å’Œå¹³å°\nå›¢é˜ŸåŸ¹è®­ - ç¡®ä¿å›¢é˜Ÿç†è§£ Agent åä½œæ¨¡å¼\n\nğŸ“š æ‰©å±•èµ„æº\nClaude Code Agent æ–‡æ¡£\nC++ Web æ¡†æ¶æ¯”è¾ƒ\nç°ä»£ C++ æœ€ä½³å®è·µ\nAPI è®¾è®¡æŒ‡å—\n\n\n\nğŸ’¡ æç¤º:\n\nAgent é—´çš„åä½œéœ€è¦æ˜ç¡®çš„æ¥å£å’Œè§„èŒƒ\nå®šæœŸå›é¡¾å’Œä¼˜åŒ– Agent å·¥ä½œæµç¨‹\nä¿æŒ Agent çŸ¥è¯†åº“çš„æ›´æ–°å’Œç»´æŠ¤\nå»ºç«‹æœ‰æ•ˆçš„è´¨é‡ç›‘æ§å’Œåé¦ˆæœºåˆ¶\n\n\n","categories":["è½¯ä»¶æ¶æ„"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Linux CLI å‚è€ƒæ‰‹å†Œ","url":"/posts/d7364a6b/","content":"Linux CLI å‚è€ƒæ‰‹å†Œç›®å½•\næ–‡ä»¶å’Œç›®å½•æ“ä½œ\næ–‡æœ¬å¤„ç†\nç³»ç»Ÿç®¡ç†\nç½‘ç»œæ“ä½œ\nç”¨æˆ·ä¸æƒé™\nè¿›ç¨‹ç®¡ç†\nåŒ…ç®¡ç†\næ–‡ä»¶å‹ç¼©ä¸å½’æ¡£\nç³»ç»Ÿç›‘æ§ä¸æ€§èƒ½åˆ†æ\n\næ–‡ä»¶å’Œç›®å½•æ“ä½œå¯¼èˆªä¸æŸ¥çœ‹\npwd: æ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•ã€‚\nls -la: åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ï¼ˆåŒ…æ‹¬éšè—çš„ï¼‰ï¼Œæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚\nls -lh: ä»¥äººç±»å¯è¯»çš„æ ¼å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å° (K, M, G)ã€‚\ncd /path/to/dir: åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•ã€‚\ncd ..: åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•ã€‚\ncd ~ æˆ– cd: åˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚\ncd -: åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªå·¥ä½œç›®å½•ã€‚\n\nåˆ›å»ºä¸åˆ é™¤\ntouch file.txt: åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶æˆ–æ›´æ–°æ–‡ä»¶çš„æ—¶é—´æˆ³ã€‚\nmkdir new_dir: åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ã€‚\nmkdir -p path/to/new_dir: é€’å½’åˆ›å»ºå¤šçº§ç›®å½•ã€‚\nrm file.txt: åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ï¼ˆä¼šæç¤ºï¼‰ã€‚\nrm -f file.txt: å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªæ–‡ä»¶ã€‚\nrm -r my_dir: é€’å½’åˆ é™¤ä¸€ä¸ªç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹ã€‚\nrm -rf my_dir: å¼ºåˆ¶é€’å½’åˆ é™¤ä¸€ä¸ªç›®å½•ï¼ˆå±é™©å‘½ä»¤ï¼Œè¯·è°¨æ…ä½¿ç”¨ï¼‰ã€‚\n\nå¤åˆ¶ä¸ç§»åŠ¨\ncp source.txt destination.txt: å¤åˆ¶æ–‡ä»¶ã€‚\ncp -r source_dir/ destination_dir/: é€’å½’å¤åˆ¶ç›®å½•ã€‚\nmv old_name.txt new_name.txt: é‡å‘½åæ–‡ä»¶æˆ–ç›®å½•ã€‚\nmv source.txt /path/to/destination/: ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•ã€‚\n\næŸ¥æ‰¾\nfind /path -name &quot;*.log&quot;: åœ¨æŒ‡å®šè·¯å¾„ä¸‹æŒ‰åç§°æŸ¥æ‰¾æ–‡ä»¶ã€‚\nfind /path -type f -size +100M: æŸ¥æ‰¾å¤§äº 100MB çš„æ–‡ä»¶ã€‚\nfind /path -name &quot;*.log&quot; -mtime +7: æŸ¥æ‰¾7å¤©å‰ä¿®æ”¹çš„æ—¥å¿—æ–‡ä»¶ã€‚\ngrep &quot;pattern&quot; file.txt: åœ¨æ–‡ä»¶ä¸­æœç´¢åŒ…å«ç‰¹å®šæ¨¡å¼çš„è¡Œã€‚\ngrep -r &quot;pattern&quot; /path/to/dir: åœ¨ç›®å½•ä¸­é€’å½’æœç´¢ã€‚\ngrep -i &quot;pattern&quot; file.txt: å¿½ç•¥å¤§å°å†™æœç´¢ã€‚\ngrep -n &quot;pattern&quot; file.txt: æ˜¾ç¤ºåŒ¹é…è¡Œçš„è¡Œå·ã€‚\ngrep -v &quot;pattern&quot; file.txt: æ˜¾ç¤ºä¸åŒ…å«åŒ¹é…æ¨¡å¼çš„è¡Œã€‚\n\næ–‡æœ¬å¤„ç†æŸ¥çœ‹å†…å®¹\ncat file.txt: ä¸€æ¬¡æ€§æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚\nless file.txt: åˆ†é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼ˆåŠŸèƒ½æ¯” more æ›´å¼ºå¤§ï¼‰ã€‚\nhead -n 20 file.txt: æ˜¾ç¤ºæ–‡ä»¶çš„å‰ 20 è¡Œã€‚\ntail -n 20 file.txt: æ˜¾ç¤ºæ–‡ä»¶çš„å 20 è¡Œã€‚\ntail -f /var/log/syslog: å®æ—¶è·Ÿè¸ªæ–‡ä»¶çš„æ–°å¢å†…å®¹ï¼Œå¸¸ç”¨äºçœ‹æ—¥å¿—ã€‚\ntail -F /var/log/syslog: è·Ÿè¸ªæ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶è¢«è½®è½¬ä¼šè‡ªåŠ¨è·Ÿè¸ªæ–°æ–‡ä»¶ã€‚\nless +F file.txt: åœ¨ less ä¸­æ‰“å¼€æ–‡ä»¶å¹¶è¿›å…¥è·Ÿè¸ªæ¨¡å¼ï¼ˆæŒ‰ Ctrl+C é€€å‡ºè·Ÿè¸ªï¼ŒæŒ‰ F é‡æ–°è¿›å…¥ï¼‰ã€‚\n\næ–‡æœ¬å·¥å…·\nwc -l file.txt: ç»Ÿè®¡æ–‡ä»¶çš„è¡Œæ•°ã€‚\nwc -w file.txt: ç»Ÿè®¡æ–‡ä»¶çš„å•è¯æ•°ã€‚\nsort file.txt: å¯¹æ–‡ä»¶çš„è¡Œè¿›è¡Œæ’åºã€‚\nuniq file.txt: ç§»é™¤æ–‡ä»¶ä¸­çš„è¿ç»­é‡å¤è¡Œï¼ˆé€šå¸¸ä¸ sort é…åˆä½¿ç”¨ï¼šsort file.txt | uniqï¼‰ã€‚\ncut -d&#39;,&#39; -f1 data.csv: ä»¥é€—å·ä¸ºåˆ†éš”ç¬¦ï¼Œæå–ç¬¬ä¸€åˆ—ã€‚\ntr &#39;a-z&#39; &#39;A-Z&#39; &lt; file.txt: å°†æ–‡æœ¬è½¬æ¢ä¸ºå¤§å†™ã€‚\ntr -d &#39;\\n&#39; &lt; file.txt: åˆ é™¤æ‰€æœ‰æ¢è¡Œç¬¦ã€‚\n\nsed ä¸ awk\nsed &#39;s/old/new/g&#39; file.txt: ä½¿ç”¨ sed æ›¿æ¢æ–‡ä»¶ä¸­çš„æ–‡æœ¬ã€‚\nsed -i &#39;s/old/new/g&#39; file.txt: ç›´æ¥ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼ˆæ³¨æ„å¤‡ä»½ï¼‰ã€‚\nawk &#39;{print $1}&#39; file.txt: ä½¿ç”¨ awk æ‰“å°æ¯ä¸€è¡Œçš„ç¬¬ä¸€åˆ—ï¼ˆé»˜è®¤ä»¥ç©ºæ ¼åˆ†éš”ï¼‰ã€‚\nawk -F&#39;,&#39; &#39;{print $2}&#39; data.csv: ä»¥é€—å·ä¸ºåˆ†éš”ç¬¦ï¼Œæ‰“å°ç¬¬äºŒåˆ—ã€‚\nawk &#39;{sum+=$1} END {print sum}&#39; numbers.txt: è®¡ç®—ç¬¬ä¸€åˆ—çš„æ€»å’Œã€‚\n\nç³»ç»Ÿç®¡ç†ç³»ç»Ÿä¿¡æ¯\nuname -a: æ˜¾ç¤ºè¯¦ç»†çš„å†…æ ¸å’Œç³»ç»Ÿä¿¡æ¯ã€‚\nlsb_release -a æˆ– cat /etc/os-release: æŸ¥çœ‹ Linux å‘è¡Œç‰ˆä¿¡æ¯ã€‚\nlscpu: æ˜¾ç¤º CPU ä¿¡æ¯ã€‚\nfree -h: ä»¥äººç±»å¯è¯»æ ¼å¼æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µã€‚\ndf -h: ä»¥äººç±»å¯è¯»æ ¼å¼æ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚\ndu -sh /path/to/dir: ä¼°ç®—ç›®å½•çš„æ€»å¤§å°ã€‚\ndu -h --max-depth=1 /path/to/dir: æ˜¾ç¤ºç›®å½•ä¸‹å„å­ç›®å½•çš„å¤§å°ã€‚\ndf -i: æ˜¾ç¤ºç£ç›˜ inode ä½¿ç”¨æƒ…å†µã€‚\n\næ—¶é—´ä¸æ—¥æœŸ\ndate: æ˜¾ç¤ºå½“å‰æ—¥æœŸå’Œæ—¶é—´ã€‚\ntimedatectl: æŸ¥çœ‹å’Œè®¾ç½®ç³»ç»Ÿæ—¶é—´ä¸æ—¶åŒºã€‚\nsudo timedatectl set-timezone Asia/Shanghai: è®¾ç½®æ—¶åŒºä¸ºä¸Šæµ·ã€‚\nsudo timedatectl set-ntp true: (æ¨è) å¯ç”¨ç½‘ç»œæ—¶é—´åŒæ­¥ã€‚\n\nå…³æœºä¸é‡å¯\nsudo shutdown -h now æˆ– sudo poweroff: ç«‹å³å…³æœºã€‚\nsudo shutdown -r now æˆ– sudo reboot: ç«‹å³é‡å¯ã€‚\nsudo shutdown -c: å–æ¶ˆä¸€ä¸ªå·²è®¡åˆ’çš„å…³æœºæˆ–é‡å¯ã€‚\nsudo shutdown -h +60 &quot;System will shutdown in 60 minutes&quot;: 60åˆ†é’Ÿåå…³æœºå¹¶æç¤ºæ¶ˆæ¯ã€‚\nsudo init 0: å…³æœºï¼ˆå¦ä¸€ç§æ–¹å¼ï¼‰ã€‚\nsudo init 6: é‡å¯ï¼ˆå¦ä¸€ç§æ–¹å¼ï¼‰ã€‚\n\nç½‘ç»œæ“ä½œ\nip addr show æˆ– ip a: æ˜¾ç¤ºæ‰€æœ‰ç½‘ç»œæ¥å£çš„ IP åœ°å€ã€‚\nping -c 4 google.com: å‘é€4ä¸ªICMPåŒ…æµ‹è¯•ç½‘ç»œè¿é€šæ€§ã€‚\nnetstat -tlnp: æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨ç›‘å¬çš„ TCP ç«¯å£ï¼ˆæ³¨æ„ï¼šnetstat å·²è¢« ss æ›¿ä»£ï¼‰ã€‚\nss -tuln: æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨ç›‘å¬çš„ TCP å’Œ UDP ç«¯å£ï¼ˆnetstat çš„ç°ä»£æ›¿ä»£å“ï¼‰ã€‚\nss -tulpn: æ˜¾ç¤ºç›‘å¬ç«¯å£åŠå¯¹åº”çš„è¿›ç¨‹ã€‚\nwget https://example.com/file.zip: ä¸‹è½½æ–‡ä»¶ã€‚\nwget -c https://example.com/largefile.zip: æ–­ç‚¹ç»­ä¼ ä¸‹è½½ã€‚\ncurl -I http://example.com: è·å–ä¸€ä¸ª URL çš„ HTTP å¤´éƒ¨ä¿¡æ¯ã€‚\ncurl -X POST -H &quot;Content-Type: application/json&quot; -d &#39;{&quot;key&quot;:&quot;value&quot;}&#39; https://api.example.com: å‘é€ POST è¯·æ±‚ã€‚\ndig example.com: DNS æŸ¥è¯¢å·¥å…·ï¼Œæ˜¾ç¤ºåŸŸåè§£æä¿¡æ¯ã€‚\nnslookup example.com: å¦ä¸€ä¸ª DNS æŸ¥è¯¢å·¥å…·ã€‚\n\nç”¨æˆ·ä¸æƒé™ç”¨æˆ·å’Œç»„\nwhoami: æ˜¾ç¤ºå½“å‰ç™»å½•çš„ç”¨æˆ·åã€‚\nsudo adduser newuser: åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ï¼ˆäº¤äº’å¼ï¼‰ã€‚\nsudo userdel -r olduser: åˆ é™¤ä¸€ä¸ªç”¨æˆ·åŠå…¶ä¸»ç›®å½•ã€‚\nsudo usermod -aG sudo myuser: å°†ç”¨æˆ· myuser æ·»åŠ åˆ° sudo ç»„ã€‚\nsudo usermod -aG docker username: å°†ç”¨æˆ·æ·»åŠ åˆ° docker ç»„ã€‚\ngroups username: æŸ¥çœ‹ç”¨æˆ·æ‰€å±çš„æ‰€æœ‰ç»„ã€‚\npasswd: ä¿®æ”¹å½“å‰ç”¨æˆ·çš„å¯†ç ã€‚\nsudo passwd username: ä¿®æ”¹å…¶ä»–ç”¨æˆ·çš„å¯†ç ï¼ˆéœ€è¦ root æƒé™ï¼‰ã€‚\n\næ–‡ä»¶æƒé™\nchmod 755 script.sh: è®¾ç½®æ–‡ä»¶æƒé™ä¸º rwxr-xr-xã€‚\nchmod +x script.sh: ä¸ºæ–‡ä»¶æ·»åŠ å¯æ‰§è¡Œæƒé™ã€‚\nchmod -R 755 /path/to/dir: é€’å½’è®¾ç½®ç›®å½•æƒé™ã€‚\nchown user:group file.txt: æ›´æ”¹æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€å±ç»„ã€‚\nchown -R user:group /path/to/dir: é€’å½’æ›´æ”¹ç›®å½•çš„æ‰€æœ‰æƒã€‚\nchmod u=rwx,g=rx,o=r file.txt: ä½¿ç”¨ç¬¦å·æ¨¡å¼è®¾ç½®æƒé™ã€‚\numask 022: è®¾ç½®æ–°åˆ›å»ºæ–‡ä»¶çš„é»˜è®¤æƒé™æ©ç ã€‚\n\nè¿›ç¨‹ç®¡ç†\nps aux: æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¿›ç¨‹çš„å¿«ç…§ã€‚\nps -ef: æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹çš„å®Œæ•´æ ¼å¼åˆ—è¡¨ã€‚\ntop æˆ– htop: å®æ—¶ã€äº¤äº’å¼åœ°æ˜¾ç¤ºè¿›ç¨‹å’Œç³»ç»Ÿèµ„æºã€‚\nkill &lt;PID&gt;: ç»ˆæ­¢ä¸€ä¸ªæŒ‡å®š PID çš„è¿›ç¨‹ã€‚\nkill -9 &lt;PID&gt;: å¼ºåˆ¶ç»ˆæ­¢ä¸€ä¸ªè¿›ç¨‹ï¼ˆæœ€åçš„æ‰‹æ®µï¼‰ã€‚\nkill -15 &lt;PID&gt;: å‘é€ SIGTERM ä¿¡å·ï¼Œä¼˜é›…åœ°ç»ˆæ­¢è¿›ç¨‹ã€‚\npkill process_name: æŒ‰åç§°ç»ˆæ­¢è¿›ç¨‹ã€‚\npgrep process_name: æŸ¥æ‰¾è¿›ç¨‹çš„ PIDã€‚\ncommand &amp;: åœ¨åå°è¿è¡Œä¸€ä¸ªå‘½ä»¤ã€‚\nnohup command &amp;: åå°è¿è¡Œå‘½ä»¤ï¼Œå³ä½¿é€€å‡ºç»ˆç«¯ä¹Ÿç»§ç»­è¿è¡Œã€‚\njobs: æ˜¾ç¤ºåœ¨åå°è¿è¡Œçš„ä½œä¸šã€‚\nbg %1: å°†ä½œä¸š1æ”¾åˆ°åå°è¿è¡Œã€‚\nfg %1: å°†ä½œä¸š1è°ƒåˆ°å‰å°è¿è¡Œã€‚\n\nåŒ…ç®¡ç†Debian&#x2F;Ubuntu (apt)\nsudo apt update: åˆ·æ–°å¯ç”¨çš„è½¯ä»¶åŒ…åˆ—è¡¨ã€‚\nsudo apt upgrade: å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶åŒ…ã€‚\nsudo apt full-upgrade: å‡çº§æ‰€æœ‰è½¯ä»¶åŒ…ï¼ˆå¯èƒ½åˆ é™¤è½¯ä»¶åŒ…ï¼‰ã€‚\nsudo apt install &lt;package_name&gt;: å®‰è£…ä¸€ä¸ªè½¯ä»¶åŒ…ã€‚\nsudo apt install --no-install-recommends &lt;package_name&gt;: åªå®‰è£…å¿…è¦çš„ä¾èµ–ã€‚\nsudo apt remove &lt;package_name&gt;: å¸è½½ä¸€ä¸ªè½¯ä»¶åŒ…ï¼ˆä¿ç•™é…ç½®æ–‡ä»¶ï¼‰ã€‚\nsudo apt purge &lt;package_name&gt;: å®Œå…¨å¸è½½è½¯ä»¶åŒ…ï¼ˆåŒ…æ‹¬é…ç½®æ–‡ä»¶ï¼‰ã€‚\nsudo apt autoremove: è‡ªåŠ¨ç§»é™¤ä¸éœ€è¦çš„ä¾èµ–åŒ…ã€‚\napt search &lt;keyword&gt;: æœç´¢è½¯ä»¶åŒ…ã€‚\napt show &lt;package_name&gt;: æ˜¾ç¤ºè½¯ä»¶åŒ…çš„è¯¦ç»†ä¿¡æ¯ã€‚\n\nRed Hat&#x2F;CentOS&#x2F;Fedora (dnf&#x2F;yum)\nsudo dnf update: å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶åŒ…ã€‚\nsudo dnf upgrade: å‡çº§è½¯ä»¶åŒ…ï¼ˆä¸æ›´æ–°å†…æ ¸ï¼‰ã€‚\nsudo dnf install &lt;package_name&gt;: å®‰è£…ä¸€ä¸ªè½¯ä»¶åŒ…ã€‚\nsudo dnf remove &lt;package_name&gt;: å¸è½½ä¸€ä¸ªè½¯ä»¶åŒ…ã€‚\nsudo dnf autoremove: è‡ªåŠ¨ç§»é™¤ä¸éœ€è¦çš„ä¾èµ–åŒ…ã€‚\ndnf search &lt;keyword&gt;: æœç´¢è½¯ä»¶åŒ…ã€‚\ndnf info &lt;package_name&gt;: æ˜¾ç¤ºè½¯ä»¶åŒ…ä¿¡æ¯ã€‚\n\nArch Linux (pacman)\nsudo pacman -Syu: åŒæ­¥ä»“åº“å¹¶å‡çº§ç³»ç»Ÿã€‚\nsudo pacman -S &lt;package_name&gt;: å®‰è£…è½¯ä»¶åŒ…ã€‚\nsudo pacman -R &lt;package_name&gt;: åˆ é™¤è½¯ä»¶åŒ…ã€‚\nsudo pacman -Rs &lt;package_name&gt;: åˆ é™¤è½¯ä»¶åŒ…åŠå…¶ä¸éœ€è¦çš„ä¾èµ–ã€‚\npacman -Ss &lt;keyword&gt;: æœç´¢è½¯ä»¶åŒ…ã€‚\npacman -Qi &lt;package_name&gt;: æŸ¥çœ‹è½¯ä»¶åŒ…ä¿¡æ¯ã€‚\n\næ–‡ä»¶å‹ç¼©ä¸å½’æ¡£tar å½’æ¡£\ntar -czf archive.tar.gz files/: åˆ›å»º gzip å‹ç¼©çš„ tar å½’æ¡£ã€‚\ntar -xzf archive.tar.gz: è§£å‹ gzip å‹ç¼©çš„ tar å½’æ¡£ã€‚\ntar -cjf archive.tar.bz2 files/: åˆ›å»º bzip2 å‹ç¼©çš„ tar å½’æ¡£ã€‚\ntar -xjf archive.tar.bz2: è§£å‹ bzip2 å‹ç¼©çš„ tar å½’æ¡£ã€‚\ntar -czf archive.tar.gz --exclude=&#39;*.log&#39; directory/: åˆ›å»ºå½’æ¡£ä½†æ’é™¤æ—¥å¿—æ–‡ä»¶ã€‚\ntar -tzf archive.tar.gz: æŸ¥çœ‹å½’æ¡£å†…å®¹ä½†ä¸è§£å‹ã€‚\n\nzip å‹ç¼©\nzip -r archive.zip files/: åˆ›å»º zip å‹ç¼©åŒ…ã€‚\nunzip archive.zip: è§£å‹ zip æ–‡ä»¶ã€‚\nunzip -l archive.zip: æŸ¥çœ‹ zip æ–‡ä»¶å†…å®¹ã€‚\nzip -r archive.zip files/ -x &quot;*.log&quot;: åˆ›å»º zip å‹ç¼©åŒ…ä½†æ’é™¤æ—¥å¿—æ–‡ä»¶ã€‚\n\nå…¶ä»–å‹ç¼©æ ¼å¼\ngzip file.txt: å‹ç¼©æ–‡ä»¶ï¼ˆåŸæ–‡ä»¶ä¼šè¢«æ›¿æ¢ä¸º .gzï¼‰ã€‚\ngzip -d file.txt.gz: è§£å‹ gzip æ–‡ä»¶ã€‚\nbzip2 file.txt: ä½¿ç”¨ bzip2 å‹ç¼©ï¼ˆæ›´é«˜çš„å‹ç¼©ç‡ï¼‰ã€‚\nbzip2 -d file.txt.bz2: è§£å‹ bzip2 æ–‡ä»¶ã€‚\nxz file.txt: ä½¿ç”¨ xz å‹ç¼©ï¼ˆç°ä»£é«˜æ•ˆç‡å‹ç¼©ï¼‰ã€‚\nxz -d file.txt.xz: è§£å‹ xz æ–‡ä»¶ã€‚\n\nç³»ç»Ÿç›‘æ§ä¸æ€§èƒ½åˆ†æç³»ç»Ÿè´Ÿè½½\nuptime: æ˜¾ç¤ºç³»ç»Ÿè¿è¡Œæ—¶é—´ã€ç”¨æˆ·æ•°å’Œå¹³å‡è´Ÿè½½ã€‚\nw: æ˜¾ç¤ºå½“å‰ç™»å½•ç”¨æˆ·å’Œç³»ç»Ÿè´Ÿè½½ã€‚\nload average: é€šè¿‡ uptime æˆ– top æŸ¥çœ‹ 1ã€5ã€15åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ã€‚\n\nå†…å­˜ä½¿ç”¨åˆ†æ\nfree -h: ä»¥äººç±»å¯è¯»æ ¼å¼æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µã€‚\nfree -m: ä»¥ MB ä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨ã€‚\nvmstat 5: æ¯5ç§’æ˜¾ç¤ºä¸€æ¬¡è™šæ‹Ÿå†…å­˜ç»Ÿè®¡ä¿¡æ¯ã€‚\n\nCPU ä½¿ç”¨åˆ†æ\ntop: å®æ—¶æ˜¾ç¤ºè¿›ç¨‹å’Œ CPU ä½¿ç”¨æƒ…å†µã€‚\nhtop: æ›´å‹å¥½çš„äº¤äº’å¼è¿›ç¨‹æŸ¥çœ‹å™¨ï¼ˆéœ€è¦å®‰è£…ï¼‰ã€‚\nmpstat 1: æ¯ç§’æ˜¾ç¤ºä¸€æ¬¡ CPU ç»Ÿè®¡ä¿¡æ¯ã€‚\n\nç£ç›˜ I&#x2F;O ç›‘æ§\niostat: æ˜¾ç¤º CPU å’Œ I&#x2F;O ç»Ÿè®¡ä¿¡æ¯ã€‚\niotop: æ˜¾ç¤ºè¿›ç¨‹çš„ I&#x2F;O ä½¿ç”¨æƒ…å†µï¼ˆéœ€è¦å®‰è£…ï¼‰ã€‚\ndf -h: æŸ¥çœ‹ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µã€‚\n\nç½‘ç»œç›‘æ§\niftop: å®æ—¶æ˜¾ç¤ºç½‘ç»œå¸¦å®½ä½¿ç”¨ï¼ˆéœ€è¦å®‰è£…ï¼‰ã€‚\nnethogs: æŒ‰è¿›ç¨‹æ˜¾ç¤ºç½‘ç»œä½¿ç”¨ï¼ˆéœ€è¦å®‰è£…ï¼‰ã€‚\ntcpdump -i eth0: æ•è·ç½‘ç»œåŒ…ï¼ˆéœ€è¦ root æƒé™ï¼‰ã€‚\n\næ—¥å¿—æŸ¥çœ‹\njournalctl -xe: æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼ˆsystemd ç³»ç»Ÿï¼‰ã€‚\njournalctl -u nginx: æŸ¥çœ‹ç‰¹å®šæœåŠ¡çš„æ—¥å¿—ã€‚\ntail -f /var/log/syslog: å®æ—¶æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ã€‚\ntail -100f /var/log/nginx/access.log: æŸ¥çœ‹æœ€å100è¡Œå¹¶å®æ—¶è·Ÿè¸ªã€‚\n\n","categories":["ç³»ç»Ÿè¿ç»´ç®¡ç†","Linuxç³»ç»Ÿç®¡ç†"],"tags":["Linux","ç³»ç»Ÿç®¡ç†","Bash","å‘½ä»¤è¡Œ","Shell","Cheatsheet"]},{"title":"Qt libcurl é›†æˆæŒ‡å—","url":"/posts/31cbd6c5/","content":"Qt libcurl é›†æˆæŒ‡å—ç›®å½•\næ¦‚è¿°\næ–¹æ³•ä¸€ï¼šä½¿ç”¨vcpkg (å¼ºçƒˆæ¨è)\næ–¹æ³•äºŒï¼šæ‰‹åŠ¨ä»æºç ç¼–è¯‘ (é«˜çº§)\nåœ¨Qté¡¹ç›®ä¸­ä½¿ç”¨libcurl\nå¸¸è§é—®é¢˜\n\næ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ç°ä»£ Windows å¼€å‘ç¯å¢ƒ (Visual Studio 2022) ä¸­ï¼Œä¸º Qt é¡¹ç›®é›†æˆ libcurl åº“ã€‚é¦–é€‰æ–¹æ³•æ˜¯ä½¿ç”¨ vcpkg åŒ…ç®¡ç†å™¨ï¼Œå› ä¸ºå®ƒæå¤§åœ°ç®€åŒ–äº†æµç¨‹ã€‚\nä¸ºä»€ä¹ˆä½¿ç”¨ libcurl?\nåŠŸèƒ½å¼ºå¤§: æ”¯æŒ HTTP&#x2F;2, HTTPS, FTP(S), aå¤šç§è®¤è¯æœºåˆ¶ç­‰ã€‚\nç¨³å®šå¯é : ç»è¿‡é•¿æœŸå’Œå¹¿æ³›ä½¿ç”¨çš„è€ƒéªŒã€‚\nè¡¥å…… Qt Network: åœ¨å¤„ç†å¤æ‚çš„ HTTP å¤´éƒ¨ã€ä»£ç†æˆ–ç‰¹å®šè®¤è¯æ—¶ï¼Œæ¯” QNetworkAccessManager æ›´çµæ´»ã€‚\n\næ–¹æ³•ä¸€ï¼šä½¿ç”¨vcpkg (å¼ºçƒˆæ¨è)vcpkg æ˜¯å¾®è½¯å®˜æ–¹çš„ C++ åº“ç®¡ç†å™¨ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨å¤„ç†åº“çš„ä¸‹è½½ã€ç¼–è¯‘å’Œé›†æˆã€‚\n1. å®‰è£… vcpkgå¦‚æœå°šæœªå®‰è£… vcpkgï¼Œè¯·åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š\n# Qt libcurl é›†æˆæŒ‡å—git clone https://github.com/microsoft/vcpkg.gitcd vcpkg# Qt libcurl é›†æˆæŒ‡å—.\\bootstrap-vcpkg.bat# Qt libcurl é›†æˆæŒ‡å—.\\vcpkg integrate install\n\n2. ä½¿ç”¨ vcpkg å®‰è£… libcurlvcpkg å¯ä»¥è½»æ¾åœ°å®‰è£… libcurl åŠå…¶æ‰€æœ‰ä¾èµ–ï¼ˆå¦‚ OpenSSL, zlibï¼‰ã€‚\n# Qt libcurl é›†æˆæŒ‡å—# Qt libcurl é›†æˆæŒ‡å—.\\vcpkg.exe install curl:x64-windows-static\nå®‰è£…å®Œæˆåï¼Œvcpkg ä¼šæç¤ºä½ å¦‚ä½•ä¸ CMake æˆ– MSBuild é¡¹ç›®é›†æˆã€‚\n3. åœ¨ Qt é¡¹ç›®ä¸­é›†æˆ (CMake)å½“ä½¿ç”¨ CMake æ„å»º Qt é¡¹ç›®æ—¶ï¼Œé›†æˆ vcpkg éå¸¸ç®€å•ã€‚\nCMakeLists.txt:\ncmake_minimum_required(VERSION 3.18)project(MyQtCurlApp)# Qt libcurl é›†æˆæŒ‡å—set(CMAKE_CXX_STANDARD 17)set(CMAKE_CXX_STANDARD_REQUIRED ON)# Qt libcurl é›†æˆæŒ‡å—find_package(Qt6 REQUIRED COMPONENTS Core Gui Widgets)# Qt libcurl é›†æˆæŒ‡å—find_package(CURL REQUIRED)# Qt libcurl é›†æˆæŒ‡å—add_executable(my_app main.cpp HttpClient.cpp)# Qt libcurl é›†æˆæŒ‡å—target_link_libraries(my_app PRIVATE    Qt6::Core    Qt6::Gui    Qt6::Widgets    CURL::libcurl # vcpkg æä¾›çš„ CMake target)\n\né…ç½®é¡¹ç›®:åœ¨é¦–æ¬¡è¿è¡Œ CMake æ—¶ï¼Œé€šè¿‡ CMAKE_TOOLCHAIN_FILE å‚æ•°æŒ‡å‘ vcpkg çš„è„šæœ¬ã€‚\n# Qt libcurl é›†æˆæŒ‡å—cmake -B build -S . -DCMAKE_TOOLCHAIN_FILE=C:/dev/vcpkg/scripts/buildsystems/vcpkg.cmake\nä¹‹åï¼ŒCMake å°±èƒ½è‡ªåŠ¨æ‰¾åˆ° libcurl çš„æ‰€æœ‰å¤´æ–‡ä»¶å’Œåº“ã€‚\næ–¹æ³•äºŒï¼šæ‰‹åŠ¨ä»æºç ç¼–è¯‘ (é«˜çº§)ä»…å½“ä½ éœ€è¦ä¸€ä¸ª vcpkg æ— æ³•æä¾›çš„ã€é«˜åº¦å®šåˆ¶åŒ–çš„ libcurl ç‰ˆæœ¬æ—¶ï¼Œæ‰æ¨èæ­¤æ–¹æ³•ã€‚\n1. ç¯å¢ƒå‡†å¤‡\nVisual Studio 2022: ç¡®ä¿å·²å®‰è£… â€œä½¿ç”¨ C++ çš„æ¡Œé¢å¼€å‘â€ å·¥ä½œè´Ÿè½½ã€‚\nPerl: ç”¨äºè¿è¡Œéƒ¨åˆ†æ„å»ºè„šæœ¬ã€‚æ¨è Strawberry Perlã€‚\nå¯åŠ¨å¼€å‘è€…å‘½ä»¤æç¤ºç¬¦: ä»å¼€å§‹èœå•å¯åŠ¨ x64 Native Tools Command Prompt for VS 2022ã€‚\n\n2. è·å–æºç å’Œä¾èµ–\nlibcurl: ä» curl å®˜ç½‘ ä¸‹è½½æœ€æ–°æºç ã€‚\nOpenSSL: ä» slproweb.com ä¸‹è½½é¢„ç¼–è¯‘çš„ OpenSSLï¼Œæˆ–ä½¿ç”¨ vcpkg å•ç‹¬å®‰è£… opensslã€‚\n\n3. ç¼–è¯‘libcurl çš„ Windows ç‰ˆæœ¬æºç ä¸­åŒ…å«ä¸€ä¸ª winbuild ç›®å½•ï¼Œä½¿ç”¨ nmake è¿›è¡Œç¼–è¯‘ã€‚\n# Qt libcurl é›†æˆæŒ‡å—cd curl-8.4.0\\winbuild# Qt libcurl é›†æˆæŒ‡å—# Qt libcurl é›†æˆæŒ‡å—# Qt libcurl é›†æˆæŒ‡å—# Qt libcurl é›†æˆæŒ‡å—# Qt libcurl é›†æˆæŒ‡å—nmake /f Makefile.vc mode=static MACHINE=x64 ENABLE_SSL=yes WITH_SSL=C:\\vcpkg\\installed\\x64-windows-static\n\nåœ¨Qté¡¹ç›®ä¸­ä½¿ç”¨libcurl1. å°è£… HttpClient (æ¨è)ç›´æ¥ä½¿ç”¨ C-API é£æ ¼çš„ libcurl æ¯”è¾ƒç¹çã€‚å»ºè®®å°†å…¶å°è£…åœ¨ä¸€ä¸ª C++ ç±»ä¸­ã€‚\né‡è¦æç¤º: curl_global_init() å’Œ curl_global_cleanup() å¿…é¡»åœ¨ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­åªè°ƒç”¨ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªå¯¹è±¡çš„æ„é€ &#x2F;ææ„å‡½æ•°ä¸­è°ƒç”¨ã€‚æœ€ä½³å®è·µæ˜¯åœ¨ main å‡½æ•°çš„å¼€å¤´å’Œç»“å°¾è°ƒç”¨ã€‚\nmain.cpp:\n#include &lt;QApplication&gt;#include &lt;curl/curl.h&gt;#include &quot;mainwindow.h&quot; // ä½ çš„ä¸»çª—å£int main(int argc, char *argv[]) &#123;    // åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ– libcurl    curl_global_init(CURL_GLOBAL_ALL);    QApplication a(argc, argv);    MainWindow w;    w.show();    int result = a.exec();    // åœ¨ç¨‹åºé€€å‡ºæ—¶æ¸…ç† libcurl    curl_global_cleanup();    return result;&#125;\n\nhttp_client.h:\n#ifndef HTTPCLIENT_H#define HTTPCLIENT_H#include &lt;string&gt;#include &lt;curl/curl.h&gt;class HttpClient &#123;public:    HttpClient();    ~HttpClient();    std::string get(const std::string&amp; url);private:    CURL* curl_handle;    static size_t write_callback(void* contents, size_t size, size_t nmemb, void* userp);&#125;;#endif // HTTPCLIENT_H\n\nhttp_client.cpp:\n#include &quot;http_client.h&quot;HttpClient::HttpClient() &#123;    // åªåœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ– handle    curl_handle = curl_easy_init();&#125;HttpClient::~HttpClient() &#123;    // åªåœ¨ææ„å‡½æ•°ä¸­æ¸…ç† handle    if (curl_handle) &#123;        curl_easy_cleanup(curl_handle);    &#125;&#125;size_t HttpClient::write_callback(void* contents, size_t size, size_t nmemb, void* userp) &#123;    ((std::string*)userp)-&gt;append((char*)contents, size * nmemb);    return size * nmemb;&#125;std::string HttpClient::get(const std::string&amp; url) &#123;    if (!curl_handle) &#123;        return &quot;Error: curl handle not initialized.&quot;;    &#125;    std::string read_buffer;    curl_easy_setopt(curl_handle, CURLOPT_URL, url.c_str());    curl_easy_setopt(curl_handle, CURLOPT_WRITEFUNCTION, write_callback);    curl_easy_setopt(curl_handle, CURLOPT_WRITEDATA, &amp;read_buffer);    // æ›´å¤šé€‰é¡¹...    // curl_easy_setopt(curl_handle, CURLOPT_CAINFO, &quot;cacert.pem&quot;); // è®¾ç½®CAè¯ä¹¦    CURLcode res = curl_easy_perform(curl_handle);    if (res != CURLE_OK) &#123;        return &quot;curl_easy_perform() failed: &quot; + std::string(curl_easy_strerror(res));    &#125;    return read_buffer;&#125;\n\n2. Qt .pro æ–‡ä»¶é…ç½® (qmake)å¦‚æœä½ ä¸ä½¿ç”¨ CMakeï¼Œå¯ä»¥åœ¨ .pro æ–‡ä»¶ä¸­è¿™æ ·é…ç½®ï¼š\n# Qt libcurl é›†æˆæŒ‡å—# Qt libcurl é›†æˆæŒ‡å—# Qt libcurl é›†æˆæŒ‡å—DEFINES += CURL_STATICLIB# Qt libcurl é›†æˆæŒ‡å—INCLUDEPATH += C:/dev/vcpkg/installed/x64-windows-static/include# Qt libcurl é›†æˆæŒ‡å—LIBS += -LC:/dev/vcpkg/installed/x64-windows-static/libLIBS += -lcurl -lcrypt32 -lws2_32 -lwldap32# Qt libcurl é›†æˆæŒ‡å—CONFIG(debug, debug|release) &#123;    LIBS += -lcurld&#125; else &#123;    LIBS += -lcurl&#125;\n\nå¸¸è§é—®é¢˜Q1: ä½¿ç”¨ vcpkg åï¼ŒCMake find_package(CURL) å¤±è´¥?A: ä½ åœ¨è¿è¡Œ CMake æ—¶æ²¡æœ‰æŒ‡å®š CMAKE_TOOLCHAIN_FILEã€‚ç¡®ä¿ä½ çš„ CMake é…ç½®å‘½ä»¤åŒ…å«äº† -DCMAKE_TOOLCHAIN_FILE=&lt;path-to-vcpkg&gt;/scripts/buildsystems/vcpkg.cmakeã€‚\nQ2: é“¾æ¥æ—¶å‡ºç° unresolved external symbol é”™è¯¯?A:\n\nCURL_STATICLIB æœªå®šä¹‰: å¦‚æœä½ é“¾æ¥çš„æ˜¯é™æ€åº“ï¼Œå¿…é¡»åœ¨é¡¹ç›®ä¸­å®šä¹‰ CURL_STATICLIB é¢„å¤„ç†å™¨å®ã€‚\nç¼ºå°‘ç³»ç»Ÿåº“: libcurl ä¾èµ–ä¸€äº› Windows ç³»ç»Ÿåº“ã€‚ç¡®ä¿ä½ é“¾æ¥äº† ws2_32.lib, crypt32.lib, wldap32.libã€‚\nè¿è¡Œæ—¶åº“ä¸åŒ¹é…: ç¡®ä¿ä½ çš„é¡¹ç›®å’Œ libcurl ä½¿ç”¨äº†ç›¸åŒçš„è¿è¡Œæ—¶åº“è®¾ç½®ï¼ˆä¾‹å¦‚ï¼Œéƒ½æ˜¯ /MD æˆ– /MTï¼‰ã€‚vcpkg é»˜è®¤ä½¿ç”¨åŠ¨æ€è¿è¡Œæ—¶ (/MD)ã€‚\n\nQ3: è¿è¡Œæ—¶å‡ºç° SSL&#x2F;TLS é”™è¯¯ï¼Œä¾‹å¦‚ SSL certificate problem?A: libcurl éœ€è¦ CA è¯ä¹¦æ¥éªŒè¯ HTTPS æœåŠ¡å™¨çš„èº«ä»½ã€‚\n\nvcpkg: vcpkg å®‰è£…çš„ curl é€šå¸¸ä¼šè‡ªåŠ¨å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒä¾èµ–çš„ openssl ä¼šè®¾ç½®ä¸€ä¸ªé»˜è®¤çš„è¯ä¹¦è·¯å¾„ã€‚\næ‰‹åŠ¨å¤„ç†: ä½ å¯ä»¥ä» curl å®˜ç½‘ ä¸‹è½½ cacert.pem æ–‡ä»¶ï¼Œå¹¶é€šè¿‡ curl_easy_setopt(curl, CURLOPT_CAINFO, &quot;path/to/cacert.pem&quot;); æ¥æŒ‡å®šå®ƒçš„è·¯å¾„ã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","CMake","Windows","Qt","libcurl","vcpkg","Visual Studio","ç½‘ç»œåº“"]},{"title":"Qt QSS æ ·å¼è¡¨æŒ‡å—","url":"/posts/35f89acf/","content":"Qt QSS æ ·å¼è¡¨æŒ‡å—ç›®å½•\næ¦‚è¿°\nåŸºç¡€è¯­æ³•ä¸åº”ç”¨\né€‰æ‹©å™¨ (Selectors)\nç›’å­æ¨¡å‹ (Box Model)\nä¼ªçŠ¶æ€ (Pseudo-States)\nå­æ§ä»¶ (Sub-Controls)\nå¸¸ç”¨å±æ€§å‚è€ƒ\né«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ\n\næ¦‚è¿°Qt æ ·å¼è¡¨ (Qt Style Sheets, QSS) æ˜¯ä¸€ç§å¼ºå¤§çš„æœºåˆ¶ï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨ç±»ä¼¼ CSS çš„è¯­æ³•æ¥å®šåˆ¶ Qt æ§ä»¶çš„å¤–è§‚ã€‚é€šè¿‡ QSSï¼Œå¯ä»¥è½»æ¾å®ç°ç•Œé¢ç¾åŒ–ã€ä¸»é¢˜åˆ‡æ¢å’Œå“ç‰Œå®šåˆ¶ï¼Œè€Œæ— éœ€ä¿®æ”¹ C++ ä»£ç ã€‚\nåŸºç¡€è¯­æ³•ä¸åº”ç”¨1. è¯­æ³•ç»“æ„QSS çš„åŸºæœ¬è¯­æ³•ä¸ CSS éå¸¸ç›¸ä¼¼ï¼šselector { property: value; }\n/* è¿™æ˜¯ä¸€ä¸ªæ³¨é‡Š *//* ç±»å‹é€‰æ‹©å™¨: åº”ç”¨äºæ‰€æœ‰ QPushButton å®ä¾‹ */QPushButton &#123;    color: white;    background-color: #5cb85c;    border-radius: 4px;    padding: 8px 16px;&#125;/* å¯¹è±¡åç§°é€‰æ‹©å™¨ (IDé€‰æ‹©å™¨): åªåº”ç”¨äº objectName ä¸º &#x27;loginButton&#x27; çš„æ§ä»¶ */QPushButton#loginButton &#123;    font-weight: bold;&#125;\n\n2. åœ¨ä»£ç ä¸­åº”ç”¨æ ·å¼åº”ç”¨äºå•ä¸ªæ§ä»¶#include &lt;QPushButton&gt;// ...auto myButton = new QPushButton(&quot;Click Me&quot;);myButton-&gt;setStyleSheet(&quot;background-color: #f0ad4e; color: white;&quot;);\n\nåº”ç”¨äºæ•´ä¸ªåº”ç”¨ç¨‹åºè¿™æ˜¯æœ€å¸¸è§çš„æ–¹å¼ï¼Œç”¨äºè®¾ç½®å…¨å±€ä¸»é¢˜ã€‚\n#include &lt;QApplication&gt;int main(int argc, char *argv[]) &#123;    QApplication a(argc, argv);    a.setStyleSheet(&quot;QPushButton &#123; background-color: #5bc0de; &#125;&quot;);    // ...    return a.exec();&#125;\n\nä»æ–‡ä»¶åŠ è½½æ ·å¼ (æ¨è)å°† QSS æ”¾åœ¨å•ç‹¬çš„ .qss æ–‡ä»¶ä¸­æ˜¯æœ€ä½³å®è·µã€‚\nstyles/dark_theme.qss:\nQWidget &#123;    background-color: #2d2d2d;    color: #f0f0f0;&#125;QPushButton &#123;    background-color: #4a4a4a;    border: 1px solid #666;&#125;\n\nmain.cpp:\n#include &lt;QApplication&gt;#include &lt;QFile&gt;void loadStyleSheet(const QString&amp; path) &#123;    QFile file(path);    if (file.open(QFile::ReadOnly | QFile::Text)) &#123;        QString style = QLatin1String(file.readAll());        qApp-&gt;setStyleSheet(style);        file.close();    &#125;&#125;int main(int argc, char *argv[]) &#123;    QApplication a(argc, argv);    loadStyleSheet(&quot;:/styles/dark_theme.qss&quot;); // ä» Qt èµ„æºç³»ç»ŸåŠ è½½    // ...    return a.exec();&#125;\n\né€‰æ‹©å™¨ (Selectors)é€‰æ‹©å™¨ç”¨äºæŒ‡å®šæ ·å¼è§„åˆ™åº”ç”¨åˆ°å“ªäº›æ§ä»¶ã€‚\n\n\n\né€‰æ‹©å™¨ç±»å‹\nç¤ºä¾‹\nè¯´æ˜\n\n\n\nç±»å‹é€‰æ‹©å™¨\nQPushButton\nåŒ¹é…æ‰€æœ‰ QPushButton åŠå…¶å­ç±»çš„å®ä¾‹ã€‚\n\n\nå¯¹è±¡åç§°é€‰æ‹©å™¨\nQPushButton#myButton\nåŒ¹é… objectName ä¸º myButton çš„ QPushButtonã€‚\n\n\nç±»é€‰æ‹©å™¨\n.MyCustomButton\nåŒ¹é… MyCustomButton ç±»çš„å®ä¾‹ (åŠå…¶å­ç±»)ã€‚\n\n\nå±æ€§é€‰æ‹©å™¨\nQPushButton[flat=&quot;true&quot;]\nåŒ¹é… flat å±æ€§ä¸º true çš„ QPushButtonã€‚\n\n\nåä»£é€‰æ‹©å™¨\nQDialog QPushButton\nåŒ¹é… QDialog å†…çš„æ‰€æœ‰ QPushButtonã€‚\n\n\nå­é€‰æ‹©å™¨\nQGroupBox &gt; QCheckBox\nåªåŒ¹é…ä½œä¸º QGroupBox ç›´æ¥å­å…ƒç´ çš„ QCheckBoxã€‚\n\n\né€šç”¨é€‰æ‹©å™¨\n*\nåŒ¹é…æ‰€æœ‰æ§ä»¶ (æ€§èƒ½å¼€é”€å¤§ï¼Œæ…ç”¨)ã€‚\n\n\nç›’å­æ¨¡å‹ (Box Model)QSS çš„ç›’å­æ¨¡å‹ä¸ CSS ç±»ä¼¼ï¼Œå®šä¹‰äº†æ§ä»¶çš„å°ºå¯¸å’Œé—´è·ã€‚\n\nQPushButton &#123;    /* è¾¹æ¡† (border) */    border: 2px solid #1e90ff;    border-radius: 5px;    /* å†…è¾¹è· (padding) */    padding: 10px;    /* å¤–è¾¹è· (margin) */    margin: 5px;    /* èƒŒæ™¯ä» padding åŒºåŸŸå¼€å§‹ç»˜åˆ¶ */    background-origin: padding;&#125;\n\nmargin: è¾¹æ¡†ä»¥å¤–çš„åŒºåŸŸï¼Œæ˜¯é€æ˜çš„ã€‚\nborder: å›´ç»•åœ¨ padding å’Œå†…å®¹åŒºçš„è¾¹ç•Œã€‚\npadding: border å’Œå†…å®¹ä¹‹é—´çš„ç©ºç™½åŒºåŸŸã€‚\ncontent: æ§ä»¶å®é™…å†…å®¹çš„åŒºåŸŸ (ä¾‹å¦‚ï¼ŒæŒ‰é’®çš„æ–‡æœ¬å’Œå›¾æ ‡)ã€‚\n\nä¼ªçŠ¶æ€ (Pseudo-States)ä¼ªçŠ¶æ€å…è®¸ä½ æ ¹æ®æ§ä»¶çš„ä¸åŒçŠ¶æ€ï¼ˆå¦‚é¼ æ ‡æ‚¬åœã€è¢«æŒ‰ä¸‹ï¼‰åº”ç”¨ä¸åŒçš„æ ·å¼ã€‚\n/* é¼ æ ‡æ‚¬åœæ—¶ */QPushButton:hover &#123;    background-color: #70ad47;&#125;/* è¢«æŒ‰ä¸‹æ—¶ */QPushButton:pressed &#123;    background-color: #3c883c;&#125;/* ç¦ç”¨æ—¶ */QPushButton:disabled &#123;    background-color: #d3d3d3;    color: #808080;&#125;/* è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹æ—¶ */QLineEdit:focus &#123;    border: 1px solid #55aaff;&#125;/* å¤é€‰æ¡†è¢«é€‰ä¸­æ—¶ */QCheckBox:checked &#123;    color: #55aaff;&#125;/* å¤šä¸ªä¼ªçŠ¶æ€ç»„åˆ */QCheckBox:checked:hover &#123;    color: #77aaff;&#125;/* å¦å®šä¼ªçŠ¶æ€ */QPushButton:!hover &#123;    /* ... */&#125;\n\nå­æ§ä»¶ (Sub-Controls)å¤æ‚çš„æ§ä»¶ç”±å¤šä¸ªå­éƒ¨åˆ†ç»„æˆï¼ŒQSS å…è®¸å¯¹è¿™äº›å­æ§ä»¶è¿›è¡Œå•ç‹¬çš„æ ·å¼è®¾ç½®ã€‚\n/* --- QComboBox (ä¸‹æ‹‰æ¡†) --- */QComboBox &#123;    border: 1px solid #ccc;    padding-left: 10px;&#125;/* è®¾ç½®ä¸‹æ‹‰ç®­å¤´éƒ¨åˆ† */QComboBox::drop-down &#123;    subcontrol-origin: padding;    subcontrol-position: top right;    width: 20px;    border-left: 1px solid #ccc;&#125;/* è®¾ç½®ä¸‹æ‹‰ç®­å¤´å›¾æ ‡ */QComboBox::down-arrow &#123;    image: url(:/icons/down_arrow.png);&#125;/* --- QSlider (æ»‘å—) --- *//* è®¾ç½®æ»‘å—çš„å‡¹æ§½ */QSlider::groove:horizontal &#123;    height: 8px;    background: #f0f0f0;    border-radius: 4px;&#125;/* è®¾ç½®æ»‘å—çš„æ»‘å—æ‰‹æŸ„ */QSlider::handle:horizontal &#123;    background: #55aaff;    width: 16px;    margin: -4px 0; /* å‚ç›´å±…ä¸­ */    border-radius: 8px;&#125;/* --- QScrollBar (æ»šåŠ¨æ¡) --- */QScrollBar:vertical &#123;    border: none;    background: #e0e0e0;    width: 12px;    margin: 0;&#125;QScrollBar::handle:vertical &#123;    background: #a0a0a0;    min-height: 20px;    border-radius: 6px;&#125;QScrollBar::add-line:vertical, QScrollBar::sub-line:vertical &#123;    height: 0px;&#125;\n\nå¸¸ç”¨å±æ€§å‚è€ƒ\n\n\nç±»åˆ«\nå±æ€§\nç¤ºä¾‹å€¼\n\n\n\nèƒŒæ™¯\nbackground-color\n#ffffff, rgb(255, 255, 255), transparent\n\n\n\nbackground-image\nurl(:/images/bg.png)\n\n\n\nbackground-repeat\nrepeat-x, no-repeat\n\n\n\nbackground-position\ncenter\n\n\né¢œè‰²\ncolor\n#333333\n\n\nå­—ä½“\nfont-family\n&quot;Segoe UI&quot;\n\n\n\nfont-size\n12pt, 16px\n\n\n\nfont-weight\nbold, normal\n\n\n\nfont-style\nitalic\n\n\nè¾¹æ¡†\nborder\n1px solid #cccccc\n\n\n\nborder-radius\n5px\n\n\n\nborder-color\n#ff0000\n\n\nå°ºå¯¸\nwidth, height\n100px\n\n\n\nmin-width, max-height\n50px\n\n\né—´è·\npadding, margin\n10px, 5px 10px\n\n\né«˜çº§æŠ€å·§ä¸æœ€ä½³å®è·µ\nä½¿ç”¨åŠ¨æ€å±æ€§: åœ¨ QSS ä¸­ä½¿ç”¨ qproperty-&lt;propertyname&gt; å¯ä»¥è®¾ç½®æ§ä»¶çš„ Qt å±æ€§ã€‚\nMyCustomButton &#123;    qproperty-iconSize: 24px; /* è®¾ç½® iconSize å±æ€§ */    qproperty-text: &quot;Hello&quot;; /* è®¾ç½® text å±æ€§ */&#125;\n\nä¸»é¢˜åŒ–: å°†é¢œè‰²ã€å­—ä½“ç­‰å®šä¹‰ä¸ºå¸¸é‡ï¼Œé€šè¿‡åŠ è½½ä¸åŒçš„ QSS æ–‡ä»¶æ¥å®ç°ä¸»é¢˜åˆ‡æ¢ã€‚è¿™æ˜¯æœ€ç®€å•æœ‰æ•ˆçš„â€œæ¢è‚¤â€æ–¹æ³•ã€‚\n\næ€§èƒ½: \n\n**é¿å…ä½¿ç”¨é€šç”¨é€‰æ‹©å™¨ ***ï¼Œå®ƒçš„æ€§èƒ½å¼€é”€æœ€å¤§ã€‚\né€‰æ‹©å™¨è¶Šå…·ä½“ï¼Œæ€§èƒ½è¶Šå¥½ã€‚QPushButton#myButton æ¯” QPushButton å¿«ã€‚\nå°½é‡å°†æ ·å¼è¡¨åº”ç”¨åœ¨çˆ¶æ§ä»¶ä¸Šï¼Œè€Œä¸æ˜¯ä¸ºæˆç™¾ä¸Šåƒä¸ªå­æ§ä»¶å•ç‹¬è®¾ç½®æ ·å¼ï¼Œåˆ©ç”¨ QSS çš„ç»§æ‰¿ç‰¹æ€§ã€‚\n\n\nåŠ¨ç”»: QSS æœ¬èº«ä¸ç›´æ¥æ”¯æŒ transition æˆ– animation å±æ€§ã€‚Qt ä¸­çš„åŠ¨ç”»æ˜¯é€šè¿‡ C++ çš„ QPropertyAnimation ç±»å®ç°çš„ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥å¹³æ»‘åœ°æ”¹å˜ä¸€ä¸ªæ§ä»¶çš„å‡ ä½•å±æ€§ï¼ˆå¦‚ geometryï¼‰æˆ–æ ·å¼ç›¸å…³çš„å±æ€§ã€‚\n\nå¸ƒå±€: QSS ä¸è´Ÿè´£æ§ä»¶çš„å¸ƒå±€ï¼ˆä½ç½®å’Œæ’åˆ—ï¼‰ã€‚å¸ƒå±€åº”ç”± C++ ä¸­çš„ QLayout ç±»ï¼ˆQHBoxLayout, QVBoxLayout ç­‰ï¼‰æˆ–åœ¨ .ui æ–‡ä»¶ä¸­å®Œæˆã€‚\n\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","QSS","æ ·å¼è¡¨","UIè®¾è®¡","ç•Œé¢ç¾åŒ–"]},{"title":"Qt QPainter ç»˜å›¾æŒ‡å—","url":"/posts/38ea5a46/","content":"Qt QPainter ç»˜å›¾æŒ‡å—ç›®å½•\næ¦‚è¿°\nQPainter æ ¸å¿ƒæ¦‚å¿µ\nç¤ºä¾‹1ï¼šç»˜åˆ¶åŸºç¡€å›¾å½¢\nç¤ºä¾‹2ï¼šç»˜åˆ¶é«˜çº§è·¯å¾„ä¸å½¢çŠ¶\nç¤ºä¾‹3ï¼šæ¸²æŸ“æ–‡æœ¬\nç¤ºä¾‹4ï¼šç»˜åˆ¶ä¸å˜æ¢å›¾åƒ\nç¤ºä¾‹5ï¼šåº”ç”¨æ¸å˜å’Œç‰¹æ•ˆ\nç¤ºä¾‹6ï¼šè‡ªå®šä¹‰æ§ä»¶ (åœ†å½¢è¿›åº¦æ¡)\næ€§èƒ½ä¼˜åŒ–\nå¸¸è§é—®é¢˜\n\næ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨ Qt çš„ QPainter ç±»å®ç°å„ç§ 2D ç»˜å›¾åŠŸèƒ½ã€‚ä¸åŸæ–‡å°†æ‰€æœ‰åŠŸèƒ½å¡å…¥ä¸€ä¸ªç±»ä¸åŒï¼Œæœ¬æŒ‡å—å°†åŠŸèƒ½æ‹†åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„ç¤ºä¾‹æ§ä»¶ï¼Œä»¥å±•ç¤ºæ›´æ¸…æ™°çš„ç¼–ç¨‹å®è·µã€‚\nQPainter æ ¸å¿ƒæ¦‚å¿µ\nPaint Engine: QPainter æ˜¯ä¸€ä¸ªé«˜çº§ APIï¼Œå®ƒå¯ä»¥åœ¨ä¸åŒçš„â€œç»˜å›¾å¼•æ“â€ä¸Šè¿›è¡Œç»˜åˆ¶ï¼Œä¾‹å¦‚åœ¨ QWidgetã€QPixmap æˆ– QImage ä¸Šã€‚\nPaint Event: åœ¨è‡ªå®šä¹‰ QWidget ä¸­ï¼Œæ‰€æœ‰çš„ç»˜åˆ¶ä»£ç éƒ½åº”åœ¨ paintEvent() è¿™ä¸ªè™šå‡½æ•°ä¸­å®Œæˆã€‚\nState Machine: QPainter æ˜¯ä¸€ä¸ªçŠ¶æ€æœºã€‚ä½ è®¾ç½®çš„ QPenï¼ˆç”»ç¬”ï¼‰ã€QBrushï¼ˆç”»åˆ·ï¼‰ã€QFontï¼ˆå­—ä½“ï¼‰ç­‰ä¼šä¸€ç›´ä¿æŒï¼Œç›´åˆ°ä½ å†æ¬¡ä¿®æ”¹å®ƒä»¬ã€‚å¯ä»¥ä½¿ç”¨ painter.save() å’Œ painter.restore() æ¥ä¿å­˜å’Œæ¢å¤çŠ¶æ€ã€‚\nRender Hints: é€šè¿‡ painter.setRenderHint() å¯ä»¥å¼€å¯æŠ—é”¯é½¿ç­‰åŠŸèƒ½ï¼Œæå‡ç»˜å›¾è´¨é‡ã€‚\n\nç¤ºä¾‹1ï¼šç»˜åˆ¶åŸºç¡€å›¾å½¢è¿™ä¸ªæ§ä»¶æ¼”ç¤ºå¦‚ä½•ç»˜åˆ¶ç›´çº¿ã€çŸ©å½¢ã€åœ†å½¢ç­‰åŸºæœ¬å½¢çŠ¶ã€‚\nbasic_shapes_widget.h:\n#ifndef BASICSHAPESWIDGET_H#define BASICSHAPESWIDGET_H#include &lt;QWidget&gt;class BasicShapesWidget : public QWidget &#123;    Q_OBJECTpublic:    explicit BasicShapesWidget(QWidget *parent = nullptr);protected:    void paintEvent(QPaintEvent *event) override;&#125;;#endif // BASICSHAPESWIDGET_H\n\nbasic_shapes_widget.cpp:\n#include &quot;basic_shapes_widget.h&quot;#include &lt;QPainter&gt;#include &lt;QPaintEvent&gt;BasicShapesWidget::BasicShapesWidget(QWidget *parent) : QWidget(parent) &#123;    setMinimumSize(400, 250);    setWindowTitle(&quot;Basic Shapes&quot;);&#125;void BasicShapesWidget::paintEvent(QPaintEvent *event) &#123;    Q_UNUSED(event);    QPainter painter(this);    painter.setRenderHint(QPainter::Antialiasing, true);    // 1. è®¾ç½®ç”»ç¬” (ç”¨äºè½®å»“)    QPen pen(Qt::blue, 2, Qt::SolidLine, Qt::RoundCap, Qt::RoundJoin);    painter.setPen(pen);    // 2. è®¾ç½®ç”»åˆ· (ç”¨äºå¡«å……)    QBrush brush(QColor(150, 200, 255, 128)); // åŠé€æ˜è“è‰²    painter.setBrush(brush);    // 3. ç»˜åˆ¶å›¾å½¢    painter.drawRect(10, 10, 100, 80); // çŸ©å½¢    painter.drawEllipse(130, 10, 100, 80); // æ¤­åœ†    painter.drawRoundedRect(10, 110, 100, 80, 15, 15); // åœ†è§’çŸ©å½¢    painter.drawEllipse(QPoint(180, 150), 50, 50); // åœ†å½¢    // 4. åªç”¨ç”»ç¬”ï¼Œä¸ç”¨ç”»åˆ·    painter.setBrush(Qt::NoBrush);    painter.setPen(Qt::red);    painter.drawLine(250, 10, 350, 110);&#125;\n\nç¤ºä¾‹2ï¼šç»˜åˆ¶é«˜çº§è·¯å¾„ä¸å½¢çŠ¶QPainterPath å…è®¸ä½ ç»„åˆå¤šä¸ªå›¾å…ƒï¼Œåˆ›å»ºå¤æ‚çš„å½¢çŠ¶ï¼Œä¾‹å¦‚è´å¡å°”æ›²çº¿ã€å¤šè¾¹å½¢ç­‰ã€‚\nadvanced_shapes_widget.h:\n#ifndef ADVANCEDSHAPESWIDGET_H#define ADVANCEDSHAPESWIDGET_H#include &lt;QWidget&gt;class AdvancedShapesWidget : public QWidget &#123;    Q_OBJECTpublic:    explicit AdvancedShapesWidget(QWidget *parent = nullptr);protected:    void paintEvent(QPaintEvent *event) override;&#125;;#endif // ADVANCEDSHAPESWIDGET_H\n\nadvanced_shapes_widget.cpp:\n#include &quot;advanced_shapes_widget.h&quot;#include &lt;QPainter&gt;#include &lt;QPainterPath&gt;#include &lt;cmath&gt; // For M_PIAdvancedShapesWidget::AdvancedShapesWidget(QWidget *parent) : QWidget(parent) &#123;    setMinimumSize(400, 300);    setWindowTitle(&quot;Advanced Shapes&quot;);&#125;void AdvancedShapesWidget::paintEvent(QPaintEvent *event) &#123;    QPainter painter(this);    painter.setRenderHint(QPainter::Antialiasing, true);    painter.setPen(QPen(Qt::darkGreen, 2));    // 1. ç»˜åˆ¶å¤šè¾¹å½¢    QPolygonF polygon;    polygon &lt;&lt; QPointF(10, 10) &lt;&lt; QPointF(10, 90) &lt;&lt; QPointF(110, 70) &lt;&lt; QPointF(90, 20);    painter.drawPolygon(polygon);    // 2. ç»˜åˆ¶è´å¡å°”æ›²çº¿    QPainterPath bezierPath;    bezierPath.moveTo(150, 50);    bezierPath.cubicTo(200, 10, 250, 100, 300, 60);    painter.drawPath(bezierPath);    // 3. ç»˜åˆ¶ä¸€ä¸ªå¤æ‚çš„è·¯å¾„ï¼ˆä¾‹å¦‚å¿ƒå½¢ï¼‰    QPainterPath heartPath;    heartPath.moveTo(200, 150);    heartPath.cubicTo(250, 120, 280, 180, 200, 250);    heartPath.cubicTo(120, 180, 150, 120, 200, 150);    painter.setBrush(Qt::red);    painter.drawPath(heartPath);&#125;\n\nç¤ºä¾‹3ï¼šæ¸²æŸ“æ–‡æœ¬QPainter æä¾›äº†å¼ºå¤§çš„æ–‡æœ¬æ¸²æŸ“åŠŸèƒ½ã€‚\ntext_rendering_widget.h &#x2F; .cpp (ç»“æ„åŒä¸Š):\n// In paintEvent of TextRenderingWidgetvoid TextRenderingWidget::paintEvent(QPaintEvent *event) &#123;    QPainter painter(this);    painter.setRenderHint(QPainter::TextAntialiasing, true);    // 1. åŸºç¡€æ–‡æœ¬    painter.setFont(QFont(&quot;Arial&quot;, 12));    painter.setPen(Qt::black);    painter.drawText(10, 20, &quot;Hello, QPainter!&quot;);    // 2. å¸¦æ ·å¼çš„æ–‡æœ¬    painter.setFont(QFont(&quot;Times New Roman&quot;, 20, QFont::Bold, true));    painter.setPen(Qt::darkBlue);    painter.drawText(10, 60, &quot;Styled Text&quot;);    // 3. æ—‹è½¬æ–‡æœ¬    painter.save(); // ä¿å­˜å½“å‰çŠ¶æ€    painter.translate(100, 150);    painter.rotate(-45);    painter.drawText(0, 0, &quot;Rotated Text&quot;);    painter.restore(); // æ¢å¤ä¹‹å‰çŠ¶æ€    // 4. åœ¨çŸ©å½¢å†…æ¢è¡Œ    QRectF textRect(200, 10, 180, 100);    painter.drawRect(textRect); // ç”»å‡ºè¾¹ç•Œæ–¹ä¾¿è§‚å¯Ÿ    QString longText = &quot;This is a long text that will wrap inside the specified rectangle.&quot;;    painter.drawText(textRect, Qt::TextWordWrap, longText);&#125;\n\nç¤ºä¾‹4ï¼šç»˜åˆ¶ä¸å˜æ¢å›¾åƒQPainter å¯ä»¥ç»˜åˆ¶ QPixmap å’Œ QImageï¼Œå¹¶å¯¹å…¶è¿›è¡Œå®æ—¶å˜æ¢ã€‚\nimage_drawing_widget.h &#x2F; .cpp (ç»“æ„åŒä¸Š):\n// In paintEvent of ImageDrawingWidgetvoid ImageDrawingWidget::paintEvent(QPaintEvent *event) &#123;    QPainter painter(this);    painter.setRenderHint(QPainter::SmoothPixmapTransform, true);    // å‡†å¤‡ä¸€å¼ æµ‹è¯•å›¾ç‰‡ (ä¹Ÿå¯ä»¥ä»æ–‡ä»¶åŠ è½½: QPixmap(&quot;:/images/logo.png&quot;))    QPixmap pixmap(100, 100);    pixmap.fill(Qt::cyan);    QPainter p(&amp;pixmap);    p.drawText(pixmap.rect(), Qt::AlignCenter, &quot;Qt&quot;);    p.end();    // 1. æ­£å¸¸ç»˜åˆ¶    painter.drawPixmap(10, 10, pixmap);    // 2. ç¼©æ”¾ç»˜åˆ¶    painter.drawPixmap(120, 10, 150, 150, pixmap);    // 3. æ—‹è½¬ç»˜åˆ¶    painter.save();    painter.translate(100, 200); // ç§»åŠ¨åæ ‡ç³»    painter.rotate(45); // æ—‹è½¬    painter.drawPixmap(-50, -50, 100, 100, pixmap); // åœ¨æ–°åæ ‡ç³»åŸç‚¹ç»˜åˆ¶    painter.restore();    // 4. é€æ˜åº¦ç»˜åˆ¶    painter.setOpacity(0.5);    painter.drawPixmap(200, 180, pixmap);    painter.setOpacity(1.0); // æ¢å¤ä¸é€æ˜&#125;\n\nç¤ºä¾‹5ï¼šåº”ç”¨æ¸å˜å’Œç‰¹æ•ˆä½¿ç”¨ QGradient ç³»åˆ—ç±»å¯ä»¥åˆ›å»ºæ¼‚äº®çš„æ¸å˜æ•ˆæœã€‚\ngradients_widget.h &#x2F; .cpp (ç»“æ„åŒä¸Š):\n// In paintEvent of GradientsWidgetvoid GradientsWidget::paintEvent(QPaintEvent *event) &#123;    QPainter painter(this);    painter.setRenderHint(QPainter::Antialiasing, true);    painter.setPen(Qt::NoPen);    // 1. çº¿æ€§æ¸å˜    QLinearGradient linearGrad(0, 0, 100, 100);    linearGrad.setColorAt(0, Qt::red);    linearGrad.setColorAt(1, Qt::yellow);    painter.setBrush(linearGrad);    painter.drawRect(10, 10, 100, 100);    // 2. å¾„å‘æ¸å˜    QRadialGradient radialGrad(180, 60, 50);    radialGrad.setColorAt(0, Qt::white);    radialGrad.setColorAt(1, Qt::blue);    painter.setBrush(radialGrad);    painter.drawEllipse(130, 10, 100, 100);    // 3. é”¥å½¢æ¸å˜    QConicalGradient conicalGrad(60, 170, 0);    conicalGrad.setColorAt(0, Qt::cyan);    conicalGrad.setColorAt(0.5, Qt::magenta);    conicalGrad.setColorAt(1, Qt::cyan);    painter.setBrush(conicalGrad);    painter.drawEllipse(10, 120, 100, 100);&#125;\n\nç¤ºä¾‹6ï¼šè‡ªå®šä¹‰æ§ä»¶ (åœ†å½¢è¿›åº¦æ¡)è¿™æ˜¯å°† QPainter ç”¨äºå®è·µçš„æœ€å¥½ä¾‹å­ï¼šåˆ›å»ºä¸€ä¸ªæ ‡å‡†åº“ä¸­æ²¡æœ‰çš„ã€å®Œå…¨è‡ªå®šä¹‰çš„æ§ä»¶ã€‚\ncircular_progress_bar.h:\n#ifndef CIRCULARPROGRESSBAR_H#define CIRCULARPROGRESSBAR_H#include &lt;QWidget&gt;#include &lt;QColor&gt;class CircularProgressBar : public QWidget &#123;    Q_OBJECT    Q_PROPERTY(int value READ value WRITE setValue)public:    explicit CircularProgressBar(QWidget *parent = nullptr);    int value() const &#123; return m_value; &#125;public slots:    void setValue(int value);protected:    void paintEvent(QPaintEvent *event) override;private:    int m_value = 0;    QColor m_backgroundColor = QColor(220, 220, 220);    QColor m_progressColor = QColor(30, 144, 255);&#125;;#endif // CIRCULARPROGRESSBAR_H\n\ncircular_progress_bar.cpp:\n#include &quot;circular_progress_bar.h&quot;#include &lt;QPainter&gt;CircularProgressBar::CircularProgressBar(QWidget *parent) : QWidget(parent) &#123;    setMinimumSize(100, 100);&#125;void CircularProgressBar::setValue(int value) &#123;    if (m_value != value) &#123;        m_value = qBound(0, value, 100);        update(); // è¯·æ±‚é‡ç»˜    &#125;&#125;void CircularProgressBar::paintEvent(QPaintEvent *event) &#123;    QPainter painter(this);    painter.setRenderHint(QPainter::Antialiasing, true);    QRectF rect = this-&gt;rect().adjusted(5, 5, -5, -5);    int startAngle = 90 * 16; // 12ç‚¹é’Ÿæ–¹å‘    int spanAngle = -static_cast&lt;int&gt;((m_value / 100.0) * 360.0 * 16.0);    // ç»˜åˆ¶èƒŒæ™¯ç¯    painter.setPen(QPen(m_backgroundColor, 8, Qt::SolidLine, Qt::FlatCap));    painter.drawArc(rect, 0, 360 * 16);    // ç»˜åˆ¶è¿›åº¦ç¯    painter.setPen(QPen(m_progressColor, 8, Qt::SolidLine, Qt::RoundCap));    painter.drawArc(rect, startAngle, spanAngle);    // ç»˜åˆ¶ä¸­å¿ƒæ–‡æœ¬    painter.setPen(m_progressColor);    painter.setFont(QFont(&quot;Arial&quot;, 16, QFont::Bold));    painter.drawText(rect, Qt::AlignCenter, QString::number(m_value) + &quot;%&quot;);&#125;\n\næ€§èƒ½ä¼˜åŒ–\nåŒç¼“å†²: QWidget é»˜è®¤å¼€å¯åŒç¼“å†²ï¼Œä¸€èˆ¬æ— éœ€æ‰‹åŠ¨å¤„ç†ã€‚å¯¹äºé QWidget çš„ç»˜å›¾è¡¨é¢ï¼ˆå¦‚ QPixmapï¼‰ï¼ŒåŒç¼“å†²æ˜¯éšå¼çš„ã€‚\nå‡å°‘é‡ç»˜åŒºåŸŸ: åœ¨ paintEvent ä¸­ï¼Œåªé‡ç»˜ event-&gt;rect() æˆ– event-&gt;region() æä¾›çš„â€œè„åŒºåŸŸâ€ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ§ä»¶ã€‚\nç¼“å­˜: å¯¹äºå¤æ‚ä¸”ä¸å¸¸å˜åŒ–çš„èƒŒæ™¯æˆ–å…ƒç´ ï¼Œå¯ä»¥å°†å…¶é¢„å…ˆç»˜åˆ¶åˆ°ä¸€ä¸ª QPixmap ç¼“å­˜ä¸Šï¼Œåœ¨ paintEvent ä¸­ç›´æ¥ç»˜åˆ¶è¯¥ QPixmap å³å¯ã€‚\né¿å…åœ¨ paintEvent ä¸­è¿›è¡Œè€—æ—¶æ“ä½œ: ä¸è¦åœ¨ paintEvent ä¸­åˆ›å»ºå¤æ‚çš„å¯¹è±¡æˆ–æ‰§è¡Œè®¡ç®—ã€‚æ‰€æœ‰æ•°æ®éƒ½åº”æå‰å‡†å¤‡å¥½ã€‚\n\nå¸¸è§é—®é¢˜Q1: ç»˜å›¾æœ‰é”¯é½¿ï¼Œä¸å¹³æ»‘?A: å¼€å¯æŠ—é”¯é½¿ã€‚painter.setRenderHint(QPainter::Antialiasing, true);\nQ2: æ§ä»¶ç¼©æ”¾æ—¶ï¼Œå†…å®¹ä¼šé—ªçƒ?A: QWidget é»˜è®¤çš„åŒç¼“å†²èƒ½å¤„ç†å¤§éƒ¨åˆ†æƒ…å†µã€‚å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œç¡®ä¿æ²¡æœ‰åœ¨ resizeEvent ä¸­è°ƒç”¨ update()ï¼Œè€Œåº”è®©ç³»ç»Ÿè‡ªåŠ¨è§¦å‘ paintEventã€‚\nQ3: å¦‚ä½•åœ¨é«˜DPIå±å¹•ä¸Šä¿è¯æ¸…æ™°åº¦?A: åœ¨ main.cpp ä¸­å¯ç”¨é«˜DPIæ”¯æŒï¼š\nQApplication::setAttribute(Qt::AA_EnableHighDpiScaling);QApplication::setAttribute(Qt::AA_UseHighDpiPixmaps);\nQt ä¼šè‡ªåŠ¨å¤„ç†å¤§éƒ¨åˆ†DPIç¼©æ”¾ã€‚å¯¹äºæ‰‹åŠ¨åŠ è½½çš„ QPixmapï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ @2x åç¼€çš„èµ„æºæˆ–æ‰‹åŠ¨è®¾ç½®å…¶ devicePixelRatioã€‚\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","QPainter","ç»˜å›¾","è‡ªå®šä¹‰æ§ä»¶","2Då›¾å½¢"]},{"title":"æœåŠ¡å™¨è®¤è¯ API è§„èŒƒ","url":"/posts/ec4e5506/","content":"æœåŠ¡å™¨è®¤è¯ API è§„èŒƒ\næ–‡æ¡£åˆ›å»ºæ—¶é—´: 2025-11-14æœ€åæ›´æ–°: 2025-11-14æ ‡ç­¾: authentication, api, security, jwt, express, nodejs, middleware\n\nğŸ“‘ ç›®å½•\n1. æ¦‚è¿°\n2. è®¤è¯ä¸­é—´ä»¶\n3. è®¤è¯æµç¨‹\n3.1 æ³¨å†Œæµç¨‹\n3.2 ç™»å½•æµç¨‹\n3.3 Token éªŒè¯æµç¨‹\n\n\n4. å®‰å…¨æªæ–½\n4.1 è¾“å…¥éªŒè¯\n4.2 è¯·æ±‚é¢‘ç‡é™åˆ¶\n4.3 CORS é…ç½®\n\n\n5. ç”¨æˆ·æ¨¡å‹\n6. å—ä¿æŠ¤çš„è·¯ç”±\n7. å®¢æˆ·ç«¯ä½¿ç”¨\n8. é«˜çº§ç‰¹æ€§\n9. æµ‹è¯•ä¸è°ƒè¯•\n\n\n1. ğŸ“– æ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•å®ç°æœåŠ¡å™¨ç«¯çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ŒåŒ…æ‹¬æ³¨å†Œã€ç™»å½•ã€Token éªŒè¯ä»¥åŠç›¸å…³å®‰å…¨æªæ–½ã€‚\nğŸ¯ è®¤è¯ç³»ç»Ÿç‰¹æ€§\nâœ… JWT Token è®¤è¯\nâœ… å¯†ç åŠ å¯†å­˜å‚¨\nâœ… è¯·æ±‚é¢‘ç‡é™åˆ¶\nâœ… è¾“å…¥éªŒè¯å’Œæ¸…ç†\nâœ… CORS è·¨åŸŸä¿æŠ¤\nâœ… é”™è¯¯å¤„ç†å’Œå®‰å…¨æ—¥å¿—\n\nğŸ—ï¸ ç³»ç»Ÿæ¶æ„graph TD    A[Client Request] --&gt; B[Rate Limiting]    B --&gt; C[Input Validation]    C --&gt; D[Auth Middleware]    D --&gt; E&#123;Public Route?&#125;    E --&gt;|Yes| F[Business Logic]    E --&gt;|No| G[JWT Verification]    G --&gt; H[User Extraction]    H --&gt; F    F --&gt; I[Response]\n\n\n2. ğŸ” è®¤è¯ä¸­é—´ä»¶2.1 ğŸ“„ ä¸­é—´ä»¶å®ç° (src/middleware/auth.js)const jwt = require(&#x27;jsonwebtoken&#x27;);const rateLimit = require(&#x27;express-rate-limit&#x27;);const helmet = require(&#x27;helmet&#x27;);/** * JWT Token è®¤è¯ä¸­é—´ä»¶ * @param &#123;Object&#125; req - Express è¯·æ±‚å¯¹è±¡ * @param &#123;Object&#125; res - Express å“åº”å¯¹è±¡ * @param &#123;Function&#125; next - Express ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•° */const authenticateToken = (req, res, next) =&gt; &#123;    try &#123;        // ä»è¯·æ±‚å¤´è·å– Bearer Token        const authHeader = req.headers[&#x27;authorization&#x27;];        const token = authHeader &amp;&amp; authHeader.split(&#x27; &#x27;)[1];        // éªŒè¯ Token æ ¼å¼        if (!token) &#123;            return res.status(401).json(&#123;                success: false,                message: &#x27;Access token is required&#x27;,                code: &#x27;TOKEN_MISSING&#x27;            &#125;);        &#125;        if (!authHeader.startsWith(&#x27;Bearer &#x27;)) &#123;            return res.status(401).json(&#123;                success: false,                message: &#x27;Invalid token format. Expected: Bearer &lt;token&gt;&#x27;,                code: &#x27;TOKEN_FORMAT_INVALID&#x27;            &#125;);        &#125;        // éªŒè¯ JWT Token        jwt.verify(token, process.env.JWT_SECRET, &#123;            algorithms: [&#x27;HS256&#x27;],            clockTolerance: 30 // å…è®¸30ç§’æ—¶é’Ÿåå·®        &#125;, (err, decoded) =&gt; &#123;            if (err) &#123;                console.warn(`JWT Verification failed: $&#123;err.message&#125;`);                return res.status(403).json(&#123;                    success: false,                    message: &#x27;Invalid or expired token&#x27;,                    code: &#x27;TOKEN_INVALID&#x27;,                    details: err.name // å¯é€‰ï¼šç”Ÿäº§ç¯å¢ƒå¯èƒ½è¦éšè—                &#125;);            &#125;            // å°†ç”¨æˆ·ä¿¡æ¯é™„åŠ åˆ°è¯·æ±‚å¯¹è±¡            req.user = &#123;                id: decoded.userId,                iat: decoded.iat,                exp: decoded.exp            &#125;;            next();        &#125;);    &#125; catch (error) &#123;        console.error(&#x27;Authentication middleware error:&#x27;, error);        return res.status(500).json(&#123;            success: false,            message: &#x27;Internal server error during authentication&#x27;,            code: &#x27;AUTH_ERROR&#x27;        &#125;);    &#125;&#125;;/** * å¯é€‰çš„è®¤è¯ä¸­é—´ä»¶ - Token å¯é€‰çš„è·¯ç”± */const optionalAuth = (req, res, next) =&gt; &#123;    const authHeader = req.headers[&#x27;authorization&#x27;];    const token = authHeader &amp;&amp; authHeader.split(&#x27; &#x27;)[1];    if (token) &#123;        authenticateToken(req, res, next);    &#125; else &#123;        next(); // æ²¡æœ‰ Token æ—¶ç»§ç»­æ‰§è¡Œ    &#125;&#125;;module.exports = &#123;    authenticateToken,    optionalAuth&#125;;\n\n2.2 ğŸš¦ è¯·æ±‚é¢‘ç‡é™åˆ¶/** * è®¤è¯ç›¸å…³çš„é¢‘ç‡é™åˆ¶ */const authLimiter = rateLimit(&#123;    windowMs: 15 * 60 * 1000,  // 15åˆ†é’Ÿçª—å£æœŸ    max: 5,                    // æœ€å¤š5æ¬¡å°è¯•    message: &#123;        success: false,        message: &#x27;Too many authentication attempts, please try again later&#x27;,        code: &#x27;RATE_LIMIT_EXCEEDED&#x27;,        retryAfter: &#x27;15 minutes&#x27;    &#125;,    standardHeaders: true,      // è¿”å›é€Ÿç‡é™åˆ¶ä¿¡æ¯åœ¨ headers    legacyHeaders: false,      // ç¦ç”¨ `X-RateLimit-*` headers    handler: (req, res) =&gt; &#123;        res.status(429).json(&#123;            success: false,            message: &#x27;Too many authentication attempts, please try again later&#x27;,            code: &#x27;RATE_LIMIT_EXCEEDED&#x27;,            retryAfter: &#x27;15 minutes&#x27;        &#125;);    &#125;&#125;);/** * ä¸€èˆ¬ API çš„é¢‘ç‡é™åˆ¶ */const apiLimiter = rateLimit(&#123;    windowMs: 15 * 60 * 1000,  // 15åˆ†é’Ÿ    max: 100,                  // æœ€å¤š100æ¬¡è¯·æ±‚    message: &#123;        success: false,        message: &#x27;API rate limit exceeded&#x27;,        code: &#x27;API_RATE_LIMIT_EXCEEDED&#x27;    &#125;&#125;);module.exports = &#123;    authLimiter,    apiLimiter&#125;;\n\n\n3. ğŸ”‘ è®¤è¯æµç¨‹3.1 ğŸ“ æ³¨å†Œæµç¨‹ (/auth/register)const express = require(&#x27;express&#x27;);const &#123; body, validationResult &#125; = require(&#x27;express-validator&#x27;);const bcrypt = require(&#x27;bcrypt&#x27;);const router = express.Router();// æ³¨å†ŒéªŒè¯è§„åˆ™const registerValidation = [    body(&#x27;username&#x27;)        .trim()        .isLength(&#123; min: 3, max: 20 &#125;)        .withMessage(&#x27;Username must be 3-20 characters long&#x27;)        .matches(/^[a-zA-Z0-9_]+$/)        .withMessage(&#x27;Username can only contain letters, numbers and underscores&#x27;),    body(&#x27;email&#x27;)        .isEmail()        .normalizeEmail()        .withMessage(&#x27;Valid email address is required&#x27;),    body(&#x27;password&#x27;)        .isLength(&#123; min: 6 &#125;)        .withMessage(&#x27;Password must be at least 6 characters long&#x27;)        .matches(/^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).*$/)        .withMessage(&#x27;Password must contain at least one uppercase letter, one lowercase letter, and one number&#x27;)];/** * ç”¨æˆ·æ³¨å†Œè·¯ç”± * POST /auth/register */router.post(&#x27;/register&#x27;,    registerValidation,  // è¾“å…¥éªŒè¯    validate,            // éªŒè¯ç»“æœå¤„ç†    authLimiter,        // è¯·æ±‚é¢‘ç‡é™åˆ¶    async (req, res) =&gt; &#123;        const transaction = await pool.beginTransaction();        try &#123;            const &#123; username, password, email &#125; = req.body;            console.info(`Registration attempt: username=$&#123;username&#125;, email=$&#123;email&#125;`);            // 1. æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨            const [existingUser] = await pool.execute(                &#x27;SELECT id FROM users WHERE username = ? OR email = ?&#x27;,                [username, email]            );            if (existingUser.length &gt; 0) &#123;                await transaction.rollback();                return res.status(400).json(&#123;                    success: false,                    message: existingUser[0].username === username                        ? &#x27;Username is already taken&#x27;                        : &#x27;Email is already registered&#x27;,                    code: &#x27;USER_EXISTS&#x27;                &#125;);            &#125;            // 2. å¯†ç åŠ å¯†            const saltRounds = 12;            const hashedPassword = await bcrypt.hash(password, saltRounds);            // 3. åˆ›å»ºæ–°ç”¨æˆ·            const [result] = await pool.execute(                &#x27;INSERT INTO users (username, password, email, created_at, updated_at) VALUES (?, ?, ?, NOW(), NOW())&#x27;,                [username, hashedPassword, email]            );            const userId = result.insertId;            // 4. ç”Ÿæˆ JWT Token            const token = jwt.sign(                &#123;                    userId,                    username,                    type: &#x27;access&#x27;                &#125;,                process.env.JWT_SECRET,                &#123;                    expiresIn: &#x27;24h&#x27;,                    algorithm: &#x27;HS256&#x27;,                    issuer: &#x27;your-app-name&#x27;,                    audience: &#x27;your-app-users&#x27;                &#125;            );            // 5. ç”Ÿæˆ Refresh Token (å¯é€‰)            const refreshToken = jwt.sign(                &#123;                    userId,                    type: &#x27;refresh&#x27;                &#125;,                process.env.JWT_REFRESH_SECRET,                &#123;                    expiresIn: &#x27;7d&#x27;,                    algorithm: &#x27;HS256&#x27;                &#125;            );            // 6. ä¿å­˜ Refresh Token åˆ°æ•°æ®åº“ (å¯é€‰)            await pool.execute(                &#x27;UPDATE users SET refresh_token = ? WHERE id = ?&#x27;,                [refreshToken, userId]            );            await transaction.commit();            console.info(`User registered successfully: userId=$&#123;userId&#125;, username=$&#123;username&#125;`);            // 7. è¿”å›æˆåŠŸå“åº” (ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯)            res.status(201).json(&#123;                success: true,                message: &#x27;Registration successful&#x27;,                data: &#123;                    user: &#123;                        id: userId,                        username: username,                        email: email,                        created_at: new Date().toISOString()                    &#125;,                    tokens: &#123;                        access_token: token,                        refresh_token: refreshToken,                        token_type: &#x27;Bearer&#x27;,                        expires_in: 86400 // 24å°æ—¶                    &#125;                &#125;            &#125;);        &#125; catch (error) &#123;            await transaction.rollback();            console.error(&#x27;Registration error:&#x27;, error);            res.status(500).json(&#123;                success: false,                message: &#x27;Registration failed due to server error&#x27;,                code: &#x27;REGISTRATION_ERROR&#x27;            &#125;);        &#125;    &#125;);\n\n3.2 ğŸ” ç™»å½•æµç¨‹ (/auth/login)/** * ç”¨æˆ·ç™»å½•è·¯ç”± * POST /auth/login */router.post(&#x27;/login&#x27;,    authLimiter,      // è¯·æ±‚é¢‘ç‡é™åˆ¶    [        body(&#x27;username&#x27;)            .trim()            .notEmpty()            .withMessage(&#x27;Username or email is required&#x27;),        body(&#x27;password&#x27;)            .notEmpty()            .withMessage(&#x27;Password is required&#x27;)    ],    validate,         // éªŒè¯ç»“æœå¤„ç†    async (req, res) =&gt; &#123;        try &#123;            const &#123; username, password &#125; = req.body;            console.info(`Login attempt: username=$&#123;username&#125;`);            // 1. æŸ¥æ‰¾ç”¨æˆ· (æ”¯æŒç”¨æˆ·åæˆ–é‚®ç®±ç™»å½•)            const [users] = await pool.execute(                &#x27;SELECT id, username, email, password, refresh_token, failed_login_attempts, locked_until FROM users WHERE username = ? OR email = ?&#x27;,                [username, username]            );            if (users.length === 0) &#123;                return res.status(401).json(&#123;                    success: false,                    message: &#x27;Invalid username or password&#x27;,                    code: &#x27;INVALID_CREDENTIALS&#x27;                &#125;);            &#125;            const user = users[0];            // 2. æ£€æŸ¥è´¦æˆ·æ˜¯å¦è¢«é”å®š            if (user.locked_until &amp;&amp; new Date() &lt; new Date(user.locked_until)) &#123;                return res.status(423).json(&#123;                    success: false,                    message: &#x27;Account is temporarily locked due to too many failed login attempts&#x27;,                    code: &#x27;ACCOUNT_LOCKED&#x27;,                    locked_until: user.locked_until                &#125;);            &#125;            // 3. éªŒè¯å¯†ç             const isValidPassword = await bcrypt.compare(password, user.password);            if (!isValidPassword) &#123;                // å¢åŠ å¤±è´¥æ¬¡æ•°                const newFailedAttempts = user.failed_login_attempts + 1;                const lockAccount = newFailedAttempts &gt;= 5;                await pool.execute(                    `UPDATE users SET                     failed_login_attempts = ?,                     locked_until = ?                     WHERE id = ?`,                    [                        lockAccount ? 0 : newFailedAttempts,                        lockAccount ? new Date(Date.now() + 30 * 60 * 1000) : null, // 30åˆ†é’Ÿé”å®š                        user.id                    ]                );                console.warn(`Failed login attempt: username=$&#123;username&#125;, attempts=$&#123;newFailedAttempts&#125;`);                return res.status(401).json(&#123;                    success: false,                    message: &#x27;Invalid username or password&#x27;,                    code: &#x27;INVALID_CREDENTIALS&#x27;,                    remaining_attempts: Math.max(0, 5 - newFailedAttempts)                &#125;);            &#125;            // 4. ç™»å½•æˆåŠŸ - é‡ç½®å¤±è´¥æ¬¡æ•°            await pool.execute(                &#x27;UPDATE users SET failed_login_attempts = 0, locked_until = NULL, last_login = NOW() WHERE id = ?&#x27;,                [user.id]            );            // 5. ç”Ÿæˆ JWT Token            const token = jwt.sign(                &#123;                    userId: user.id,                    username: user.username,                    type: &#x27;access&#x27;                &#125;,                process.env.JWT_SECRET,                &#123;                    expiresIn: &#x27;24h&#x27;,                    algorithm: &#x27;HS256&#x27;,                    issuer: &#x27;your-app-name&#x27;,                    audience: &#x27;your-app-users&#x27;                &#125;            );            // 6. ç”Ÿæˆæ–°çš„ Refresh Token            const refreshToken = jwt.sign(                &#123;                    userId: user.id,                    type: &#x27;refresh&#x27;                &#125;,                process.env.JWT_REFRESH_SECRET,                &#123;                    expiresIn: &#x27;7d&#x27;,                    algorithm: &#x27;HS256&#x27;                &#125;            );            // 7. æ›´æ–° Refresh Token            await pool.execute(                &#x27;UPDATE users SET refresh_token = ? WHERE id = ?&#x27;,                [refreshToken, user.id]            );            console.info(`User logged in successfully: userId=$&#123;user.id&#125;, username=$&#123;user.username&#125;`);            res.json(&#123;                success: true,                message: &#x27;Login successful&#x27;,                data: &#123;                    user: &#123;                        id: user.id,                        username: user.username,                        email: user.email,                        last_login: new Date().toISOString()                    &#125;,                    tokens: &#123;                        access_token: token,                        refresh_token: refreshToken,                        token_type: &#x27;Bearer&#x27;,                        expires_in: 86400 // 24å°æ—¶                    &#125;                &#125;            &#125;);        &#125; catch (error) &#123;            console.error(&#x27;Login error:&#x27;, error);            res.status(500).json(&#123;                success: false,                message: &#x27;Login failed due to server error&#x27;,                code: &#x27;LOGIN_ERROR&#x27;            &#125;);        &#125;    &#125;);\n\n3.3 ğŸ”„ Token åˆ·æ–°æµç¨‹/** * åˆ·æ–°è®¿é—®ä»¤ç‰Œ * POST /auth/refresh */router.post(&#x27;/refresh&#x27;,    async (req, res) =&gt; &#123;        try &#123;            const &#123; refresh_token &#125; = req.body;            if (!refresh_token) &#123;                return res.status(401).json(&#123;                    success: false,                    message: &#x27;Refresh token is required&#x27;,                    code: &#x27;REFRESH_TOKEN_MISSING&#x27;                &#125;);            &#125;            // éªŒè¯ Refresh Token            jwt.verify(refresh_token, process.env.JWT_REFRESH_SECRET, async (err, decoded) =&gt; &#123;                if (err) &#123;                    return res.status(403).json(&#123;                        success: false,                        message: &#x27;Invalid refresh token&#x27;,                        code: &#x27;REFRESH_TOKEN_INVALID&#x27;                    &#125;);                &#125;                // æ£€æŸ¥æ•°æ®åº“ä¸­çš„ Refresh Token                const [users] = await pool.execute(                    &#x27;SELECT id, username, refresh_token FROM users WHERE id = ?&#x27;,                    [decoded.userId]                );                if (users.length === 0 || users[0].refresh_token !== refresh_token) &#123;                    return res.status(403).json(&#123;                        success: false,                        message: &#x27;Invalid refresh token&#x27;,                        code: &#x27;REFRESH_TOKEN_MISMATCH&#x27;                    &#125;);                &#125;                // ç”Ÿæˆæ–°çš„ Access Token                const newAccessToken = jwt.sign(                    &#123;                        userId: decoded.userId,                        username: users[0].username,                        type: &#x27;access&#x27;                    &#125;,                    process.env.JWT_SECRET,                    &#123;                        expiresIn: &#x27;24h&#x27;,                        algorithm: &#x27;HS256&#x27;                    &#125;                );                res.json(&#123;                    success: true,                    message: &#x27;Token refreshed successfully&#x27;,                    data: &#123;                        access_token: newAccessToken,                        token_type: &#x27;Bearer&#x27;,                        expires_in: 86400                    &#125;                &#125;);            &#125;);        &#125; catch (error) &#123;            console.error(&#x27;Token refresh error:&#x27;, error);            res.status(500).json(&#123;                success: false,                message: &#x27;Token refresh failed&#x27;,                code: &#x27;REFRESH_ERROR&#x27;            &#125;);        &#125;    &#125;);\n\n\n4. ğŸ›¡ï¸ å®‰å…¨æªæ–½4.1 âœ… è¾“å…¥éªŒè¯const &#123; body, validationResult &#125; = require(&#x27;express-validator&#x27;);// éªŒè¯ç»“æœå¤„ç†ä¸­é—´ä»¶const validate = (req, res, next) =&gt; &#123;    const errors = validationResult(req);    if (!errors.isEmpty()) &#123;        return res.status(400).json(&#123;            success: false,            message: &#x27;Validation failed&#x27;,            code: &#x27;VALIDATION_ERROR&#x27;,            errors: errors.array()        &#125;);    &#125;    next();&#125;;// é€šç”¨éªŒè¯è§„åˆ™const commonValidation = &#123;    username: [        body(&#x27;username&#x27;)            .trim()            .isLength(&#123; min: 3, max: 20 &#125;)            .matches(/^[a-zA-Z0-9_]+$/)    ],    email: [        body(&#x27;email&#x27;)            .isEmail()            .normalizeEmail()    ],    password: [        body(&#x27;password&#x27;)            .isLength(&#123; min: 8 &#125;)            .matches(/^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[@$!%*?&amp;]).*$/)            .withMessage(&#x27;Password must be at least 8 characters long and contain uppercase, lowercase, number, and special character&#x27;)    ]&#125;;\n\n4.2 ğŸš¦ CORS é…ç½®const cors = require(&#x27;cors&#x27;);const corsOptions = &#123;    origin: function (origin, callback) &#123;        const allowedOrigins = process.env.ALLOWED_ORIGINS?.split(&#x27;,&#x27;) || [&#x27;http://localhost:3000&#x27;];        // å…è®¸æ²¡æœ‰ origin çš„è¯·æ±‚ (å¦‚ç§»åŠ¨åº”ç”¨)        if (!origin) return callback(null, true);        if (allowedOrigins.includes(origin)) &#123;            callback(null, true);        &#125; else &#123;            callback(new Error(&#x27;Not allowed by CORS&#x27;));        &#125;    &#125;,    methods: [&#x27;GET&#x27;, &#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;, &#x27;OPTIONS&#x27;],    allowedHeaders: [&#x27;Content-Type&#x27;, &#x27;Authorization&#x27;, &#x27;X-Requested-With&#x27;],    credentials: true,    optionsSuccessStatus: 200,    maxAge: 86400 // 24å°æ—¶&#125;;app.use(cors(corsOptions));\n\n4.3 ğŸ”’ å®‰å…¨å¤´éƒ¨const helmet = require(&#x27;helmet&#x27;);app.use(helmet(&#123;    contentSecurityPolicy: &#123;        directives: &#123;            defaultSrc: [&quot;&#x27;self&#x27;&quot;],            styleSrc: [&quot;&#x27;self&#x27;&quot;, &quot;&#x27;unsafe-inline&#x27;&quot;],            scriptSrc: [&quot;&#x27;self&#x27;&quot;],            imgSrc: [&quot;&#x27;self&#x27;&quot;, &quot;data:&quot;, &quot;https:&quot;],        &#125;,    &#125;,    hsts: &#123;        maxAge: 31536000,        includeSubDomains: true,        preload: true    &#125;&#125;));\n\n\n5. ğŸ‘¤ ç”¨æˆ·æ¨¡å‹const bcrypt = require(&#x27;bcrypt&#x27;);const pool = require(&#x27;../database/connection&#x27;);class User &#123;    /**     * åˆ›å»ºç”¨æˆ·     * @param &#123;string&#125; username - ç”¨æˆ·å     * @param &#123;string&#125; password - æ˜æ–‡å¯†ç      * @param &#123;string&#125; email - é‚®ç®±     * @returns &#123;Promise&lt;number&gt;&#125; ç”¨æˆ·ID     */    static async createUser(username, password, email) &#123;        const hashedPassword = await bcrypt.hash(password, 12);        const [result] = await pool.execute(            &#x27;INSERT INTO users (username, password, email, created_at, updated_at) VALUES (?, ?, ?, NOW(), NOW())&#x27;,            [username, hashedPassword, email]        );        return result.insertId;    &#125;    /**     * æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·     * @param &#123;string&#125; username - ç”¨æˆ·å     * @returns &#123;Promise&lt;Object|null&gt;&#125; ç”¨æˆ·å¯¹è±¡     */    static async findUserByUsername(username) &#123;        const [users] = await pool.execute(            &#x27;SELECT id, username, email, password, created_at, updated_at FROM users WHERE username = ?&#x27;,            [username]        );        return users[0] || null;    &#125;    /**     * æ ¹æ®é‚®ç®±æŸ¥æ‰¾ç”¨æˆ·     * @param &#123;string&#125; email - é‚®ç®±     * @returns &#123;Promise&lt;Object|null&gt;&#125; ç”¨æˆ·å¯¹è±¡     */    static async findUserByEmail(email) &#123;        const [users] = await pool.execute(            &#x27;SELECT id, username, email, password, created_at, updated_at FROM users WHERE email = ?&#x27;,            [email]        );        return users[0] || null;    &#125;    /**     * éªŒè¯å¯†ç      * @param &#123;string&#125; password - æ˜æ–‡å¯†ç      * @param &#123;string&#125; hashedPassword - å“ˆå¸Œå¯†ç      * @returns &#123;Promise&lt;boolean&gt;&#125; éªŒè¯ç»“æœ     */    static async verifyPassword(password, hashedPassword) &#123;        return await bcrypt.compare(password, hashedPassword);    &#125;    /**     * æ›´æ–°ç”¨æˆ·æœ€åç™»å½•æ—¶é—´     * @param &#123;number&#125; userId - ç”¨æˆ·ID     * @returns &#123;Promise&lt;void&gt;&#125;     */    static async updateLastLogin(userId) &#123;        await pool.execute(            &#x27;UPDATE users SET last_login = NOW() WHERE id = ?&#x27;,            [userId]        );    &#125;    /**     * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨     * @param &#123;string&#125; username - ç”¨æˆ·å     * @param &#123;string&#125; email - é‚®ç®±     * @returns &#123;Promise&lt;boolean&gt;&#125; æ˜¯å¦å­˜åœ¨     */    static async userExists(username, email) &#123;        const [users] = await pool.execute(            &#x27;SELECT id FROM users WHERE username = ? OR email = ?&#x27;,            [username, email]        );        return users.length &gt; 0;    &#125;&#125;module.exports = User;\n\n\n6. ğŸ›¡ï¸ å—ä¿æŠ¤çš„è·¯ç”±const &#123; authenticateToken &#125; = require(&#x27;../middleware/auth&#x27;);const router = express.Router();/** * è·å–ç”¨æˆ·ä¿¡æ¯ * GET /api/user/profile */router.get(&#x27;/profile&#x27;, authenticateToken, async (req, res) =&gt; &#123;    try &#123;        const userId = req.user.id;        const [users] = await pool.execute(            &#x27;SELECT id, username, email, created_at, last_login FROM users WHERE id = ?&#x27;,            [userId]        );        if (users.length === 0) &#123;            return res.status(404).json(&#123;                success: false,                message: &#x27;User not found&#x27;,                code: &#x27;USER_NOT_FOUND&#x27;            &#125;);        &#125;        res.json(&#123;            success: true,            data: &#123;                user: users[0]            &#125;        &#125;);    &#125; catch (error) &#123;        console.error(&#x27;Profile fetch error:&#x27;, error);        res.status(500).json(&#123;            success: false,            message: &#x27;Failed to fetch profile&#x27;,            code: &#x27;PROFILE_ERROR&#x27;        &#125;);    &#125;&#125;);/** * æ–‡ä»¶ä¸Šä¼ è·¯ç”± * POST /api/files/upload */router.post(&#x27;/upload&#x27;,    authenticateToken,    upload.single(&#x27;file&#x27;),    async (req, res) =&gt; &#123;        try &#123;            if (!req.file) &#123;                return res.status(400).json(&#123;                    success: false,                    message: &#x27;No file uploaded&#x27;,                    code: &#x27;NO_FILE_UPLOADED&#x27;                &#125;);            &#125;            // æ–‡ä»¶å¤„ç†é€»è¾‘...            res.json(&#123;                success: true,                message: &#x27;File uploaded successfully&#x27;,                data: &#123;                    filename: req.file.filename,                    size: req.file.size,                    mimetype: req.file.mimetype                &#125;            &#125;);        &#125; catch (error) &#123;            console.error(&#x27;File upload error:&#x27;, error);            res.status(500).json(&#123;                success: false,                message: &#x27;File upload failed&#x27;,                code: &#x27;UPLOAD_ERROR&#x27;            &#125;);        &#125;    &#125;);\n\n\n7. ğŸ’» å®¢æˆ·ç«¯ä½¿ç”¨7.1 ğŸ” ç™»å½•ç¤ºä¾‹class AuthClient &#123;    constructor(baseURL) &#123;        this.baseURL = baseURL;        this.token = null;    &#125;    /**     * ç”¨æˆ·ç™»å½•     * @param &#123;string&#125; username - ç”¨æˆ·åæˆ–é‚®ç®±     * @param &#123;string&#125; password - å¯†ç      * @returns &#123;Promise&lt;Object&gt;&#125; ç™»å½•ç»“æœ     */    async login(username, password) &#123;        try &#123;            const response = await fetch(`$&#123;this.baseURL&#125;/auth/login`, &#123;                method: &#x27;POST&#x27;,                headers: &#123;                    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,                &#125;,                body: JSON.stringify(&#123; username, password &#125;)            &#125;);            const data = await response.json();            if (data.success) &#123;                this.token = data.data.tokens.access_token;                this.refreshToken = data.data.tokens.refresh_token;                // å­˜å‚¨åˆ° localStorage                localStorage.setItem(&#x27;access_token&#x27;, this.token);                localStorage.setItem(&#x27;refresh_token&#x27;, this.refreshToken);            &#125;            return data;        &#125; catch (error) &#123;            console.error(&#x27;Login error:&#x27;, error);            throw error;        &#125;    &#125;    /**     * å¸¦è®¤è¯çš„è¯·æ±‚     * @param &#123;string&#125; url - è¯·æ±‚URL     * @param &#123;Object&#125; options - è¯·æ±‚é€‰é¡¹     * @returns &#123;Promise&lt;Response&gt;&#125; å“åº”å¯¹è±¡     */    async authenticatedRequest(url, options = &#123;&#125;) &#123;        if (!this.token) &#123;            throw new Error(&#x27;No authentication token available&#x27;);        &#125;        const defaultOptions = &#123;            headers: &#123;                &#x27;Authorization&#x27;: `Bearer $&#123;this.token&#125;`,                &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,            &#125;,            ...options        &#125;;        let response = await fetch(url, defaultOptions);        // Token è¿‡æœŸæ—¶è‡ªåŠ¨åˆ·æ–°        if (response.status === 403) &#123;            await this.refreshAccessToken();            defaultOptions.headers.Authorization = `Bearer $&#123;this.token&#125;`;            response = await fetch(url, defaultOptions);        &#125;        return response;    &#125;    /**     * åˆ·æ–°è®¿é—®ä»¤ç‰Œ     */    async refreshAccessToken() &#123;        try &#123;            const response = await fetch(`$&#123;this.baseURL&#125;/auth/refresh`, &#123;                method: &#x27;POST&#x27;,                headers: &#123;                    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,                &#125;,                body: JSON.stringify(&#123;                    refresh_token: this.refreshToken                &#125;)            &#125;);            const data = await response.json();            if (data.success) &#123;                this.token = data.data.access_token;                localStorage.setItem(&#x27;access_token&#x27;, this.token);            &#125; else &#123;                throw new Error(&#x27;Token refresh failed&#x27;);            &#125;        &#125; catch (error) &#123;            console.error(&#x27;Token refresh error:&#x27;, error);            this.logout();            throw error;        &#125;    &#125;    /**     * ç”¨æˆ·ç™»å‡º     */    logout() &#123;        this.token = null;        this.refreshToken = null;        localStorage.removeItem(&#x27;access_token&#x27;);        localStorage.removeItem(&#x27;refresh_token&#x27;);    &#125;&#125;// ä½¿ç”¨ç¤ºä¾‹const authClient = new AuthClient(&#x27;http://localhost:3000/api&#x27;);// ç™»å½•const loginResult = await authClient.login(&#x27;username&#x27;, &#x27;password&#x27;);// å‘é€è®¤è¯è¯·æ±‚const profileResponse = await authClient.authenticatedRequest(&#x27;/user/profile&#x27;);const profileData = await profileResponse.json();\n\n\n8. ğŸš€ é«˜çº§ç‰¹æ€§8.1 ğŸ”„ åŒå› ç´ è®¤è¯ (2FA)const speakeasy = require(&#x27;speakeasy&#x27;);const qrcode = require(&#x27;qrcode&#x27;);/** * å¯ç”¨åŒå› ç´ è®¤è¯ */router.post(&#x27;/2fa/enable&#x27;, authenticateToken, async (req, res) =&gt; &#123;    try &#123;        const userId = req.user.id;        // ç”Ÿæˆå¯†é’¥        const secret = speakeasy.generateSecret(&#123;            name: `YourApp ($&#123;req.user.username&#125;)`,            issuer: &#x27;YourApp&#x27;,            length: 32        &#125;);        // ä¿å­˜å¯†é’¥åˆ°æ•°æ®åº“ (æœªéªŒè¯çŠ¶æ€)        await pool.execute(            &#x27;UPDATE users SET two_factor_secret = ?, two_factor_enabled = FALSE WHERE id = ?&#x27;,            [secret.base32, userId]        );        // ç”ŸæˆäºŒç»´ç         const qrCodeUrl = await qrcode.toDataURL(secret.otpauth_url);        res.json(&#123;            success: true,            message: &#x27;2FA setup initiated&#x27;,            data: &#123;                secret: secret.base32,                qr_code: qrCodeUrl,                backup_codes: generateBackupCodes()            &#125;        &#125;);    &#125; catch (error) &#123;        console.error(&#x27;2FA enable error:&#x27;, error);        res.status(500).json(&#123;            success: false,            message: &#x27;Failed to enable 2FA&#x27;,            code: &#x27;TWO_FA_ENABLE_ERROR&#x27;        &#125;);    &#125;&#125;);/** * éªŒè¯åŒå› ç´ è®¤è¯ */router.post(&#x27;/2fa/verify&#x27;, authenticateToken, async (req, res) =&gt; &#123;    try &#123;        const &#123; token &#125; = req.body;        const userId = req.user.id;        // è·å–ç”¨æˆ·çš„å¯†é’¥        const [users] = await pool.execute(            &#x27;SELECT two_factor_secret FROM users WHERE id = ?&#x27;,            [userId]        );        if (users.length === 0 || !users[0].two_factor_secret) &#123;            return res.status(400).json(&#123;                success: false,                message: &#x27;2FA not set up for this user&#x27;,                code: &#x27;TWO_FA_NOT_SETUP&#x27;            &#125;);        &#125;        // éªŒè¯ä»¤ç‰Œ        const verified = speakeasy.totp.verify(&#123;            secret: users[0].two_factor_secret,            encoding: &#x27;base32&#x27;,            token: token,            window: 2 // å…è®¸2ä¸ªæ—¶é—´çª—å£çš„åå·®        &#125;);        if (!verified) &#123;            return res.status(400).json(&#123;                success: false,                message: &#x27;Invalid 2FA token&#x27;,                code: &#x27;TWO_FA_INVALID_TOKEN&#x27;            &#125;);        &#125;        // å¯ç”¨åŒå› ç´ è®¤è¯        await pool.execute(            &#x27;UPDATE users SET two_factor_enabled = TRUE WHERE id = ?&#x27;,            [userId]        );        res.json(&#123;            success: true,            message: &#x27;2FA enabled successfully&#x27;        &#125;);    &#125; catch (error) &#123;        console.error(&#x27;2FA verification error:&#x27;, error);        res.status(500).json(&#123;            success: false,            message: &#x27;Failed to verify 2FA&#x27;,            code: &#x27;TWO_FA_VERIFY_ERROR&#x27;        &#125;);    &#125;&#125;);\n\n8.2 ğŸ“ å®¡è®¡æ—¥å¿—/** * è®°å½•å®‰å…¨äº‹ä»¶ */async function logSecurityEvent(userId, eventType, details, ipAddress, userAgent) &#123;    try &#123;        await pool.execute(            `INSERT INTO security_logs             (user_id, event_type, details, ip_address, user_agent, created_at)             VALUES (?, ?, ?, ?, ?, NOW())`,            [userId, eventType, JSON.stringify(details), ipAddress, userAgent]        );    &#125; catch (error) &#123;        console.error(&#x27;Failed to log security event:&#x27;, error);    &#125;&#125;// åœ¨è®¤è¯è·¯ç”±ä¸­ä½¿ç”¨router.post(&#x27;/login&#x27;, authLimiter, async (req, res) =&gt; &#123;    const ipAddress = req.ip;    const userAgent = req.get(&#x27;User-Agent&#x27;);    // ... ç™»å½•é€»è¾‘ ...    if (loginSuccessful) &#123;        await logSecurityEvent(            user.id,            &#x27;LOGIN_SUCCESS&#x27;,            &#123; username &#125;,            ipAddress,            userAgent        );    &#125; else &#123;        await logSecurityEvent(            null, // æœªçŸ¥ç”¨æˆ·            &#x27;LOGIN_FAILED&#x27;,            &#123; username, reason: &#x27;invalid_credentials&#x27; &#125;,            ipAddress,            userAgent        );    &#125;&#125;);\n\n\n9. ğŸ§ª æµ‹è¯•ä¸è°ƒè¯•9.1 ğŸ§ª å•å…ƒæµ‹è¯•const request = require(&#x27;supertest&#x27;);const app = require(&#x27;../app&#x27;);const pool = require(&#x27;../database/connection&#x27;);describe(&#x27;Authentication API&#x27;, () =&gt; &#123;    beforeEach(async () =&gt; &#123;        // æ¸…ç†æµ‹è¯•æ•°æ®        await pool.execute(&#x27;DELETE FROM users WHERE username LIKE &quot;test_%&quot;&#x27;);    &#125;);    afterAll(async () =&gt; &#123;        // å…³é—­æ•°æ®åº“è¿æ¥        await pool.end();    &#125;);    describe(&#x27;POST /auth/register&#x27;, () =&gt; &#123;        it(&#x27;should register a new user successfully&#x27;, async () =&gt; &#123;            const userData = &#123;                username: &#x27;test_user&#x27;,                email: &#x27;test@example.com&#x27;,                password: &#x27;TestPass123!&#x27;            &#125;;            const response = await request(app)                .post(&#x27;/auth/register&#x27;)                .send(userData)                .expect(201);            expect(response.body.success).toBe(true);            expect(response.body.data.user.username).toBe(userData.username);            expect(response.body.data.tokens.access_token).toBeDefined();        &#125;);        it(&#x27;should reject duplicate username&#x27;, async () =&gt; &#123;            const userData = &#123;                username: &#x27;test_user&#x27;,                email: &#x27;test@example.com&#x27;,                password: &#x27;TestPass123!&#x27;            &#125;;            // ç¬¬ä¸€æ¬¡æ³¨å†ŒæˆåŠŸ            await request(app)                .post(&#x27;/auth/register&#x27;)                .send(userData)                .expect(201);            // ç¬¬äºŒæ¬¡æ³¨å†Œå¤±è´¥            const response = await request(app)                .post(&#x27;/auth/register&#x27;)                .send(userData)                .expect(400);            expect(response.body.success).toBe(false);            expect(response.body.code).toBe(&#x27;USER_EXISTS&#x27;);        &#125;);    &#125;);    describe(&#x27;POST /auth/login&#x27;, () =&gt; &#123;        beforeEach(async () =&gt; &#123;            // åˆ›å»ºæµ‹è¯•ç”¨æˆ·            await request(app)                .post(&#x27;/auth/register&#x27;)                .send(&#123;                    username: &#x27;test_user&#x27;,                    email: &#x27;test@example.com&#x27;,                    password: &#x27;TestPass123!&#x27;                &#125;);        &#125;);        it(&#x27;should login with valid credentials&#x27;, async () =&gt; &#123;            const response = await request(app)                .post(&#x27;/auth/login&#x27;)                .send(&#123;                    username: &#x27;test_user&#x27;,                    password: &#x27;TestPass123!&#x27;                &#125;)                .expect(200);            expect(response.body.success).toBe(true);            expect(response.body.data.tokens.access_token).toBeDefined();        &#125;);        it(&#x27;should reject invalid credentials&#x27;, async () =&gt; &#123;            const response = await request(app)                .post(&#x27;/auth/login&#x27;)                .send(&#123;                    username: &#x27;test_user&#x27;,                    password: &#x27;wrongpassword&#x27;                &#125;)                .expect(401);            expect(response.body.success).toBe(false);            expect(response.body.code).toBe(&#x27;INVALID_CREDENTIALS&#x27;);        &#125;);    &#125;);&#125;);\n\n9.2 ğŸ” è°ƒè¯•å·¥å…·// Token è°ƒè¯•å·¥å…·const jwt = require(&#x27;jsonwebtoken&#x27;);function debugToken(token) &#123;    try &#123;        const decoded = jwt.decode(token, &#123; complete: true &#125;);        console.log(&#x27;Token Debug Info:&#x27;);        console.log(&#x27;Header:&#x27;, decoded.header);        console.log(&#x27;Payload:&#x27;, decoded.payload);        console.log(&#x27;Signature:&#x27;, decoded.signature);        // éªŒè¯ token        const verified = jwt.verify(token, process.env.JWT_SECRET);        console.log(&#x27;Verification:&#x27;, &#x27;âœ… Valid&#x27;);        console.log(&#x27;Expiration:&#x27;, new Date(verified.exp * 1000));    &#125; catch (error) &#123;        console.log(&#x27;Verification:&#x27;, &#x27;âŒ Invalid&#x27;);        console.log(&#x27;Error:&#x27;, error.message);    &#125;&#125;// ä½¿ç”¨æ–¹å¼debugToken(&#x27;your.jwt.token.here&#x27;);\n\n\nğŸ“Š æ€»ç»“âœ… è®¤è¯ç³»ç»Ÿç‰¹æ€§\nâœ… å®‰å…¨çš„å¯†ç å­˜å‚¨ (bcrypt)\nâœ… JWT Token è®¤è¯\nâœ… è¯·æ±‚é¢‘ç‡é™åˆ¶\nâœ… è¾“å…¥éªŒè¯å’Œæ¸…ç†\nâœ… CORS è·¨åŸŸä¿æŠ¤\nâœ… é”™è¯¯å¤„ç†å’Œå®‰å…¨æ—¥å¿—\nâœ… åŒå› ç´ è®¤è¯æ”¯æŒ\nâœ… å®¡è®¡æ—¥å¿—è®°å½•\n\nğŸ¯ å®‰å…¨æœ€ä½³å®è·µ\nä½¿ç”¨ HTTPS - æ‰€æœ‰è®¤è¯è¯·æ±‚å¿…é¡»é€šè¿‡ HTTPS\nå¯†ç ç­–ç•¥ - å¼ºåˆ¶ä½¿ç”¨å¤æ‚å¯†ç \nToken ç®¡ç† - åˆç†è®¾ç½®è¿‡æœŸæ—¶é—´\nç›‘æ§æ—¥å¿— - è®°å½•æ‰€æœ‰å®‰å…¨ç›¸å…³äº‹ä»¶\nå®šæœŸæ›´æ–° - ä¿æŒä¾èµ–åº“æœ€æ–°ç‰ˆæœ¬\n\nğŸ“š æ‰©å±•å»ºè®®\nå®ç°å¯†ç é‡ç½®åŠŸèƒ½\næ·»åŠ è´¦æˆ·é‚®ç®±éªŒè¯\nå®ç°ç¤¾äº¤ç™»å½•é›†æˆ\næ·»åŠ è®¾å¤‡ç®¡ç†åŠŸèƒ½\nå®ç°ç»†ç²’åº¦æƒé™æ§åˆ¶\n\n\n\nğŸ’¡ æç¤º: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·ç¡®ä¿ï¼š\n\nä½¿ç”¨å¼ºå¯†é’¥å’Œå®šæœŸè½®æ¢\nå¯ç”¨è¯¦ç»†çš„æ—¥å¿—è®°å½•\nå®æ–½ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶\nå®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡\n\n\n","categories":["Webæ¶æ„å®‰å…¨"],"tags":["æŠ€æœ¯æ–‡æ¡£","æŒ‡å—"]},{"title":"Qt SQLite åŠ å¯†æŒ‡å—","url":"/posts/ee94e619/","content":"Qt SQLite åŠ å¯†æŒ‡å—ç›®å½•\næ¦‚è¿°ï¼šä¸ºä»€ä¹ˆéœ€è¦åŠ å¯†ä»¥åŠä¸ºä»€ä¹ˆæ˜¯ SQLCipher\næ ¸å¿ƒæŒ‘æˆ˜ï¼šç¼–è¯‘è‡ªå®šä¹‰çš„ Qt é©±åŠ¨\nç¬¬ä¸€æ­¥ï¼šå‡†å¤‡ç¼–è¯‘ç¯å¢ƒ\nç¬¬äºŒæ­¥ï¼šç¼–è¯‘ SQLCipher\nç¬¬ä¸‰æ­¥ï¼šç¼–è¯‘ Qt çš„ QSQLITE é©±åŠ¨\nç¬¬å››æ­¥ï¼šéƒ¨ç½²å’Œä½¿ç”¨åŠ å¯†æ•°æ®åº“\nå¯†é’¥ç®¡ç†æœ€ä½³å®è·µ\n\næ¦‚è¿°ï¼šä¸ºä»€ä¹ˆéœ€è¦åŠ å¯†ä»¥åŠä¸ºä»€ä¹ˆæ˜¯ SQLCipheræ ‡å‡†çš„ SQLite3 æ•°æ®åº“æ˜¯ä¸€ä¸ªæ™®é€šçš„ç£ç›˜æ–‡ä»¶ï¼Œä»»ä½•æœ‰æƒè®¿é—®è¯¥æ–‡ä»¶çš„äººéƒ½å¯ä»¥è¯»å–å…¶å…¨éƒ¨å†…å®¹ã€‚å½“ä½ çš„åº”ç”¨éœ€è¦å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€å¯†ç ã€å¯†é’¥ç­‰ï¼‰æ—¶ï¼Œå¯¹æ•°æ®åº“è¿›è¡ŒåŠ å¯†å°±è‡³å…³é‡è¦ã€‚\nSQLCipher æ˜¯ä¸€ä¸ªå¼€æºçš„ SQLite æ‰©å±•ï¼Œå®ƒåœ¨æ•°æ®åº“é¡µçº§åˆ«ä¸Šè¿›è¡Œ 100% çš„ AES-256 åŠ å¯†ï¼Œæ˜¯ç›®å‰ä¸º SQLite æä¾›åŠ å¯†æ”¯æŒæœ€æˆç†Ÿã€æœ€å¹¿æ³›çš„è§£å†³æ–¹æ¡ˆã€‚\næ ¸å¿ƒæŒ‘æˆ˜ï¼šç¼–è¯‘è‡ªå®šä¹‰çš„ Qt é©±åŠ¨Qt å®˜æ–¹æä¾›çš„ QSQLITE é©±åŠ¨é»˜è®¤ä¸åŒ…å«åŠ å¯†åŠŸèƒ½ã€‚å› æ­¤ï¼Œä¸ºäº†è®© Qt èƒ½ä½¿ç”¨ SQLCipherï¼Œæˆ‘ä»¬ä¸èƒ½ç®€å•åœ°åœ¨é¡¹ç›®ä¸­é“¾æ¥åº“ï¼Œè€Œå¿…é¡»ä» Qt æºç é‡æ–°ç¼–è¯‘ QSQLITE é©±åŠ¨æ’ä»¶ï¼Œå¹¶è®©å®ƒé“¾æ¥åˆ°æˆ‘ä»¬è‡ªå·±ç¼–è¯‘çš„ SQLCipher åº“ã€‚è¿™æ˜¯æ•´ä¸ªè¿‡ç¨‹ä¸­æœ€å…³é”®çš„ä¸€æ­¥ã€‚\nç¬¬ä¸€æ­¥ï¼šå‡†å¤‡ç¼–è¯‘ç¯å¢ƒä½ éœ€è¦å‡†å¤‡ä»¥ä¸‹å‡ æ ·ä¸œè¥¿ï¼š\n\nC++ ç¼–è¯‘å™¨: ä¸€ä¸ªä¸ä½ çš„ Qt ç‰ˆæœ¬åŒ¹é…çš„ç¼–è¯‘å™¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨ Windows ä¸Šæ˜¯ Visual Studio 2019&#x2F;2022ï¼Œåœ¨ Linux ä¸Šæ˜¯ GCC&#x2F;Clangï¼‰ã€‚\nQt æºç : ä½ å®‰è£…çš„ Qt ç‰ˆæœ¬çš„å®Œæ•´æºç ã€‚å¦‚æœä½ é€šè¿‡åœ¨çº¿å®‰è£…å™¨å®‰è£… Qtï¼Œå¯ä»¥åœ¨â€œæ·»åŠ æˆ–ç§»é™¤ç»„ä»¶â€ä¸­å‹¾é€‰å¯¹åº”ç‰ˆæœ¬çš„â€œSourcesâ€ã€‚ç¡®ä¿æºç ç‰ˆæœ¬ä¸ä½ æ­£åœ¨ä½¿ç”¨çš„ Qt Kit çš„ç‰ˆæœ¬å®Œå…¨ä¸€è‡´ã€‚\nOpenSSL å¼€å‘åº“: SQLCipher ä¾èµ– OpenSSLã€‚åœ¨ Windows ä¸Šï¼Œå¯ä»¥ä» slproweb.com ä¸‹è½½é¢„ç¼–è¯‘çš„å¼€å‘åŒ…ã€‚åœ¨ Linux ä¸Šï¼Œé€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…ï¼ˆsudo apt-get install libssl-devï¼‰ã€‚\nSQLCipher æºç : ä» GitHub å…‹éš†ã€‚git clone https://github.com/sqlcipher/sqlcipher.git\n\nç¬¬äºŒæ­¥ï¼šç¼–è¯‘ SQLCipheræˆ‘ä»¬å°† SQLCipher ç¼–è¯‘ä¸ºä¸€ä¸ªé™æ€åº“ï¼Œä»¥ä¾¿åç»­é“¾æ¥ã€‚\nWindows (ä½¿ç”¨ VS å¼€å‘è€…å‘½ä»¤æç¤ºç¬¦)cd sqlcipher# Qt SQLite åŠ å¯†æŒ‡å—nmake /f Makefile.msc# Qt SQLite åŠ å¯†æŒ‡å—\n\nLinuxcd sqlcipher./configure --enable-tempstore=yes CFLAGS=&quot;-DSQLITE_HAS_CODEC&quot; LDFLAGS=&quot;-lcrypto&quot;makesudo make install# Qt SQLite åŠ å¯†æŒ‡å—\n\nç¬¬ä¸‰æ­¥ï¼šç¼–è¯‘ Qt çš„ QSQLITE é©±åŠ¨è¿™æ˜¯æœ€æ ¸å¿ƒçš„æ­¥éª¤ã€‚\n\næ‰¾åˆ°é©±åŠ¨æºç : å¯¼èˆªåˆ°ä½ ä¸‹è½½çš„ Qt æºç ç›®å½•ï¼Œæ‰¾åˆ° QSQLITE é©±åŠ¨çš„æºç ã€‚è·¯å¾„é€šå¸¸æ˜¯ï¼šC:\\Qt\\6.x.x\\Src\\qtbase\\src\\plugins\\sqldrivers\\sqlite\n\né…ç½® qmake: åœ¨è¯¥ç›®å½•ä¸‹ï¼Œæ‰“å¼€ä¸€ä¸ªä¸ä½ çš„ Qt ç‰ˆæœ¬åŒ¹é…çš„å‘½ä»¤è¡Œå·¥å…·ï¼ˆä¾‹å¦‚ x64 Native Tools Command Prompt for VS 2022 å¹¶ç¡®ä¿ qmake.exe åœ¨ PATH ä¸­ï¼‰ï¼Œç„¶åè¿è¡Œ qmake å‘½ä»¤ï¼Œå¹¶ä¼ å…¥é¢å¤–çš„å‚æ•°æ¥æŒ‡å®š SQLCipher çš„ä½ç½®å’Œç¼–è¯‘å®ã€‚\nWindows ç¤ºä¾‹:\nqmake -- &quot;LIBS+=-LC:/path/to/openssl/lib -llibcrypto&quot; &quot;LIBS+=-LC:/path/to/sqlcipher -lsqlcipher&quot; &quot;INCLUDEPATH+=C:/path/to/sqlcipher&quot; &quot;DEFINES+=SQLITE_HAS_CODEC&quot;\n\nLinux ç¤ºä¾‹:\nqmake -- &quot;LIBS+=-lsqlcipher -lcrypto&quot; &quot;DEFINES+=SQLITE_HAS_CODEC&quot;\nè¿™ä¸ªå‘½ä»¤å‘Šè¯‰ qmake åœ¨é“¾æ¥æ—¶åŠ å…¥ sqlcipher å’Œ crypto åº“ï¼Œå¹¶å®šä¹‰ SQLITE_HAS_CODEC å®ï¼Œè¿™æ˜¯å¼€å¯åŠ å¯†åŠŸèƒ½çš„å…³é”®ã€‚\n\nç¼–è¯‘æ’ä»¶: è¿è¡Œä½ çš„æ„å»ºå·¥å…·ã€‚\n\nWindows: nmake\nLinux&#x2F;macOS: make\n\n\n\nç¬¬å››æ­¥ï¼šéƒ¨ç½²å’Œä½¿ç”¨åŠ å¯†æ•°æ®åº“1. éƒ¨ç½²æ’ä»¶ç¼–è¯‘æˆåŠŸåï¼Œåœ¨æ„å»ºç›®å½•çš„ plugins/sqldrivers å­ç›®å½•ä¸‹ï¼Œä½ ä¼šæ‰¾åˆ°æ–°çš„é©±åŠ¨æ–‡ä»¶ï¼ˆä¾‹å¦‚ qsqlite.dll æˆ– libqsqlite.soï¼‰ã€‚\nä½ éœ€è¦å°†è¿™ä¸ªæ–°ç”Ÿæˆçš„æ–‡ä»¶ï¼Œè¦†ç›–ä½ å½“å‰ Qt å®‰è£…ç›®å½•ä¸­å¯¹åº”çš„æ—§æ–‡ä»¶ã€‚è·¯å¾„é€šå¸¸æ˜¯ï¼šC:\\Qt\\6.x.x\\mingw_64\\plugins\\sqldrivers\\qsqlite.dll\nå¼ºçƒˆå»ºè®®å…ˆå¤‡ä»½åŸå§‹æ–‡ä»¶ï¼\n2. åœ¨ä»£ç ä¸­ä½¿ç”¨ä¸€æ—¦ä½ æ›¿æ¢äº†é©±åŠ¨ï¼Œä½¿ç”¨åŠ å¯†æ•°æ®åº“å°±å˜å¾—éå¸¸ç®€å•ã€‚\n#include &lt;QSqlDatabase&gt;#include &lt;QSqlQuery&gt;#include &lt;QSqlError&gt;#include &lt;QDebug&gt;bool openEncryptedDb(const QString&amp; dbPath, const QString&amp; password) &#123;    QSqlDatabase db = QSqlDatabase::addDatabase(&quot;QSQLITE&quot;);    db.setDatabaseName(dbPath);    // å¿…é¡»åœ¨ open() ä¹‹å‰è®¾ç½®å¯†ç     db.setPassword(password);    if (!db.open()) &#123;        qWarning() &lt;&lt; &quot;Failed to open database:&quot; &lt;&lt; db.lastError().text();        return false;    &#125;    qDebug() &lt;&lt; &quot;Encrypted database opened successfully.&quot;;    // (å¯é€‰) ä¸º SQLCipher è®¾ç½®æ›´å¼ºçš„åŠ å¯†å‚æ•°    QSqlQuery query(db);    query.exec(&quot;PRAGMA cipher_page_size = 4096;&quot;);    query.exec(&quot;PRAGMA kdf_iter = 64000;&quot;);    query.exec(&quot;PRAGMA cipher_hmac_algorithm = HMAC_SHA256;&quot;);    query.exec(&quot;PRAGMA cipher_kdf_algorithm = PBKDF2_HMAC_SHA256;&quot;);    return true;&#125;\n\næ ¸å¿ƒè¦ç‚¹: å…³é”®åœ¨äº db.setPassword(password) è¿™ä¸€æ­¥ã€‚åœ¨ db.open() ä¹‹å‰è°ƒç”¨å®ƒï¼Œæ–°ç¼–è¯‘çš„é©±åŠ¨å°±ä¼šè¯†åˆ«è¿™ä¸ªå¯†ç ï¼Œå¹¶ç”¨å®ƒæ¥è§£å¯†æ•°æ®åº“ã€‚å¦‚æœæ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå®ƒä¼šè‡ªåŠ¨ç”¨è¿™ä¸ªå¯†ç åˆ›å»ºä¸€ä¸ªæ–°çš„åŠ å¯†æ•°æ®åº“ã€‚\nä¹‹åï¼Œæ‰€æœ‰ QSqlQuery çš„æ“ä½œéƒ½å’Œæ“ä½œæ™®é€šæ•°æ®åº“å®Œå…¨ä¸€æ ·ï¼ŒåŠ å¯†å’Œè§£å¯†å¯¹ä½ çš„ä»£ç æ˜¯å®Œå…¨é€æ˜çš„ã€‚\nå¯†é’¥ç®¡ç†æœ€ä½³å®è·µç»å¯¹ä¸è¦å°†å¯†ç ç¡¬ç¼–ç åœ¨ä½ çš„æºä»£ç ä¸­ï¼\n\nä»ç”¨æˆ·è¾“å…¥æ´¾ç”Ÿ: æœ€å®‰å…¨çš„æ–¹å¼æ˜¯è®©ç”¨æˆ·åœ¨æ¯æ¬¡å¯åŠ¨åº”ç”¨æ—¶è¾“å…¥å¯†ç ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªå¯†é’¥æ´¾ç”Ÿå‡½æ•°ï¼ˆå¦‚ PBKDF2ï¼‰æ¥ç”Ÿæˆæ•°æ®åº“çš„åŠ å¯†å¯†é’¥ã€‚QCryptographicHash::pbkdf2() å¯ä»¥ç”¨æ¥å®ç°è¿™ä¸€ç‚¹ã€‚\nä½¿ç”¨ç³»ç»Ÿå¯†é’¥é“¾: å¯¹äºéœ€è¦è‡ªåŠ¨ç™»å½•çš„åº”ç”¨ï¼Œå¯ä»¥å°†åŠ å¯†å¯†é’¥å­˜å‚¨åœ¨æ“ä½œç³»ç»Ÿçš„å®‰å…¨å¯†é’¥é“¾ä¸­ï¼ˆå¦‚ Windows Credential Manager, macOS Keychain, Linux Secret Serviceï¼‰ã€‚æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹ Qt åº“ï¼ˆå¦‚ QKeychainï¼‰å¯ä»¥å¸®åŠ©ä½ è®¿é—®è¿™äº›ç³»ç»ŸæœåŠ¡ã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","SQLite","SQLCipher","æ•°æ®åº“åŠ å¯†","å®‰å…¨"]},{"title":"Qt åª’ä½“æ’­æ”¾å™¨æŒ‡å—","url":"/posts/2d1c3806/","content":"Qt åª’ä½“æ’­æ”¾å™¨æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šé¡¹ç›®è®¾ç½®ä¸UIè®¾è®¡\nç¬¬äºŒæ­¥ï¼šå®ç°åŸºç¡€æ’­æ”¾åŠŸèƒ½\nç¬¬ä¸‰æ­¥ï¼šæ·»åŠ æ’­æ”¾åˆ—è¡¨\nç¬¬å››æ­¥ï¼šé«˜çº§åŠŸèƒ½å±•æœ› (æ–‡å­—è¯´æ˜)\nå®Œæ•´ä»£ç å‚è€ƒ\nå¸¸è§é—®é¢˜\n\næ¦‚è¿°æœ¬æ•™ç¨‹å°†å¾ªåºæ¸è¿›åœ°æŒ‡å¯¼ä½ å¦‚ä½•ä½¿ç”¨ Qt çš„ QMediaPlayer å’Œ QMediaPlaylist ç±»æ¥æ„å»ºä¸€ä¸ªåŠŸèƒ½æ€§çš„æ¡Œé¢éŸ³ä¹æ’­æ”¾å™¨ã€‚æˆ‘ä»¬å°†ä»ä¸€ä¸ªèƒ½æ’­æ”¾å•ä¸ªæ–‡ä»¶çš„æœ€ç®€æ’­æ”¾å™¨å¼€å§‹ï¼Œé€æ­¥ä¸ºå…¶æ·»åŠ æ’­æ”¾åˆ—è¡¨ç­‰åŠŸèƒ½ã€‚\næ ¸å¿ƒç»„ä»¶\nQMediaPlayer: ç”¨äºæ§åˆ¶åª’ä½“ï¼ˆéŸ³é¢‘&#x2F;è§†é¢‘ï¼‰æ’­æ”¾çš„æ ¸å¿ƒç±»ï¼Œæä¾›æ’­æ”¾ã€æš‚åœã€åœæ­¢ã€è®¾ç½®éŸ³é‡ã€è·³è½¬è¿›åº¦ç­‰åŠŸèƒ½ã€‚\nQMediaPlaylist: ç”¨äºç®¡ç†ä¸€ä¸ªåª’ä½“é¡¹ç›®åˆ—è¡¨ï¼Œæ”¯æŒé¡ºåºæ’­æ”¾ã€å¾ªç¯ã€éšæœºç­‰æ¨¡å¼ã€‚\n\nç¬¬ä¸€æ­¥ï¼šé¡¹ç›®è®¾ç½®ä¸UIè®¾è®¡1. é¡¹ç›®é…ç½® (.pro æ–‡ä»¶)åˆ›å»ºä¸€ä¸ªæ–°çš„ Qt Widgets Application é¡¹ç›®ï¼Œå¹¶ç¡®ä¿ .pro æ–‡ä»¶ä¸­åŒ…å«äº† multimedia æ¨¡å—ã€‚\nQT += core gui multimediaGREATER_THAN_QT_5 &#123;    QT += widgets&#125;TARGET = MusicPlayerTEMPLATE = appSOURCES += main.cpp mainwindow.cppHEADERS += mainwindow.hFORMS   += mainwindow.ui\n\n2. UI è®¾è®¡ (mainwindow.ui)åœ¨ Qt Designer ä¸­ï¼Œè®¾è®¡ä¸€ä¸ªç®€å•çš„ä¸»çª—å£ç•Œé¢ï¼ŒåŒ…å«ä»¥ä¸‹æ§ä»¶ï¼š\n\nQPushButton (openButton): ç”¨äºæ‰“å¼€æ–‡ä»¶ã€‚\nQPushButton (playPauseButton): ç”¨äºæ’­æ”¾&#x2F;æš‚åœã€‚\nQPushButton (stopButton): ç”¨äºåœæ­¢ã€‚\nQSlider (positionSlider): æ°´å¹³æ»‘å—ï¼Œç”¨äºæ˜¾ç¤ºå’Œæ§åˆ¶æ’­æ”¾è¿›åº¦ã€‚\nQLabel (timeLabel): ç”¨äºæ˜¾ç¤º å½“å‰æ—¶é—´ / æ€»æ—¶é—´ã€‚\nQListView (playlistView): ç”¨äºæ˜¾ç¤ºæ’­æ”¾åˆ—è¡¨ã€‚\n\nç¬¬äºŒæ­¥ï¼šå®ç°åŸºç¡€æ’­æ”¾åŠŸèƒ½æˆ‘ä»¬å…ˆå®ç°ä¸€ä¸ªèƒ½æ‰“å¼€å¹¶æ’­æ”¾å•ä¸ªéŸ³é¢‘æ–‡ä»¶çš„æ’­æ”¾å™¨ã€‚\n1. æ·»åŠ æˆå‘˜å˜é‡åœ¨ mainwindow.h ä¸­ï¼Œæ·»åŠ  QMediaPlayer çš„æŒ‡é’ˆã€‚\n// mainwindow.h#include &lt;QMediaPlayer&gt;class MainWindow : public QMainWindow &#123;    // ...private:    Ui::MainWindow *ui;    QMediaPlayer *m_player;&#125;;\n\n2. åˆå§‹åŒ–æ’­æ”¾å™¨åœ¨ mainwindow.cpp çš„æ„é€ å‡½æ•°ä¸­ï¼Œåˆå§‹åŒ–æ’­æ”¾å™¨å¹¶è¿æ¥å¿…è¦çš„ä¿¡å·å’Œæ§½ã€‚\n// mainwindow.cpp#include &quot;mainwindow.h&quot;#include &quot;ui_mainwindow.h&quot;#include &lt;QFileDialog&gt;MainWindow::MainWindow(QWidget *parent)    : QMainWindow(parent), ui(new Ui::MainWindow) &#123;    ui-&gt;setupUi(this);    // 1. åˆ›å»ºæ’­æ”¾å™¨å®ä¾‹    m_player = new QMediaPlayer(this);    // 2. ä¿¡å·æ§½è¿æ¥    connect(ui-&gt;openButton, &amp;QPushButton::clicked, this, &amp;MainWindow::openFile);    connect(ui-&gt;playPauseButton, &amp;QPushButton::clicked, this, &amp;MainWindow::togglePlayback);    connect(ui-&gt;stopButton, &amp;QPushButton::clicked, m_player, &amp;QMediaPlayer::stop);    // å½“æ’­æ”¾è¿›åº¦å˜åŒ–æ—¶ï¼Œæ›´æ–°æ»‘å—    connect(m_player, &amp;QMediaPlayer::positionChanged, this, &amp;MainWindow::updatePosition);    // å½“åª’ä½“æ€»æ—¶é•¿å˜åŒ–æ—¶ï¼Œè®¾ç½®æ»‘å—èŒƒå›´    connect(m_player, &amp;QMediaPlayer::durationChanged, this, &amp;MainWindow::updateDuration);    // å½“æ’­æ”¾çŠ¶æ€å˜åŒ–æ—¶ï¼Œæ›´æ–°æŒ‰é’®æ–‡æœ¬    connect(m_player, &amp;QMediaPlayer::stateChanged, this, &amp;MainWindow::updateState);    // æ‹–åŠ¨æ»‘å—ä»¥æ”¹å˜æ’­æ”¾è¿›åº¦    connect(ui-&gt;positionSlider, &amp;QSlider::sliderMoved, m_player, &amp;QMediaPlayer::setPosition);&#125;\n\n3. å®ç°æ§½å‡½æ•°// mainwindow.cppvoid MainWindow::openFile() &#123;    QString filePath = QFileDialog::getOpenFileName(this, &quot;æ‰“å¼€éŸ³é¢‘æ–‡ä»¶&quot;, &quot;&quot;, &quot;éŸ³é¢‘æ–‡ä»¶ (*.mp3 *.wav *.flac)&quot;);    if (!filePath.isEmpty()) &#123;        m_player-&gt;setMedia(QUrl::fromLocalFile(filePath));        m_player-&gt;play();    &#125;&#125;void MainWindow::togglePlayback() &#123;    if (m_player-&gt;state() == QMediaPlayer::PlayingState) &#123;        m_player-&gt;pause();    &#125; else &#123;        m_player-&gt;play();    &#125;&#125;void MainWindow::updatePosition(qint64 position) &#123;    ui-&gt;positionSlider-&gt;setValue(position);    // æ›´æ–°æ—¶é—´æ ‡ç­¾    qint64 duration = m_player-&gt;duration();    QString timeStr = QString(&quot;%1:%2 / %3:%4&quot;)                        .arg(position / 60000, 2, 10, QChar(&#x27;0&#x27;))                        .arg((position / 1000) % 60, 2, 10, QChar(&#x27;0&#x27;))                        .arg(duration / 60000, 2, 10, QChar(&#x27;0&#x27;))                        .arg((duration / 1000) % 60, 2, 10, QChar(&#x27;0&#x27;));    ui-&gt;timeLabel-&gt;setText(timeStr);&#125;void MainWindow::updateDuration(qint64 duration) &#123;    ui-&gt;positionSlider-&gt;setRange(0, duration);&#125;void MainWindow::updateState(QMediaPlayer::State state) &#123;    if (state == QMediaPlayer::PlayingState) &#123;        ui-&gt;playPauseButton-&gt;setText(&quot;æš‚åœ&quot;);    &#125; else &#123;        ui-&gt;playPauseButton-&gt;setText(&quot;æ’­æ”¾&quot;);    &#125;&#125;\nè‡³æ­¤ï¼Œä¸€ä¸ªå¯ä»¥æ’­æ”¾å•ä¸ªæ–‡ä»¶çš„åŸºç¡€æ’­æ”¾å™¨å°±å®Œæˆäº†ï¼\nç¬¬ä¸‰æ­¥ï¼šæ·»åŠ æ’­æ”¾åˆ—è¡¨ç°åœ¨ï¼Œæˆ‘ä»¬å¼•å…¥ QMediaPlaylist æ¥ç®¡ç†å¤šä¸ªæ–‡ä»¶ã€‚\n1. æ·»åŠ æˆå‘˜å˜é‡åœ¨ mainwindow.h ä¸­ï¼Œæ·»åŠ  QMediaPlaylist çš„æŒ‡é’ˆå’Œä¸€ä¸ªç”¨äºæ˜¾ç¤ºåˆ—è¡¨çš„æ¨¡å‹ã€‚\n// mainwindow.h#include &lt;QMediaPlaylist&gt;#include &lt;QStringListModel&gt;class MainWindow : public QMainWindow &#123;    // ...private:    // ...    QMediaPlaylist *m_playlist;    QStringListModel *m_playlistModel;    QStringList m_filePaths; // ä¿å­˜æ–‡ä»¶è·¯å¾„&#125;;\n\n2. ä¿®æ”¹æ„é€ å‡½æ•°// mainwindow.cppMainWindow::MainWindow(QWidget *parent) /* ... */ &#123;    // ... (ä¹‹å‰çš„ä»£ç )    // 1. åˆ›å»ºæ’­æ”¾åˆ—è¡¨å®ä¾‹    m_playlist = new QMediaPlaylist(this);    m_player-&gt;setPlaylist(m_playlist);    // 2. è®¾ç½®æ¨¡å‹å’Œè§†å›¾    m_playlistModel = new QStringListModel(this);    ui-&gt;playlistView-&gt;setModel(m_playlistModel);    // 3. è¿æ¥æ’­æ”¾åˆ—è¡¨ç›¸å…³çš„ä¿¡å·æ§½    connect(ui-&gt;playlistView, &amp;QListView::doubleClicked, this, &amp;MainWindow::playFromPlaylist);&#125;\n\n3. ä¿®æ”¹æ–‡ä»¶æ‰“å¼€é€»è¾‘è®©â€œæ‰“å¼€â€æŒ‰é’®æ”¯æŒé€‰æ‹©å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°æ’­æ”¾åˆ—è¡¨ã€‚\n// mainwindow.cppvoid MainWindow::openFile() &#123;    QStringList filePaths = QFileDialog::getOpenFileNames(this, &quot;æ‰“å¼€éŸ³é¢‘æ–‡ä»¶&quot;, &quot;&quot;, &quot;éŸ³é¢‘æ–‡ä»¶ (*.mp3 *.wav *.flac)&quot;);    if (!filePaths.isEmpty()) &#123;        m_filePaths = filePaths;        m_playlist-&gt;clear();        for (const QString &amp;filePath : filePaths) &#123;            m_playlist-&gt;addMedia(QUrl::fromLocalFile(filePath));        &#125;                // æ›´æ–° UI ä¸Šçš„åˆ—è¡¨        QStringList fileNames;        for (const QString &amp;filePath : filePaths) &#123;            fileNames.append(QFileInfo(filePath).fileName());        &#125;        m_playlistModel-&gt;setStringList(fileNames);        m_playlist-&gt;setCurrentIndex(0);        m_player-&gt;play();    &#125;&#125;void MainWindow::playFromPlaylist(const QModelIndex &amp;index) &#123;    m_playlist-&gt;setCurrentIndex(index.row());    m_player-&gt;play();&#125;\nç°åœ¨ï¼Œä½ çš„æ’­æ”¾å™¨å·²ç»æ”¯æŒæ’­æ”¾åˆ—è¡¨äº†ï¼ä½ å¯ä»¥æ·»åŠ â€œä¸Šä¸€é¦–â€å’Œâ€œä¸‹ä¸€é¦–â€æŒ‰é’®ï¼Œå¹¶åˆ†åˆ«è¿æ¥åˆ° m_playlist-&gt;previous() å’Œ m_playlist-&gt;next()ã€‚\nç¬¬å››æ­¥ï¼šé«˜çº§åŠŸèƒ½å±•æœ› (æ–‡å­—è¯´æ˜)\néŸ³é‡æ§åˆ¶: æ·»åŠ ä¸€ä¸ª QSliderï¼Œå°†å…¶ valueChanged(int) ä¿¡å·è¿æ¥åˆ° m_player çš„ setVolume(int) æ§½ã€‚\næ’­æ”¾æ¨¡å¼: ä½¿ç”¨ m_playlist-&gt;setPlaybackMode() å¯ä»¥è®¾ç½®ä¸åŒçš„æ’­æ”¾æ¨¡å¼ï¼Œå¦‚ QMediaPlaylist::Loop (åˆ—è¡¨å¾ªç¯), QMediaPlaylist::CurrentItemInLoop (å•æ›²å¾ªç¯), QMediaPlaylist::Random (éšæœºæ’­æ”¾)ã€‚\nä¿å­˜&#x2F;åŠ è½½æ’­æ”¾åˆ—è¡¨: QMediaPlaylist æ”¯æŒ .m3u æ ¼å¼ã€‚ä½¿ç”¨ m_playlist-&gt;save(QUrl::fromLocalFile(path), &quot;m3u&quot;) ä¿å­˜ï¼Œä½¿ç”¨ m_playlist-&gt;load(QUrl::fromLocalFile(path)) åŠ è½½ã€‚\néŸ³é¢‘å¯è§†åŒ–: è¦å®ç°é¢‘è°±æ•ˆæœï¼Œä½ éœ€è¦ä½¿ç”¨ QAudioProbe é™„åŠ åˆ° QMediaPlayer ä¸Šï¼Œå®ƒä¼šå‘å‡º audioBufferProbed(QAudioBuffer) ä¿¡å·ã€‚ä½ éœ€è¦å¯¹è¿™ä¸ª buffer ä¸­çš„åŸå§‹éŸ³é¢‘æ•°æ®è¿›è¡Œ FFT (å¿«é€Ÿå‚…é‡Œå¶å˜æ¢) è®¡ç®—ï¼Œç„¶åä½¿ç”¨ QPainter åœ¨ä¸€ä¸ªè‡ªå®šä¹‰æ§ä»¶ä¸Šå°†é¢‘è°±ç»˜åˆ¶å‡ºæ¥ã€‚è¿™æ˜¯ä¸€ä¸ªé«˜çº§çš„æ•°å­—ä¿¡å·å¤„ç†è¯é¢˜ã€‚\nå‡è¡¡å™¨: Qt æä¾›äº† QAudioEqualizer ç±»ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œç„¶åé€šè¿‡ m_player-&gt;setAudioEqualizer(myEqualizer) å°†å…¶åº”ç”¨åˆ°æ’­æ”¾å™¨ä¸Šã€‚\n\nå®Œæ•´ä»£ç å‚è€ƒ(ä¸ºç®€æ´èµ·è§ï¼Œæ­¤å¤„çœç•¥äº†å®Œæ•´çš„ main.cpp å’Œ mainwindow.h æ–‡ä»¶ï¼Œä¸Šæ–‡å·²åŒ…å«æ‰€æœ‰æ ¸å¿ƒé€»è¾‘ã€‚)\nå¸¸è§é—®é¢˜Q1: MP3 æ–‡ä»¶åœ¨ Windows ä¸Šèƒ½æ’­æ”¾ï¼Œä½†åœ¨ Linux ä¸Šä¸èƒ½?A: è¿™æ˜¯æœ€å¸¸è§çš„é—®é¢˜ï¼ŒåŸå› æ˜¯ç¼ºå°‘è§£ç å™¨ã€‚Qt Multimedia ä¾èµ–æ“ä½œç³»ç»Ÿçš„åç«¯ï¼ˆå¦‚ Windows ä¸Šçš„ DirectShowï¼ŒLinux ä¸Šçš„ GStreamerï¼‰ã€‚è¯·ç¡®ä¿åœ¨ Linux ä¸Šå®‰è£…äº† gstreamer1.0-plugins-good, gstreamer1.0-plugins-bad, gstreamer1.0-plugins-ugly ç­‰æ’ä»¶åŒ…ã€‚\nQ2: è§†é¢‘å¯ä»¥æ’­æ”¾ï¼Œä½†æ²¡æœ‰å£°éŸ³?A: åŒæ ·æ˜¯è§£ç å™¨é—®é¢˜ï¼Œæˆ–è€…éŸ³é¢‘è¾“å‡ºè®¾å¤‡æ²¡æœ‰æ­£ç¡®é€‰æ‹©ã€‚æ£€æŸ¥ç³»ç»ŸéŸ³é‡å’ŒéŸ³é¢‘è®¾å¤‡è®¾ç½®ã€‚\nQ3: å¦‚ä½•è·å–æ­Œæ›²çš„å…ƒæ•°æ®ï¼ˆæ­Œæ‰‹ã€ä¸“è¾‘ç­‰ï¼‰?A: QMediaPlayer æä¾›äº† metaDataChanged() ä¿¡å·å’Œ metaData(const QString &amp;key) æ–¹æ³•ã€‚å½“åª’ä½“åŠ è½½å®Œæˆåï¼Œä½ å¯ä»¥é€šè¿‡ player-&gt;metaData(QMediaMetaData::Title) ç­‰æ¥è·å–ä¿¡æ¯ã€‚\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","QMediaPlayer","QMediaPlaylist","MP3æ’­æ”¾å™¨","éŸ³é¢‘"]},{"title":"Qt ç½‘ç»œç¼–ç¨‹æŒ‡å—","url":"/posts/1653e33b/","content":"Qt ç½‘ç»œç¼–ç¨‹æŒ‡å—ç›®å½•\næ¦‚è¿°\nHTTP ç¼–ç¨‹ (QNetworkAccessManager)\nTCP ç¼–ç¨‹ (QTcpServer å’Œ QTcpSocket)\nUDP ç¼–ç¨‹ (QUdpSocket)\nWebSocket ç¼–ç¨‹ (QWebSocket)\nå¤„ç† SSL&#x2F;TLS\n\næ¦‚è¿°Qt çš„ Network æ¨¡å—æä¾›äº†ä¸€æ•´å¥—å¼ºå¤§çš„ç±»ï¼Œç”¨äºå¤„ç†ä»é«˜å±‚çš„ HTTP è¯·æ±‚åˆ°ä½å±‚çš„ TCP&#x2F;UDP å¥—æ¥å­—ç­‰å„ç§ç½‘ç»œé€šä¿¡ä»»åŠ¡ã€‚æœ¬æŒ‡å—å°†é€šè¿‡ä¸€ç³»åˆ—ç‹¬ç«‹çš„ã€æœ€å°åŒ–çš„ç¤ºä¾‹ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™äº›æ ¸å¿ƒç±»ã€‚\né¡¹ç›®é…ç½® (.pro æ–‡ä»¶)è¦ä½¿ç”¨æœ¬æŒ‡å—ä¸­çš„ä»»ä½•åŠŸèƒ½ï¼Œè¯·ç¡®ä¿ä½ çš„ .pro æ–‡ä»¶ä¸­åŒ…å«äº† network æ¨¡å—ã€‚\nQT += core gui network\n\nHTTP ç¼–ç¨‹ (QNetworkAccessManager)QNetworkAccessManager æ˜¯ Qt ä¸­ç”¨äºå¤„ç† HTTP&#x2F;HTTPS è¯·æ±‚çš„ä¸­å¿ƒç±»ã€‚å®ƒæ˜¯å¼‚æ­¥çš„ï¼Œé€šè¿‡ä¿¡å·å’Œæ§½æ¥å¤„ç†ç½‘ç»œå›å¤ã€‚\n1. å‘é€ GET è¯·æ±‚#include &lt;QCoreApplication&gt;#include &lt;QNetworkAccessManager&gt;#include &lt;QNetworkRequest&gt;#include &lt;QNetworkReply&gt;#include &lt;QDebug&gt;class HttpClient : public QObject &#123;    Q_OBJECTpublic:    HttpClient(QObject *parent = nullptr) : QObject(parent) &#123;        m_manager = new QNetworkAccessManager(this);        connect(m_manager, &amp;QNetworkAccessManager::finished, this, &amp;HttpClient::onFinished);    &#125;    void fetch(const QUrl &amp;url) &#123;        qDebug() &lt;&lt; &quot;Fetching URL:&quot; &lt;&lt; url;        m_manager-&gt;get(QNetworkRequest(url));    &#125;private slots:    void onFinished(QNetworkReply *reply) &#123;        if (reply-&gt;error() == QNetworkReply::NoError) &#123;            qDebug() &lt;&lt; &quot;Reply received:&quot;;            qDebug().noquote() &lt;&lt; reply-&gt;readAll();        &#125; else &#123;            qWarning() &lt;&lt; &quot;Error:&quot; &lt;&lt; reply-&gt;errorString();        &#125;        reply-&gt;deleteLater();    &#125;private:    QNetworkAccessManager *m_manager;&#125;;int main(int argc, char *argv[]) &#123;    QCoreApplication a(argc, argv);    HttpClient client;    client.fetch(QUrl(&quot;https://api.github.com/users/qt&quot;));    return a.exec();&#125;\n\n2. å‘é€ POST è¯·æ±‚ (JSON)#include &lt;QJsonObject&gt;#include &lt;QJsonDocument&gt;void HttpClient::postJson(const QUrl &amp;url, const QJsonObject &amp;jsonObject) &#123;    QNetworkRequest request(url);    request.setHeader(QNetworkRequest::ContentTypeHeader, &quot;application/json&quot;);    QJsonDocument doc(jsonObject);    QByteArray data = doc.toJson();    qDebug() &lt;&lt; &quot;Posting JSON data to&quot; &lt;&lt; url;    m_manager-&gt;post(request, data);&#125;// åœ¨ main å‡½æ•°ä¸­è°ƒç”¨// QJsonObject obj;// obj[&quot;name&quot;] = &quot;Qt User&quot;;// obj[&quot;job&quot;] = &quot;Developer&quot;;// client.postJson(QUrl(&quot;https://httpbin.org/post&quot;), obj);\n\nTCP ç¼–ç¨‹ (QTcpServer å’Œ QTcpSocket)TCP æä¾›äº†ä¸€ç§å¯é çš„ã€é¢å‘è¿æ¥çš„å­—èŠ‚æµæœåŠ¡ã€‚\n1. ç®€å•çš„ TCP å›å£°æœåŠ¡å™¨ (Echo Server)#include &lt;QTcpServer&gt;#include &lt;QTcpSocket&gt;class EchoServer : public QTcpServer &#123;    Q_OBJECTpublic:    EchoServer(QObject *parent = nullptr) : QTcpServer(parent) &#123;        connect(this, &amp;QTcpServer::newConnection, this, &amp;EchoServer::handleNewConnection);    &#125;    void start(quint16 port) &#123;        if (listen(QHostAddress::Any, port)) &#123;            qDebug() &lt;&lt; &quot;Server started on port&quot; &lt;&lt; port;        &#125; else &#123;            qWarning() &lt;&lt; &quot;Server failed to start:&quot; &lt;&lt; errorString();        &#125;    &#125;private slots:    void handleNewConnection() &#123;        QTcpSocket *socket = nextPendingConnection();        qDebug() &lt;&lt; &quot;New client connected:&quot; &lt;&lt; socket-&gt;peerAddress();        connect(socket, &amp;QTcpSocket::readyRead, this, [socket]() &#123;            QByteArray data = socket-&gt;readAll();            qDebug() &lt;&lt; &quot;Received:&quot; &lt;&lt; data;            socket-&gt;write(&quot;Echo: &quot; + data);        &#125;);        connect(socket, &amp;QTcpSocket::disconnected, this, [socket]() &#123;            qDebug() &lt;&lt; &quot;Client disconnected.&quot;;            socket-&gt;deleteLater();        &#125;);    &#125;&#125;;\n\n2. ç®€å•çš„ TCP å®¢æˆ·ç«¯#include &lt;QTcpSocket&gt;class EchoClient : public QObject &#123;    Q_OBJECTpublic:    EchoClient(QObject *parent = nullptr) : QObject(parent) &#123;        m_socket = new QTcpSocket(this);        connect(m_socket, &amp;QTcpSocket::connected, []() &#123; qDebug() &lt;&lt; &quot;Connected to server.&quot;; &#125;);        connect(m_socket, &amp;QTcpSocket::readyRead, this, [this]() &#123;            qDebug() &lt;&lt; &quot;Server replied:&quot; &lt;&lt; m_socket-&gt;readAll();        &#125;);    &#125;    void connectToServer(const QString &amp;host, quint16 port) &#123;        m_socket-&gt;connectToHost(host, port);    &#125;    void sendMessage(const QByteArray &amp;message) &#123;        m_socket-&gt;write(message);    &#125;private:    QTcpSocket *m_socket;&#125;;\n\nUDP ç¼–ç¨‹ (QUdpSocket)UDP æ˜¯ä¸€ç§æ— è¿æ¥çš„æ•°æ®æŠ¥åè®®ï¼Œå®ƒé€Ÿåº¦å¿«ï¼Œä½†ä¸ä¿è¯æ¶ˆæ¯çš„å¯é æ€§æˆ–é¡ºåºã€‚\n#include &lt;QUdpSocket&gt;class UdpPeer : public QObject &#123;    Q_OBJECTpublic:    UdpPeer(QObject *parent = nullptr) : QObject(parent) &#123;        m_socket = new QUdpSocket(this);        connect(m_socket, &amp;QUdpSocket::readyRead, this, &amp;UdpPeer::onReadyRead);    &#125;    void bind(quint16 port) &#123;        if (m_socket-&gt;bind(QHostAddress::Any, port)) &#123;            qDebug() &lt;&lt; &quot;UDP socket bound to port&quot; &lt;&lt; port;        &#125; else &#123;            qWarning() &lt;&lt; &quot;Failed to bind UDP socket.&quot;;        &#125;    &#125;    void sendBroadcast(const QByteArray &amp;datagram, quint16 port) &#123;        m_socket-&gt;writeDatagram(datagram, QHostAddress::Broadcast, port);        qDebug() &lt;&lt; &quot;Broadcast sent:&quot; &lt;&lt; datagram;    &#125;private slots:    void onReadyRead() &#123;        while (m_socket-&gt;hasPendingDatagrams()) &#123;            QByteArray datagram;            datagram.resize(m_socket-&gt;pendingDatagramSize());            QHostAddress senderHost;            quint16 senderPort;            m_socket-&gt;readDatagram(datagram.data(), datagram.size(), &amp;senderHost, &amp;senderPort);            qDebug() &lt;&lt; &quot;Received datagram from&quot; &lt;&lt; senderHost.toString() &lt;&lt; &quot;:&quot; &lt;&lt; datagram;        &#125;    &#125;private:    QUdpSocket *m_socket;&#125;;\n\nWebSocket ç¼–ç¨‹ (QWebSocket)WebSocket æä¾›äº†åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šä¿¡çš„èƒ½åŠ›ï¼Œéå¸¸é€‚åˆå®æ—¶ Web åº”ç”¨ã€‚\n#include &lt;QWebSocket&gt;class WebSocketClient : public QObject &#123;    Q_OBJECTpublic:    WebSocketClient(QObject *parent = nullptr) : QObject(parent) &#123;        m_socket = new QWebSocket();        connect(m_socket, &amp;QWebSocket::connected, this, &amp;WebSocketClient::onConnected);        connect(m_socket, &amp;QWebSocket::textMessageReceived, this, &amp;WebSocketClient::onTextMessageReceived);    &#125;    void connectToServer(const QUrl &amp;url) &#123;        qDebug() &lt;&lt; &quot;Connecting to WebSocket server:&quot; &lt;&lt; url;        m_socket-&gt;open(url);    &#125;private slots:    void onConnected() &#123;        qDebug() &lt;&lt; &quot;WebSocket connected!&quot;;        m_socket-&gt;sendTextMessage(&quot;Hello from Qt WebSocket!&quot;);    &#125;    void onTextMessageReceived(const QString &amp;message) &#123;        qDebug() &lt;&lt; &quot;Message received:&quot; &lt;&lt; message;    &#125;private:    QWebSocket *m_socket;&#125;;// åœ¨ main ä¸­ä½¿ç”¨// WebSocketClient client;// client.connectToServer(QUrl(&quot;wss://echo.websocket.events&quot;)); // ä¸€ä¸ªå…¬å…±çš„æµ‹è¯•æœåŠ¡\n\nå¤„ç† SSL&#x2F;TLSQt ç½‘ç»œæ¨¡å—å¯ä»¥é€æ˜åœ°å¤„ç† SSL&#x2F;TLS åŠ å¯†ï¼ˆå³ HTTPS å’Œ WSSï¼‰ã€‚\n\nä¾èµ–: ç¡®ä¿ä½ çš„ Qt å‘è¡Œç‰ˆåŒ…å«äº† OpenSSL åº“ã€‚é€šå¸¸ Windows å’Œ macOS çš„å®‰è£…åŒ…ä¼šè‡ªå¸¦ï¼ŒLinux ä¸Šå¯èƒ½éœ€è¦æ‰‹åŠ¨å®‰è£… (sudo apt-get install libssl-dev)ã€‚\nè‡ªåŠ¨å¤„ç†: å½“ä½ è¯·æ±‚ä¸€ä¸ª https:// æˆ– wss:// çš„ URL æ—¶ï¼ŒQt ä¼šè‡ªåŠ¨å¯ç”¨ SSL&#x2F;TLSã€‚\né”™è¯¯å¤„ç†: å¦‚æœè¯ä¹¦éªŒè¯å¤±è´¥ï¼ŒQNetworkReply æˆ– QWebSocket ä¼šå‘å‡º sslErrors ä¿¡å·ã€‚ä½ å¯ä»¥è¿æ¥è¿™ä¸ªä¿¡å·æ¥è¯Šæ–­é—®é¢˜ã€‚\n\n// åœ¨ HttpClient ä¸­// connect(m_manager, &amp;QNetworkAccessManager::sslErrors, this, &amp;HttpClient::onSslErrors);void HttpClient::onSslErrors(QNetworkReply *reply, const QList&lt;QSslError&gt; &amp;errors) &#123;    qWarning() &lt;&lt; &quot;SSL Errors Occurred:&quot;;    for (const QSslError &amp;error : errors) &#123;        qWarning() &lt;&lt; error.errorString();    &#125;    // åœ¨å¼€å‘å’Œæµ‹è¯•ä¸­ï¼Œä½ å¯èƒ½æƒ³ä¸´æ—¶å¿½ç•¥è¿™äº›é”™è¯¯ï¼Œä½†è¿™åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ˜¯ä¸å®‰å…¨çš„ï¼    // reply-&gt;ignoreSslErrors();&#125;\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","ç½‘ç»œç¼–ç¨‹","QNetworkAccessManager","QTcpSocket","QUdpSocket","QWebSocket"]},{"title":"Qt æ‘„åƒå¤´é‡‡é›†æŒ‡å—","url":"/posts/5d5b09a4/","content":"Qt æ‘„åƒå¤´é‡‡é›†æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¯å¢ƒä¸é¡¹ç›®é…ç½®\nUI ç•Œé¢è®¾è®¡\næ ¸å¿ƒä»£ç å®ç°\nå®Œæ•´ä»£ç ç¤ºä¾‹\næœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜\n\næ¦‚è¿°æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ Qt åº”ç”¨ç¨‹åºä¸­ï¼Œä½¿ç”¨ QCamera å’Œ QVideoWidget ç­‰æ ¸å¿ƒå¤šåª’ä½“ç±»ï¼Œå®ç°æ‘„åƒå¤´é¢„è§ˆå’Œå›¾åƒé‡‡é›†ï¼ˆæˆªå›¾ï¼‰åŠŸèƒ½ã€‚æœ¬æŒ‡å—é‡‡ç”¨ Qt æ¨èçš„æ ‡å‡†å®è·µï¼Œä»£ç ç®€æ´ä¸”é«˜æ•ˆã€‚\næ ¸å¿ƒç»„ä»¶\nQCamera: Qt ä¸­ä»£è¡¨ç‰©ç†æ‘„åƒå¤´çš„æ ¸å¿ƒç±»ã€‚\nQCameraInfo: ç”¨äºæŸ¥è¯¢ç³»ç»Ÿä¸Šå¯ç”¨çš„æ‘„åƒå¤´åŠå…¶ä¿¡æ¯ã€‚\nQVideoWidget: ç”¨äºåœ¨ UI ä¸Šæ˜¾ç¤ºæ‘„åƒå¤´é¢„è§ˆç”»é¢çš„ä¸“ç”¨æ§ä»¶ã€‚\nQCameraImageCapture: ç”¨äºä»æ‘„åƒå¤´æ•è·é«˜è´¨é‡é™æ€å›¾åƒçš„æœåŠ¡ç±»ã€‚\n\nç¯å¢ƒä¸é¡¹ç›®é…ç½®1. .pro æ–‡ä»¶é…ç½®ç¡®ä¿ä½ çš„ Qt é¡¹ç›®æ–‡ä»¶ (.pro) ä¸­åŒ…å«äº† multimedia å’Œ multimediawidgets æ¨¡å—ã€‚\n# Qt æ‘„åƒå¤´é‡‡é›†æŒ‡å—QT += core gui multimedia multimediawidgetsTARGET = CameraAppTEMPLATE = appSOURCES += main.cpp mainwindow.cppHEADERS += mainwindow.hFORMS   += mainwindow.ui\n\n2. ç³»ç»Ÿä¾èµ–\nWindows: é€šå¸¸æ— éœ€é¢å¤–ä¾èµ–ã€‚\nLinux (Ubuntu&#x2F;Debian): éœ€è¦ç¡®ä¿å®‰è£…äº† GStreamer æ’ä»¶ã€‚sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good\nmacOS: é€šå¸¸æ— éœ€é¢å¤–ä¾èµ–ã€‚\n\nUI ç•Œé¢è®¾è®¡åœ¨ Qt Designer ä¸­ï¼Œè®¾è®¡ä½ çš„ä¸»çª—å£ (MainWindow.ui)ï¼Œè‡³å°‘åŒ…å«ä»¥ä¸‹æ§ä»¶ï¼š\n\nQComboBox: ç”¨äºé€‰æ‹©æ‘„åƒå¤´ã€‚å¯¹è±¡åè®¾ä¸º cameraComboBoxã€‚\nQVideoWidget: è¿™æ˜¯æ˜¾ç¤ºæ‘„åƒå¤´ç”»é¢çš„å…³é”®ã€‚ä»æ§ä»¶åˆ—è¡¨ä¸­æ‹–å…¥ä¸€ä¸ª QVideoWidgetã€‚å¯¹è±¡åè®¾ä¸º videoWidgetã€‚\nQPushButton: ç”¨äºè§¦å‘æ‹ç…§ã€‚å¯¹è±¡åè®¾ä¸º captureButtonã€‚\nQLabel: ç”¨äºæ˜¾ç¤ºæ‹ä¸‹çš„ç…§ç‰‡é¢„è§ˆã€‚å¯¹è±¡åè®¾ä¸º capturePreviewLabelã€‚\n\næ ¸å¿ƒä»£ç å®ç°æˆ‘ä»¬å°†æ‰€æœ‰æ‘„åƒå¤´é€»è¾‘å°è£…åœ¨ MainWindow ç±»ä¸­ï¼Œä»¥ç®€åŒ–ç¤ºä¾‹ã€‚\n1. åˆå§‹åŒ–æ‘„åƒå¤´åœ¨ MainWindow çš„æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä¼šæŸ¥æ‰¾å¯ç”¨æ‘„åƒå¤´ï¼Œå¹¶è®¾ç½®é»˜è®¤æ‘„åƒå¤´ã€‚\n// mainwindow.cpp#include &quot;mainwindow.h&quot;#include &quot;ui_mainwindow.h&quot;#include &lt;QCameraInfo&gt;#include &lt;QMessageBox&gt;MainWindow::MainWindow(QWidget *parent)    : QMainWindow(parent)    , ui(new Ui::MainWindow)    , m_camera(nullptr)    , m_imageCapture(nullptr)&#123;    ui-&gt;setupUi(this);        // æŸ¥æ‰¾å¯ç”¨æ‘„åƒå¤´    const QList&lt;QCameraInfo&gt; availableCameras = QCameraInfo::availableCameras();    for (const QCameraInfo &amp;cameraInfo : availableCameras) &#123;        ui-&gt;cameraComboBox-&gt;addItem(cameraInfo.description());    &#125;    if (!availableCameras.isEmpty()) &#123;        // é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªæ‘„åƒå¤´        setupCamera(availableCameras.first());    &#125; else &#123;        QMessageBox::warning(this, &quot;æ— æ‘„åƒå¤´&quot;, &quot;ç³»ç»Ÿä¸­æœªæ‰¾åˆ°å¯ç”¨æ‘„åƒå¤´ã€‚&quot;);        ui-&gt;captureButton-&gt;setEnabled(false);    &#125;    connect(ui-&gt;captureButton, &amp;QPushButton::clicked, this, &amp;MainWindow::captureImage);    connect(ui-&gt;cameraComboBox, QOverload&lt;int&gt;::of(&amp;QComboBox::currentIndexChanged), this, &amp;MainWindow::changeCamera);&#125;\n\n2. è®¾ç½®å’Œå¯åŠ¨æ‘„åƒå¤´æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª setupCamera å‡½æ•°æ¥å¤„ç†æ‘„åƒå¤´çš„åˆ›å»ºã€é…ç½®å’Œå¯åŠ¨ã€‚\n// mainwindow.cppvoid MainWindow::setupCamera(const QCameraInfo &amp;cameraInfo) &#123;    // æ¸…ç†æ—§çš„æ‘„åƒå¤´å¯¹è±¡    if (m_camera) &#123;        m_camera-&gt;stop();        delete m_camera;        m_camera = nullptr;        delete m_imageCapture;        m_imageCapture = nullptr;    &#125;    // åˆ›å»ºæ–°çš„æ‘„åƒå¤´å’Œæˆªå›¾å¯¹è±¡    m_camera = new QCamera(cameraInfo);    m_imageCapture = new QCameraImageCapture(m_camera);    // å°†é¢„è§ˆç”»é¢è¾“å‡ºåˆ° QVideoWidget    m_camera-&gt;setViewfinder(ui-&gt;videoWidget);    // ä¿¡å·æ§½è¿æ¥ï¼Œå¤„ç†æˆªå›¾å’Œé”™è¯¯    connect(m_imageCapture, &amp;QCameraImageCapture::imageCaptured, this, &amp;MainWindow::displayCapturedImage);    connect(m_imageCapture, &amp;QCameraImageCapture::errorOccurred, this, &amp;MainWindow::handleCaptureError);    // å¯åŠ¨æ‘„åƒå¤´    m_camera-&gt;start();&#125;\n\n3. å®ç°æˆªå›¾åŠŸèƒ½å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œè°ƒç”¨ QCameraImageCapture çš„ capture() æ–¹æ³•ã€‚\n// mainwindow.cppvoid MainWindow::captureImage() &#123;    if (!m_imageCapture || !m_imageCapture-&gt;isReadyForCapture()) &#123;        QMessageBox::warning(this, &quot;é”™è¯¯&quot;, &quot;æ‘„åƒå¤´æœªå‡†å¤‡å¥½ï¼Œæ— æ³•æ‹ç…§ã€‚&quot;);        return;    &#125;    // æ‹ç…§ï¼Œå›¾åƒæ•°æ®ä¼šé€šè¿‡ imageCaptured ä¿¡å·è¿”å›    m_imageCapture-&gt;capture();&#125;void MainWindow::displayCapturedImage(int id, const QImage &amp;preview) &#123;    Q_UNUSED(id);    // åœ¨ QLabel ä¸Šæ˜¾ç¤ºæˆªå›¾çš„é¢„è§ˆ    ui-&gt;capturePreviewLabel-&gt;setPixmap(QPixmap::fromImage(preview).scaled(        ui-&gt;capturePreviewLabel-&gt;size(),        Qt::KeepAspectRatio,        Qt::SmoothTransformation    ));&#125;void MainWindow::handleCaptureError(int id, QCameraImageCapture::Error error, const QString &amp;errorString) &#123;    Q_UNUSED(id);    Q_UNUSED(error);    QMessageBox::warning(this, &quot;æ‹ç…§å¤±è´¥&quot;, errorString);&#125;\n\nå®Œæ•´ä»£ç ç¤ºä¾‹mainwindow.h:\n#ifndef MAINWINDOW_H#define MAINWINDOW_H#include &lt;QMainWindow&gt;#include &lt;QCamera&gt;#include &lt;QCameraImageCapture&gt;QT_BEGIN_NAMESPACEnamespace Ui &#123; class MainWindow; &#125;QT_END_NAMESPACEclass MainWindow : public QMainWindow &#123;    Q_OBJECTpublic:    MainWindow(QWidget *parent = nullptr);    ~MainWindow();private slots:    void captureImage();    void displayCapturedImage(int id, const QImage &amp;preview);    void handleCaptureError(int id, QCameraImageCapture::Error error, const QString &amp;errorString);    void changeCamera(int index);private:    void setupCamera(const QCameraInfo &amp;cameraInfo);    Ui::MainWindow *ui;    QCamera *m_camera;    QCameraImageCapture *m_imageCapture;&#125;;#endif // MAINWINDOW_H\n\nmainwindow.cpp (åŒ…å« changeCamera çš„å®ç°):\n#include &quot;mainwindow.h&quot;#include &quot;ui_mainwindow.h&quot;#include &lt;QCameraInfo&gt;#include &lt;QMessageBox&gt;MainWindow::MainWindow(QWidget *parent)    : QMainWindow(parent)    , ui(new Ui::MainWindow)    , m_camera(nullptr)    , m_imageCapture(nullptr)&#123;    ui-&gt;setupUi(this);        const QList&lt;QCameraInfo&gt; availableCameras = QCameraInfo::availableCameras();    for (const QCameraInfo &amp;cameraInfo : availableCameras) &#123;        ui-&gt;cameraComboBox-&gt;addItem(cameraInfo.description());    &#125;    if (!availableCameras.isEmpty()) &#123;        setupCamera(availableCameras.first());    &#125; else &#123;        QMessageBox::warning(this, &quot;æ— æ‘„åƒå¤´&quot;, &quot;ç³»ç»Ÿä¸­æœªæ‰¾åˆ°å¯ç”¨æ‘„åƒå¤´ã€‚&quot;);        ui-&gt;captureButton-&gt;setEnabled(false);    &#125;    connect(ui-&gt;captureButton, &amp;QPushButton::clicked, this, &amp;MainWindow::captureImage);    connect(ui-&gt;cameraComboBox, QOverload&lt;int&gt;::of(&amp;QComboBox::currentIndexChanged), this, &amp;MainWindow::changeCamera);&#125;MainWindow::~MainWindow() &#123;    if (m_camera) &#123;        m_camera-&gt;stop();    &#125;    delete ui;&#125;void MainWindow::setupCamera(const QCameraInfo &amp;cameraInfo) &#123;    if (m_camera) &#123;        m_camera-&gt;stop();        delete m_camera;        m_camera = nullptr;        delete m_imageCapture;        m_imageCapture = nullptr;    &#125;    m_camera = new QCamera(cameraInfo);    m_imageCapture = new QCameraImageCapture(m_camera);    m_camera-&gt;setViewfinder(ui-&gt;videoWidget);    connect(m_imageCapture, &amp;QCameraImageCapture::imageCaptured, this, &amp;MainWindow::displayCapturedImage);    connect(m_imageCapture, QOverload&lt;int, QCameraImageCapture::Error, const QString &amp;&gt;::of(&amp;QCameraImageCapture::errorOccurred), this, &amp;MainWindow::handleCaptureError);    m_camera-&gt;start();&#125;void MainWindow::captureImage() &#123;    if (!m_imageCapture || !m_imageCapture-&gt;isReadyForCapture()) &#123;        QMessageBox::warning(this, &quot;é”™è¯¯&quot;, &quot;æ‘„åƒå¤´æœªå‡†å¤‡å¥½ï¼Œæ— æ³•æ‹ç…§ã€‚&quot;);        return;    &#125;    m_imageCapture-&gt;capture();&#125;void MainWindow::displayCapturedImage(int id, const QImage &amp;preview) &#123;    Q_UNUSED(id);    ui-&gt;capturePreviewLabel-&gt;setPixmap(QPixmap::fromImage(preview).scaled(ui-&gt;capturePreviewLabel-&gt;size(), Qt::KeepAspectRatio, Qt::SmoothTransformation));&#125;void MainWindow::handleCaptureError(int id, QCameraImageCapture::Error error, const QString &amp;errorString) &#123;    Q_UNUSED(id);    Q_UNUSED(error);    QMessageBox::warning(this, &quot;æ‹ç…§å¤±è´¥&quot;, errorString);&#125;void MainWindow::changeCamera(int index) &#123;    if (index == -1) return;    const QList&lt;QCameraInfo&gt; availableCameras = QCameraInfo::availableCameras();    if (index &lt; availableCameras.size()) &#123;        setupCamera(availableCameras[index]);    &#125;&#125;\n\næœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜\næ£€æŸ¥æ‘„åƒå¤´å¯ç”¨æ€§: åœ¨å°è¯•ä½¿ç”¨æ‘„åƒå¤´å‰ï¼ŒåŠ¡å¿…é€šè¿‡ QCameraInfo::availableCameras() æ£€æŸ¥åˆ—è¡¨æ˜¯å¦ä¸ºç©ºã€‚\nèµ„æºç®¡ç†: QCamera å’Œ QCameraImageCapture éƒ½æ˜¯ QObjectï¼Œå°† MainWindow è®¾ç½®ä¸ºå®ƒä»¬çš„ parent å¯ä»¥åˆ©ç”¨ Qt çš„çˆ¶å­å¯¹è±¡æ ‘æœºåˆ¶è‡ªåŠ¨ç®¡ç†å†…å­˜ã€‚\né”™è¯¯å¤„ç†: å§‹ç»ˆè¿æ¥ QCamera::errorOccurred å’Œ QCameraImageCapture::errorOccurred ä¿¡å·ï¼Œå‘ç”¨æˆ·æä¾›æ¸…æ™°çš„é”™è¯¯åé¦ˆã€‚\nå¹³å°å·®å¼‚: æ‘„åƒå¤´åç«¯åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸Šï¼ˆWindows, Linux, macOSï¼‰çš„å®ç°ä¸åŒã€‚è™½ç„¶ Qt æŠ¹å¹³äº†å¤§éƒ¨åˆ†å·®å¼‚ï¼Œä½†åœ¨éƒ¨ç½²æ—¶ä»éœ€åœ¨ç›®æ ‡å¹³å°ä¸Šè¿›è¡Œå……åˆ†æµ‹è¯•ã€‚\né¢„è§ˆå¡é¡¿: å¦‚æœé¢„è§ˆç”»é¢å¡é¡¿ï¼Œå¯ä»¥å°è¯•æŸ¥è¯¢å¹¶è®¾ç½®ä¸€ä¸ªè¾ƒä½çš„é¢„è§ˆåˆ†è¾¨ç‡ã€‚ä½¿ç”¨ camera-&gt;supportedViewfinderResolutions() è·å–æ”¯æŒçš„åˆ†è¾¨ç‡åˆ—è¡¨ã€‚\næˆªå›¾è´¨é‡: ä½¿ç”¨ QImageEncoderSettings å¯ä»¥ç²¾ç»†æ§åˆ¶æˆªå›¾çš„åˆ†è¾¨ç‡å’Œè´¨é‡ã€‚åœ¨è°ƒç”¨ capture() ä¹‹å‰ï¼Œå°†å…¶è®¾ç½®åˆ° QCameraImageCapture å¯¹è±¡ä¸Šã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","QCamera","QVideoWidget","æ‘„åƒå¤´","æˆªå›¾","å¤šåª’ä½“"]},{"title":"Qt Model-View æ¶æ„æŒ‡å—","url":"/posts/4f2fc4b2/","content":"Qt Model-View æ¶æ„æŒ‡å—ç›®å½•\næ¦‚è¿°ï¼šModel-View-Delegate æ¨¡å¼\nç¬¬ä¸€æ­¥ï¼šè‡ªå®šä¹‰æ•°æ®æ¨¡å‹ (Model)\nç¬¬äºŒæ­¥ï¼šä½¿ç”¨è§†å›¾ (View) å±•ç¤ºæ•°æ®\nç¬¬ä¸‰æ­¥ï¼šè‡ªå®šä¹‰å§”æ‰˜ (Delegate) è¿›è¡Œæ¸²æŸ“\nç¬¬å››æ­¥ï¼šä½¿ç”¨ä»£ç†æ¨¡å‹ (Proxy Model) å®ç°æ’åºä¸è¿‡æ»¤\nç¬¬äº”æ­¥ï¼šç»„åˆåº”ç”¨\næ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ\n\næ¦‚è¿°ï¼šModel-View-Delegate æ¨¡å¼Qt çš„ Model-View æ¶æ„æ˜¯ç»å…¸ MVC æ¨¡å¼çš„ä¸€ç§å˜ä½“ï¼Œå®ƒå°† Viewï¼ˆè§†å›¾ï¼‰å’Œ Controllerï¼ˆæ§åˆ¶å™¨ï¼‰çš„èŒè´£è¿›ä¸€æ­¥åˆ’åˆ†ï¼š\n\nModel (æ¨¡å‹): è´Ÿè´£å­˜å‚¨å’Œç®¡ç†æ•°æ®ã€‚å®ƒä¸çŸ¥é“æ•°æ®å°†å¦‚ä½•è¢«å±•ç¤ºã€‚è¿™æ˜¯æ•°æ®çš„å”¯ä¸€çœŸå®æ¥æºã€‚\nView (è§†å›¾): è´Ÿè´£ä»¥æŸç§æ–¹å¼å°†æ¨¡å‹ä¸­çš„æ•°æ®å±•ç¤ºç»™ç”¨æˆ·ã€‚å®ƒå¯ä»¥æ˜¯åˆ—è¡¨ (QListView)ã€è¡¨æ ¼ (QTableView) æˆ–æ ‘ (QTreeView)ã€‚\nDelegate (å§”æ‰˜): è´Ÿè´£æ§åˆ¶æ•°æ®é¡¹çš„æ¸²æŸ“æ–¹å¼å’Œç¼–è¾‘æ–¹å¼ã€‚å®ƒå…è®¸ä½ é«˜åº¦è‡ªå®šä¹‰æ•°æ®åœ¨è§†å›¾ä¸­çš„å¤–è§‚å’Œäº¤äº’è¡Œä¸ºã€‚\n\nè¿™ç§æ¶æ„çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äºæ•°æ®ä¸è¡¨ç°çš„åˆ†ç¦»ï¼ŒåŒä¸€ä¸ªæ•°æ®æ¨¡å‹å¯ä»¥è¢«å¤šä¸ªä¸åŒçš„è§†å›¾ä»¥ä¸åŒçš„æ–¹å¼å±•ç¤ºï¼Œè€Œæ— éœ€å¤åˆ¶æ•°æ®ã€‚\nç¬¬ä¸€æ­¥ï¼šè‡ªå®šä¹‰æ•°æ®æ¨¡å‹ (Model)æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªè”ç³»äººåˆ—è¡¨æ¨¡å‹ ContactModelï¼Œå®ƒç»§æ‰¿è‡ª QAbstractListModelã€‚\ncontact_model.h:\n#ifndef CONTACTMODEL_H#define CONTACTMODEL_H#include &lt;QAbstractListModel&gt;#include &lt;QStringList&gt;#include &lt;QVector&gt;struct Contact &#123;    QString name;    QString phone;&#125;;class ContactModel : public QAbstractListModel &#123;    Q_OBJECTpublic:    explicit ContactModel(QObject *parent = nullptr);    // --- å¿…é¡»é‡å†™çš„æ ¸å¿ƒè™šå‡½æ•° ---    int rowCount(const QModelIndex &amp;parent = QModelIndex()) const override;    QVariant data(const QModelIndex &amp;index, int role = Qt::DisplayRole) const override;    // --- ç”¨äº QML æˆ–è‡ªå®šä¹‰ Delegate çš„è§’è‰²åç§° ---    QHash&lt;int, QByteArray&gt; roleNames() const override;    // --- è‡ªå®šä¹‰çš„æ•°æ®æ“ä½œæ–¹æ³• ---    void addContact(const Contact &amp;contact);    void removeContact(int row);private:    QVector&lt;Contact&gt; m_contacts;&#125;;#endif // CONTACTMODEL_H\n\ncontact_model.cpp:\n#include &quot;contact_model.h&quot;ContactModel::ContactModel(QObject *parent) : QAbstractListModel(parent) &#123;    // æ·»åŠ ä¸€äº›åˆå§‹æ•°æ®    addContact(&#123;&quot;Alice&quot;, &quot;+1-202-555-0173&quot;&#125;);    addContact(&#123;&quot;Bob&quot;, &quot;+44-20-7946-0958&quot;&#125;);&#125;int ContactModel::rowCount(const QModelIndex &amp;parent) const &#123;    // å¯¹äº List æ¨¡å‹ï¼Œæˆ‘ä»¬å¿½ç•¥ parent å‚æ•°    if (parent.isValid()) return 0;    return m_contacts.count();&#125;QVariant ContactModel::data(const QModelIndex &amp;index, int role) const &#123;    if (!index.isValid() || index.row() &gt;= m_contacts.count()) &#123;        return QVariant();    &#125;    const Contact &amp;contact = m_contacts.at(index.row());    // Qt::DisplayRole æ˜¯è§†å›¾é»˜è®¤è¯·æ±‚çš„æ–‡æœ¬è§’è‰²    if (role == Qt::DisplayRole) &#123;        return contact.name + &quot; (&quot; + contact.phone + &quot;)&quot;;    &#125;    // ä¹Ÿå¯ä»¥ä¸ºå…¶ä»–è§’è‰²æä¾›æ•°æ®ï¼Œä¾‹å¦‚å·¥å…·æç¤º    if (role == Qt::ToolTipRole) &#123;        return contact.name;    &#125;    return QVariant();&#125;void ContactModel::addContact(const Contact &amp;contact) &#123;    // åœ¨æ’å…¥æ•°æ®å‰ï¼Œå¿…é¡»è°ƒç”¨ beginInsertRows    beginInsertRows(QModelIndex(), rowCount(), rowCount());    m_contacts.append(contact);    // æ’å…¥æ•°æ®åï¼Œå¿…é¡»è°ƒç”¨ endInsertRowsï¼Œè¿™ä¼šé€šçŸ¥æ‰€æœ‰è§†å›¾è¿›è¡Œæ›´æ–°    endInsertRows();&#125;void ContactModel::removeContact(int row) &#123;    if (row &lt; 0 || row &gt;= m_contacts.count()) return;    beginRemoveRows(QModelIndex(), row, row);    m_contacts.removeAt(row);    endRemoveRows();&#125;// roleNames çš„å®ç°ä¸»è¦ç”¨äº QML ç¯å¢ƒï¼Œæ­¤å¤„çœç•¥QHash&lt;int, QByteArray&gt; ContactModel::roleNames() const &#123; return &#123;&#125;; &#125;\n\nç¬¬äºŒæ­¥ï¼šä½¿ç”¨è§†å›¾ (View) å±•ç¤ºæ•°æ®ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ¨¡å‹è®¾ç½®åˆ°ä¸€ä¸ªæ ‡å‡†çš„ QListView ä¸­ã€‚\nmainwindow.cpp:\n#include &quot;mainwindow.h&quot;#include &quot;ui_mainwindow.h&quot;#include &quot;contact_model.h&quot;MainWindow::MainWindow(QWidget *parent)    : QMainWindow(parent), ui(new Ui::MainWindow) &#123;    ui-&gt;setupUi(this);    // 1. åˆ›å»ºæ¨¡å‹å®ä¾‹    auto *model = new ContactModel(this);    // 2. å°†æ¨¡å‹è®¾ç½®åˆ°è§†å›¾ä¸Š    ui-&gt;listView-&gt;setModel(model);&#125;\nè¿è¡Œç¨‹åºï¼Œä½ å°†çœ‹åˆ°ä¸€ä¸ªç®€å•çš„åˆ—è¡¨ï¼Œæ˜¾ç¤ºäº†æˆ‘ä»¬åœ¨æ¨¡å‹ä¸­å®šä¹‰çš„è”ç³»äººä¿¡æ¯ã€‚è¿™å·²ç»æ˜¯ä¸€ä¸ªå¯ä»¥å·¥ä½œçš„ Model-View ç»“æ„äº†ã€‚\nç¬¬ä¸‰æ­¥ï¼šè‡ªå®šä¹‰å§”æ‰˜ (Delegate) è¿›è¡Œæ¸²æŸ“é»˜è®¤çš„è§†å›¾åªæ˜¾ç¤º Qt::DisplayRole çš„æ–‡æœ¬ã€‚å¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªæ›´ä¸°å¯Œçš„åˆ—è¡¨é¡¹ï¼ˆä¾‹å¦‚ï¼Œå·¦è¾¹æ˜¯å¤´åƒï¼Œå³è¾¹æ˜¯å§“åå’Œç”µè¯ï¼‰ï¼Œå°±éœ€è¦è‡ªå®šä¹‰å§”æ‰˜ã€‚\ncontact_delegate.h:\n#ifndef CONTACTDELEGATE_H#define CONTACTDELEGATE_H#include &lt;QStyledItemDelegate&gt;class ContactDelegate : public QStyledItemDelegate &#123;    Q_OBJECTpublic:    explicit ContactDelegate(QObject *parent = nullptr);    // é‡å†™ paint æ¥è‡ªå®šä¹‰ç»˜åˆ¶    void paint(QPainter *painter, const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index) const override;    // é‡å†™ sizeHint æ¥å‘Šè¯‰è§†å›¾æ¯ä¸ªé¡¹éœ€è¦å¤šå¤§ç©ºé—´    QSize sizeHint(const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index) const override;&#125;;#endif // CONTACTDELEGATE_H\n\ncontact_delegate.cpp:\n#include &quot;contact_delegate.h&quot;#include &lt;QPainter&gt;#include &quot;contact_model.h&quot; // éœ€è¦è®¿é—®æ¨¡å‹ä¸­çš„æ•°æ®ContactDelegate::ContactDelegate(QObject *parent) : QStyledItemDelegate(parent) &#123;&#125;void ContactDelegate::paint(QPainter *painter, const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index) const &#123;    if (!index.isValid()) return;    painter-&gt;save();    // ç»˜åˆ¶èƒŒæ™¯ (ä¾‹å¦‚ï¼Œé€‰ä¸­æ—¶é«˜äº®)    if (option.state &amp; QStyle::State_Selected) &#123;        painter-&gt;fillRect(option.rect, option.palette.highlight());    &#125;    // è·å–æ•°æ® (è¿™é‡Œæˆ‘ä»¬å‡è®¾æ¨¡å‹è¿”å›ä¸€ä¸ª Contact ç»“æ„ä½“)    // ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬ç›´æ¥ä»æ¨¡å‹è·å–ï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯é€šè¿‡è§’è‰²    Contact contact = index.data(Qt::UserRole).value&lt;Contact&gt;(); // å‡è®¾æ¨¡å‹åœ¨ UserRole ä¸­è¿”å›æ•´ä¸ªå¯¹è±¡    // ç»˜åˆ¶å¸ƒå±€    QRect r = option.rect;    QRect nameRect = r.adjusted(10, 10, -10, -20);    QRect phoneRect = r.adjusted(10, 30, -10, 0);    // ç»˜åˆ¶æ–‡æœ¬    painter-&gt;setPen(option.palette.windowText().color());    painter-&gt;setFont(QFont(&quot;Arial&quot;, 10, QFont::Bold));    painter-&gt;drawText(nameRect, Qt::AlignLeft, contact.name);    painter-&gt;setPen(Qt::gray);    painter-&gt;setFont(QFont(&quot;Arial&quot;, 9));    painter-&gt;drawText(phoneRect, Qt::AlignLeft, contact.phone);    painter-&gt;restore();&#125;QSize ContactDelegate::sizeHint(const QStyleOptionViewItem &amp;option, const QModelIndex &amp;index) const &#123;    // è®©æ¯ä¸ªåˆ—è¡¨é¡¹çš„é«˜åº¦ä¸º 60 åƒç´     return QSize(200, 60);&#125;\n\nåº”ç”¨å§”æ‰˜: åœ¨ MainWindow ä¸­ï¼Œå°†å§”æ‰˜è®¾ç½®ç»™è§†å›¾ã€‚\n// mainwindow.cpp#include &quot;contact_delegate.h&quot;MainWindow::MainWindow(QWidget *parent) /*...*/ &#123;    // ...    ui-&gt;listView-&gt;setModel(model);    // è®¾ç½®è‡ªå®šä¹‰å§”æ‰˜    ui-&gt;listView-&gt;setItemDelegate(new ContactDelegate(this));&#125;\n\nç¬¬å››æ­¥ï¼šä½¿ç”¨ä»£ç†æ¨¡å‹ (Proxy Model) å®ç°æ’åºä¸è¿‡æ»¤å¦‚æœä½ æƒ³åœ¨ä¸ä¿®æ”¹åŸå§‹æ•°æ®æ¨¡å‹çš„æƒ…å†µä¸‹ï¼Œå¯¹è§†å›¾ä¸­çš„æ•°æ®è¿›è¡Œæ’åºæˆ–è¿‡æ»¤ï¼ŒQSortFilterProxyModel æ˜¯æœ€ä½³é€‰æ‹©ã€‚\nmainwindow.cpp:\n#include &lt;QSortFilterProxyModel&gt;#include &lt;QLineEdit&gt;MainWindow::MainWindow(QWidget *parent) /*...*/ &#123;    // ...    auto *model = new ContactModel(this);    // 1. åˆ›å»ºä»£ç†æ¨¡å‹    auto *proxyModel = new QSortFilterProxyModel(this);    proxyModel-&gt;setSourceModel(model); // è®¾ç½®æºæ¨¡å‹    proxyModel-&gt;setFilterCaseSensitivity(Qt::CaseInsensitive); // è®¾ç½®è¿‡æ»¤æ—¶å¿½ç•¥å¤§å°å†™    proxyModel-&gt;setFilterKeyColumn(0); // æŒ‰ç¬¬ä¸€åˆ—ï¼ˆæˆ‘ä»¬å”¯ä¸€çš„åˆ—ï¼‰è¿›è¡Œè¿‡æ»¤    // 2. å°†ä»£ç†æ¨¡å‹è®¾ç½®åˆ°è§†å›¾ä¸Š    ui-&gt;listView-&gt;setModel(proxyModel);    // 3. æ·»åŠ ä¸€ä¸ªæœç´¢æ¡†    auto *filterLineEdit = new QLineEdit(this);    // ... å°† filterLineEdit æ·»åŠ åˆ°å¸ƒå±€ä¸­ ...    connect(filterLineEdit, &amp;QLineEdit::textChanged, proxyModel, &amp;QSortFilterProxyModel::setFilterFixedString);&#125;\nç°åœ¨ï¼Œå½“ä½ åœ¨æœç´¢æ¡†ä¸­è¾“å…¥æ–‡æœ¬æ—¶ï¼Œåˆ—è¡¨è§†å›¾ä¼šè‡ªåŠ¨è¿‡æ»¤ï¼Œåªæ˜¾ç¤ºåŒ¹é…çš„é¡¹ï¼Œè€ŒåŸå§‹çš„ ContactModel ä¸­çš„æ•°æ®å®Œå…¨ä¸å—å½±å“ã€‚\nç¬¬äº”æ­¥ï¼šç»„åˆåº”ç”¨å°†ä»¥ä¸Šæ‰€æœ‰éƒ¨åˆ†ç»„åˆèµ·æ¥ï¼Œå°±å¯ä»¥æ„å»ºä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åº”ç”¨ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè”ç³»äººç®¡ç†å™¨ï¼Œå·¦è¾¹æ˜¯ QListView æ˜¾ç¤ºè”ç³»äººåˆ—è¡¨ï¼Œå³è¾¹æ˜¯ QDataWidgetMapper å°†é€‰ä¸­é¡¹çš„æ•°æ®æ˜ å°„åˆ° QLineEdit ç­‰ç¼–è¾‘æ§ä»¶ä¸Šã€‚\næ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ\næ‰¹é‡æ“ä½œ: å½“ä½ è¦å¯¹æ¨¡å‹è¿›è¡Œå¤§é‡ä¿®æ”¹ï¼ˆå¦‚æ·»åŠ æˆ–åˆ é™¤ä¸Šç™¾è¡Œï¼‰æ—¶ï¼ŒåŠ¡å¿…å°†æ“ä½œåŒ…è£¹åœ¨ begin...Rows() å’Œ end...Rows() æˆ– beginResetModel() å’Œ endResetModel() ä¹‹é—´ã€‚è¿™ä¼šå°†æ‰€æœ‰æ›´æ–°åˆå¹¶ä¸ºä¸€æ¬¡ï¼Œå¤§å¤§æé«˜æ€§èƒ½ã€‚\næ‡’åŠ è½½ (Lazy Loading): å¯¹äºæå¤§çš„æ•°æ®é›†ï¼ˆå¦‚æ•°æ®åº“æˆ–å¤§å‹æ—¥å¿—æ–‡ä»¶ï¼‰ï¼Œä¸è¦ä¸€æ¬¡æ€§å°†æ‰€æœ‰æ•°æ®åŠ è½½åˆ°æ¨¡å‹ä¸­ã€‚å¯ä»¥åœ¨æ¨¡å‹ä¸­é‡å†™ canFetchMore() å’Œ fetchMore() æ–¹æ³•ï¼Œå½“è§†å›¾æ»šåŠ¨åˆ°æœ«å°¾æ—¶ï¼Œæ¨¡å‹ä¼šæŒ‰éœ€åŠ è½½ä¸‹ä¸€æ‰¹æ•°æ®ã€‚\nè§†å›¾ä¼˜åŒ–: å¦‚æœä½ çš„åˆ—è¡¨é¡¹å¤§å°æ˜¯å›ºå®šçš„ï¼Œåœ¨è§†å›¾ä¸Šè®¾ç½® view-&gt;setUniformItemSizes(true) å¯ä»¥æ˜¾è‘—æé«˜æ»šåŠ¨æ€§èƒ½ã€‚\næ•°æ®è§’è‰² (Roles): å……åˆ†åˆ©ç”¨ data() å‡½æ•°çš„ role å‚æ•°ã€‚é™¤äº† Qt::DisplayRoleï¼Œè¿˜å¯ä»¥ä¸º Qt::ToolTipRole (å·¥å…·æç¤º), Qt::FontRole (å­—ä½“), Qt::ForegroundRole (å‰æ™¯è‰²) ç­‰æä¾›æ•°æ®ï¼Œè®©è§†å›¾è‡ªåŠ¨å¤„ç†ä¸€äº›ç®€å•çš„æ ·å¼ï¼Œä»è€Œç®€åŒ– Delegateã€‚\né¿å…åœ¨ Model ä¸­æŒæœ‰ Qt æ§ä»¶: æ¨¡å‹åº”è¯¥åªå…³å¿ƒæ•°æ®ï¼Œä¸åº”åŒ…å«ä»»ä½•ä¸ UI ç›¸å…³çš„å¯¹è±¡ã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","MVC","Model-View","Delegate","æ¶æ„è®¾è®¡"]},{"title":"Qt å•å…ƒæµ‹è¯•æŒ‡å—","url":"/posts/75dde51b/","content":"Qt å•å…ƒæµ‹è¯•æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šé¡¹ç›®é…ç½®\nç¬¬äºŒæ­¥ï¼šç¼–å†™åŸºç¡€æµ‹è¯•\nç¬¬ä¸‰æ­¥ï¼šæ•°æ®é©±åŠ¨æµ‹è¯•\nç¬¬å››æ­¥ï¼šGUI æµ‹è¯•\nç¬¬äº”æ­¥ï¼šä½¿ç”¨æ¨¡æ‹Ÿå¯¹è±¡ (Mocking)\nç¬¬å…­æ­¥ï¼šè¿è¡Œæµ‹è¯•ä¸ç”ŸæˆæŠ¥å‘Š\né™„å½•ï¼šæŒç»­é›†æˆ (CI&#x2F;CD)\n\næ¦‚è¿°å•å…ƒæµ‹è¯•æ˜¯ä¿è¯ä»£ç è´¨é‡ã€æ–¹ä¾¿é‡æ„ã€å‡å°‘ Bug çš„å…³é”®å®è·µã€‚Qt æä¾›äº†è‡ªå®¶çš„æµ‹è¯•æ¡†æ¶ Qt Testï¼Œå®ƒè½»é‡ã€å¿«é€Ÿï¼Œå¹¶ä¸ Qt çš„å…ƒå¯¹è±¡ç³»ç»Ÿå’Œäº‹ä»¶å¾ªç¯æ·±åº¦é›†æˆï¼Œå°¤å…¶æ“…é•¿è¿›è¡Œ GUI æµ‹è¯•ã€‚\nç¬¬ä¸€æ­¥ï¼šé¡¹ç›®é…ç½®è¦å¼€å§‹ä½¿ç”¨ Qt Testï¼Œé¦–å…ˆéœ€è¦é…ç½®ä½ çš„ .pro æ–‡ä»¶ã€‚\n# Qt å•å…ƒæµ‹è¯•æŒ‡å—# Qt å•å…ƒæµ‹è¯•æŒ‡å—QT += testlib# Qt å•å…ƒæµ‹è¯•æŒ‡å—CONFIG += testcase# Qt å•å…ƒæµ‹è¯•æŒ‡å—SOURCES += test_calculator.cppHEADERS += test_calculator.h# Qt å•å…ƒæµ‹è¯•æŒ‡å—# Qt å•å…ƒæµ‹è¯•æŒ‡å—\n\nç¬¬äºŒæ­¥ï¼šç¼–å†™åŸºç¡€æµ‹è¯•ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹é€šå¸¸æ˜¯ä¸€ä¸ªç»§æ‰¿è‡ª QObject çš„ç±»ï¼Œå…¶ä¸­åŒ…å«ä¸€ç³»åˆ—ä»¥ test å¼€å¤´çš„ç§æœ‰æ§½å‡½æ•° (private slots)ã€‚\n1. æµ‹è¯•ç±»ç»“æ„// test_calculator.h#include &lt;QObject&gt;class TestCalculator : public QObject &#123;    Q_OBJECTprivate slots:    void initTestCase();    // åœ¨æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œå‰è°ƒç”¨    void cleanupTestCase(); // åœ¨æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œåè°ƒç”¨    void init();            // åœ¨æ¯ä¸ªæµ‹è¯•å‡½æ•°æ‰§è¡Œå‰è°ƒç”¨    void cleanup();         // åœ¨æ¯ä¸ªæµ‹è¯•å‡½æ•°æ‰§è¡Œåè°ƒç”¨    // --- æµ‹è¯•å‡½æ•° ---    void testAddition();    void testDivision();    void testDivisionByZero_expectedFailure();&#125;;\n\n2. æµ‹è¯•å®Qt Test æä¾›äº†ä¸°å¯Œçš„å®æ¥è¿›è¡Œæ–­è¨€ï¼š\n\nQCOMPARE(actual, expected): æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ã€‚\nQVERIFY(condition): éªŒè¯æ¡ä»¶æ˜¯å¦ä¸º trueã€‚\nQVERIFY2(condition, message): åŒä¸Šï¼Œä½†å¤±è´¥æ—¶ä¼šè¾“å‡ºè‡ªå®šä¹‰æ¶ˆæ¯ã€‚\nQVERIFY_EXCEPTION_THROWN(expression, ExceptionType): éªŒè¯è¡¨è¾¾å¼æ˜¯å¦ä¼šæŠ›å‡ºæŒ‡å®šç±»å‹çš„å¼‚å¸¸ã€‚\nQWARN(message): è¾“å‡ºä¸€æ¡è­¦å‘Šä¿¡æ¯ã€‚\nQBENCHMARK: ç”¨äºç®€å•çš„æ€§èƒ½åŸºå‡†æµ‹è¯•ã€‚\n\n3. å®Œæ•´ç¤ºä¾‹// test_calculator.cpp#include &lt;QtTest&gt;#include &quot;calculator.h&quot; // å‡è®¾è¢«æµ‹è¯•çš„ç±»åœ¨è¿™é‡Œ#include &lt;stdexcept&gt;// ... TestCalculator ç±»çš„å£°æ˜ ...void TestCalculator::initTestCase() &#123;    qDebug() &lt;&lt; &quot;Starting calculator tests...&quot;;&#125;void TestCalculator::cleanupTestCase() &#123;    qDebug() &lt;&lt; &quot;Calculator tests finished.&quot;;&#125;void TestCalculator::init() &#123;    // æ¯ä¸ªæµ‹è¯•å‡½æ•°éƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„ Calculator å®ä¾‹    m_calculator = new Calculator();&#125;void TestCalculator::cleanup() &#123;    delete m_calculator;&#125;void TestCalculator::testAddition() &#123;    QCOMPARE(m_calculator-&gt;add(2, 3), 5);    QCOMPARE(m_calculator-&gt;add(-1, 1), 0);&#125;void TestCalculator::testDivision() &#123;    // å¯¹äºæµ®ç‚¹æ•°ï¼Œä½¿ç”¨ qFuzzyCompare    QVERIFY(qFuzzyCompare(m_calculator-&gt;divide(10, 3), 3.33333));&#125;void TestCalculator::testDivisionByZero_expectedFailure() &#123;    // éªŒè¯é™¤ä»¥é›¶æ˜¯å¦ä¼šæŒ‰é¢„æœŸæŠ›å‡ºå¼‚å¸¸    QVERIFY_EXCEPTION_THROWN(m_calculator-&gt;divide(1, 0), std::runtime_error);&#125;// --- å¯åŠ¨æµ‹è¯• ---// QTEST_APPLESS_MAIN ç”¨äºé GUI æµ‹è¯•ï¼Œå®ƒä¸åˆ›å»º QApplication å®ä¾‹ï¼Œæ›´è½»é‡QTEST_APPLESS_MAIN(TestCalculator)// å¦‚æœä½ çš„æµ‹è¯•éœ€è¦äº‹ä»¶å¾ªç¯æˆ–æµ‹è¯•GUIç»„ä»¶ï¼Œåº”ä½¿ç”¨ QTEST_MAIN// QTEST_MAIN(TestCalculator)#include &quot;test_calculator.moc&quot; // å¿…é¡»åŒ…å« moc æ–‡ä»¶\n\nç¬¬ä¸‰æ­¥ï¼šæ•°æ®é©±åŠ¨æµ‹è¯•å½“ä½ æƒ³ç”¨å¤šç»„ä¸åŒçš„æ•°æ®æµ‹è¯•åŒä¸€ä¸ªé€»è¾‘æ—¶ï¼Œæ•°æ®é©±åŠ¨æµ‹è¯•éå¸¸æœ‰ç”¨ã€‚æµ‹è¯•å‡½æ•°ä¼šä¸ºæ¯ä¸€è¡Œæ•°æ®ç‹¬ç«‹è¿è¡Œä¸€æ¬¡ã€‚\n// test_string_utils.cpp#include &lt;QtTest&gt;#include &lt;algorithm&gt; // for std::reverseclass TestStringUtils : public QObject &#123;    Q_OBJECTprivate slots:    void testToUpperCase_data(); // å‡½æ•°åå¿…é¡»æ˜¯ &quot;æµ‹è¯•å‡½æ•°å_data&quot;    void testToUpperCase();    void testReverse_data();    void testReverse();&#125;;void TestStringUtils::testToUpperCase_data() &#123;    // 1. å®šä¹‰æ•°æ®åˆ—    QTest::addColumn&lt;QString&gt;(&quot;input&quot;);    QTest::addColumn&lt;QString&gt;(&quot;expected&quot;);    // 2. æ·»åŠ æ•°æ®è¡Œ    QTest::newRow(&quot;all_lower&quot;) &lt;&lt; &quot;hello&quot; &lt;&lt; &quot;HELLO&quot;;    QTest::newRow(&quot;mixed&quot;)     &lt;&lt; &quot;World&quot; &lt;&lt; &quot;WORLD&quot;;    QTest::newRow(&quot;empty&quot;)      &lt;&lt; &quot;&quot;      &lt;&lt; &quot;&quot;;&#125;void TestStringUtils::testToUpperCase() &#123;    // 3. åœ¨æµ‹è¯•å‡½æ•°ä¸­è·å–æ•°æ®    QFETCH(QString, input);    QFETCH(QString, expected);    QCOMPARE(input.toUpper(), expected);&#125;void TestStringUtils::testReverse_data() &#123;    QTest::addColumn&lt;QString&gt;(&quot;input&quot;);    QTest::addColumn&lt;QString&gt;(&quot;expected&quot;);    QTest::newRow(&quot;simple&quot;) &lt;&lt; &quot;abc&quot; &lt;&lt; &quot;cba&quot;;    QTest::newRow(&quot;palindrome&quot;) &lt;&lt; &quot;madam&quot; &lt;&lt; &quot;madam&quot;;&#125;void TestStringUtils::testReverse() &#123;    QFETCH(QString, input);    QFETCH(QString, expected);    // ä¿®æ­£ï¼šQString æ²¡æœ‰ reverse() æ–¹æ³•ï¼Œéœ€è¦ä½¿ç”¨ std::reverse    std::reverse(input.begin(), input.end());    QCOMPARE(input, expected);&#125;QTEST_APPLESS_MAIN(TestStringUtils)#include &quot;test_string_utils.moc&quot;\n\nç¬¬å››æ­¥ï¼šGUI æµ‹è¯•Qt Test æ¡†æ¶æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€å°±æ˜¯æµ‹è¯• GUI äº¤äº’ã€‚\n\nQTest::mouseClick(widget, button, modifiers, delay): æ¨¡æ‹Ÿé¼ æ ‡ç‚¹å‡»ã€‚\nQTest::keyClicks(widget, sequence): æ¨¡æ‹Ÿé”®ç›˜è¾“å…¥å­—ç¬¦ä¸²ã€‚\nQTest::keyClick(widget, key): æ¨¡æ‹Ÿå•ä¸ªæŒ‰é”®ã€‚\nQSignalSpy: ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºç›‘è§†ä¿¡å·çš„å‘å°„æƒ…å†µã€‚\n\n// test_login_dialog.cpp#include &lt;QtTest&gt;#include &lt;QPushButton&gt;#include &lt;QLineEdit&gt;#include &quot;logindialog.h&quot; // å‡è®¾è¿™æ˜¯ä½ çš„ç™»å½•å¯¹è¯æ¡†UIç±»class TestLoginDialog : public QObject &#123;    Q_OBJECTprivate slots:    void testLogin() &#123;        LoginDialog dialog;        // 1. æŸ¥æ‰¾å­æ§ä»¶        QLineEdit *usernameEdit = dialog.findChild&lt;QLineEdit*&gt;(&quot;usernameEdit&quot;);        QLineEdit *passwordEdit = dialog.findChild&lt;QLineEdit*&gt;(&quot;passwordEdit&quot;);        QPushButton *loginButton = dialog.findChild&lt;QPushButton*&gt;(&quot;loginButton&quot;);        QVERIFY(usernameEdit);        QVERIFY(passwordEdit);        QVERIFY(loginButton);        // 2. åˆ›å»ºä¿¡å·ç›‘è§†å™¨        QSignalSpy loginSpy(&amp;dialog, &amp;LoginDialog::accepted);        // 3. æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥        QTest::keyClicks(usernameEdit, &quot;testuser&quot;);        QTest::keyClicks(passwordEdit, &quot;password&quot;);        // 4. æ¨¡æ‹Ÿç‚¹å‡»        QTest::mouseClick(loginButton, Qt::LeftButton);        // 5. éªŒè¯ä¿¡å·æ˜¯å¦è¢«å‘å°„        QCOMPARE(loginSpy.count(), 1);    &#125;&#125;;QTEST_MAIN(TestLoginDialog) // GUI æµ‹è¯•éœ€è¦ QApplicationï¼Œä½¿ç”¨ QTEST_MAIN#include &quot;test_login_dialog.moc&quot;\n\nç¬¬äº”æ­¥ï¼šä½¿ç”¨æ¨¡æ‹Ÿå¯¹è±¡ (Mocking)å½“è¢«æµ‹è¯•çš„ä»£ç ä¾èµ–äºå¤–éƒ¨ç³»ç»Ÿï¼ˆå¦‚ç½‘ç»œã€æ•°æ®åº“ï¼‰æ—¶ï¼Œä½¿ç”¨æ¨¡æ‹Ÿå¯¹è±¡ï¼ˆMockï¼‰æ¥éš”ç¦»ä¾èµ–ï¼Œä½¿æµ‹è¯•æ›´å¿«é€Ÿã€æ›´ç¨³å®šã€‚\n// --- 1. å®šä¹‰ä¸€ä¸ªé€šç”¨æ¥å£ ---class INetworkManager &#123;public:    virtual ~INetworkManager() &#123;&#125;    virtual QString fetchData(const QUrl &amp;url) = 0;&#125;;// --- 2. ä¸šåŠ¡ç±»ä¾èµ–äºæ¥å£ï¼Œè€Œä¸æ˜¯å…·ä½“å®ç° ---class DataProcessor &#123;public:    DataProcessor(INetworkManager *networkManager) : m_net(networkManager) &#123;&#125;    QString processUrl(const QUrl &amp;url) &#123;        QString data = m_net-&gt;fetchData(url);        return &quot;Processed: &quot; + data.toUpper();    &#125;private:    INetworkManager *m_net;&#125;;// --- 3. åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿå®ç°ç”¨äºæµ‹è¯• ---class MockNetworkManager : public INetworkManager &#123;public:    QString fetchData(const QUrl &amp;url) override &#123;        // åœ¨æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ä¸è¿›è¡ŒçœŸå®ç½‘ç»œè¯·æ±‚ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›ä¸€ä¸ªé¢„è®¾å€¼        if (url.toString().contains(&quot;test&quot;)) &#123;            return &quot;mock_data&quot;;        &#125;        return &quot;&quot;;    &#125;&#125;;// --- 4. ç¼–å†™æµ‹è¯•ç”¨ä¾‹ ---class TestDataProcessor : public QObject &#123;    Q_OBJECTprivate slots:    void testProcessing() &#123;        MockNetworkManager mockNet;        DataProcessor processor(&amp;mockNet);        QString result = processor.processUrl(QUrl(&quot;http://test.com&quot;));        QCOMPARE(result, QString(&quot;Processed: MOCK_DATA&quot;));    &#125;&#125;;\n\nç¬¬å…­æ­¥ï¼šè¿è¡Œæµ‹è¯•ä¸ç”ŸæˆæŠ¥å‘Šç¼–è¯‘ä½ çš„æµ‹è¯•é¡¹ç›®åï¼Œä¼šç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚ç›´æ¥è¿è¡Œå®ƒå°†åœ¨æ§åˆ¶å°æ˜¾ç¤ºæµ‹è¯•ç»“æœã€‚\nå‘½ä»¤è¡Œå‚æ•°Qt Test æ”¯æŒä¸°å¯Œçš„å‘½ä»¤è¡Œå‚æ•°æ¥æ§åˆ¶æµ‹è¯•æ‰§è¡Œå’Œè¾“å‡ºã€‚\n\nè¿è¡Œç‰¹å®šæµ‹è¯•: my_test_executable testAddition\nè¾“å‡ºä¸º XML æ ¼å¼: my_test_executable -o my_report.xml,xunitxml\nè¾“å‡ºä¸º CSV æ ¼å¼: my_test_executable -o my_report.csv,csv\n\nç”Ÿæˆçš„ xunitxml æ ¼å¼çš„æŠ¥å‘Šå¯ä»¥è¢« Jenkinsã€GitLab CIã€GitHub Actions ç­‰å‡ ä¹æ‰€æœ‰ CI&#x2F;CD å·¥å…·è¯†åˆ«å’Œå±•ç¤ºã€‚\né™„å½•ï¼šæŒç»­é›†æˆ (CI&#x2F;CD)åœ¨ CI&#x2F;CD æµç¨‹ä¸­è‡ªåŠ¨è¿è¡Œå•å…ƒæµ‹è¯•æ˜¯ä¿è¯é¡¹ç›®è´¨é‡çš„å…³é”®ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€åŒ–çš„ GitHub Actions å·¥ä½œæµç¤ºä¾‹ã€‚\n.github/workflows/ci.yml:\nname: Qt CIon: [push, pull_request]jobs:  test:    runs-on: ubuntu-latest    steps:    - uses: actions/checkout@v3    - name: Install Qt      uses: jurplel/install-qt-action@v3      with:        version: &#x27;6.2.4&#x27; # é€‰æ‹©ä½ çš„ Qt ç‰ˆæœ¬    - name: Build Project      run: |        qmake        make -j$(nproc)    - name: Run Tests      run: |        ./test_project # è¿è¡Œæµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","å•å…ƒæµ‹è¯•","Qt Test","TDD","è‡ªåŠ¨åŒ–æµ‹è¯•"]},{"title":"Qt éŸ³é¢‘å½•åˆ¶æŒ‡å—","url":"/posts/df73c2a8/","content":"Qt éŸ³é¢‘å½•åˆ¶æŒ‡å—ç›®å½•\næ¦‚è¿°\nç¬¬ä¸€æ­¥ï¼šé¡¹ç›®è®¾ç½®ä¸UIè®¾è®¡\nç¬¬äºŒæ­¥ï¼šå®ç°å½•éŸ³é€»è¾‘\nç¬¬ä¸‰æ­¥ï¼šå¤„ç†WAVæ–‡ä»¶å¤´\nå®Œæ•´ä»£ç å‚è€ƒ\né«˜çº§åŠŸèƒ½å±•æœ› (æ–‡å­—è¯´æ˜)\nå¸¸è§é—®é¢˜\n\næ¦‚è¿°æœ¬æŒ‡å—å°†ä»¥ä¸€ä¸ªæ¸…æ™°ã€å¾ªåºæ¸è¿›çš„æ–¹å¼ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨ Qt çš„ QAudioInput ç±»æ¥å®ç°åŸºç¡€çš„éŸ³é¢‘å½•åˆ¶åŠŸèƒ½ï¼Œå¹¶å°†å½•åˆ¶çš„åŸå§‹éŸ³é¢‘æ•°æ®ä¿å­˜ä¸ºå¯æ’­æ”¾çš„ .wav æ–‡ä»¶ã€‚\næ ¸å¿ƒç»„ä»¶\nQAudioDeviceInfo: ç”¨äºæŸ¥è¯¢å’Œé€‰æ‹©å¯ç”¨çš„éŸ³é¢‘è¾“å…¥è®¾å¤‡ï¼ˆå¦‚éº¦å…‹é£ï¼‰ã€‚\nQAudioFormat: ç”¨äºå®šä¹‰å½•éŸ³çš„å‚æ•°ï¼Œå¦‚é‡‡æ ·ç‡ã€å£°é“æ•°ã€é‡‡æ ·ä½æ·±ç­‰ã€‚\nQAudioInput: æ ¸å¿ƒç±»ï¼Œç”¨äºä»æŒ‡å®šçš„è®¾å¤‡ä»¥æŒ‡å®šçš„æ ¼å¼æ•è·éŸ³é¢‘æ•°æ®ã€‚\nQFile: ä¸€ä¸ªç»§æ‰¿è‡ª QIODevice çš„ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®© QAudioInput å°†éŸ³é¢‘æ•°æ®å†™å…¥ä¸€ä¸ª QFile å¯¹è±¡ã€‚\n\nç¬¬ä¸€æ­¥ï¼šé¡¹ç›®è®¾ç½®ä¸UIè®¾è®¡1. é¡¹ç›®é…ç½® (.pro æ–‡ä»¶)åˆ›å»ºä¸€ä¸ªæ–°çš„ Qt Widgets Application é¡¹ç›®ï¼Œå¹¶ç¡®ä¿ .pro æ–‡ä»¶ä¸­åŒ…å«äº† multimedia æ¨¡å—ã€‚\nQT += core gui multimediaGREATER_THAN_QT_5 &#123;    QT += widgets&#125;TARGET = AudioRecorderAppTEMPLATE = appSOURCES += main.cpp mainwindow.cppHEADERS += mainwindow.hFORMS   += mainwindow.ui\n\n2. UI è®¾è®¡ (mainwindow.ui)åœ¨ Qt Designer ä¸­ï¼Œè®¾è®¡ä¸€ä¸ªç®€å•çš„ä¸»çª—å£ç•Œé¢ï¼ŒåŒ…å«ä»¥ä¸‹æ§ä»¶ï¼š\n\nQComboBox (deviceComboBox): ç”¨äºé€‰æ‹©è¾“å…¥è®¾å¤‡ã€‚\nQPushButton (recordButton): ç”¨äºå¼€å§‹å½•éŸ³ã€‚\nQPushButton (stopButton): ç”¨äºåœæ­¢å½•éŸ³ã€‚\nQLabel (statusLabel): ç”¨äºæ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼ˆå¦‚â€œæ­£åœ¨å½•éŸ³â€¦â€ã€â€œå·²åœæ­¢â€ï¼‰ã€‚\n\nç¬¬äºŒæ­¥ï¼šå®ç°å½•éŸ³é€»è¾‘æˆ‘ä»¬å°†æ‰€æœ‰å½•éŸ³é€»è¾‘éƒ½å°è£…åœ¨ MainWindow ç±»ä¸­ï¼Œä»¥ä¿æŒç¤ºä¾‹çš„ç®€æ´æ€§ã€‚\n1. æ·»åŠ æˆå‘˜å˜é‡åœ¨ mainwindow.h ä¸­ï¼Œæ·»åŠ  QAudioInput å’Œ QFile çš„æŒ‡é’ˆã€‚\n// mainwindow.h#include &lt;QAudioInput&gt;#include &lt;QFile&gt;class MainWindow : public QMainWindow &#123;    // ...private:    Ui::MainWindow *ui;    QAudioInput *m_audioInput = nullptr;    QFile *m_outputFile = nullptr;    QAudioDeviceInfo m_selectedDevice;&#125;;\n\n2. åˆå§‹åŒ–è®¾å¤‡åˆ—è¡¨åœ¨ mainwindow.cpp çš„æ„é€ å‡½æ•°ä¸­ï¼ŒæŸ¥æ‰¾å¯ç”¨çš„éŸ³é¢‘è¾“å…¥è®¾å¤‡å¹¶å¡«å……åˆ° QComboBox ä¸­ã€‚\n// mainwindow.cpp#include &quot;mainwindow.h&quot;#include &quot;ui_mainwindow.h&quot;#include &lt;QAudioDeviceInfo&gt;#include &lt;QMessageBox&gt;#include &lt;QFileDialog&gt;MainWindow::MainWindow(QWidget *parent)    : QMainWindow(parent), ui(new Ui::MainWindow) &#123;    ui-&gt;setupUi(this);    ui-&gt;stopButton-&gt;setEnabled(false);    // 1. å¡«å……è®¾å¤‡åˆ—è¡¨    const auto devices = QAudioDeviceInfo::availableDevices(QAudio::AudioInput);    for (const QAudioDeviceInfo &amp;deviceInfo : devices) &#123;        ui-&gt;deviceComboBox-&gt;addItem(deviceInfo.deviceName(), QVariant::fromValue(deviceInfo));    &#125;    // 2. è¿æ¥ä¿¡å·æ§½    connect(ui-&gt;recordButton, &amp;QPushButton::clicked, this, &amp;MainWindow::startRecording);    connect(ui-&gt;stopButton, &amp;QPushButton::clicked, this, &amp;MainWindow::stopRecording);&#125;\n\n3. å¼€å§‹ä¸åœæ­¢å½•éŸ³// mainwindow.cppvoid MainWindow::startRecording() &#123;    // 1. è·å–é€‰ä¸­çš„è®¾å¤‡    int selectedIndex = ui-&gt;deviceComboBox-&gt;currentIndex();    if (selectedIndex &lt; 0) &#123;        QMessageBox::warning(this, &quot;é”™è¯¯&quot;, &quot;æ²¡æœ‰é€‰æ‹©æœ‰æ•ˆçš„éŸ³é¢‘è¾“å…¥è®¾å¤‡ã€‚&quot;);        return;    &#125;    m_selectedDevice = ui-&gt;deviceComboBox-&gt;itemData(selectedIndex).value&lt;QAudioDeviceInfo&gt;();    // 2. è®¾ç½®éŸ³é¢‘æ ¼å¼ (ä¾‹å¦‚: 44.1kHz, 16-bit, ç«‹ä½“å£°)    QAudioFormat format;    format.setSampleRate(44100);    format.setChannelCount(2);    format.setSampleSize(16);    format.setSampleType(QAudioFormat::SignedInt);    format.setByteOrder(QAudioFormat::LittleEndian);    format.setCodec(&quot;audio/pcm&quot;);    // 3. æ£€æŸ¥è®¾å¤‡æ˜¯å¦æ”¯æŒæ­¤æ ¼å¼    if (!m_selectedDevice.isFormatSupported(format)) &#123;        QMessageBox::warning(this, &quot;é”™è¯¯&quot;, &quot;æ‰€é€‰è®¾å¤‡ä¸æ”¯æŒå½“å‰éŸ³é¢‘æ ¼å¼ã€‚&quot;);        return;    &#125;    // 4. è®¾ç½®è¾“å‡ºæ–‡ä»¶    QString savePath = QFileDialog::getSaveFileName(this, &quot;ä¿å­˜å½•éŸ³&quot;, &quot;&quot;, &quot;WAV æ–‡ä»¶ (*.wav)&quot;);    if (savePath.isEmpty()) return;    m_outputFile = new QFile(savePath, this);    if (!m_outputFile-&gt;open(QIODevice::WriteOnly | QIODevice::Truncate)) &#123;        QMessageBox::warning(this, &quot;é”™è¯¯&quot;, &quot;æ— æ³•æ‰“å¼€è¾“å‡ºæ–‡ä»¶ã€‚&quot;);        return;    &#125;    // 5. åˆ›å»ºå¹¶å¯åŠ¨ QAudioInput    m_audioInput = new QAudioInput(m_selectedDevice, format, this);    m_audioInput-&gt;start(m_outputFile); // ç›´æ¥å°†éŸ³é¢‘æ•°æ®å†™å…¥æ–‡ä»¶    // æ›´æ–°UIçŠ¶æ€    ui-&gt;recordButton-&gt;setEnabled(false);    ui-&gt;stopButton-&gt;setEnabled(true);    ui-&gt;statusLabel-&gt;setText(&quot;æ­£åœ¨å½•éŸ³...&quot;);&#125;void MainWindow::stopRecording() &#123;    if (!m_audioInput) return;    // 1. åœæ­¢å½•éŸ³    m_audioInput-&gt;stop();    // 2. æ¸…ç†èµ„æº    m_outputFile-&gt;close();    delete m_audioInput;    m_audioInput = nullptr;    // æ›´æ–°UIçŠ¶æ€    ui-&gt;recordButton-&gt;setEnabled(true);    ui-&gt;stopButton-&gt;setEnabled(false);    ui-&gt;statusLabel-&gt;setText(&quot;å½•éŸ³å·²åœæ­¢ã€‚&quot;);&#125;\n\nç¬¬ä¸‰æ­¥ï¼šå¤„ç†WAVæ–‡ä»¶å¤´QAudioInput å½•åˆ¶çš„æ˜¯çº¯å‡€çš„ PCM éŸ³é¢‘æ•°æ®ã€‚ä¸ºäº†è®©æ™®é€šæ’­æ”¾å™¨èƒ½è¯†åˆ«ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ–‡ä»¶å¼€å¤´å†™å…¥ä¸€ä¸ª WAV æ ¼å¼çš„å¤´éƒ¨ä¿¡æ¯ã€‚ç”±äºå½•åˆ¶å‰ä¸çŸ¥é“æ–‡ä»¶æ€»å¤§å°ï¼Œæˆ‘ä»¬é‡‡ç”¨â€œå ä½-å›å¡«â€çš„æ–¹å¼ã€‚\n1. å½•åˆ¶å‰å†™å…¥å ä½æ–‡ä»¶å¤´ä¿®æ”¹ startRecording å‡½æ•°ï¼Œåœ¨ m_audioInput-&gt;start(m_outputFile) ä¹‹å‰åŠ å…¥å†™æ–‡ä»¶å¤´çš„é€»è¾‘ã€‚\n// åœ¨ startRecording() ä¸­...if (!m_outputFile-&gt;open(QIODevice::WriteOnly | QIODevice::Truncate)) &#123; /*...*/ &#125;// æ–°å¢ï¼šå†™å…¥ä¸€ä¸ª44å­—èŠ‚çš„å ä½WAVå¤´writeWavHeader(m_outputFile, format, 0);m_audioInput = new QAudioInput(m_selectedDevice, format, this);m_audioInput-&gt;start(m_outputFile);// ...\n\n2. å½•åˆ¶åæ›´æ–°æ–‡ä»¶å¤´ä¿®æ”¹ stopRecording å‡½æ•°ï¼Œåœ¨ m_outputFile-&gt;close() ä¹‹åï¼Œé‡æ–°æ‰“å¼€æ–‡ä»¶å¹¶æ›´æ–°æ–‡ä»¶å¤´ä¸­çš„é•¿åº¦ä¿¡æ¯ã€‚\n// åœ¨ stopRecording() ä¸­...m_audioInput-&gt;stop();qint64 fileSize = m_outputFile-&gt;size();m_outputFile-&gt;close();// æ–°å¢ï¼šæ›´æ–°WAVå¤´çš„é•¿åº¦ä¿¡æ¯updateWavHeader(m_outputFile-&gt;fileName(), fileSize);delete m_audioInput;// ...\n\n3. WAV æ–‡ä»¶å¤´è¾…åŠ©å‡½æ•°å°†è¿™äº›å‡½æ•°æ·»åŠ åˆ° mainwindow.cpp æˆ–ä¸€ä¸ªå•ç‹¬çš„å·¥å…·ç±»ä¸­ã€‚\n// mainwindow.cpp#include &lt;QDataStream&gt;// å†™ä¸€ä¸ªå ä½çš„WAVå¤´void writeWavHeader(QFile *file, const QAudioFormat &amp;format, qint64 dataSize) &#123;    QDataStream out(file);    out.setByteOrder(QDataStream::LittleEndian);    out.writeRawData(&quot;RIFF&quot;, 4);    out &lt;&lt; quint32(dataSize + 36);    out.writeRawData(&quot;WAVE&quot;, 4);    out.writeRawData(&quot;fmt &quot;, 4);    out &lt;&lt; quint32(16);    out &lt;&lt; quint16(1); // PCM    out &lt;&lt; quint16(format.channelCount());    out &lt;&lt; quint32(format.sampleRate());    out &lt;&lt; quint32(format.sampleRate() * format.channelCount() * format.sampleSize() / 8); // byteRate    out &lt;&lt; quint16(format.channelCount() * format.sampleSize() / 8); // blockAlign    out &lt;&lt; quint16(format.sampleSize());    out.writeRawData(&quot;data&quot;, 4);    out &lt;&lt; quint32(dataSize);&#125;// å½•åˆ¶ç»“æŸåæ›´æ–°WAVå¤´çš„å°ºå¯¸ä¿¡æ¯void updateWavHeader(const QString &amp;fileName, qint64 fileSize) &#123;    QFile file(fileName);    if (!file.open(QIODevice::ReadWrite)) return;    qint64 dataSize = fileSize - 44;    QDataStream out(&amp;file);    out.setByteOrder(QDataStream::LittleEndian);    file.seek(4);    out &lt;&lt; quint32(dataSize + 36);    file.seek(40);    out &lt;&lt; quint32(dataSize);    file.close();&#125;\n\nå®Œæ•´ä»£ç å‚è€ƒ(ä¸ºç®€æ´èµ·è§ï¼Œæ­¤å¤„çœç•¥äº†å®Œæ•´çš„ main.cpp å’Œ mainwindow.h æ–‡ä»¶ï¼Œä¸Šæ–‡å·²åŒ…å«æ‰€æœ‰æ ¸å¿ƒé€»è¾‘ã€‚)\né«˜çº§åŠŸèƒ½å±•æœ› (æ–‡å­—è¯´æ˜)\nå®æ—¶éŸ³é¢‘ç›‘æ§ (ç”µå¹³è¡¨): ä¸å°† QFile ä¼ é€’ç»™ start()ï¼Œè€Œæ˜¯è°ƒç”¨ QIODevice *device = m_audioInput-&gt;start()ã€‚ç„¶åè¿æ¥ device çš„ readyRead ä¿¡å·ï¼Œä»ä¸­å®æ—¶è¯»å–éŸ³é¢‘æ•°æ®å—ï¼Œè®¡ç®—å…¶æŒ¯å¹…ï¼ˆRMSæˆ–å³°å€¼ï¼‰ï¼Œå¹¶æ›´æ–° UI ä¸Šçš„ QProgressBarã€‚\nç¼–ç ä¸º MP3: QAudioInput åªäº§ç”ŸåŸå§‹çš„ PCM æ•°æ®ã€‚è¦å½•åˆ¶ä¸º MP3ï¼Œä½ éœ€è¦å°†å®æ—¶è¯»å–çš„éŸ³é¢‘æ•°æ®å—ä¼ é€’ç»™ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ MP3 ç¼–ç åº“ï¼ˆå¦‚ LAMEï¼‰ï¼Œç„¶åå°†ç¼–ç åçš„æ•°æ®å†™å…¥æ–‡ä»¶ã€‚\næš‚åœä¸æ¢å¤: QAudioInput æä¾›äº† suspend() å’Œ resume() æ–¹æ³•ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°æš‚åœå’Œæ¢å¤åŠŸèƒ½ã€‚\n\nå¸¸è§é—®é¢˜Q1: å½•åˆ¶çš„ .wav æ–‡ä»¶æ— æ³•æ’­æ”¾æˆ–æ’­æ”¾é€Ÿåº¦ä¸æ­£å¸¸?A: è¿™å‡ ä¹æ€»æ˜¯å› ä¸º WAV æ–‡ä»¶å¤´ä¿¡æ¯ä¸æ­£ç¡®ã€‚è¯·ä»”ç»†æ£€æŸ¥ writeWavHeader å’Œ updateWavHeader å‡½æ•°ä¸­çš„è®¡ç®—ï¼Œç‰¹åˆ«æ˜¯ dataSize å’Œ riffSize æ˜¯å¦æ­£ç¡®ã€‚\nQ2: ç¨‹åºæç¤ºâ€œé»˜è®¤éŸ³é¢‘è¾“å…¥è®¾å¤‡ä¸æ”¯æŒè¯¥æ ¼å¼â€?A: ä½ çš„éº¦å…‹é£å¯èƒ½ä¸æ”¯æŒä½ è®¾ç½®çš„ QAudioFormatï¼ˆä¾‹å¦‚ï¼Œä¸æ”¯æŒ 48000Hz é‡‡æ ·ç‡æˆ–ç«‹ä½“å£°å½•åˆ¶ï¼‰ã€‚å¯ä»¥å°è¯•ä¸€ä¸ªæ›´é€šç”¨çš„æ ¼å¼ï¼Œå¦‚ 44100Hz é‡‡æ ·ç‡ã€16ä½ã€å•å£°é“ã€‚\nQ3: å½•éŸ³æ—¶æœ‰æ‚éŸ³æˆ–å™ªéŸ³?A: è¿™å¯èƒ½æ˜¯ç¡¬ä»¶é—®é¢˜ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¼“å†²åŒºå¤§å°ä¸åˆé€‚ã€‚å¯ä»¥å°è¯•é€šè¿‡ m_audioInput-&gt;setBufferSize() è®¾ç½®ä¸€ä¸ªæ›´å¤§çš„ç¼“å†²åŒºã€‚\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","å¤šåª’ä½“","QAudioInput","éŸ³é¢‘å½•åˆ¶","WAV"]},{"title":"Qt å›½é™…åŒ–æŒ‡å—","url":"/posts/6d91761d/","content":"Qt å›½é™…åŒ–æŒ‡å—ç›®å½•\næ¦‚è¿°ï¼šQt çš„ i18n å·¥ä½œæµç¨‹\nç¬¬ä¸€æ­¥ï¼šåœ¨ä»£ç ä¸­æ ‡è®°å¾…ç¿»è¯‘æ–‡æœ¬\nç¬¬äºŒæ­¥ï¼šé…ç½®é¡¹ç›® (.pro) æ–‡ä»¶\nç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨å·¥å…·ç”Ÿæˆå’Œç¿»è¯‘\nç¬¬å››æ­¥ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­åŠ è½½ç¿»è¯‘\nç¬¬äº”æ­¥ï¼šå®ç°åŠ¨æ€è¯­è¨€åˆ‡æ¢\nå¤„ç†æ•°å­—ã€æ—¥æœŸå’Œè´§å¸çš„æœ¬åœ°åŒ–\n\næ¦‚è¿°ï¼šQt çš„ i18n å·¥ä½œæµç¨‹å›½é™…åŒ– (i18n) æ˜¯æŒ‡è®©ä½ çš„åº”ç”¨ç¨‹åºèƒ½å¤Ÿé€‚åº”ä¸åŒè¯­è¨€å’Œåœ°åŒºçš„è¿‡ç¨‹ã€‚Qt æä¾›äº†ä¸€å¥—å¼ºå¤§è€Œç›´æ¥çš„å·¥å…·é“¾æ¥å®Œæˆè¿™é¡¹å·¥ä½œï¼Œå…¶æ ¸å¿ƒæµç¨‹å¦‚ä¸‹ï¼š\n\nåŒ…è£¹ (Wrap): åœ¨ä½ çš„ C++ æºä»£ç ä¸­ï¼Œå°†æ‰€æœ‰éœ€è¦è¢«ç¿»è¯‘çš„ç”¨æˆ·ç•Œé¢å­—ç¬¦ä¸²ç”¨ tr() å‡½æ•°åŒ…è£¹èµ·æ¥ã€‚\næ›´æ–° (Update): ä½¿ç”¨ Qt çš„å‘½ä»¤è¡Œå·¥å…· lupdate æ‰«æä½ çš„é¡¹ç›®æ–‡ä»¶ï¼Œå®ƒä¼šæ‰¾åˆ°æ‰€æœ‰è¢« tr() åŒ…è£¹çš„å­—ç¬¦ä¸²ï¼Œå¹¶ç”Ÿæˆæˆ–æ›´æ–° .ts (Translation Source) æ ¼å¼çš„ç¿»è¯‘æºæ–‡ä»¶ã€‚\nç¿»è¯‘ (Translate): ä½¿ç”¨ Qt æä¾›çš„å›¾å½¢åŒ–å·¥å…· Qt Linguist æ‰“å¼€ .ts æ–‡ä»¶ï¼Œç„¶åç”±ç¿»è¯‘äººå‘˜é€æ¡å¡«å†™ç›®æ ‡è¯­è¨€çš„è¯‘æ–‡ã€‚\nå‘å¸ƒ (Release): ä½¿ç”¨ Qt çš„å‘½ä»¤è¡Œå·¥å…· lrelease å°†ç¿»è¯‘å®Œæˆçš„ .ts æ–‡ä»¶ç¼–è¯‘æˆç´§å‡‘çš„äºŒè¿›åˆ¶ .qm (Qt Message) æ–‡ä»¶ã€‚ä½ çš„åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶å®é™…åŠ è½½çš„æ˜¯è¿™ä¸ª .qm æ–‡ä»¶ã€‚\nåŠ è½½ (Load): åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ï¼Œåˆ›å»ºä¸€ä¸ª QTranslator å¯¹è±¡ï¼ŒåŠ è½½å¯¹åº”çš„ .qm æ–‡ä»¶ï¼Œå¹¶å°†å…¶å®‰è£…åˆ°åº”ç”¨ç¨‹åºå®ä¾‹ä¸­ã€‚\n\nç¬¬ä¸€æ­¥ï¼šåœ¨ä»£ç ä¸­æ ‡è®°å¾…ç¿»è¯‘æ–‡æœ¬è¿™æ˜¯å›½é™…åŒ–çš„åŸºç¡€ã€‚ä¸ºäº†è®© lupdate å·¥å…·èƒ½è¯†åˆ«å‡ºå“ªäº›æ–‡æœ¬éœ€è¦ç¿»è¯‘ï¼Œä½ å¿…é¡»å°†å®ƒä»¬ç”¨ tr() å‡½æ•°åŒ…è£¹èµ·æ¥ã€‚tr() æ˜¯ QObject çš„ä¸€ä¸ªæˆå‘˜å‡½æ•°ã€‚\n// mywidget.cpp#include &lt;QPushButton&gt;#include &lt;QLabel&gt;MyWidget::MyWidget(QWidget *parent) : QWidget(parent) &#123;    // æ­£ç¡®çš„åšæ³•ï¼šä½¿ç”¨ tr()    auto *label = new QLabel(tr(&quot;Username:&quot;), this);    auto *button = new QPushButton(tr(&quot;Submit&quot;), this);    // é”™è¯¯çš„åšæ³•ï¼šä½¿ç”¨è£¸å­—ç¬¦ä¸²    // auto *label = new QLabel(&quot;Username:&quot;, this); // è¿™ä¸ªå­—ç¬¦ä¸²ä¸ä¼šè¢«ç¿»è¯‘&#125;\n\nå¤„ç†å¤æ•°å½“æ–‡æœ¬éœ€è¦æ ¹æ®æ•°é‡å˜åŒ–æ—¶ï¼ˆä¾‹å¦‚â€œ1ä¸ªæ–‡ä»¶â€ vs â€œå¤šä¸ªæ–‡ä»¶â€ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ tr() çš„ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚\nint fileCount = getFileCount();QString text = tr(&quot;%n file(s) found.&quot;, &quot;&quot;, fileCount);// å½“ fileCount ä¸º 1 æ—¶ï¼Œç¿»è¯‘å·¥å…·ä¼šè®©ä½ ç¿»è¯‘ &quot;%n file found.&quot;// å½“ fileCount ä¸ä¸º 1 æ—¶ï¼Œä¼šè®©ä½ ç¿»è¯‘ &quot;%n files found.&quot;\n\nç¬¬äºŒæ­¥ï¼šé…ç½®é¡¹ç›® (.pro) æ–‡ä»¶åœ¨ä½ çš„ .pro é¡¹ç›®æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ TRANSLATIONS å˜é‡æ¥å£°æ˜ä½ è®¡åˆ’æ”¯æŒçš„è¯­è¨€ä»¥åŠå¯¹åº”çš„ .ts æ–‡ä»¶ã€‚\n# Qt å›½é™…åŒ–æŒ‡å—SOURCES += main.cpp \\           mainwindow.cppHEADERS += mainwindow.hFORMS += mainwindow.ui# Qt å›½é™…åŒ–æŒ‡å—TRANSLATIONS = \\    translations/my_app_de.ts \\    translations/my_app_fr.ts \\    translations/my_app_zh_CN.ts\n\nç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨å·¥å…·ç”Ÿæˆå’Œç¿»è¯‘1. lupdate - ç”Ÿæˆ&#x2F;æ›´æ–° .ts æ–‡ä»¶æ‰“å¼€ä¸€ä¸ª Qt å‘½ä»¤è¡Œå·¥å…·ï¼ˆä¾‹å¦‚ Qt Creator ä¸­çš„å‘½ä»¤è¡Œï¼Œæˆ–æ‰‹åŠ¨é…ç½®å¥½ç¯å¢ƒçš„ç»ˆç«¯ï¼‰ï¼Œè¿›å…¥ä½ çš„é¡¹ç›®æ ¹ç›®å½•ï¼Œç„¶åè¿è¡Œï¼š\n# Qt å›½é™…åŒ–æŒ‡å—lupdate my_app.pro\n\næ‰§è¡Œåï¼Œtranslations/ ç›®å½•ä¸‹å°±ä¼šç”Ÿæˆ my_app_de.ts, my_app_fr.ts ç­‰æ–‡ä»¶ã€‚\n2. Qt Linguist - è¿›è¡Œç¿»è¯‘Qt Linguist æ˜¯ä¸€ä¸ªå›¾å½¢åŒ–çš„ç¿»è¯‘å·¥å…·ã€‚\n\næ‰“å¼€ Qt Linguistã€‚\næ–‡ä»¶ -&gt; æ‰“å¼€â€¦ -&gt; é€‰æ‹©ä¸€ä¸ª .ts æ–‡ä»¶ï¼ˆä¾‹å¦‚ my_app_zh_CN.tsï¼‰ã€‚\nåœ¨å·¦ä¾§çš„â€œä¸Šä¸‹æ–‡â€åˆ—è¡¨ä¸­é€‰æ‹©ä¸€é¡¹ï¼Œç„¶ååœ¨å³ä¾§çš„â€œç¿»è¯‘â€åŒºåŸŸå¡«å…¥ä¸­æ–‡è¯‘æ–‡ã€‚\nå®Œæˆåï¼Œç‚¹å‡»å·¥å…·æ ä¸Šçš„â€œå®Œæˆâ€å¤é€‰æ¡†ã€‚\nä¿å­˜æ–‡ä»¶ã€‚\n\n3. lrelease - å‘å¸ƒ .qm æ–‡ä»¶ç¿»è¯‘å®Œæˆåï¼Œä½¿ç”¨ lrelease å·¥å…·å°† .ts æ–‡ä»¶ç¼–è¯‘æˆåº”ç”¨ç¨‹åºæœ€ç»ˆä½¿ç”¨çš„ .qm æ–‡ä»¶ã€‚\nlrelease my_app.pro\næ‰§è¡Œåï¼Œæ¯ä¸ª .ts æ–‡ä»¶æ—è¾¹éƒ½ä¼šç”Ÿæˆä¸€ä¸ªåŒåçš„ .qm æ–‡ä»¶ã€‚\næç¤º: å°† .qm æ–‡ä»¶æ·»åŠ åˆ°ä½ çš„é¡¹ç›®çš„èµ„æºæ–‡ä»¶ (.qrc) ä¸­æ˜¯æœ€ä½³å®è·µï¼Œè¿™æ ·å®ƒä»¬ä¼šè¢«ç¼–è¯‘è¿›æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚\nç¬¬å››æ­¥ï¼šåœ¨åº”ç”¨ç¨‹åºä¸­åŠ è½½ç¿»è¯‘åœ¨ main.cpp ä¸­ï¼Œæ ¹æ®å½“å‰çš„ç³»ç»Ÿè¯­è¨€ç¯å¢ƒï¼ŒåŠ è½½å¯¹åº”çš„ .qm æ–‡ä»¶ã€‚\n// main.cpp#include &lt;QApplication&gt;#include &lt;QTranslator&gt;#include &lt;QLocale&gt;#include &lt;QLibraryInfo&gt;int main(int argc, char *argv[]) &#123;    QApplication app(argc, argv);    QTranslator translator;    // è·å–ç³»ç»Ÿå½“å‰çš„è¯­è¨€ç¯å¢ƒ    QLocale currentLocale = QLocale::system();    // åŠ è½½æˆ‘ä»¬è‡ªå·±çš„ç¿»è¯‘æ–‡ä»¶    // æ³¨æ„ï¼šè·¯å¾„ &quot;:/translations&quot; æ˜¯æŒ‡åœ¨ qrc èµ„æºæ–‡ä»¶ä¸­çš„è·¯å¾„    if (translator.load(currentLocale, &quot;my_app&quot;, &quot;_&quot;, &quot;:/translations&quot;)) &#123;        app.installTranslator(&amp;translator);    &#125;    // (å¯é€‰) åŠ è½½ Qt è‡ªèº«çš„æ ‡å‡†ç¿»è¯‘ï¼ˆä¾‹å¦‚ &quot;OK&quot;, &quot;Cancel&quot; æŒ‰é’®çš„ç¿»è¯‘ï¼‰    QTranslator qtBaseTranslator;    if (qtBaseTranslator.load(&quot;qtbase_&quot; + currentLocale.name(),                               QLibraryInfo::location(QLibraryInfo::TranslationsPath))) &#123;        app.installTranslator(&amp;qtBaseTranslator);    &#125;    MainWindow w;    w.show();    return app.exec();&#125;\n\nç¬¬äº”æ­¥ï¼šå®ç°åŠ¨æ€è¯­è¨€åˆ‡æ¢è¦è®©ç”¨æˆ·åœ¨ç¨‹åºè¿è¡Œæ—¶åˆ‡æ¢è¯­è¨€ï¼Œä½ éœ€è¦ï¼š\n\nä¸€ä¸ªåŠ è½½æ–°ç¿»è¯‘æ–‡ä»¶çš„æœºåˆ¶ã€‚\nä¸€ä¸ªè®©æ‰€æœ‰çª—å£å’Œæ§ä»¶åˆ·æ–°å…¶æ–‡æœ¬çš„æœºåˆ¶ã€‚\n\nQt é€šè¿‡ QEvent::LanguageChange äº‹ä»¶æ¥ä¼˜é›…åœ°å¤„ç†ç¬¬äºŒç‚¹ã€‚\n// åœ¨ä½ çš„ä¸»çª—å£æˆ–è®¾ç½®å¯¹è¯æ¡†ä¸­// æˆå‘˜å˜é‡QTranslator m_translator;void switchLanguage(const QString&amp; langCode) &#123; // e.g., &quot;zh_CN&quot;    // 1. ç§»é™¤æ—§çš„ç¿»è¯‘å™¨    qApp-&gt;removeTranslator(&amp;m_translator);    // 2. åŠ è½½æ–°çš„ .qm æ–‡ä»¶    if (m_translator.load(&quot;:/translations/my_app_&quot; + langCode)) &#123;        // 3. å®‰è£…æ–°çš„ç¿»è¯‘å™¨        qApp-&gt;installTranslator(&amp;m_translator);    &#125;&#125;// åœ¨éœ€è¦æ›´æ–°ç•Œé¢çš„ QWidget å­ç±»ä¸­ï¼Œé‡å†™ changeEventvoid MyWidget::changeEvent(QEvent *event) &#123;    if (event-&gt;type() == QEvent::LanguageChange) &#123;        // å½“è¯­è¨€æ”¹å˜æ—¶ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šè¢«å‘é€åˆ°æ‰€æœ‰é¡¶çº§çª—å£        // åœ¨è¿™é‡Œé‡æ–°ç¿»è¯‘æ‰€æœ‰ UI æ–‡æœ¬        ui-&gt;retranslateUi(this); // å¦‚æœä½¿ç”¨ .ui æ–‡ä»¶        // æˆ–è€…æ‰‹åŠ¨è°ƒç”¨ tr()        // ui-&gt;myButton-&gt;setText(tr(&quot;Submit&quot;));    &#125;    QWidget::changeEvent(event);&#125;\nå½“ä½ å®‰è£…ä¸€ä¸ªæ–°çš„ç¿»è¯‘å™¨åï¼ŒQt ä¼šè‡ªåŠ¨å‘æ‰€æœ‰çª—å£å‘é€ LanguageChange äº‹ä»¶ï¼Œè§¦å‘ changeEventï¼Œä»è€Œåˆ·æ–°æ•´ä¸ª UIã€‚\nå¤„ç†æ•°å­—ã€æ—¥æœŸå’Œè´§å¸çš„æœ¬åœ°åŒ–ç¿»è¯‘æ–‡æœ¬åªæ˜¯å›½é™…åŒ–çš„ä¸€éƒ¨åˆ†ã€‚ä¸åŒåœ°åŒºå¯¹æ•°å­—ã€æ—¥æœŸå’Œè´§å¸çš„æ ¼å¼è¦æ±‚ä¹Ÿä¸åŒã€‚QLocale æ˜¯å¤„ç†è¿™äº›é—®é¢˜çš„å…³é”®ã€‚\n#include &lt;QLocale&gt;#include &lt;QDate&gt;// å‡è®¾å½“å‰ locale æ˜¯ &quot;de_DE&quot; (å¾·å›½)QLocale german(QLocale::German, QLocale::Germany);double number = 12345.67;QDate date(2025, 9, 21);// ä½¿ç”¨å¾·å›½çš„æ ¼å¼debug() &lt;&lt; german.toString(number, &#x27;f&#x27;, 2); // è¾“å‡º: &quot;12.345,67&quot;debug() &lt;&lt; german.toString(date, QLocale::LongFormat); // è¾“å‡º: &quot;Sonntag, 21. September 2025&quot;// ä½¿ç”¨ç¾å›½çš„æ ¼å¼QLocale american(QLocale::English, QLocale::UnitedStates);debug() &lt;&lt; american.toString(number, &#x27;f&#x27;, 2); // è¾“å‡º: &quot;12,345.67&quot;debug() &lt;&lt; american.toString(date, QLocale::LongFormat); // è¾“å‡º: &quot;Sunday, September 21, 2025&quot;\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","å›½é™…åŒ–","i18n","æœ¬åœ°åŒ–","QTranslator","lupdate"]},{"title":"Qt å¤šçº¿ç¨‹ç¼–ç¨‹æŒ‡å—","url":"/posts/f6798f2a/","content":"Qt å¤šçº¿ç¨‹ç¼–ç¨‹æŒ‡å—ç›®å½•\næ¦‚è¿°ï¼šä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹\nQt çº¿ç¨‹åŸºç¡€ï¼šQThread\næ–¹æ³•ä¸€ï¼šWorker-Object æ¨¡å¼ (å®˜æ–¹æ¨è)\næ–¹æ³•äºŒï¼šç»§æ‰¿ QThread (ç‰¹å®šåœºæ™¯)\nçº¿ç¨‹åŒæ­¥\né«˜çº§å¹¶å‘ï¼šQThreadPool ä¸ QtConcurrent\næœ€ä½³å®è·µä¸æ ¸å¿ƒåŸåˆ™\n\næ¦‚è¿°ï¼šä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹åœ¨ GUI åº”ç”¨ç¨‹åºä¸­ï¼Œä¸»çº¿ç¨‹ï¼ˆæˆ–ç§° GUI çº¿ç¨‹ï¼‰è´Ÿè´£å¤„ç†ç”¨æˆ·äº¤äº’å’Œç•Œé¢æ›´æ–°ã€‚å¦‚æœåœ¨è¿™ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼ˆå¦‚å¤æ‚çš„è®¡ç®—ã€ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶ I&#x2F;Oï¼‰ï¼Œç•Œé¢å°†ä¼šå†»ç»“ï¼Œæ— æ³•å“åº”ç”¨æˆ·æ“ä½œï¼Œå¯¼è‡´ç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒã€‚å¤šçº¿ç¨‹å…è®¸æˆ‘ä»¬å°†è¿™äº›è€—æ—¶æ“ä½œç§»åˆ°åå°çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä»è€Œä¿æŒç•Œé¢çš„æµç•…å“åº”ã€‚\nQt çº¿ç¨‹åŸºç¡€ï¼šQThreadQThread æ˜¯ Qt ä¸­ç®¡ç†çº¿ç¨‹çš„æ ¸å¿ƒç±»ã€‚ä¸€ä¸ªå¸¸è§çš„è¯¯è§£æ˜¯ QThread æœ¬èº«å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼ŒQThread æ˜¯ä¸€ä¸ªçº¿ç¨‹çš„æ§åˆ¶å™¨ï¼Œå®ƒå¯ä»¥ç®¡ç†ä¸€ä¸ªåœ¨æ“ä½œç³»ç»Ÿå±‚é¢ä¸Šè¿è¡Œçš„ç‹¬ç«‹æ‰§è¡Œæµã€‚\nçº¿ç¨‹äº²å’Œæ€§ (Thread Affinity)æ¯ä¸ª QObject å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªâ€œçº¿ç¨‹äº²å’Œæ€§â€ï¼Œæ„å‘³ç€å®ƒâ€œå±äºâ€æŸä¸ªç‰¹å®šçš„çº¿ç¨‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹è±¡å±äºåˆ›å»ºå®ƒçš„é‚£ä¸ªçº¿ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ object-&gt;moveToThread(thread) æ¥æ”¹å˜å¯¹è±¡çš„çº¿ç¨‹äº²å’Œæ€§ã€‚ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡è¢«ç§»åŠ¨åˆ°æ–°çº¿ç¨‹ï¼Œå®ƒçš„æ‰€æœ‰æ§½å‡½æ•°éƒ½ä¼šåœ¨è¯¥çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯ä¸­æ‰§è¡Œã€‚\næ–¹æ³•ä¸€ï¼šWorker-Object æ¨¡å¼ (å®˜æ–¹æ¨è)è¿™æ˜¯ä½¿ç”¨ QThread æœ€å¸¸è§ä¹Ÿæ˜¯æœ€è¢«æ¨èçš„æ–¹å¼ã€‚å®ƒéµå¾ªâ€œå°†å·¥ä½œå¯¹è±¡ç§»åˆ°çº¿ç¨‹ä¸­ï¼Œè€Œä¸æ˜¯ç»§æ‰¿ QThreadâ€çš„åŸåˆ™ã€‚\n\nåˆ›å»º Worker ç±»: åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª QObject çš„æ™®é€šç±»ï¼Œå°†è€—æ—¶ä»»åŠ¡å°è£…åœ¨ä¸€ä¸ªæ§½å‡½æ•°ä¸­ã€‚\nåˆ›å»º QThread å®ä¾‹: QThread ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ§åˆ¶å™¨å­˜åœ¨ã€‚\nç§»åŠ¨ Worker: è°ƒç”¨ worker-&gt;moveToThread(thread) å°†å·¥ä½œå¯¹è±¡ç§»åˆ°æ–°çº¿ç¨‹ã€‚\nè¿æ¥ä¿¡å·æ§½: ä½¿ç”¨ä¿¡å·æ§½æœºåˆ¶æ¥è§¦å‘ä»»åŠ¡å¼€å§‹ã€æŠ¥å‘Šè¿›åº¦å’Œè¿”å›ç»“æœã€‚\nå¯åŠ¨çº¿ç¨‹: è°ƒç”¨ thread-&gt;start() å¯åŠ¨çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯ã€‚\n\nç¤ºä¾‹ä»£ç worker.h:\n#ifndef WORKER_H#define WORKER_H#include &lt;QObject&gt;#include &lt;QDebug&gt;#include &lt;QThread&gt;class Worker : public QObject &#123;    Q_OBJECTpublic slots:    void doWork(int parameter) &#123;        qDebug() &lt;&lt; &quot;Worker started in thread:&quot; &lt;&lt; QThread::currentThread();        for (int i = 0; i &lt;= parameter; ++i) &#123;            qDebug() &lt;&lt; &quot;Working...&quot; &lt;&lt; i;            QThread::msleep(100); // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ        &#125;        emit resultReady(&quot;Work finished!&quot;);    &#125;signals:    void resultReady(const QString &amp;result);&#125;;#endif // WORKER_H\n\nmain.cpp (æˆ–ä½ çš„ä¸»æ§ç±»ä¸­):\n#include &lt;QCoreApplication&gt;#include &lt;QThread&gt;#include &quot;worker.h&quot;int main(int argc, char *argv[]) &#123;    QCoreApplication a(argc, argv);    QThread *thread = new QThread();    Worker *worker = new Worker();    worker-&gt;moveToThread(thread);    // å½“çº¿ç¨‹å¯åŠ¨æ—¶ï¼Œå¼€å§‹å·¥ä½œ    QObject::connect(thread, &amp;QThread::started, worker, [=]() &#123; worker-&gt;doWork(10); &#125;);    // å½“å·¥ä½œå®Œæˆæ—¶ï¼Œæ‰“å°ç»“æœå¹¶é€€å‡ºçº¿ç¨‹    QObject::connect(worker, &amp;Worker::resultReady, [&amp;](const QString &amp;result) &#123;        qDebug() &lt;&lt; &quot;Result from worker thread:&quot; &lt;&lt; result;        thread-&gt;quit();    &#125;);    // å½“çº¿ç¨‹é€€å‡ºæ—¶ï¼Œæ¸…ç†èµ„æº    QObject::connect(thread, &amp;QThread::finished, worker, &amp;QObject::deleteLater);    QObject::connect(thread, &amp;QThread::finished, thread, &amp;QObject::deleteLater);    thread-&gt;start();    qDebug() &lt;&lt; &quot;Main thread continues...&quot;;    return a.exec();&#125;\n\næ–¹æ³•äºŒï¼šç»§æ‰¿ QThread (ç‰¹å®šåœºæ™¯)åªæœ‰å½“ä½ éœ€è¦ä¸€ä¸ªæ²¡æœ‰äº‹ä»¶å¾ªç¯ã€åªæ‰§è¡Œä¸€ä¸ªé•¿æœŸé˜»å¡ä»»åŠ¡çš„çº¿ç¨‹æ—¶ï¼Œæ‰åº”è€ƒè™‘ç»§æ‰¿ QThread å¹¶é‡å†™ run() æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•æ— æ³•åœ¨çº¿ç¨‹ä¸­ä½¿ç”¨ä¿¡å·æ§½ã€‚\n#include &lt;QThread&gt;#include &lt;QDebug&gt;class SimpleThread : public QThread &#123;    Q_OBJECTprotected:    void run() override &#123;        qDebug() &lt;&lt; &quot;Subclassed thread started in thread:&quot; &lt;&lt; currentThread();        // æ‰§è¡Œä¸€ä¸ªç‹¬ç«‹çš„ã€é˜»å¡çš„ä»»åŠ¡        for (int i = 0; i &lt; 5; ++i) &#123;            qDebug() &lt;&lt; &quot;Processing in run():&quot; &lt;&lt; i;            msleep(500);        &#125;        qDebug() &lt;&lt; &quot;Subclassed thread finished.&quot;;    &#125;&#125;;// ä½¿ç”¨SimpleThread *myThread = new SimpleThread();myThread-&gt;start(); // run() æ–¹æ³•å°†åœ¨æ–°çº¿ç¨‹ä¸­æ‰§è¡ŒmyThread-&gt;wait();  // ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œæ¯•delete myThread;\n\n\n\n\nå¯¹æ¯”\nWorker-Object (moveToThread)\nç»§æ‰¿ QThread (run())\n\n\n\næ¨èåº¦\né«˜ (å®˜æ–¹æ¨è)\nä½ (ä»…é™ç‰¹å®šåœºæ™¯)\n\n\näº‹ä»¶å¾ªç¯\næœ‰\næ— \n\n\nä¿¡å·æ§½\næ”¯æŒ\nä¸æ”¯æŒ (åœ¨ run å†…éƒ¨)\n\n\né€‚ç”¨åœºæ™¯\nå¤§éƒ¨åˆ†éœ€è¦ä¸ä¸»çº¿ç¨‹é€šä¿¡çš„åå°ä»»åŠ¡\nçº¯ç²¹çš„ã€ç‹¬ç«‹çš„ã€é˜»å¡çš„è®¡ç®—ä»»åŠ¡\n\n\nçº¿ç¨‹åŒæ­¥å½“å¤šä¸ªçº¿ç¨‹éœ€è¦è®¿é—®å…±äº«æ•°æ®æ—¶ï¼Œå¿…é¡»ä½¿ç”¨åŒæ­¥æœºåˆ¶æ¥é¿å…æ•°æ®ç«äº‰å’Œä¸ä¸€è‡´ã€‚\n\nQMutex (äº’æ–¥é”): æœ€åŸºæœ¬çš„åŒæ­¥å·¥å…·ã€‚åœ¨ä»»ä½•æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½é”å®šäº’æ–¥é”ã€‚ä½¿ç”¨ QMutexLocker å¯ä»¥æ–¹ä¾¿åœ°å®ç° RAII å¼çš„åŠ é”å’Œè§£é”ã€‚\nQMutex mutex;int shared_counter = 0;void increment() &#123;    QMutexLocker locker(&amp;mutex); // æ„é€ æ—¶åŠ é”ï¼Œææ„æ—¶è§£é”    shared_counter++;&#125;\n\nQReadWriteLock (è¯»å†™é”):å…è®¸å¤šä¸ªâ€œè¯»è€…â€åŒæ—¶è®¿é—®æ•°æ®ï¼Œä½†â€œå†™è€…â€æ˜¯ç‹¬å çš„ã€‚é€‚ç”¨äºâ€œè¯»å¤šå†™å°‘â€çš„åœºæ™¯ï¼Œå¯ä»¥æé«˜å¹¶å‘æ€§ã€‚\nQReadWriteLock lock;QString readData() &#123;    QReadLocker locker(&amp;lock); // å¤šä¸ªè¯»è€…å¯ä»¥åŒæ—¶è¿›å…¥    return shared_data;&#125;void writeData(const QString &amp;data) &#123;    QWriteLocker locker(&amp;lock); // å†™è€…æ˜¯ç‹¬å çš„    shared_data = data;&#125;\n\nQSemaphore (ä¿¡å·é‡): ç”¨äºä¿æŠ¤ä¸€å®šæ•°é‡çš„ç›¸åŒèµ„æºã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¤§å°ä¸º N çš„èµ„æºæ± ï¼Œå¯ä»¥æœ‰ N ä¸ªçº¿ç¨‹åŒæ—¶è·å–èµ„æºã€‚\n\nQWaitCondition (ç­‰å¾…æ¡ä»¶): ç”¨äºå®ç°å¤æ‚çš„çº¿ç¨‹åŒæ­¥ï¼Œé€šå¸¸ä¸ QMutex é…åˆä½¿ç”¨ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ç­‰å¾… (wait()) æŸä¸ªæ¡ä»¶å˜ä¸ºçœŸï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åœ¨æ”¹å˜æ¡ä»¶åå¯ä»¥å”¤é†’ (wakeOne() æˆ– wakeAll()) ç­‰å¾…çš„çº¿ç¨‹ã€‚\n\n\né«˜çº§å¹¶å‘ï¼šQThreadPool ä¸ QtConcurrentå¯¹äºè®¸å¤šå¸¸è§çš„å¹¶å‘ä»»åŠ¡ï¼Œä½ ç”šè‡³ä¸éœ€è¦ç›´æ¥ä½¿ç”¨ QThreadã€‚Qt æä¾›äº†æ›´é«˜çº§çš„ APIã€‚\n\nQThreadPool: ä¸€ä¸ªå…¨å±€çš„çº¿ç¨‹æ± ï¼Œç”¨äºæ‰§è¡Œç®€çŸ­çš„ã€ç‹¬ç«‹çš„ä»»åŠ¡ã€‚ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ª QRunnable çš„ä»»åŠ¡ç±»ï¼Œç„¶åå°†å…¶æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ã€‚\nclass MyTask : public QRunnable &#123;    void run() override &#123; /* ... è€—æ—¶æ“ä½œ ... */ &#125;&#125;;MyTask *task = new MyTask();QThreadPool::globalInstance()-&gt;start(task);\n\nQtConcurrent: ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„æ¡†æ¶ï¼Œç”¨äºä»¥å¹¶è¡Œæ–¹å¼å¤„ç†æ•°æ®é›†åˆï¼Œç±»ä¼¼äºå‡½æ•°å¼ç¼–ç¨‹ã€‚å®ƒè‡ªåŠ¨ä½¿ç”¨ QThreadPoolã€‚\n#include &lt;QtConcurrent&gt;#include &lt;QStringList&gt;#include &lt;QFuture&gt;QStringList strings = &#123;&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;&#125;;// 1. å¹¶è¡Œæ˜ å°„ (map): å¯¹æ¯ä¸ªå…ƒç´ åº”ç”¨ä¸€ä¸ªå‡½æ•°QFuture&lt;QString&gt; future = QtConcurrent::mapped(strings, [](const QString &amp;s) &#123;    return s.toUpper();&#125;);future.waitForFinished();qDebug() &lt;&lt; future.results(); // è¾“å‡º: (&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;)// 2. å¹¶è¡Œè¿‡æ»¤ (filter): ç­›é€‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ QFuture&lt;QString&gt; future2 = QtConcurrent::filtered(strings, [](const QString &amp;s) &#123;    return s &gt; &quot;b&quot;;&#125;);// ...// 3. å¹¶è¡Œè§„çº¦ (reduce): å°†æ‰€æœ‰å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªç»“æœQFuture&lt;int&gt; future3 = QtConcurrent::reduced(QList&lt;int&gt;&#123;1,2,3,4&#125;, [](int &amp;sum, int val) &#123;    sum += val;&#125;);// ...\n\næœ€ä½³å®è·µä¸æ ¸å¿ƒåŸåˆ™\nä¼˜å…ˆä½¿ç”¨é«˜çº§ API: å°½å¯èƒ½ä¼˜å…ˆä½¿ç”¨ QtConcurrent æˆ– QThreadPoolã€‚åªæœ‰åœ¨éœ€è¦å¯¹çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸè¿›è¡Œç²¾ç»†æ§åˆ¶æ—¶ï¼Œæ‰ç›´æ¥ä½¿ç”¨ QThreadã€‚\nä¼˜å…ˆä½¿ç”¨ Worker-Object æ¨¡å¼: å½“ä½ å¿…é¡»ä½¿ç”¨ QThread æ—¶ï¼ŒmoveToThread æ¨¡å¼æ˜¯é¦–é€‰ã€‚å®ƒèƒ½è®©ä½ åœ¨å·¥ä½œçº¿ç¨‹ä¸­å®‰å…¨åœ°ä½¿ç”¨ä¿¡å·æ§½ï¼Œæ˜¯ä¸ Qt äº‹ä»¶é©±åŠ¨æ¨¡å‹ç»“åˆå¾—æœ€å¥½çš„æ–¹å¼ã€‚\nä¸¥ç¦ç›´æ¥æ“ä½œ GUI: ä»»ä½•æ—¶å€™éƒ½ä¸è¦åœ¨ä¸»çº¿ç¨‹ä»¥å¤–çš„çº¿ç¨‹ä¸­ç›´æ¥åˆ›å»ºã€è®¿é—®æˆ–ä¿®æ”¹ QWidget åŠå…¶å­ç±»å¯¹è±¡ã€‚æ‰€æœ‰ä¸ GUI çš„äº¤äº’éƒ½å¿…é¡»é€šè¿‡ä¿¡å·æ§½æœºåˆ¶ï¼Œå°†ä»»åŠ¡çš„æ‰§è¡Œç»“æœå‘é€åˆ°ä¸»çº¿ç¨‹çš„æ§½å‡½æ•°ä¸­ï¼Œå†ç”±è¯¥æ§½å‡½æ•°æ›´æ–°ç•Œé¢ã€‚\nä¿æŠ¤å…±äº«æ•°æ®: åªè¦æœ‰æ•°æ®å¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œå°±å¿…é¡»ä½¿ç”¨ QMutex æˆ–å…¶ä»–åŒæ­¥å·¥å…·æ¥ä¿æŠ¤å®ƒã€‚\næ³¨æ„å¯¹è±¡æ‰€æœ‰æƒ: å½“ä½¿ç”¨ moveToThread æ—¶ï¼Œè¦ç¡®ä¿ Worker å¯¹è±¡å’Œ QThread å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸè¢«æ­£ç¡®ç®¡ç†ã€‚é€šå¸¸çš„åšæ³•æ˜¯å°†å®ƒä»¬éƒ½è®¾ç½®ä¸ºæŸä¸ªä¸»çº¿ç¨‹å¯¹è±¡çš„å­å¯¹è±¡ï¼Œæˆ–è€…åœ¨çº¿ç¨‹ç»“æŸåä½¿ç”¨ deleteLater() æ¥å®‰å…¨åœ°åˆ é™¤å®ƒä»¬ã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","å¤šçº¿ç¨‹","å¹¶å‘","QThread","QtConcurrent","çº¿ç¨‹åŒæ­¥"]},{"title":"Qt SQL æ•°æ®åº“æŒ‡å—","url":"/posts/835264d4/","content":"Qt SQL æ•°æ®åº“æŒ‡å—ç›®å½•\næ¦‚è¿°ï¼šQt SQL æ¨¡å—\nç¬¬ä¸€æ­¥ï¼šé…ç½®ä¸è¿æ¥æ•°æ®åº“\nç¬¬äºŒæ­¥ï¼šä½¿ç”¨ QSqlQuery æ‰§è¡Œ SQL å‘½ä»¤\nç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨æ¨¡å‹&#x2F;è§†å›¾æ˜¾ç¤ºæ•°æ®\nç¬¬å››æ­¥ï¼šä½¿ç”¨äº‹åŠ¡\næœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜\n\næ¦‚è¿°ï¼šQt SQL æ¨¡å—Qt çš„ SQL æ¨¡å—æä¾›äº†ä¸€å¥—ä¸å¹³å°å’Œæ•°æ®åº“æ— å…³çš„æ¥å£ï¼Œç”¨äºè®¿é—® SQL æ•°æ®åº“ã€‚å…¶æ ¸å¿ƒæ˜¯é©±åŠ¨ç¨‹åºæ¶æ„ï¼Œå…è®¸ä½ ä½¿ç”¨ç›¸åŒçš„ Qt API æ¥æ“ä½œå¤šç§ä¸åŒçš„æ•°æ®åº“ï¼Œå¦‚ SQLite, MySQL, PostgreSQL ç­‰ã€‚\næ ¸å¿ƒç±»\nQSqlDatabase: ä»£è¡¨ä¸€ä¸ªæ•°æ®åº“è¿æ¥ã€‚å®ƒè´Ÿè´£ç®¡ç†è¿æ¥æœ¬èº«ã€‚\nQSqlQuery: ç”¨äºæ‰§è¡Œ SQL è¯­å¥ï¼Œå¹¶éå†æŸ¥è¯¢ç»“æœã€‚\nQSqlQueryModel: ä¸€ä¸ªåªè¯»çš„æ•°æ®æ¨¡å‹ï¼Œç”¨äºå°†ä¸€ä¸ª SQL æŸ¥è¯¢çš„ç»“æœç›´æ¥å±•ç¤ºåœ¨è§†å›¾ï¼ˆå¦‚ QTableViewï¼‰ä¸­ã€‚\nQSqlTableModel: ä¸€ä¸ªå¯è¯»å†™çš„æ•°æ®æ¨¡å‹ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªå•ä¸€çš„æ•°æ®åº“è¡¨ï¼Œå¹¶å…è®¸åœ¨è§†å›¾ä¸­ç›´æ¥ç¼–è¾‘æ•°æ®ã€‚\n\nç¬¬ä¸€æ­¥ï¼šé…ç½®ä¸è¿æ¥æ•°æ®åº“1. é¡¹ç›®é…ç½® (.pro æ–‡ä»¶)ç¡®ä¿ä½ çš„é¡¹ç›®æ–‡ä»¶åŒ…å«äº† sql æ¨¡å—ã€‚\nQT += core gui sql\n\n2. æ£€æŸ¥é©±åŠ¨åœ¨ä½¿ç”¨ç‰¹å®šæ•°æ®åº“å‰ï¼Œåº”æ£€æŸ¥ Qt æ˜¯å¦æœ‰å¯ç”¨çš„é©±åŠ¨ã€‚\n#include &lt;QSqlDatabase&gt;#include &lt;QDebug&gt;qDebug() &lt;&lt; &quot;Available drivers:&quot; &lt;&lt; QSqlDatabase::drivers();// è¾“å‡ºåº”åŒ…å« &quot;QSQLITE&quot;, &quot;QMYSQL&quot;, &quot;QPSQL&quot; ç­‰\nå¦‚æœç¼ºå°‘é©±åŠ¨ï¼Œä½ éœ€è¦å®‰è£…å®ƒï¼ˆä¾‹å¦‚ï¼Œåœ¨ Ubuntu ä¸Š sudo apt-get install libqt5sql5-mysqlï¼‰ã€‚\n3. å»ºç«‹è¿æ¥ (SQLite ç¤ºä¾‹)SQLite æ˜¯æœ€ç®€å•çš„å…¥é—¨æ•°æ®åº“ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ï¼Œæ— éœ€æœåŠ¡å™¨ã€‚\n#include &lt;QSqlDatabase&gt;#include &lt;QDebug&gt;#include &lt;QSqlError&gt;bool createConnection() &#123;    // 1. æ·»åŠ ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œä½¿ç”¨é»˜è®¤è¿æ¥å    QSqlDatabase db = QSqlDatabase::addDatabase(&quot;QSQLITE&quot;);    // 2. è®¾ç½®æ•°æ®åº“æ–‡ä»¶å    db.setDatabaseName(&quot;mydatabase.db&quot;);    // 3. æ‰“å¼€è¿æ¥    if (!db.open()) &#123;        qWarning() &lt;&lt; &quot;Connection failed:&quot; &lt;&lt; db.lastError().text();        return false;    &#125;    qDebug() &lt;&lt; &quot;Database connected successfully!&quot;;    return true;&#125;\næç¤º: QSqlDatabase::addDatabase è¿”å›çš„æ˜¯ä¸€ä¸ªå€¼ï¼Œä½†å®ƒå®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªå¯è¢«å…¨å±€è®¿é—®çš„é™æ€å®ä¾‹ã€‚ä½ å¯ä»¥é€šè¿‡ QSqlDatabase::database() æ¥éšæ—¶è·å–è¿™ä¸ªè¿æ¥çš„å¼•ç”¨ã€‚\nç¬¬äºŒæ­¥ï¼šä½¿ç”¨ QSqlQuery æ‰§è¡Œ SQL å‘½ä»¤QSqlQuery æ˜¯æ‰§è¡Œæ‰€æœ‰ SQL æ“ä½œçš„æ ¸å¿ƒã€‚\n1. æ‰§è¡Œç®€å•æŸ¥è¯¢ (DDL å’Œ DML)#include &lt;QSqlQuery&gt;void setupDatabase() &#123;    QSqlQuery query; // é»˜è®¤ä½¿ç”¨ä¸»è¿æ¥    // åˆ›å»ºè¡¨    bool success = query.exec(&quot;CREATE TABLE IF NOT EXISTS contacts (&quot;                            &quot;id INTEGER PRIMARY KEY AUTOINCREMENT, &quot;                            &quot;name TEXT NOT NULL, &quot;                            &quot;phone TEXT)&quot;);    if (!success) &#123;        qWarning() &lt;&lt; &quot;Create table failed:&quot; &lt;&lt; query.lastError();    &#125;    // æ’å…¥æ•°æ®    query.exec(&quot;INSERT INTO contacts (name, phone) VALUES (&#x27;Alice&#x27;, &#x27;+1-202-555-0173&#x27;)&quot;);&#125;\n\n2. ä½¿ç”¨é¢„å¤„ç†æŸ¥è¯¢ (é˜²æ­¢ SQL æ³¨å…¥)å½“ä½ çš„æŸ¥è¯¢éœ€è¦åŒ…å«æ¥è‡ªç”¨æˆ·è¾“å…¥ç­‰å¤–éƒ¨æ¥æºçš„æ•°æ®æ—¶ï¼Œå¿…é¡»ä½¿ç”¨é¢„å¤„ç†æŸ¥è¯¢æ¥é˜²æ­¢ SQL æ³¨å…¥æ”»å‡»ã€‚\nvoid addContact(const QString &amp;name, const QString &amp;phone) &#123;    QSqlQuery query;        // 1. å‡†å¤‡ä¸€ä¸ªå¸¦å ä½ç¬¦çš„æŸ¥è¯¢    query.prepare(&quot;INSERT INTO contacts (name, phone) VALUES (:name, :phone)&quot;);        // 2. ç»‘å®šå€¼åˆ°å ä½ç¬¦    query.bindValue(&quot;:name&quot;, name);    query.bindValue(&quot;:phone&quot;, phone);        // 3. æ‰§è¡ŒæŸ¥è¯¢    if (!query.exec()) &#123;        qWarning() &lt;&lt; &quot;Add contact failed:&quot; &lt;&lt; query.lastError();    &#125;&#125;\n\n3. éå†æŸ¥è¯¢ç»“æœvoid printAllContacts() &#123;    QSqlQuery query(&quot;SELECT id, name, phone FROM contacts&quot;);        // query.next() ä¼šå°†å†…éƒ¨æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€æ¡è®°å½•    while (query.next()) &#123;        int id = query.value(0).toInt();        QString name = query.value(1).toString();        QString phone = query.value(&quot;phone&quot;).toString(); // ä¹Ÿå¯ä»¥æŒ‰åˆ—åè·å–        qDebug() &lt;&lt; &quot;ID:&quot; &lt;&lt; id &lt;&lt; &quot;Name:&quot; &lt;&lt; name &lt;&lt; &quot;Phone:&quot; &lt;&lt; phone;    &#125;&#125;\n\nç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨æ¨¡å‹&#x2F;è§†å›¾æ˜¾ç¤ºæ•°æ®Qt çš„ SQL æ¨¡å—ä¸æ¨¡å‹&#x2F;è§†å›¾æ¡†æ¶æ— ç¼é›†æˆï¼Œå¯ä»¥è½»æ¾åœ°å°†æ•°æ®åº“æ•°æ®æ˜¾ç¤ºåœ¨ UI ä¸Šã€‚\n1. QSqlQueryModel (åªè¯»æ¨¡å‹)è¿™ä¸ªæ¨¡å‹æœ€é€‚åˆç”¨äºæ˜¾ç¤ºå¤æ‚æŸ¥è¯¢ï¼ˆå¦‚ JOINï¼‰çš„ç»“æœã€‚\n// åœ¨ MainWindow ä¸­#include &lt;QSqlQueryModel&gt;void MainWindow::setupQueryView() &#123;    auto *model = new QSqlQueryModel(this);    model-&gt;setQuery(&quot;SELECT name, phone FROM contacts ORDER BY name&quot;);    // è®¾ç½®è¡¨å¤´    model-&gt;setHeaderData(0, Qt::Horizontal, tr(&quot;Name&quot;));    model-&gt;setHeaderData(1, Qt::Horizontal, tr(&quot;Phone Number&quot;));    ui-&gt;tableView-&gt;setModel(model);&#125;\n\n2. QSqlTableModel (è¯»å†™æ¨¡å‹)è¿™ä¸ªæ¨¡å‹ä»£è¡¨ä¸€ä¸ªå•ä¸€çš„æ•°æ®åº“è¡¨ï¼Œå¹¶æ”¯æŒç›´æ¥åœ¨è§†å›¾ä¸­è¿›è¡Œç¼–è¾‘ã€‚\n// åœ¨ MainWindow ä¸­#include &lt;QSqlTableModel&gt;void MainWindow::setupTableView() &#123;    auto *model = new QSqlTableModel(this); // db å‚æ•°é»˜è®¤ä¸ºä¸»è¿æ¥    model-&gt;setTable(&quot;contacts&quot;);    // è®¾ç½®ç¼–è¾‘ç­–ç•¥ï¼šOnManualSubmit è¡¨ç¤ºæ‰€æœ‰ä¿®æ”¹éƒ½å°†ç¼“å­˜ï¼Œç›´åˆ°æ‰‹åŠ¨æäº¤    model-&gt;setEditStrategy(QSqlTableModel::OnManualSubmit);    // ä»æ•°æ®åº“åŠ è½½æ•°æ®    model-&gt;select();    // è®¾ç½®è¡¨å¤´    model-&gt;setHeaderData(1, Qt::Horizontal, tr(&quot;Name&quot;));    model-&gt;setHeaderData(2, Qt::Horizontal, tr(&quot;Phone Number&quot;));    ui-&gt;tableView-&gt;setModel(model);    ui-&gt;tableView-&gt;hideColumn(0); // éšè— ID åˆ—    // ... åœ¨ UI ä¸Šæ·»åŠ  &quot;Submit&quot; å’Œ &quot;Revert&quot; æŒ‰é’®    connect(ui-&gt;submitButton, &amp;QPushButton::clicked, model, &amp;QSqlTableModel::submitAll);    connect(ui-&gt;revertButton, &amp;QPushButton::clicked, model, &amp;QSqlTableModel::revertAll);&#125;\n\nç¬¬å››æ­¥ï¼šä½¿ç”¨äº‹åŠ¡å½“éœ€è¦æ‰§è¡Œå¤šä¸ªå…³è”çš„ SQL è¯­å¥ï¼Œå¹¶ç¡®ä¿å®ƒä»¬è¦ä¹ˆå…¨éƒ¨æˆåŠŸã€è¦ä¹ˆå…¨éƒ¨å¤±è´¥æ—¶ï¼Œåº”ä½¿ç”¨äº‹åŠ¡ã€‚\nvoid performTransaction() &#123;    QSqlDatabase db = QSqlDatabase::database(); // è·å–é»˜è®¤è¿æ¥    // 1. å¼€å§‹äº‹åŠ¡    if (!db.transaction()) &#123;        qWarning() &lt;&lt; &quot;Failed to start transaction:&quot; &lt;&lt; db.lastError();        return;    &#125;    QSqlQuery query(db);    query.prepare(&quot;UPDATE accounts SET balance = balance - 100 WHERE id = 1&quot;);    bool success1 = query.exec();    query.prepare(&quot;UPDATE accounts SET balance = balance + 100 WHERE id = 2&quot;);    bool success2 = query.exec();    // 2. å¦‚æœæ‰€æœ‰æ“ä½œéƒ½æˆåŠŸï¼Œåˆ™æäº¤äº‹åŠ¡    if (success1 &amp;&amp; success2) &#123;        if (db.commit()) &#123;            qDebug() &lt;&lt; &quot;Transaction successful!&quot;;        &#125; else &#123;            qWarning() &lt;&lt; &quot;Commit failed:&quot; &lt;&lt; db.lastError();            db.rollback(); // å°è¯•å›æ»š        &#125;    &#125; else &#123;        // 3. å¦‚æœæœ‰ä»»ä½•æ“ä½œå¤±è´¥ï¼Œåˆ™å›æ»šäº‹åŠ¡        qWarning() &lt;&lt; &quot;One of the queries failed, rolling back.&quot;;        db.rollback();    &#125;&#125;\n\næœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜\né˜²æ­¢ SQL æ³¨å…¥: æ°¸è¿œä¸è¦æ‰‹åŠ¨æ‹¼æ¥ SQL æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚å§‹ç»ˆä½¿ç”¨ QSqlQuery::prepare() å’Œ bindValue() æ¥å¤„ç†ç”¨æˆ·è¾“å…¥ã€‚\nç®¡ç†è¿æ¥: å¯¹äºå¤šçº¿ç¨‹åº”ç”¨ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰è‡ªå·±ç‹¬ç«‹çš„æ•°æ®åº“è¿æ¥ã€‚å¯ä»¥é€šè¿‡ QSqlDatabase::addDatabase(&quot;QSQLITE&quot;, &quot;connection_name&quot;) åˆ›å»ºå‘½åè¿æ¥ï¼Œå¹¶åœ¨éœ€è¦æ—¶é€šè¿‡ QSqlDatabase::database(&quot;connection_name&quot;) è·å–ã€‚\né”™è¯¯å¤„ç†: æ¯æ¬¡æ•°æ®åº“æ“ä½œåï¼Œéƒ½åº”æ£€æŸ¥ QSqlDatabase::lastError() æˆ– QSqlQuery::lastError() æ¥ç¡®è®¤æ“ä½œæ˜¯å¦æˆåŠŸã€‚\næ¨¡å‹ vs. æ‰‹åŠ¨æŸ¥è¯¢: ä¼˜å…ˆä½¿ç”¨ QSqlQueryModel å’Œ QSqlTableModel æ¥ä¸ UI äº¤äº’ï¼Œè¿™æ¯”æ‰‹åŠ¨ä»æŸ¥è¯¢ç»“æœä¸­è¯»å–æ•°æ®å¹¶å¡«å…… UI è¦ç®€å•å’Œé«˜æ•ˆå¾—å¤šã€‚\n\n","categories":["C++æ ¸å¿ƒå¼€å‘","Qtæ¡†æ¶"],"tags":["C++","Qt","æ•°æ®åº“","QSqlDatabase","QSqlQuery","QSqlTableModel","SQL"]}]